<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._linprog_rs Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html">_linprog_rs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._linprog_rs Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab31637da9838086fccb4ae68dfabbfdd" id="r_ab31637da9838086fccb4ae68dfabbfdd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#ab31637da9838086fccb4ae68dfabbfdd">_phase_one</a> (A, b, x0, callback, postsolve_args, maxiter, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>, disp, maxupdate, mast, pivot)</td></tr>
<tr class="separator:ab31637da9838086fccb4ae68dfabbfdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3fa822141926963bdd0c3624cd69b29" id="r_af3fa822141926963bdd0c3624cd69b29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#af3fa822141926963bdd0c3624cd69b29">_get_more_basis_columns</a> (A, basis)</td></tr>
<tr class="separator:af3fa822141926963bdd0c3624cd69b29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab61cd563b9f4544b4bcc3b1fe265a048" id="r_ab61cd563b9f4544b4bcc3b1fe265a048"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#ab61cd563b9f4544b4bcc3b1fe265a048">_generate_auxiliary_problem</a> (A, b, x0, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>)</td></tr>
<tr class="separator:ab61cd563b9f4544b4bcc3b1fe265a048"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a66f0d856ae387507be5e97c966b9d" id="r_aa0a66f0d856ae387507be5e97c966b9d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#aa0a66f0d856ae387507be5e97c966b9d">_select_singleton_columns</a> (A, b)</td></tr>
<tr class="separator:aa0a66f0d856ae387507be5e97c966b9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573a41e1ea8067128e24e97e1c0c2613" id="r_a573a41e1ea8067128e24e97e1c0c2613"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#a573a41e1ea8067128e24e97e1c0c2613">_find_nonzero_rows</a> (A, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>)</td></tr>
<tr class="separator:a573a41e1ea8067128e24e97e1c0c2613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f155d34e56c5e7076d96197c16d6e8" id="r_ab7f155d34e56c5e7076d96197c16d6e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#ab7f155d34e56c5e7076d96197c16d6e8">_select_enter_pivot</a> (c_hat, bl, <a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>, rule=&quot;bland&quot;, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-12)</td></tr>
<tr class="separator:ab7f155d34e56c5e7076d96197c16d6e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad24b4606118df6979b325ea365798ffc" id="r_ad24b4606118df6979b325ea365798ffc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#ad24b4606118df6979b325ea365798ffc">_display_iter</a> (phase, iteration, slack, con, fun)</td></tr>
<tr class="separator:ad24b4606118df6979b325ea365798ffc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad90a7c73f256be191954faaf71a30546" id="r_ad90a7c73f256be191954faaf71a30546"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#ad90a7c73f256be191954faaf71a30546">_display_and_callback</a> (phase_one_n, <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, postsolve_args, status, iteration, disp, callback)</td></tr>
<tr class="separator:ad90a7c73f256be191954faaf71a30546"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62c649559668aa374d35130644a4acd6" id="r_a62c649559668aa374d35130644a4acd6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#a62c649559668aa374d35130644a4acd6">_phase_two</a> (c, A, <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, b, callback, postsolve_args, maxiter, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>, disp, maxupdate, mast, pivot, iteration=0, phase_one_n=None)</td></tr>
<tr class="separator:a62c649559668aa374d35130644a4acd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b4d0c1bf7dc31f9a802263599799428" id="r_a1b4d0c1bf7dc31f9a802263599799428"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__linprog__rs.html#a1b4d0c1bf7dc31f9a802263599799428">_linprog_rs</a> (c, c0, A, b, x0, callback, postsolve_args, maxiter=5000, <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-12, disp=False, maxupdate=10, mast=False, pivot=&quot;mrc&quot;, **unknown_options)</td></tr>
<tr class="separator:a1b4d0c1bf7dc31f9a802263599799428"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Revised simplex method for linear programming

The *revised simplex* method uses the method described in [1]_, except
that a factorization [2]_ of the basis matrix, rather than its inverse,
is efficiently maintained and used to solve the linear systems at each
iteration of the algorithm.

.. versionadded:: 1.3.0

References
----------
.. [1] Bertsimas, Dimitris, and J. Tsitsiklis. "Introduction to linear
           programming." Athena Scientific 1 (1997): 997.
.. [2] Bartels, Richard H. "A stabilization of the simplex method."
            Journal in  Numerische Mathematik 16.5 (1971): 414-434.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="ad90a7c73f256be191954faaf71a30546" name="ad90a7c73f256be191954faaf71a30546"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad90a7c73f256be191954faaf71a30546">&#9670;&#160;</a></span>_display_and_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._display_and_callback </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>phase_one_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  313</span>                          iteration, disp, callback):</div>
<div class="line"><span class="lineno">  314</span>    <span class="keywordflow">if</span> phase_one_n <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  315</span>        phase = 1</div>
<div class="line"><span class="lineno">  316</span>        x_postsolve = x[:phase_one_n]</div>
<div class="line"><span class="lineno">  317</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  318</span>        phase = 2</div>
<div class="line"><span class="lineno">  319</span>        x_postsolve = x</div>
<div class="line"><span class="lineno">  320</span>    x_o, fun, slack, con = _postsolve(x_postsolve,</div>
<div class="line"><span class="lineno">  321</span>                                      postsolve_args)</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordflow">if</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  324</span>        res = OptimizeResult({<span class="stringliteral">&#39;x&#39;</span>: x_o, <span class="stringliteral">&#39;fun&#39;</span>: fun, <span class="stringliteral">&#39;slack&#39;</span>: slack,</div>
<div class="line"><span class="lineno">  325</span>                              <span class="stringliteral">&#39;con&#39;</span>: con, <span class="stringliteral">&#39;nit&#39;</span>: iteration,</div>
<div class="line"><span class="lineno">  326</span>                              <span class="stringliteral">&#39;phase&#39;</span>: phase, <span class="stringliteral">&#39;complete&#39;</span>: <span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  327</span>                              <span class="stringliteral">&#39;status&#39;</span>: status, <span class="stringliteral">&#39;message&#39;</span>: <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  328</span>                              <span class="stringliteral">&#39;success&#39;</span>: <span class="keyword">False</span>})</div>
<div class="line"><span class="lineno">  329</span>        callback(res)</div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">if</span> disp:</div>
<div class="line"><span class="lineno">  331</span>        _display_iter(phase, iteration, slack, con, fun)</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad24b4606118df6979b325ea365798ffc" name="ad24b4606118df6979b325ea365798ffc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad24b4606118df6979b325ea365798ffc">&#9670;&#160;</a></span>_display_iter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._display_iter </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>slack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Print indicators of optimization status to the console.
</pre> <div class="fragment"><div class="line"><span class="lineno">  290</span><span class="keyword">def </span>_display_iter(phase, iteration, slack, con, fun):</div>
<div class="line"><span class="lineno">  291</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    Print indicators of optimization status to the console.</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  294</span>    header = <span class="keyword">True</span> <span class="keywordflow">if</span> <span class="keywordflow">not</span> iteration % 20 <span class="keywordflow">else</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    <span class="keywordflow">if</span> header:</div>
<div class="line"><span class="lineno">  297</span>        print(<span class="stringliteral">&quot;Phase&quot;</span>,</div>
<div class="line"><span class="lineno">  298</span>              <span class="stringliteral">&quot;Iteration&quot;</span>,</div>
<div class="line"><span class="lineno">  299</span>              <span class="stringliteral">&quot;Minimum Slack      &quot;</span>,</div>
<div class="line"><span class="lineno">  300</span>              <span class="stringliteral">&quot;Constraint Residual&quot;</span>,</div>
<div class="line"><span class="lineno">  301</span>              <span class="stringliteral">&quot;Objective          &quot;</span>)</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>    <span class="comment"># :&lt;X.Y left aligns Y digits in X digit spaces</span></div>
<div class="line"><span class="lineno">  304</span>    fmt = <span class="stringliteral">&#39;{0:&lt;6}{1:&lt;10}{2:&lt;20.13}{3:&lt;20.13}{4:&lt;20.13}&#39;</span></div>
<div class="line"><span class="lineno">  305</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  306</span>        slack = np.min(slack)</div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno">  308</span>        slack = <span class="stringliteral">&quot;NA&quot;</span></div>
<div class="line"><span class="lineno">  309</span>    print(fmt.format(phase, iteration, slack, np.linalg.norm(con), fun))</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a573a41e1ea8067128e24e97e1c0c2613" name="a573a41e1ea8067128e24e97e1c0c2613"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a573a41e1ea8067128e24e97e1c0c2613">&#9670;&#160;</a></span>_find_nonzero_rows()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._find_nonzero_rows </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns logical array indicating the locations of rows with at least
one nonzero element.
</pre> <div class="fragment"><div class="line"><span class="lineno">  271</span><span class="keyword">def </span>_find_nonzero_rows(A, tol):</div>
<div class="line"><span class="lineno">  272</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">    Returns logical array indicating the locations of rows with at least</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">    one nonzero element.</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  276</span>    <span class="keywordflow">return</span> np.any(np.abs(A) &gt; tol, axis=1)</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab61cd563b9f4544b4bcc3b1fe265a048" name="ab61cd563b9f4544b4bcc3b1fe265a048"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab61cd563b9f4544b4bcc3b1fe265a048">&#9670;&#160;</a></span>_generate_auxiliary_problem()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._generate_auxiliary_problem </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Modifies original problem to create an auxiliary problem with a trivial
initial basic feasible solution and an objective that minimizes
infeasibility in the original problem.

Conceptually, this is done by stacking an identity matrix on the right of
the original constraint matrix, adding artificial variables to correspond
with each of these new columns, and generating a cost vector that is all
zeros except for ones corresponding with each of the new variables.

A initial basic feasible solution is trivial: all variables are zero
except for the artificial variables, which are set equal to the
corresponding element of the right hand side `b`.

Runnning the simplex method on this auxiliary problem drives all of the
artificial variables - and thus the cost - to zero if the original problem
is feasible. The original problem is declared infeasible otherwise.

Much of the complexity below is to improve efficiency by using singleton
columns in the original problem where possible, thus generating artificial
variables only as necessary, and using an initial 'guess' basic feasible
solution.
</pre> <div class="fragment"><div class="line"><span class="lineno">  136</span><span class="keyword">def </span>_generate_auxiliary_problem(A, b, x0, tol):</div>
<div class="line"><span class="lineno">  137</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    Modifies original problem to create an auxiliary problem with a trivial</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    initial basic feasible solution and an objective that minimizes</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    infeasibility in the original problem.</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">    Conceptually, this is done by stacking an identity matrix on the right of</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    the original constraint matrix, adding artificial variables to correspond</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    with each of these new columns, and generating a cost vector that is all</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    zeros except for ones corresponding with each of the new variables.</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    A initial basic feasible solution is trivial: all variables are zero</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    except for the artificial variables, which are set equal to the</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    corresponding element of the right hand side `b`.</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    Runnning the simplex method on this auxiliary problem drives all of the</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    artificial variables - and thus the cost - to zero if the original problem</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    is feasible. The original problem is declared infeasible otherwise.</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">    Much of the complexity below is to improve efficiency by using singleton</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">    columns in the original problem where possible, thus generating artificial</span></div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    variables only as necessary, and using an initial &#39;guess&#39; basic feasible</span></div>
<div class="line"><span class="lineno">  158</span><span class="stringliteral">    solution.</span></div>
<div class="line"><span class="lineno">  159</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  160</span>    status = 0</div>
<div class="line"><span class="lineno">  161</span>    m, n = A.shape</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  164</span>        x = x0</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  166</span>        x = np.zeros(n)</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    r = b - A<span class="preprocessor">@x</span>  <span class="comment"># residual; this must be all zeros for feasibility</span></div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>    A[r &lt; 0] = -A[r &lt; 0]  <span class="comment"># express problem with RHS positive for trivial BFS</span></div>
<div class="line"><span class="lineno">  171</span>    b[r &lt; 0] = -b[r &lt; 0]  <span class="comment"># to the auxiliary problem</span></div>
<div class="line"><span class="lineno">  172</span>    r[r &lt; 0] *= -1</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>    <span class="comment"># Rows which we will need to find a trivial way to zero.</span></div>
<div class="line"><span class="lineno">  175</span>    <span class="comment"># This should just be the rows where there is a nonzero residual.</span></div>
<div class="line"><span class="lineno">  176</span>    <span class="comment"># But then we would not necessarily have a column singleton in every row.</span></div>
<div class="line"><span class="lineno">  177</span>    <span class="comment"># This makes it difficult to find an initial basis.</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="keywordflow">if</span> x0 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  179</span>        nonzero_constraints = np.arange(m)</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  181</span>        nonzero_constraints = np.where(r &gt; tol)[0]</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="comment"># these are (at least some of) the initial basis columns</span></div>
<div class="line"><span class="lineno">  184</span>    basis = np.where(np.abs(x) &gt; tol)[0]</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <span class="keywordflow">if</span> len(nonzero_constraints) == 0 <span class="keywordflow">and</span> len(basis) &lt;= m:  <span class="comment"># already a BFS</span></div>
<div class="line"><span class="lineno">  187</span>        c = np.zeros(n)</div>
<div class="line"><span class="lineno">  188</span>        basis = _get_more_basis_columns(A, basis)</div>
<div class="line"><span class="lineno">  189</span>        <span class="keywordflow">return</span> A, b, c, basis, x, status</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordflow">elif</span> (len(nonzero_constraints) &gt; m - len(basis) <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  191</span>          np.any(x &lt; 0)):  <span class="comment"># can&#39;t get trivial BFS</span></div>
<div class="line"><span class="lineno">  192</span>        c = np.zeros(n)</div>
<div class="line"><span class="lineno">  193</span>        status = 6</div>
<div class="line"><span class="lineno">  194</span>        <span class="keywordflow">return</span> A, b, c, basis, x, status</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="comment"># chooses existing columns appropriate for inclusion in initial basis</span></div>
<div class="line"><span class="lineno">  197</span>    cols, rows = _select_singleton_columns(A, r)</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="comment"># find the rows we need to zero that we _can_ zero with column singletons</span></div>
<div class="line"><span class="lineno">  200</span>    i_tofix = np.isin(rows, nonzero_constraints)</div>
<div class="line"><span class="lineno">  201</span>    <span class="comment"># these columns can&#39;t already be in the basis, though</span></div>
<div class="line"><span class="lineno">  202</span>    <span class="comment"># we are going to add them to the basis and change the corresponding x val</span></div>
<div class="line"><span class="lineno">  203</span>    i_notinbasis = np.logical_not(np.isin(cols, basis))</div>
<div class="line"><span class="lineno">  204</span>    i_fix_without_aux = np.logical_and(i_tofix, i_notinbasis)</div>
<div class="line"><span class="lineno">  205</span>    rows = rows[i_fix_without_aux]</div>
<div class="line"><span class="lineno">  206</span>    cols = cols[i_fix_without_aux]</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>    <span class="comment"># indices of the rows we can only zero with auxiliary variable</span></div>
<div class="line"><span class="lineno">  209</span>    <span class="comment"># these rows will get a one in each auxiliary column</span></div>
<div class="line"><span class="lineno">  210</span>    arows = nonzero_constraints[np.logical_not(</div>
<div class="line"><span class="lineno">  211</span>                                np.isin(nonzero_constraints, rows))]</div>
<div class="line"><span class="lineno">  212</span>    n_aux = len(arows)</div>
<div class="line"><span class="lineno">  213</span>    acols = n + np.arange(n_aux)          <span class="comment"># indices of auxiliary columns</span></div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    basis_ng = np.concatenate((cols, acols))   <span class="comment"># basis columns not from guess</span></div>
<div class="line"><span class="lineno">  216</span>    basis_ng_rows = np.concatenate((rows, arows))  <span class="comment"># rows we need to zero</span></div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>    <span class="comment"># add auxiliary singleton columns</span></div>
<div class="line"><span class="lineno">  219</span>    A = np.hstack((A, np.zeros((m, n_aux))))</div>
<div class="line"><span class="lineno">  220</span>    A[arows, acols] = 1</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>    <span class="comment"># generate initial BFS</span></div>
<div class="line"><span class="lineno">  223</span>    x = np.concatenate((x, np.zeros(n_aux)))</div>
<div class="line"><span class="lineno">  224</span>    x[basis_ng] = r[basis_ng_rows]/A[basis_ng_rows, basis_ng]</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="comment"># generate costs to minimize infeasibility</span></div>
<div class="line"><span class="lineno">  227</span>    c = np.zeros(n_aux + n)</div>
<div class="line"><span class="lineno">  228</span>    c[acols] = 1</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="comment"># basis columns correspond with nonzeros in guess, those with column</span></div>
<div class="line"><span class="lineno">  231</span>    <span class="comment"># singletons we used to zero remaining constraints, and any additional</span></div>
<div class="line"><span class="lineno">  232</span>    <span class="comment"># columns to get a full set (m columns)</span></div>
<div class="line"><span class="lineno">  233</span>    basis = np.concatenate((basis, basis_ng))</div>
<div class="line"><span class="lineno">  234</span>    basis = _get_more_basis_columns(A, basis)  <span class="comment"># add columns as needed</span></div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">return</span> A, b, c, basis, x, status</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af3fa822141926963bdd0c3624cd69b29" name="af3fa822141926963bdd0c3624cd69b29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3fa822141926963bdd0c3624cd69b29">&#9670;&#160;</a></span>_get_more_basis_columns()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._get_more_basis_columns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>basis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Called when the auxiliary problem terminates with artificial columns in
the basis, which must be removed and replaced with non-artificial
columns. Finds additional columns that do not make the matrix singular.
</pre> <div class="fragment"><div class="line"><span class="lineno">  101</span><span class="keyword">def </span>_get_more_basis_columns(A, basis):</div>
<div class="line"><span class="lineno">  102</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    Called when the auxiliary problem terminates with artificial columns in</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    the basis, which must be removed and replaced with non-artificial</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral">    columns. Finds additional columns that do not make the matrix singular.</span></div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  107</span>    m, n = A.shape</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="comment"># options for inclusion are those that aren&#39;t already in the basis</span></div>
<div class="line"><span class="lineno">  110</span>    a = np.arange(m+n)</div>
<div class="line"><span class="lineno">  111</span>    bl = np.zeros(len(a), dtype=bool)</div>
<div class="line"><span class="lineno">  112</span>    bl[basis] = 1</div>
<div class="line"><span class="lineno">  113</span>    options = a[~bl]</div>
<div class="line"><span class="lineno">  114</span>    options = options[options &lt; n]  <span class="comment"># and they have to be non-artificial</span></div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    <span class="comment"># form basis matrix</span></div>
<div class="line"><span class="lineno">  117</span>    B = np.zeros((m, m))</div>
<div class="line"><span class="lineno">  118</span>    B[:, 0:len(basis)] = A[:, basis]</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">if</span> (basis.size &gt; 0 <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  121</span>            np.linalg.matrix_rank(B[:, :len(basis)]) &lt; len(basis)):</div>
<div class="line"><span class="lineno">  122</span>        <span class="keywordflow">raise</span> Exception(<span class="stringliteral">&quot;Basis has dependent columns&quot;</span>)</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>    rank = 0  <span class="comment"># just enter the loop</span></div>
<div class="line"><span class="lineno">  125</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(n):  <span class="comment"># somewhat arbitrary, but we need another way out</span></div>
<div class="line"><span class="lineno">  126</span>        <span class="comment"># permute the options, and take as many as needed</span></div>
<div class="line"><span class="lineno">  127</span>        new_basis = np.random.permutation(options)[:m-len(basis)]</div>
<div class="line"><span class="lineno">  128</span>        B[:, len(basis):] = A[:, new_basis]  <span class="comment"># update the basis matrix</span></div>
<div class="line"><span class="lineno">  129</span>        rank = np.linalg.matrix_rank(B)      <span class="comment"># check the rank</span></div>
<div class="line"><span class="lineno">  130</span>        <span class="keywordflow">if</span> rank == m:</div>
<div class="line"><span class="lineno">  131</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>    <span class="keywordflow">return</span> np.concatenate((basis, new_basis))</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b4d0c1bf7dc31f9a802263599799428" name="a1b4d0c1bf7dc31f9a802263599799428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b4d0c1bf7dc31f9a802263599799428">&#9670;&#160;</a></span>_linprog_rs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._linprog_rs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>5000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-12</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxupdate</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mast</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pivot</em> = <code>&quot;mrc&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>unknown_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Solve the following linear programming problem via a two-phase
revised simplex algorithm.::

    minimize:     c @ x

    subject to:  A @ x == b
                 0 &lt;= x &lt; oo

User-facing documentation is in _linprog_doc.py.

Parameters
----------
c : 1-D array
    Coefficients of the linear objective function to be minimized.
c0 : float
    Constant term in objective function due to fixed (and eliminated)
    variables. (Currently unused.)
A : 2-D array
    2-D array which, when matrix-multiplied by ``x``, gives the values of
    the equality constraints at ``x``.
b : 1-D array
    1-D array of values representing the RHS of each equality constraint
    (row) in ``A_eq``.
x0 : 1-D array, optional
    Starting values of the independent variables, which will be refined by
    the optimization algorithm. For the revised simplex method, these must
    correspond with a basic feasible solution.
callback : callable, optional
    If a callback function is provided, it will be called within each
    iteration of the algorithm. The callback function must accept a single
    `scipy.optimize.OptimizeResult` consisting of the following fields:

        x : 1-D array
            Current solution vector.
        fun : float
            Current value of the objective function ``c @ x``.
        success : bool
            True only when an algorithm has completed successfully,
            so this is always False as the callback function is called
            only while the algorithm is still iterating.
        slack : 1-D array
            The values of the slack variables. Each slack variable
            corresponds to an inequality constraint. If the slack is zero,
            the corresponding constraint is active.
        con : 1-D array
            The (nominally zero) residuals of the equality constraints,
            that is, ``b - A_eq @ x``.
        phase : int
            The phase of the algorithm being executed.
        status : int
            For revised simplex, this is always 0 because if a different
            status is detected, the algorithm terminates.
        nit : int
            The number of iterations performed.
        message : str
            A string descriptor of the exit status of the optimization.
postsolve_args : tuple
    Data needed by _postsolve to convert the solution to the standard-form
    problem into the solution to the original problem.

Options
-------
maxiter : int
   The maximum number of iterations to perform in either phase.
tol : float
    The tolerance which determines when a solution is "close enough" to
    zero in Phase 1 to be considered a basic feasible solution or close
    enough to positive to serve as an optimal solution.
disp : bool
    Set to ``True`` if indicators of optimization status are to be printed
    to the console each iteration.
maxupdate : int
    The maximum number of updates performed on the LU factorization.
    After this many updates is reached, the basis matrix is factorized
    from scratch.
mast : bool
    Minimize Amortized Solve Time. If enabled, the average time to solve
    a linear system using the basis factorization is measured. Typically,
    the average solve time will decrease with each successive solve after
    initial factorization, as factorization takes much more time than the
    solve operation (and updates). Eventually, however, the updated
    factorization becomes sufficiently complex that the average solve time
    begins to increase. When this is detected, the basis is refactorized
    from scratch. Enable this option to maximize speed at the risk of
    nondeterministic behavior. Ignored if ``maxupdate`` is 0.
pivot : "mrc" or "bland"
    Pivot rule: Minimum Reduced Cost (default) or Bland's rule. Choose
    Bland's rule if iteration limit is reached and cycling is suspected.
unknown_options : dict
    Optional arguments not used by this particular solver. If
    `unknown_options` is non-empty a warning is issued listing all
    unused options.

Returns
-------
x : 1-D array
    Solution vector.
status : int
    An integer representing the exit status of the optimization::

     0 : Optimization terminated successfully
     1 : Iteration limit reached
     2 : Problem appears to be infeasible
     3 : Problem appears to be unbounded
     4 : Numerical difficulties encountered
     5 : No constraints; turn presolve on
     6 : Guess x0 cannot be converted to a basic feasible solution

message : str
    A string descriptor of the exit status of the optimization.
iteration : int
    The number of iterations taken to solve the problem.
</pre> <div class="fragment"><div class="line"><span class="lineno">  420</span>                **unknown_options):</div>
<div class="line"><span class="lineno">  421</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">    Solve the following linear programming problem via a two-phase</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">    revised simplex algorithm.::</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">        minimize:     c @ x</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">        subject to:  A @ x == b</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">                     0 &lt;= x &lt; oo</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">    User-facing documentation is in _linprog_doc.py.</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    c : 1-D array</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">        Coefficients of the linear objective function to be minimized.</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral">    c0 : float</span></div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">        Constant term in objective function due to fixed (and eliminated)</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">        variables. (Currently unused.)</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">    A : 2-D array</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">        2-D array which, when matrix-multiplied by ``x``, gives the values of</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">        the equality constraints at ``x``.</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    b : 1-D array</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">        1-D array of values representing the RHS of each equality constraint</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">        (row) in ``A_eq``.</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">    x0 : 1-D array, optional</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral">        Starting values of the independent variables, which will be refined by</span></div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">        the optimization algorithm. For the revised simplex method, these must</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral">        correspond with a basic feasible solution.</span></div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral">    callback : callable, optional</span></div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">        If a callback function is provided, it will be called within each</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral">        iteration of the algorithm. The callback function must accept a single</span></div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">        `scipy.optimize.OptimizeResult` consisting of the following fields:</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral">            x : 1-D array</span></div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">                Current solution vector.</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral">            fun : float</span></div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">                Current value of the objective function ``c @ x``.</span></div>
<div class="line"><span class="lineno">  458</span><span class="stringliteral">            success : bool</span></div>
<div class="line"><span class="lineno">  459</span><span class="stringliteral">                True only when an algorithm has completed successfully,</span></div>
<div class="line"><span class="lineno">  460</span><span class="stringliteral">                so this is always False as the callback function is called</span></div>
<div class="line"><span class="lineno">  461</span><span class="stringliteral">                only while the algorithm is still iterating.</span></div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">            slack : 1-D array</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral">                The values of the slack variables. Each slack variable</span></div>
<div class="line"><span class="lineno">  464</span><span class="stringliteral">                corresponds to an inequality constraint. If the slack is zero,</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral">                the corresponding constraint is active.</span></div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">            con : 1-D array</span></div>
<div class="line"><span class="lineno">  467</span><span class="stringliteral">                The (nominally zero) residuals of the equality constraints,</span></div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral">                that is, ``b - A_eq @ x``.</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">            phase : int</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral">                The phase of the algorithm being executed.</span></div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">            status : int</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral">                For revised simplex, this is always 0 because if a different</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">                status is detected, the algorithm terminates.</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">            nit : int</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">                The number of iterations performed.</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">            message : str</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">                A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    postsolve_args : tuple</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">        Data needed by _postsolve to convert the solution to the standard-form</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">        problem into the solution to the original problem.</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">    Options</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">    maxiter : int</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">       The maximum number of iterations to perform in either phase.</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">    tol : float</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral">        The tolerance which determines when a solution is &quot;close enough&quot; to</span></div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">        zero in Phase 1 to be considered a basic feasible solution or close</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">        enough to positive to serve as an optimal solution.</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">    disp : bool</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">        Set to ``True`` if indicators of optimization status are to be printed</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">        to the console each iteration.</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">    maxupdate : int</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">        The maximum number of updates performed on the LU factorization.</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">        After this many updates is reached, the basis matrix is factorized</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">        from scratch.</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral">    mast : bool</span></div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">        Minimize Amortized Solve Time. If enabled, the average time to solve</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">        a linear system using the basis factorization is measured. Typically,</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">        the average solve time will decrease with each successive solve after</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">        initial factorization, as factorization takes much more time than the</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">        solve operation (and updates). Eventually, however, the updated</span></div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">        factorization becomes sufficiently complex that the average solve time</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">        begins to increase. When this is detected, the basis is refactorized</span></div>
<div class="line"><span class="lineno">  505</span><span class="stringliteral">        from scratch. Enable this option to maximize speed at the risk of</span></div>
<div class="line"><span class="lineno">  506</span><span class="stringliteral">        nondeterministic behavior. Ignored if ``maxupdate`` is 0.</span></div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral">    pivot : &quot;mrc&quot; or &quot;bland&quot;</span></div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral">        Pivot rule: Minimum Reduced Cost (default) or Bland&#39;s rule. Choose</span></div>
<div class="line"><span class="lineno">  509</span><span class="stringliteral">        Bland&#39;s rule if iteration limit is reached and cycling is suspected.</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">    unknown_options : dict</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">        Optional arguments not used by this particular solver. If</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">        `unknown_options` is non-empty a warning is issued listing all</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">        unused options.</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">    x : 1-D array</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">        Solution vector.</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">    status : int</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">        An integer representing the exit status of the optimization::</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">         0 : Optimization terminated successfully</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral">         1 : Iteration limit reached</span></div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">         2 : Problem appears to be infeasible</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">         3 : Problem appears to be unbounded</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">         4 : Numerical difficulties encountered</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">         5 : No constraints; turn presolve on</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">         6 : Guess x0 cannot be converted to a basic feasible solution</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    message : str</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">        A string descriptor of the exit status of the optimization.</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">    iteration : int</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">        The number of iterations taken to solve the problem.</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    _check_unknown_options(unknown_options)</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    messages = [<span class="stringliteral">&quot;Optimization terminated successfully.&quot;</span>,</div>
<div class="line"><span class="lineno">  539</span>                <span class="stringliteral">&quot;Iteration limit reached.&quot;</span>,</div>
<div class="line"><span class="lineno">  540</span>                <span class="stringliteral">&quot;The problem appears infeasible, as the phase one auxiliary &quot;</span></div>
<div class="line"><span class="lineno">  541</span>                <span class="stringliteral">&quot;problem terminated successfully with a residual of {0:.1e}, &quot;</span></div>
<div class="line"><span class="lineno">  542</span>                <span class="stringliteral">&quot;greater than the tolerance {1} required for the solution to &quot;</span></div>
<div class="line"><span class="lineno">  543</span>                <span class="stringliteral">&quot;be considered feasible. Consider increasing the tolerance to &quot;</span></div>
<div class="line"><span class="lineno">  544</span>                <span class="stringliteral">&quot;be greater than {0:.1e}. If this tolerance is unnaceptably &quot;</span></div>
<div class="line"><span class="lineno">  545</span>                <span class="stringliteral">&quot;large, the problem is likely infeasible.&quot;</span>,</div>
<div class="line"><span class="lineno">  546</span>                <span class="stringliteral">&quot;The problem is unbounded, as the simplex algorithm found &quot;</span></div>
<div class="line"><span class="lineno">  547</span>                <span class="stringliteral">&quot;a basic feasible solution from which there is a direction &quot;</span></div>
<div class="line"><span class="lineno">  548</span>                <span class="stringliteral">&quot;with negative reduced cost in which all decision variables &quot;</span></div>
<div class="line"><span class="lineno">  549</span>                <span class="stringliteral">&quot;increase.&quot;</span>,</div>
<div class="line"><span class="lineno">  550</span>                <span class="stringliteral">&quot;Numerical difficulties encountered; consider trying &quot;</span></div>
<div class="line"><span class="lineno">  551</span>                <span class="stringliteral">&quot;method=&#39;interior-point&#39;.&quot;</span>,</div>
<div class="line"><span class="lineno">  552</span>                <span class="stringliteral">&quot;Problems with no constraints are trivially solved; please &quot;</span></div>
<div class="line"><span class="lineno">  553</span>                <span class="stringliteral">&quot;turn presolve on.&quot;</span>,</div>
<div class="line"><span class="lineno">  554</span>                <span class="stringliteral">&quot;The guess x0 cannot be converted to a basic feasible &quot;</span></div>
<div class="line"><span class="lineno">  555</span>                <span class="stringliteral">&quot;solution. &quot;</span></div>
<div class="line"><span class="lineno">  556</span>                ]</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordflow">if</span> A.size == 0:  <span class="comment"># address test_unbounded_below_no_presolve_corrected</span></div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">return</span> np.zeros(c.shape), 5, messages[5], 0</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>    x, basis, A, b, residual, status, iteration = (</div>
<div class="line"><span class="lineno">  562</span>        _phase_one(A, b, x0, callback, postsolve_args,</div>
<div class="line"><span class="lineno">  563</span>                   maxiter, tol, disp, maxupdate, mast, pivot))</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="keywordflow">if</span> status == 0:</div>
<div class="line"><span class="lineno">  566</span>        x, basis, status, iteration = _phase_two(c, A, x, basis, callback,</div>
<div class="line"><span class="lineno">  567</span>                                                 postsolve_args,</div>
<div class="line"><span class="lineno">  568</span>                                                 maxiter, tol, disp,</div>
<div class="line"><span class="lineno">  569</span>                                                 maxupdate, mast, pivot,</div>
<div class="line"><span class="lineno">  570</span>                                                 iteration)</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>    <span class="keywordflow">return</span> x, status, messages[status].format(residual, tol), iteration</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab31637da9838086fccb4ae68dfabbfdd" name="ab31637da9838086fccb4ae68dfabbfdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab31637da9838086fccb4ae68dfabbfdd">&#9670;&#160;</a></span>_phase_one()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._phase_one </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxupdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mast</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pivot</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">The purpose of phase one is to find an initial basic feasible solution
(BFS) to the original problem.

Generates an auxiliary problem with a trivial BFS and an objective that
minimizes infeasibility of the original problem. Solves the auxiliary
problem using the main simplex routine (phase two). This either yields
a BFS to the original problem or determines that the original problem is
infeasible. If feasible, phase one detects redundant rows in the original
constraint matrix and removes them, then chooses additional indices as
necessary to complete a basis/BFS for the original problem.
</pre> <div class="fragment"><div class="line"><span class="lineno">   32</span>               maxupdate, mast, pivot):</div>
<div class="line"><span class="lineno">   33</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   34</span><span class="stringliteral">    The purpose of phase one is to find an initial basic feasible solution</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral">    (BFS) to the original problem.</span></div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    Generates an auxiliary problem with a trivial BFS and an objective that</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    minimizes infeasibility of the original problem. Solves the auxiliary</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">    problem using the main simplex routine (phase two). This either yields</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral">    a BFS to the original problem or determines that the original problem is</span></div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">    infeasible. If feasible, phase one detects redundant rows in the original</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">    constraint matrix and removes them, then chooses additional indices as</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">    necessary to complete a basis/BFS for the original problem.</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>    m, n = A.shape</div>
<div class="line"><span class="lineno">   47</span>    status = 0</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>    <span class="comment"># generate auxiliary problem to get initial BFS</span></div>
<div class="line"><span class="lineno">   50</span>    A, b, c, basis, x, status = _generate_auxiliary_problem(A, b, x0, tol)</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">if</span> status == 6:</div>
<div class="line"><span class="lineno">   53</span>        residual = c.dot(x)</div>
<div class="line"><span class="lineno">   54</span>        iter_k = 0</div>
<div class="line"><span class="lineno">   55</span>        <span class="keywordflow">return</span> x, basis, A, b, residual, status, iter_k</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="comment"># solve auxiliary problem</span></div>
<div class="line"><span class="lineno">   58</span>    phase_one_n = n</div>
<div class="line"><span class="lineno">   59</span>    iter_k = 0</div>
<div class="line"><span class="lineno">   60</span>    x, basis, status, iter_k = _phase_two(c, A, x, basis, callback,</div>
<div class="line"><span class="lineno">   61</span>                                          postsolve_args,</div>
<div class="line"><span class="lineno">   62</span>                                          maxiter, tol, disp,</div>
<div class="line"><span class="lineno">   63</span>                                          maxupdate, mast, pivot,</div>
<div class="line"><span class="lineno">   64</span>                                          iter_k, phase_one_n)</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>    <span class="comment"># check for infeasibility</span></div>
<div class="line"><span class="lineno">   67</span>    residual = c.dot(x)</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">if</span> status == 0 <span class="keywordflow">and</span> residual &gt; tol:</div>
<div class="line"><span class="lineno">   69</span>        status = 2</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>    <span class="comment"># drive artificial variables out of basis</span></div>
<div class="line"><span class="lineno">   72</span>    <span class="comment"># TODO: test redundant row removal better</span></div>
<div class="line"><span class="lineno">   73</span>    <span class="comment"># TODO: make solve more efficient with BGLU? This could take a while.</span></div>
<div class="line"><span class="lineno">   74</span>    keep_rows = np.ones(m, dtype=bool)</div>
<div class="line"><span class="lineno">   75</span>    <span class="keywordflow">for</span> basis_column <span class="keywordflow">in</span> basis[basis &gt;= n]:</div>
<div class="line"><span class="lineno">   76</span>        B = A[:, basis]</div>
<div class="line"><span class="lineno">   77</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">   78</span>            basis_finder = np.abs(solve(B, A))  <span class="comment"># inefficient</span></div>
<div class="line"><span class="lineno">   79</span>            pertinent_row = np.argmax(basis_finder[:, basis_column])</div>
<div class="line"><span class="lineno">   80</span>            eligible_columns = np.ones(n, dtype=bool)</div>
<div class="line"><span class="lineno">   81</span>            eligible_columns[basis[basis &lt; n]] = 0</div>
<div class="line"><span class="lineno">   82</span>            eligible_column_indices = np.where(eligible_columns)[0]</div>
<div class="line"><span class="lineno">   83</span>            index = np.argmax(basis_finder[:, :n]</div>
<div class="line"><span class="lineno">   84</span>                              [pertinent_row, eligible_columns])</div>
<div class="line"><span class="lineno">   85</span>            new_basis_column = eligible_column_indices[index]</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">if</span> basis_finder[pertinent_row, new_basis_column] &lt; tol:</div>
<div class="line"><span class="lineno">   87</span>                keep_rows[pertinent_row] = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">   88</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   89</span>                basis[basis == basis_column] = new_basis_column</div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">except</span> LinAlgError:</div>
<div class="line"><span class="lineno">   91</span>            status = 4</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="comment"># form solution to original problem</span></div>
<div class="line"><span class="lineno">   94</span>    A = A[keep_rows, :n]</div>
<div class="line"><span class="lineno">   95</span>    basis = basis[keep_rows]</div>
<div class="line"><span class="lineno">   96</span>    x = x[:n]</div>
<div class="line"><span class="lineno">   97</span>    m = A.shape[0]</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordflow">return</span> x, basis, A, b, residual, status, iter_k</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a62c649559668aa374d35130644a4acd6" name="a62c649559668aa374d35130644a4acd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62c649559668aa374d35130644a4acd6">&#9670;&#160;</a></span>_phase_two()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._phase_two </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>postsolve_args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>disp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxupdate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mast</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pivot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iteration</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>phase_one_n</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">The heart of the simplex method. Beginning with a basic feasible solution,
moves to adjacent basic feasible solutions successively lower reduced cost.
Terminates when there are no basic feasible solutions with lower reduced
cost or if the problem is determined to be unbounded.

This implementation follows the revised simplex method based on LU
decomposition. Rather than maintaining a tableau or an inverse of the
basis matrix, we keep a factorization of the basis matrix that allows
efficient solution of linear systems while avoiding stability issues
associated with inverted matrices.
</pre> <div class="fragment"><div class="line"><span class="lineno">  335</span>               maxupdate, mast, pivot, iteration=0, phase_one_n=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  336</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">    The heart of the simplex method. Beginning with a basic feasible solution,</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    moves to adjacent basic feasible solutions successively lower reduced cost.</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">    Terminates when there are no basic feasible solutions with lower reduced</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    cost or if the problem is determined to be unbounded.</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    This implementation follows the revised simplex method based on LU</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    decomposition. Rather than maintaining a tableau or an inverse of the</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    basis matrix, we keep a factorization of the basis matrix that allows</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    efficient solution of linear systems while avoiding stability issues</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    associated with inverted matrices.</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  348</span>    m, n = A.shape</div>
<div class="line"><span class="lineno">  349</span>    status = 0</div>
<div class="line"><span class="lineno">  350</span>    a = np.arange(n)                    <span class="comment"># indices of columns of A</span></div>
<div class="line"><span class="lineno">  351</span>    ab = np.arange(m)                   <span class="comment"># indices of columns of B</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">if</span> maxupdate:</div>
<div class="line"><span class="lineno">  353</span>        <span class="comment"># basis matrix factorization object; similar to B = A[:, b]</span></div>
<div class="line"><span class="lineno">  354</span>        B = BGLU(A, b, maxupdate, mast)</div>
<div class="line"><span class="lineno">  355</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  356</span>        B = LU(A, b)</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>    <span class="keywordflow">for</span> iteration <span class="keywordflow">in</span> range(iteration, maxiter):</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">if</span> disp <span class="keywordflow">or</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  361</span>            _display_and_callback(phase_one_n, x, postsolve_args, status,</div>
<div class="line"><span class="lineno">  362</span>                                  iteration, disp, callback)</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>        bl = np.zeros(len(a), dtype=bool)</div>
<div class="line"><span class="lineno">  365</span>        bl[b] = 1</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>        xb = x[b]       <span class="comment"># basic variables</span></div>
<div class="line"><span class="lineno">  368</span>        cb = c[b]       <span class="comment"># basic costs</span></div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  371</span>            v = B.solve(cb, transposed=<span class="keyword">True</span>)    <span class="comment"># similar to v = solve(B.T, cb)</span></div>
<div class="line"><span class="lineno">  372</span>        <span class="keywordflow">except</span> LinAlgError:</div>
<div class="line"><span class="lineno">  373</span>            status = 4</div>
<div class="line"><span class="lineno">  374</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>        <span class="comment"># TODO: cythonize?</span></div>
<div class="line"><span class="lineno">  377</span>        c_hat = c - v.dot(A)    <span class="comment"># reduced cost</span></div>
<div class="line"><span class="lineno">  378</span>        c_hat = c_hat[~bl]</div>
<div class="line"><span class="lineno">  379</span>        <span class="comment"># Above is much faster than:</span></div>
<div class="line"><span class="lineno">  380</span>        <span class="comment"># N = A[:, ~bl]                 # slow!</span></div>
<div class="line"><span class="lineno">  381</span>        <span class="comment"># c_hat = c[~bl] - v.T.dot(N)</span></div>
<div class="line"><span class="lineno">  382</span>        <span class="comment"># Can we perform the multiplication only on the nonbasic columns?</span></div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">if</span> np.all(c_hat &gt;= -tol):  <span class="comment"># all reduced costs positive -&gt; terminate</span></div>
<div class="line"><span class="lineno">  385</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>        j = _select_enter_pivot(c_hat, bl, a, rule=pivot, tol=tol)</div>
<div class="line"><span class="lineno">  388</span>        u = B.solve(A[:, j])        <span class="comment"># similar to u = solve(B, A[:, j])</span></div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>        i = u &gt; tol                 <span class="comment"># if none of the u are positive, unbounded</span></div>
<div class="line"><span class="lineno">  391</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.any(i):</div>
<div class="line"><span class="lineno">  392</span>            status = 3</div>
<div class="line"><span class="lineno">  393</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>        th = xb[i]/u[i]</div>
<div class="line"><span class="lineno">  396</span>        l = np.argmin(th)           <span class="comment"># implicitly selects smallest subscript</span></div>
<div class="line"><span class="lineno">  397</span>        th_star = th[l]             <span class="comment"># step size</span></div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>        x[b] = x[b] - th_star*u     <span class="comment"># take step</span></div>
<div class="line"><span class="lineno">  400</span>        x[j] = th_star</div>
<div class="line"><span class="lineno">  401</span>        B.update(ab[i][l], j)       <span class="comment"># modify basis</span></div>
<div class="line"><span class="lineno">  402</span>        b = B.b                     <span class="comment"># similar to b[ab[i][l]] =</span></div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  405</span>        <span class="comment"># If the end of the for loop is reached (without a break statement),</span></div>
<div class="line"><span class="lineno">  406</span>        <span class="comment"># then another step has been taken, so the iteration counter should</span></div>
<div class="line"><span class="lineno">  407</span>        <span class="comment"># increment, info should be displayed, and callback should be called.</span></div>
<div class="line"><span class="lineno">  408</span>        iteration += 1</div>
<div class="line"><span class="lineno">  409</span>        status = 1</div>
<div class="line"><span class="lineno">  410</span>        <span class="keywordflow">if</span> disp <span class="keywordflow">or</span> callback <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  411</span>            _display_and_callback(phase_one_n, x, postsolve_args, status,</div>
<div class="line"><span class="lineno">  412</span>                                  iteration, disp, callback)</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">return</span> x, b, status, iteration</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7f155d34e56c5e7076d96197c16d6e8" name="ab7f155d34e56c5e7076d96197c16d6e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7f155d34e56c5e7076d96197c16d6e8">&#9670;&#160;</a></span>_select_enter_pivot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._select_enter_pivot </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>c_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>bl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rule</em> = <code>&quot;bland&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-12</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Selects a pivot to enter the basis. Currently Bland's rule - the smallest
index that has a negative reduced cost - is the default.
</pre> <div class="fragment"><div class="line"><span class="lineno">  279</span><span class="keyword">def </span>_select_enter_pivot(c_hat, bl, a, rule=&quot;bland&quot;, tol=1e-12):</div>
<div class="line"><span class="lineno">  280</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">    Selects a pivot to enter the basis. Currently Bland&#39;s rule - the smallest</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    index that has a negative reduced cost - is the default.</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  284</span>    <span class="keywordflow">if</span> rule.lower() == <span class="stringliteral">&quot;mrc&quot;</span>:  <span class="comment"># index with minimum reduced cost</span></div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">return</span> a[~bl][np.argmin(c_hat)]</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordflow">else</span>:  <span class="comment"># smallest index w/ negative reduced cost</span></div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">return</span> a[~bl][c_hat &lt; -tol][0]</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa0a66f0d856ae387507be5e97c966b9d" name="aa0a66f0d856ae387507be5e97c966b9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0a66f0d856ae387507be5e97c966b9d">&#9670;&#160;</a></span>_select_singleton_columns()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._linprog_rs._select_singleton_columns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Finds singleton columns for which the singleton entry is of the same sign
as the right-hand side; these columns are eligible for inclusion in an
initial basis. Determines the rows in which the singleton entries are
located. For each of these rows, returns the indices of the one singleton
column and its corresponding row.
</pre> <div class="fragment"><div class="line"><span class="lineno">  239</span><span class="keyword">def </span>_select_singleton_columns(A, b):</div>
<div class="line"><span class="lineno">  240</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    Finds singleton columns for which the singleton entry is of the same sign</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">    as the right-hand side; these columns are eligible for inclusion in an</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    initial basis. Determines the rows in which the singleton entries are</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    located. For each of these rows, returns the indices of the one singleton</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    column and its corresponding row.</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  247</span>    <span class="comment"># find indices of all singleton columns and corresponding row indicies</span></div>
<div class="line"><span class="lineno">  248</span>    column_indices = np.nonzero(np.sum(np.abs(A) != 0, axis=0) == 1)[0]</div>
<div class="line"><span class="lineno">  249</span>    columns = A[:, column_indices]          <span class="comment"># array of singleton columns</span></div>
<div class="line"><span class="lineno">  250</span>    row_indices = np.zeros(len(column_indices), dtype=int)</div>
<div class="line"><span class="lineno">  251</span>    nonzero_rows, nonzero_columns = np.nonzero(columns)</div>
<div class="line"><span class="lineno">  252</span>    row_indices[nonzero_columns] = nonzero_rows   <span class="comment"># corresponding row indicies</span></div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>    <span class="comment"># keep only singletons with entries that have same sign as RHS</span></div>
<div class="line"><span class="lineno">  255</span>    <span class="comment"># this is necessary because all elements of BFS must be non-negative</span></div>
<div class="line"><span class="lineno">  256</span>    same_sign = A[row_indices, column_indices]*b[row_indices] &gt;= 0</div>
<div class="line"><span class="lineno">  257</span>    column_indices = column_indices[same_sign][::-1]</div>
<div class="line"><span class="lineno">  258</span>    row_indices = row_indices[same_sign][::-1]</div>
<div class="line"><span class="lineno">  259</span>    <span class="comment"># Reversing the order so that steps below select rightmost columns</span></div>
<div class="line"><span class="lineno">  260</span>    <span class="comment"># for initial basis, which will tend to be slack variables. (If the</span></div>
<div class="line"><span class="lineno">  261</span>    <span class="comment"># guess corresponds with a basic feasible solution but a constraint</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="comment"># is not satisfied with the corresponding slack variable zero, the slack</span></div>
<div class="line"><span class="lineno">  263</span>    <span class="comment"># variable must be basic.)</span></div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    <span class="comment"># for each row, keep rightmost singleton column with an entry in that row</span></div>
<div class="line"><span class="lineno">  266</span>    unique_row_indices, first_columns = np.unique(row_indices,</div>
<div class="line"><span class="lineno">  267</span>                                                  return_index=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">return</span> column_indices[first_columns], unique_row_indices</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
