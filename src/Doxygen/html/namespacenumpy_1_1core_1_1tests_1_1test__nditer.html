<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: numpy.core.tests.test_nditer Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacenumpy.html">numpy</a></li><li class="navelem"><a class="el" href="namespacenumpy_1_1core.html">core</a></li><li class="navelem"><a class="el" href="namespacenumpy_1_1core_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html">test_nditer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">numpy.core.tests.test_nditer Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnumpy_1_1core_1_1tests_1_1test__nditer_1_1_test_iter_nested.html">TestIterNested</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa08b05d378280a75bf3015ac9d106259" id="r_aa08b05d378280a75bf3015ac9d106259"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aa08b05d378280a75bf3015ac9d106259">iter_multi_index</a> (<a class="el" href="__lapack__subroutines_8h.html#a5325f1842789194c441b272cbf424674">i</a>)</td></tr>
<tr class="separator:aa08b05d378280a75bf3015ac9d106259"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61a4a7de2475d4f343178d28423b8832" id="r_a61a4a7de2475d4f343178d28423b8832"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a61a4a7de2475d4f343178d28423b8832">iter_indices</a> (<a class="el" href="__lapack__subroutines_8h.html#a5325f1842789194c441b272cbf424674">i</a>)</td></tr>
<tr class="separator:a61a4a7de2475d4f343178d28423b8832"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa86707e255262d2113923c18d4e3f537" id="r_aa86707e255262d2113923c18d4e3f537"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aa86707e255262d2113923c18d4e3f537">iter_iterindices</a> (<a class="el" href="__lapack__subroutines_8h.html#a5325f1842789194c441b272cbf424674">i</a>)</td></tr>
<tr class="separator:aa86707e255262d2113923c18d4e3f537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c53e67d057e4639dd01fb8882e125bb" id="r_a0c53e67d057e4639dd01fb8882e125bb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a0c53e67d057e4639dd01fb8882e125bb">test_iter_refcount</a> ()</td></tr>
<tr class="separator:a0c53e67d057e4639dd01fb8882e125bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58e946bda93c234c62e7957de80096ad" id="r_a58e946bda93c234c62e7957de80096ad"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a58e946bda93c234c62e7957de80096ad">test_iter_best_order</a> ()</td></tr>
<tr class="separator:a58e946bda93c234c62e7957de80096ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7484b1c6e4cc1cf233acc0e90259e8b2" id="r_a7484b1c6e4cc1cf233acc0e90259e8b2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a7484b1c6e4cc1cf233acc0e90259e8b2">test_iter_c_order</a> ()</td></tr>
<tr class="separator:a7484b1c6e4cc1cf233acc0e90259e8b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68d841bafa9244a92620a16fef86a01f" id="r_a68d841bafa9244a92620a16fef86a01f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a68d841bafa9244a92620a16fef86a01f">test_iter_f_order</a> ()</td></tr>
<tr class="separator:a68d841bafa9244a92620a16fef86a01f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4518dcd877a74990101f4f668b852bd" id="r_aa4518dcd877a74990101f4f668b852bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aa4518dcd877a74990101f4f668b852bd">test_iter_c_or_f_order</a> ()</td></tr>
<tr class="separator:aa4518dcd877a74990101f4f668b852bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24e6d498951c94b468fb5741a49fa2a1" id="r_a24e6d498951c94b468fb5741a49fa2a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a24e6d498951c94b468fb5741a49fa2a1">test_nditer_multi_index_set</a> ()</td></tr>
<tr class="separator:a24e6d498951c94b468fb5741a49fa2a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add45242cd0d4fdff21227a06945b8459" id="r_add45242cd0d4fdff21227a06945b8459"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#add45242cd0d4fdff21227a06945b8459">test_nditer_multi_index_set_refcount</a> ()</td></tr>
<tr class="separator:add45242cd0d4fdff21227a06945b8459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a719f4907ba6556cc71a0d497e15ebc1b" id="r_a719f4907ba6556cc71a0d497e15ebc1b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a719f4907ba6556cc71a0d497e15ebc1b">test_iter_best_order_multi_index_1d</a> ()</td></tr>
<tr class="separator:a719f4907ba6556cc71a0d497e15ebc1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01004062959a2e33d64318dcb6622a7c" id="r_a01004062959a2e33d64318dcb6622a7c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a01004062959a2e33d64318dcb6622a7c">test_iter_best_order_multi_index_2d</a> ()</td></tr>
<tr class="separator:a01004062959a2e33d64318dcb6622a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b58639676c388062b088478c2880725" id="r_a3b58639676c388062b088478c2880725"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a3b58639676c388062b088478c2880725">test_iter_best_order_multi_index_3d</a> ()</td></tr>
<tr class="separator:a3b58639676c388062b088478c2880725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e71d5b5558250ac44174f6b45c717be" id="r_a2e71d5b5558250ac44174f6b45c717be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a2e71d5b5558250ac44174f6b45c717be">test_iter_best_order_c_index_1d</a> ()</td></tr>
<tr class="separator:a2e71d5b5558250ac44174f6b45c717be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad34a113cec31263ae6fa140eaa1974b6" id="r_ad34a113cec31263ae6fa140eaa1974b6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ad34a113cec31263ae6fa140eaa1974b6">test_iter_best_order_c_index_2d</a> ()</td></tr>
<tr class="separator:ad34a113cec31263ae6fa140eaa1974b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386cc9002f8a76310dfdad225751dd1d" id="r_a386cc9002f8a76310dfdad225751dd1d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a386cc9002f8a76310dfdad225751dd1d">test_iter_best_order_c_index_3d</a> ()</td></tr>
<tr class="separator:a386cc9002f8a76310dfdad225751dd1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11745a26a36bf96fee89aad5b0d8ff8a" id="r_a11745a26a36bf96fee89aad5b0d8ff8a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a11745a26a36bf96fee89aad5b0d8ff8a">test_iter_best_order_f_index_1d</a> ()</td></tr>
<tr class="separator:a11745a26a36bf96fee89aad5b0d8ff8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d64b55781533e3cd992f7b9c4f42d64" id="r_a4d64b55781533e3cd992f7b9c4f42d64"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a4d64b55781533e3cd992f7b9c4f42d64">test_iter_best_order_f_index_2d</a> ()</td></tr>
<tr class="separator:a4d64b55781533e3cd992f7b9c4f42d64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a234dc9b8919a815cfe032266332370b3" id="r_a234dc9b8919a815cfe032266332370b3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a234dc9b8919a815cfe032266332370b3">test_iter_best_order_f_index_3d</a> ()</td></tr>
<tr class="separator:a234dc9b8919a815cfe032266332370b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2648404370c162e7ea2d0c36dfcf977" id="r_ad2648404370c162e7ea2d0c36dfcf977"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ad2648404370c162e7ea2d0c36dfcf977">test_iter_no_inner_full_coalesce</a> ()</td></tr>
<tr class="separator:ad2648404370c162e7ea2d0c36dfcf977"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a83fb62244406025592994cb55c98eb" id="r_a9a83fb62244406025592994cb55c98eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a9a83fb62244406025592994cb55c98eb">test_iter_no_inner_dim_coalescing</a> ()</td></tr>
<tr class="separator:a9a83fb62244406025592994cb55c98eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86ad552d873201bcce1bfca166297476" id="r_a86ad552d873201bcce1bfca166297476"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a86ad552d873201bcce1bfca166297476">test_iter_dim_coalescing</a> ()</td></tr>
<tr class="separator:a86ad552d873201bcce1bfca166297476"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae94475d90288824b3c0dfcd3b46f761" id="r_aae94475d90288824b3c0dfcd3b46f761"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aae94475d90288824b3c0dfcd3b46f761">test_iter_broadcasting</a> ()</td></tr>
<tr class="separator:aae94475d90288824b3c0dfcd3b46f761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85aba8c4384c52f13b0d20fed38fb4cc" id="r_a85aba8c4384c52f13b0d20fed38fb4cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a85aba8c4384c52f13b0d20fed38fb4cc">test_iter_itershape</a> ()</td></tr>
<tr class="separator:a85aba8c4384c52f13b0d20fed38fb4cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71548b23cd7f45f6e75db11b4da2b96b" id="r_a71548b23cd7f45f6e75db11b4da2b96b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a71548b23cd7f45f6e75db11b4da2b96b">test_iter_broadcasting_errors</a> ()</td></tr>
<tr class="separator:a71548b23cd7f45f6e75db11b4da2b96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57f9cd3747e27c18ac7f28cd2966cbd9" id="r_a57f9cd3747e27c18ac7f28cd2966cbd9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a57f9cd3747e27c18ac7f28cd2966cbd9">test_iter_flags_errors</a> ()</td></tr>
<tr class="separator:a57f9cd3747e27c18ac7f28cd2966cbd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad036cc8de2a9ff8d455935e08daeb51a" id="r_ad036cc8de2a9ff8d455935e08daeb51a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ad036cc8de2a9ff8d455935e08daeb51a">test_iter_slice</a> ()</td></tr>
<tr class="separator:ad036cc8de2a9ff8d455935e08daeb51a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1edca25fcdef89f0ebe3a591ed822b" id="r_aef1edca25fcdef89f0ebe3a591ed822b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aef1edca25fcdef89f0ebe3a591ed822b">test_iter_assign_mapping</a> ()</td></tr>
<tr class="separator:aef1edca25fcdef89f0ebe3a591ed822b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ed854ac74a30ba10697f88468c11161" id="r_a2ed854ac74a30ba10697f88468c11161"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a2ed854ac74a30ba10697f88468c11161">test_iter_nbo_align_contig</a> ()</td></tr>
<tr class="separator:a2ed854ac74a30ba10697f88468c11161"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c727c627983d5397e37ead424f31fe8" id="r_a3c727c627983d5397e37ead424f31fe8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a3c727c627983d5397e37ead424f31fe8">test_iter_array_cast</a> ()</td></tr>
<tr class="separator:a3c727c627983d5397e37ead424f31fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac89032b20c2d0185d989ebf6ed428b4a" id="r_ac89032b20c2d0185d989ebf6ed428b4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ac89032b20c2d0185d989ebf6ed428b4a">test_iter_array_cast_errors</a> ()</td></tr>
<tr class="separator:ac89032b20c2d0185d989ebf6ed428b4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1de306e4d18fe5460952ea9f90b56e3" id="r_ac1de306e4d18fe5460952ea9f90b56e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ac1de306e4d18fe5460952ea9f90b56e3">test_iter_scalar_cast</a> ()</td></tr>
<tr class="separator:ac1de306e4d18fe5460952ea9f90b56e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ddce2e8bedc1670fd130f1a79ab644d" id="r_a6ddce2e8bedc1670fd130f1a79ab644d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a6ddce2e8bedc1670fd130f1a79ab644d">test_iter_scalar_cast_errors</a> ()</td></tr>
<tr class="separator:a6ddce2e8bedc1670fd130f1a79ab644d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4103ae092ccdf911766cf5e331a9caab" id="r_a4103ae092ccdf911766cf5e331a9caab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a4103ae092ccdf911766cf5e331a9caab">test_iter_object_arrays_basic</a> ()</td></tr>
<tr class="separator:a4103ae092ccdf911766cf5e331a9caab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3403d93157dcc045212f0bccefd296e8" id="r_a3403d93157dcc045212f0bccefd296e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a3403d93157dcc045212f0bccefd296e8">test_iter_object_arrays_conversions</a> ()</td></tr>
<tr class="separator:a3403d93157dcc045212f0bccefd296e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac428ff0cc17ced64320553131a277c56" id="r_ac428ff0cc17ced64320553131a277c56"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ac428ff0cc17ced64320553131a277c56">test_iter_common_dtype</a> ()</td></tr>
<tr class="separator:ac428ff0cc17ced64320553131a277c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f11f8ee8f601d552e2e10c1e96698d1" id="r_a7f11f8ee8f601d552e2e10c1e96698d1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a7f11f8ee8f601d552e2e10c1e96698d1">test_iter_copy_if_overlap</a> ()</td></tr>
<tr class="separator:a7f11f8ee8f601d552e2e10c1e96698d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4fbde5643f7f2914732b99a3f43b581" id="r_ac4fbde5643f7f2914732b99a3f43b581"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ac4fbde5643f7f2914732b99a3f43b581">test_iter_op_axes</a> ()</td></tr>
<tr class="separator:ac4fbde5643f7f2914732b99a3f43b581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9efc276ed97ec815ca4c7bc3d0a5565" id="r_ae9efc276ed97ec815ca4c7bc3d0a5565"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ae9efc276ed97ec815ca4c7bc3d0a5565">test_iter_op_axes_errors</a> ()</td></tr>
<tr class="separator:ae9efc276ed97ec815ca4c7bc3d0a5565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a320bcc59ac19bcbfad5aec8ffff25ed0" id="r_a320bcc59ac19bcbfad5aec8ffff25ed0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a320bcc59ac19bcbfad5aec8ffff25ed0">test_iter_copy</a> ()</td></tr>
<tr class="separator:a320bcc59ac19bcbfad5aec8ffff25ed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d3d360351b13d424b829d09d1692c7a" id="r_a3d3d360351b13d424b829d09d1692c7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a3d3d360351b13d424b829d09d1692c7a">test_iter_copy_casts</a> (dtype, loop_dtype)</td></tr>
<tr class="separator:a3d3d360351b13d424b829d09d1692c7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a000f3a911dd779ca675af0c4118ce5ee" id="r_a000f3a911dd779ca675af0c4118ce5ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a000f3a911dd779ca675af0c4118ce5ee">test_iter_copy_casts_structured</a> ()</td></tr>
<tr class="separator:a000f3a911dd779ca675af0c4118ce5ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249cad103012ab20c2bc599a2b923b2b" id="r_a249cad103012ab20c2bc599a2b923b2b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a249cad103012ab20c2bc599a2b923b2b">test_iter_allocate_output_simple</a> ()</td></tr>
<tr class="separator:a249cad103012ab20c2bc599a2b923b2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b2f5edd18dae638f66f26662ed142bd" id="r_a3b2f5edd18dae638f66f26662ed142bd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a3b2f5edd18dae638f66f26662ed142bd">test_iter_allocate_output_buffered_readwrite</a> ()</td></tr>
<tr class="separator:a3b2f5edd18dae638f66f26662ed142bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bbbdc2750e807c7c1d60a9d07076570" id="r_a5bbbdc2750e807c7c1d60a9d07076570"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a5bbbdc2750e807c7c1d60a9d07076570">test_iter_allocate_output_itorder</a> ()</td></tr>
<tr class="separator:a5bbbdc2750e807c7c1d60a9d07076570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a521fa5266e3f2ab75bc00608efc631" id="r_a4a521fa5266e3f2ab75bc00608efc631"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a4a521fa5266e3f2ab75bc00608efc631">test_iter_allocate_output_opaxes</a> ()</td></tr>
<tr class="separator:a4a521fa5266e3f2ab75bc00608efc631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc6410b97ef2805c0013cc5089fae698" id="r_adc6410b97ef2805c0013cc5089fae698"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#adc6410b97ef2805c0013cc5089fae698">test_iter_allocate_output_types_promotion</a> ()</td></tr>
<tr class="separator:adc6410b97ef2805c0013cc5089fae698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f923afc6e20035f3eef7822bb4836a" id="r_a22f923afc6e20035f3eef7822bb4836a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a22f923afc6e20035f3eef7822bb4836a">test_iter_allocate_output_types_byte_order</a> ()</td></tr>
<tr class="separator:a22f923afc6e20035f3eef7822bb4836a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab34db805f08b9be4a7a5608a116fae2d" id="r_ab34db805f08b9be4a7a5608a116fae2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ab34db805f08b9be4a7a5608a116fae2d">test_iter_allocate_output_types_scalar</a> ()</td></tr>
<tr class="separator:ab34db805f08b9be4a7a5608a116fae2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acafc89590f208cd2d8fd15f6eace3663" id="r_acafc89590f208cd2d8fd15f6eace3663"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#acafc89590f208cd2d8fd15f6eace3663">test_iter_allocate_output_subtype</a> ()</td></tr>
<tr class="separator:acafc89590f208cd2d8fd15f6eace3663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac487a7ddc5db792d4c2d145566bf2251" id="r_ac487a7ddc5db792d4c2d145566bf2251"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ac487a7ddc5db792d4c2d145566bf2251">test_iter_allocate_output_errors</a> ()</td></tr>
<tr class="separator:ac487a7ddc5db792d4c2d145566bf2251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aed081064b97c2b26ab01e9867c2ad3" id="r_a5aed081064b97c2b26ab01e9867c2ad3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a5aed081064b97c2b26ab01e9867c2ad3">test_all_allocated</a> ()</td></tr>
<tr class="separator:a5aed081064b97c2b26ab01e9867c2ad3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af623e19dc12722a168cb9f6ab6689165" id="r_af623e19dc12722a168cb9f6ab6689165"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#af623e19dc12722a168cb9f6ab6689165">test_iter_remove_axis</a> ()</td></tr>
<tr class="separator:af623e19dc12722a168cb9f6ab6689165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d88c3b7a831a49cb6f9a7cc8ead2878" id="r_a1d88c3b7a831a49cb6f9a7cc8ead2878"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a1d88c3b7a831a49cb6f9a7cc8ead2878">test_iter_remove_multi_index_inner_loop</a> ()</td></tr>
<tr class="separator:a1d88c3b7a831a49cb6f9a7cc8ead2878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a386ffa75bcf829caab32fa4a1b542d10" id="r_a386ffa75bcf829caab32fa4a1b542d10"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a386ffa75bcf829caab32fa4a1b542d10">test_iter_iterindex</a> ()</td></tr>
<tr class="separator:a386ffa75bcf829caab32fa4a1b542d10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0c63d517a3694a7bf1f50bc244c56de" id="r_ac0c63d517a3694a7bf1f50bc244c56de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ac0c63d517a3694a7bf1f50bc244c56de">test_iter_iterrange</a> ()</td></tr>
<tr class="separator:ac0c63d517a3694a7bf1f50bc244c56de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cc2dedafdf85391e5c03b564bfbbb34" id="r_a9cc2dedafdf85391e5c03b564bfbbb34"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a9cc2dedafdf85391e5c03b564bfbbb34">test_iter_buffering</a> ()</td></tr>
<tr class="separator:a9cc2dedafdf85391e5c03b564bfbbb34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1edaffd1f8775550604b47e22109612" id="r_ad1edaffd1f8775550604b47e22109612"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ad1edaffd1f8775550604b47e22109612">test_iter_write_buffering</a> ()</td></tr>
<tr class="separator:ad1edaffd1f8775550604b47e22109612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72829cd2cc7fc091aa5a401f0835679d" id="r_a72829cd2cc7fc091aa5a401f0835679d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a72829cd2cc7fc091aa5a401f0835679d">test_iter_buffering_delayed_alloc</a> ()</td></tr>
<tr class="separator:a72829cd2cc7fc091aa5a401f0835679d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32fe2f504617a5a676e16d3a57b2e878" id="r_a32fe2f504617a5a676e16d3a57b2e878"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a32fe2f504617a5a676e16d3a57b2e878">test_iter_buffered_cast_simple</a> ()</td></tr>
<tr class="separator:a32fe2f504617a5a676e16d3a57b2e878"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20d71406500bc9a800c5e41abfc6320b" id="r_a20d71406500bc9a800c5e41abfc6320b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a20d71406500bc9a800c5e41abfc6320b">test_iter_buffered_cast_byteswapped</a> ()</td></tr>
<tr class="separator:a20d71406500bc9a800c5e41abfc6320b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dbf1a786bcc5cf2a5d13adb12f31293" id="r_a8dbf1a786bcc5cf2a5d13adb12f31293"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a8dbf1a786bcc5cf2a5d13adb12f31293">test_iter_buffered_cast_byteswapped_complex</a> ()</td></tr>
<tr class="separator:a8dbf1a786bcc5cf2a5d13adb12f31293"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ec2e43549df5114143c9dfa92a00c6" id="r_a67ec2e43549df5114143c9dfa92a00c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a67ec2e43549df5114143c9dfa92a00c6">test_iter_buffered_cast_structured_type</a> ()</td></tr>
<tr class="separator:a67ec2e43549df5114143c9dfa92a00c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a672e106cd4066de8d2e9191663fd10a6" id="r_a672e106cd4066de8d2e9191663fd10a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a672e106cd4066de8d2e9191663fd10a6">test_iter_buffered_cast_structured_type_failure_with_cleanup</a> ()</td></tr>
<tr class="separator:a672e106cd4066de8d2e9191663fd10a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a705cffa4f21b654369a35aa480931bec" id="r_a705cffa4f21b654369a35aa480931bec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a705cffa4f21b654369a35aa480931bec">test_buffered_cast_error_paths</a> ()</td></tr>
<tr class="separator:a705cffa4f21b654369a35aa480931bec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb9496d661eabb610360e7ef797254ba" id="r_acb9496d661eabb610360e7ef797254ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#acb9496d661eabb610360e7ef797254ba">test_buffered_cast_error_paths_unraisable</a> ()</td></tr>
<tr class="separator:acb9496d661eabb610360e7ef797254ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b5260d49860868b702a9cf4007c07e6" id="r_a6b5260d49860868b702a9cf4007c07e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a6b5260d49860868b702a9cf4007c07e6">test_iter_buffered_cast_subarray</a> ()</td></tr>
<tr class="separator:a6b5260d49860868b702a9cf4007c07e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0b81eafbae268d511b397caa82292a5" id="r_ad0b81eafbae268d511b397caa82292a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ad0b81eafbae268d511b397caa82292a5">test_iter_buffering_badwriteback</a> ()</td></tr>
<tr class="separator:ad0b81eafbae268d511b397caa82292a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a087951853dd6672a4b9a56c110cda3dc" id="r_a087951853dd6672a4b9a56c110cda3dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a087951853dd6672a4b9a56c110cda3dc">test_iter_buffering_string</a> ()</td></tr>
<tr class="separator:a087951853dd6672a4b9a56c110cda3dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9e165128658f622c2178821df73e5e5" id="r_aa9e165128658f622c2178821df73e5e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aa9e165128658f622c2178821df73e5e5">test_iter_buffering_growinner</a> ()</td></tr>
<tr class="separator:aa9e165128658f622c2178821df73e5e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40b697dddaf43dd4786c34d57df21ac0" id="r_a40b697dddaf43dd4786c34d57df21ac0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a40b697dddaf43dd4786c34d57df21ac0">test_iter_buffered_reduce_reuse</a> ()</td></tr>
<tr class="separator:a40b697dddaf43dd4786c34d57df21ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af22b46408f833830bd47671108c48eb5" id="r_af22b46408f833830bd47671108c48eb5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#af22b46408f833830bd47671108c48eb5">test_iter_no_broadcast</a> ()</td></tr>
<tr class="separator:af22b46408f833830bd47671108c48eb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4683344487d5cab3c31ac6cf1aa9f706" id="r_a4683344487d5cab3c31ac6cf1aa9f706"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a4683344487d5cab3c31ac6cf1aa9f706">test_iter_reduction_error</a> ()</td></tr>
<tr class="separator:a4683344487d5cab3c31ac6cf1aa9f706"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab04db4f7d5b6e447754f7e39c9731ceb" id="r_ab04db4f7d5b6e447754f7e39c9731ceb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ab04db4f7d5b6e447754f7e39c9731ceb">test_iter_reduction</a> ()</td></tr>
<tr class="separator:ab04db4f7d5b6e447754f7e39c9731ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94beae8767dc23577d6f1e7019b6ea4a" id="r_a94beae8767dc23577d6f1e7019b6ea4a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a94beae8767dc23577d6f1e7019b6ea4a">test_iter_buffering_reduction</a> ()</td></tr>
<tr class="separator:a94beae8767dc23577d6f1e7019b6ea4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29099d9ed9fba0960fa6a5794e50c6c0" id="r_a29099d9ed9fba0960fa6a5794e50c6c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a29099d9ed9fba0960fa6a5794e50c6c0">test_iter_buffering_reduction_reuse_reduce_loops</a> ()</td></tr>
<tr class="separator:a29099d9ed9fba0960fa6a5794e50c6c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4aca3fe1b32f5ede3dca95f04695643e" id="r_a4aca3fe1b32f5ede3dca95f04695643e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a4aca3fe1b32f5ede3dca95f04695643e">test_iter_writemasked_badinput</a> ()</td></tr>
<tr class="separator:a4aca3fe1b32f5ede3dca95f04695643e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb2fdf203991eba9f2a64aa13328536a" id="r_afb2fdf203991eba9f2a64aa13328536a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#afb2fdf203991eba9f2a64aa13328536a">_is_buffered</a> (iterator)</td></tr>
<tr class="separator:afb2fdf203991eba9f2a64aa13328536a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68e1e7e20912d6dcf9dda995e3d28a13" id="r_a68e1e7e20912d6dcf9dda995e3d28a13"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a68e1e7e20912d6dcf9dda995e3d28a13">test_iter_writemasked</a> (<a class="el" href="__blas__subroutines_8h.html#a4da0a64c77789ca4c8115aef76120fd2">a</a>)</td></tr>
<tr class="separator:a68e1e7e20912d6dcf9dda995e3d28a13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77cbb43a1c29fdb3d3be07e6f1f407f3" id="r_a77cbb43a1c29fdb3d3be07e6f1f407f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a77cbb43a1c29fdb3d3be07e6f1f407f3">test_iter_writemasked_broadcast_error</a> (mask, mask_axes)</td></tr>
<tr class="separator:a77cbb43a1c29fdb3d3be07e6f1f407f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c2146b6bf7df9548ea898370e961ae9" id="r_a6c2146b6bf7df9548ea898370e961ae9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a6c2146b6bf7df9548ea898370e961ae9">test_iter_writemasked_decref</a> ()</td></tr>
<tr class="separator:a6c2146b6bf7df9548ea898370e961ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba00d7a622c9f08fe1e41330f59f0317" id="r_aba00d7a622c9f08fe1e41330f59f0317"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aba00d7a622c9f08fe1e41330f59f0317">test_iter_non_writable_attribute_deletion</a> ()</td></tr>
<tr class="separator:aba00d7a622c9f08fe1e41330f59f0317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee631428c5d499b2031dfe3dc9ab5a91" id="r_aee631428c5d499b2031dfe3dc9ab5a91"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aee631428c5d499b2031dfe3dc9ab5a91">test_iter_writable_attribute_deletion</a> ()</td></tr>
<tr class="separator:aee631428c5d499b2031dfe3dc9ab5a91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3af524c5adc22f76b466026d72fe9ae" id="r_ad3af524c5adc22f76b466026d72fe9ae"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ad3af524c5adc22f76b466026d72fe9ae">test_iter_element_deletion</a> ()</td></tr>
<tr class="separator:ad3af524c5adc22f76b466026d72fe9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559a79791cb65fba542e5a412f156593" id="r_a559a79791cb65fba542e5a412f156593"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a559a79791cb65fba542e5a412f156593">test_iter_allocated_array_dtypes</a> ()</td></tr>
<tr class="separator:a559a79791cb65fba542e5a412f156593"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5244c664105047165587778525befd7" id="r_aa5244c664105047165587778525befd7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#aa5244c664105047165587778525befd7">test_0d_iter</a> ()</td></tr>
<tr class="separator:aa5244c664105047165587778525befd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c2e18e66aacfdf0a86bb31e5316e4c5" id="r_a9c2e18e66aacfdf0a86bb31e5316e4c5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a9c2e18e66aacfdf0a86bb31e5316e4c5">test_object_iter_cleanup</a> ()</td></tr>
<tr class="separator:a9c2e18e66aacfdf0a86bb31e5316e4c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93705830d435fe0b20bb766e056e855e" id="r_a93705830d435fe0b20bb766e056e855e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a93705830d435fe0b20bb766e056e855e">test_object_iter_cleanup_reduce</a> ()</td></tr>
<tr class="separator:a93705830d435fe0b20bb766e056e855e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62e477c5a035d2c77bcab84e4a1df933" id="r_a62e477c5a035d2c77bcab84e4a1df933"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a62e477c5a035d2c77bcab84e4a1df933">test_object_iter_cleanup_large_reduce</a> (arr)</td></tr>
<tr class="separator:a62e477c5a035d2c77bcab84e4a1df933"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51ebae33d472f29ca76b3799ee5cdea4" id="r_a51ebae33d472f29ca76b3799ee5cdea4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a51ebae33d472f29ca76b3799ee5cdea4">test_iter_too_large</a> ()</td></tr>
<tr class="separator:a51ebae33d472f29ca76b3799ee5cdea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb221ebebf658e9106d881856a6d625d" id="r_abb221ebebf658e9106d881856a6d625d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#abb221ebebf658e9106d881856a6d625d">test_iter_too_large_with_multiindex</a> ()</td></tr>
<tr class="separator:abb221ebebf658e9106d881856a6d625d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad519625a6bbde4b80d7f31fec1acfc6e" id="r_ad519625a6bbde4b80d7f31fec1acfc6e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ad519625a6bbde4b80d7f31fec1acfc6e">test_writebacks</a> ()</td></tr>
<tr class="separator:ad519625a6bbde4b80d7f31fec1acfc6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd6e949e68f8b2bcee3291d7c313e88c" id="r_afd6e949e68f8b2bcee3291d7c313e88c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#afd6e949e68f8b2bcee3291d7c313e88c">test_close_equivalent</a> ()</td></tr>
<tr class="separator:afd6e949e68f8b2bcee3291d7c313e88c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad90e430d085c2a04127ee2aaa3f91cc1" id="r_ad90e430d085c2a04127ee2aaa3f91cc1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#ad90e430d085c2a04127ee2aaa3f91cc1">test_close_raises</a> ()</td></tr>
<tr class="separator:ad90e430d085c2a04127ee2aaa3f91cc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b328724ecb27807c49c2e1dc739ea0d" id="r_a3b328724ecb27807c49c2e1dc739ea0d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a3b328724ecb27807c49c2e1dc739ea0d">test_close_parameters</a> ()</td></tr>
<tr class="separator:a3b328724ecb27807c49c2e1dc739ea0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7271d446a13573e40db57d84c3b103c7" id="r_a7271d446a13573e40db57d84c3b103c7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a7271d446a13573e40db57d84c3b103c7">test_warn_noclose</a> ()</td></tr>
<tr class="separator:a7271d446a13573e40db57d84c3b103c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4146ccefeaf3f116ddfe3001d863d96a" id="r_a4146ccefeaf3f116ddfe3001d863d96a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a4146ccefeaf3f116ddfe3001d863d96a">test_partial_iteration_cleanup</a> (in_dtype, buf_dtype, steps)</td></tr>
<tr class="separator:a4146ccefeaf3f116ddfe3001d863d96a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd5b95d7d37fcdaf80bf758374ec847" id="r_a9bd5b95d7d37fcdaf80bf758374ec847"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a9bd5b95d7d37fcdaf80bf758374ec847">test_partial_iteration_error</a> (in_dtype, buf_dtype)</td></tr>
<tr class="separator:a9bd5b95d7d37fcdaf80bf758374ec847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1056551aeca00f6a0a285e0c9665fd93" id="r_a1056551aeca00f6a0a285e0c9665fd93"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacenumpy_1_1core_1_1tests_1_1test__nditer.html#a1056551aeca00f6a0a285e0c9665fd93">test_debug_print</a> (capfd)</td></tr>
<tr class="separator:a1056551aeca00f6a0a285e0c9665fd93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="afb2fdf203991eba9f2a64aa13328536a" name="afb2fdf203991eba9f2a64aa13328536a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb2fdf203991eba9f2a64aa13328536a">&#9670;&#160;</a></span>_is_buffered()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer._is_buffered </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iterator</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2743</span><span class="keyword">def </span>_is_buffered(iterator):</div>
<div class="line"><span class="lineno"> 2744</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2745</span>        iterator.itviews</div>
<div class="line"><span class="lineno"> 2746</span>    <span class="keywordflow">except</span> ValueError:</div>
<div class="line"><span class="lineno"> 2747</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 2748</span>    <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 2749</span> </div>
<div class="line"><span class="lineno"> 2750</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;a&quot;</span>,</div>
<div class="line"><span class="lineno"> 2751</span>        [np.zeros((3,), dtype=<span class="stringliteral">&#39;f8&#39;</span>),</div>
<div class="line"><span class="lineno"> 2752</span>         np.zeros((9876, 3*5), dtype=<span class="stringliteral">&#39;f8&#39;</span>)[::2, :],</div>
<div class="line"><span class="lineno"> 2753</span>         np.zeros((4, 312, 124, 3), dtype=<span class="stringliteral">&#39;f8&#39;</span>)[::2, :, ::2, :],</div>
<div class="line"><span class="lineno"> 2754</span>         <span class="comment"># Also test with the last dimension strided (so it does not fit if</span></div>
<div class="line"><span class="lineno"> 2755</span>         <span class="comment"># there is repeated access)</span></div>
<div class="line"><span class="lineno"> 2756</span>         np.zeros((9,), dtype=<span class="stringliteral">&#39;f8&#39;</span>)[::3],</div>
<div class="line"><span class="lineno"> 2757</span>         np.zeros((9876, 3*10), dtype=<span class="stringliteral">&#39;f8&#39;</span>)[::2, ::5],</div>
<div class="line"><span class="lineno"> 2758</span>         np.zeros((4, 312, 124, 3), dtype=<span class="stringliteral">&#39;f8&#39;</span>)[::2, :, ::2, ::-1]])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a61a4a7de2475d4f343178d28423b8832" name="a61a4a7de2475d4f343178d28423b8832"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61a4a7de2475d4f343178d28423b8832">&#9670;&#160;</a></span>iter_indices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.iter_indices </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   23</span><span class="keyword">def </span>iter_indices(i):</div>
<div class="line"><span class="lineno">   24</span>    ret = []</div>
<div class="line"><span class="lineno">   25</span>    <span class="keywordflow">while</span> <span class="keywordflow">not</span> i.finished:</div>
<div class="line"><span class="lineno">   26</span>        ret.append(i.index)</div>
<div class="line"><span class="lineno">   27</span>        i.iternext()</div>
<div class="line"><span class="lineno">   28</span>    <span class="keywordflow">return</span> ret</div>
<div class="line"><span class="lineno">   29</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa86707e255262d2113923c18d4e3f537" name="aa86707e255262d2113923c18d4e3f537"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa86707e255262d2113923c18d4e3f537">&#9670;&#160;</a></span>iter_iterindices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.iter_iterindices </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   30</span><span class="keyword">def </span>iter_iterindices(i):</div>
<div class="line"><span class="lineno">   31</span>    ret = []</div>
<div class="line"><span class="lineno">   32</span>    <span class="keywordflow">while</span> <span class="keywordflow">not</span> i.finished:</div>
<div class="line"><span class="lineno">   33</span>        ret.append(i.iterindex)</div>
<div class="line"><span class="lineno">   34</span>        i.iternext()</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">return</span> ret</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span><span class="preprocessor">@pytest.mark.skipif(not HAS_REFCOUNT, reason=&quot;Python lacks refcounts&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa08b05d378280a75bf3015ac9d106259" name="aa08b05d378280a75bf3015ac9d106259"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa08b05d378280a75bf3015ac9d106259">&#9670;&#160;</a></span>iter_multi_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.iter_multi_index </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   16</span><span class="keyword">def </span>iter_multi_index(i):</div>
<div class="line"><span class="lineno">   17</span>    ret = []</div>
<div class="line"><span class="lineno">   18</span>    <span class="keywordflow">while</span> <span class="keywordflow">not</span> i.finished:</div>
<div class="line"><span class="lineno">   19</span>        ret.append(i.multi_index)</div>
<div class="line"><span class="lineno">   20</span>        i.iternext()</div>
<div class="line"><span class="lineno">   21</span>    <span class="keywordflow">return</span> ret</div>
<div class="line"><span class="lineno">   22</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5244c664105047165587778525befd7" name="aa5244c664105047165587778525befd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5244c664105047165587778525befd7">&#9670;&#160;</a></span>test_0d_iter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_0d_iter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2931</span><span class="keyword">def </span>test_0d_iter():</div>
<div class="line"><span class="lineno"> 2932</span>    <span class="comment"># Basic test for iteration of 0-d arrays:</span></div>
<div class="line"><span class="lineno"> 2933</span>    i = nditer([2, 3], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno"> 2934</span>    assert_equal(i.ndim, 0)</div>
<div class="line"><span class="lineno"> 2935</span>    assert_equal(next(i), (2, 3))</div>
<div class="line"><span class="lineno"> 2936</span>    assert_equal(i.multi_index, ())</div>
<div class="line"><span class="lineno"> 2937</span>    assert_equal(i.iterindex, 0)</div>
<div class="line"><span class="lineno"> 2938</span>    assert_raises(StopIteration, next, i)</div>
<div class="line"><span class="lineno"> 2939</span>    <span class="comment"># test reset:</span></div>
<div class="line"><span class="lineno"> 2940</span>    i.reset()</div>
<div class="line"><span class="lineno"> 2941</span>    assert_equal(next(i), (2, 3))</div>
<div class="line"><span class="lineno"> 2942</span>    assert_raises(StopIteration, next, i)</div>
<div class="line"><span class="lineno"> 2943</span> </div>
<div class="line"><span class="lineno"> 2944</span>    <span class="comment"># test forcing to 0-d</span></div>
<div class="line"><span class="lineno"> 2945</span>    i = nditer(np.arange(5), [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]], op_axes=[()])</div>
<div class="line"><span class="lineno"> 2946</span>    assert_equal(i.ndim, 0)</div>
<div class="line"><span class="lineno"> 2947</span>    assert_equal(len(i), 1)</div>
<div class="line"><span class="lineno"> 2948</span> </div>
<div class="line"><span class="lineno"> 2949</span>    i = nditer(np.arange(5), [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2950</span>               op_axes=[()], itershape=())</div>
<div class="line"><span class="lineno"> 2951</span>    assert_equal(i.ndim, 0)</div>
<div class="line"><span class="lineno"> 2952</span>    assert_equal(len(i), 1)</div>
<div class="line"><span class="lineno"> 2953</span> </div>
<div class="line"><span class="lineno"> 2954</span>    <span class="comment"># passing an itershape alone is not enough, the op_axes are also needed</span></div>
<div class="line"><span class="lineno"> 2955</span>    <span class="keyword">with</span> assert_raises(ValueError):</div>
<div class="line"><span class="lineno"> 2956</span>        nditer(np.arange(5), [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]], itershape=())</div>
<div class="line"><span class="lineno"> 2957</span> </div>
<div class="line"><span class="lineno"> 2958</span>    <span class="comment"># Test a more complex buffered casting case (same as another test above)</span></div>
<div class="line"><span class="lineno"> 2959</span>    sdt = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>), (<span class="stringliteral">&#39;b&#39;</span>, <span class="stringliteral">&#39;i8&#39;</span>), (<span class="stringliteral">&#39;c&#39;</span>, <span class="stringliteral">&#39;c8&#39;</span>, (2, 3)), (<span class="stringliteral">&#39;d&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>)]</div>
<div class="line"><span class="lineno"> 2960</span>    a = np.array(0.5, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno"> 2961</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2962</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>, op_dtypes=sdt)</div>
<div class="line"><span class="lineno"> 2963</span>    vals = next(i)</div>
<div class="line"><span class="lineno"> 2964</span>    assert_equal(vals[<span class="stringliteral">&#39;a&#39;</span>], 0.5)</div>
<div class="line"><span class="lineno"> 2965</span>    assert_equal(vals[<span class="stringliteral">&#39;b&#39;</span>], 0)</div>
<div class="line"><span class="lineno"> 2966</span>    assert_equal(vals[<span class="stringliteral">&#39;c&#39;</span>], [[(0.5)]*3]*2)</div>
<div class="line"><span class="lineno"> 2967</span>    assert_equal(vals[<span class="stringliteral">&#39;d&#39;</span>], 0.5)</div>
<div class="line"><span class="lineno"> 2968</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5aed081064b97c2b26ab01e9867c2ad3" name="a5aed081064b97c2b26ab01e9867c2ad3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aed081064b97c2b26ab01e9867c2ad3">&#9670;&#160;</a></span>test_all_allocated()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_all_allocated </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1627</span><span class="keyword">def </span>test_all_allocated():</div>
<div class="line"><span class="lineno"> 1628</span>    <span class="comment"># When no output and no shape is given, `()` is used as shape.</span></div>
<div class="line"><span class="lineno"> 1629</span>    i = np.nditer([<span class="keywordtype">None</span>], op_dtypes=[<span class="stringliteral">&quot;int64&quot;</span>])</div>
<div class="line"><span class="lineno"> 1630</span>    <span class="keyword">assert</span> i.operands[0].shape == ()</div>
<div class="line"><span class="lineno"> 1631</span>    <span class="keyword">assert</span> i.dtypes == (np.dtype(<span class="stringliteral">&quot;int64&quot;</span>),)</div>
<div class="line"><span class="lineno"> 1632</span> </div>
<div class="line"><span class="lineno"> 1633</span>    i = np.nditer([<span class="keywordtype">None</span>], op_dtypes=[<span class="stringliteral">&quot;int64&quot;</span>], itershape=(2, 3, 4))</div>
<div class="line"><span class="lineno"> 1634</span>    <span class="keyword">assert</span> i.operands[0].shape == (2, 3, 4)</div>
<div class="line"><span class="lineno"> 1635</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a705cffa4f21b654369a35aa480931bec" name="a705cffa4f21b654369a35aa480931bec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a705cffa4f21b654369a35aa480931bec">&#9670;&#160;</a></span>test_buffered_cast_error_paths()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_buffered_cast_error_paths </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2014</span><span class="keyword">def </span>test_buffered_cast_error_paths():</div>
<div class="line"><span class="lineno"> 2015</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 2016</span>        <span class="comment"># The input is cast into an `S3` buffer</span></div>
<div class="line"><span class="lineno"> 2017</span>        np.nditer((np.array(<span class="stringliteral">&quot;a&quot;</span>, dtype=<span class="stringliteral">&quot;S1&quot;</span>),), op_dtypes=[<span class="stringliteral">&quot;i&quot;</span>],</div>
<div class="line"><span class="lineno"> 2018</span>                  casting=<span class="stringliteral">&quot;unsafe&quot;</span>, flags=[<span class="stringliteral">&quot;buffered&quot;</span>])</div>
<div class="line"><span class="lineno"> 2019</span> </div>
<div class="line"><span class="lineno"> 2020</span>    <span class="comment"># The `M8[ns]` is cast into the `S3` output</span></div>
<div class="line"><span class="lineno"> 2021</span>    it = np.nditer((np.array(1, dtype=<span class="stringliteral">&quot;i&quot;</span>),), op_dtypes=[<span class="stringliteral">&quot;S1&quot;</span>],</div>
<div class="line"><span class="lineno"> 2022</span>                   op_flags=[<span class="stringliteral">&quot;writeonly&quot;</span>], casting=<span class="stringliteral">&quot;unsafe&quot;</span>, flags=[<span class="stringliteral">&quot;buffered&quot;</span>])</div>
<div class="line"><span class="lineno"> 2023</span>    <span class="keyword">with</span> pytest.raises(ValueError):</div>
<div class="line"><span class="lineno"> 2024</span>        <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 2025</span>            buf = next(it)</div>
<div class="line"><span class="lineno"> 2026</span>            buf[...] = <span class="stringliteral">&quot;a&quot;</span>  <span class="comment"># cannot be converted to int.</span></div>
<div class="line"><span class="lineno"> 2027</span> </div>
<div class="line"><span class="lineno"> 2028</span><span class="preprocessor">@pytest.mark.skipif(IS_WASM, reason=&quot;Cannot start subprocess&quot;)</span></div>
<div class="line"><span class="lineno"> 2029</span><span class="preprocessor">@pytest.mark.skipif(not HAS_REFCOUNT, reason=&quot;PyPy seems to not hit this.&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb9496d661eabb610360e7ef797254ba" name="acb9496d661eabb610360e7ef797254ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb9496d661eabb610360e7ef797254ba">&#9670;&#160;</a></span>test_buffered_cast_error_paths_unraisable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_buffered_cast_error_paths_unraisable </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2030</span><span class="keyword">def </span>test_buffered_cast_error_paths_unraisable():</div>
<div class="line"><span class="lineno"> 2031</span>    <span class="comment"># The following gives an unraisable error. Pytest sometimes captures that</span></div>
<div class="line"><span class="lineno"> 2032</span>    <span class="comment"># (depending python and/or pytest version). So with Python&gt;=3.8 this can</span></div>
<div class="line"><span class="lineno"> 2033</span>    <span class="comment"># probably be cleaned out in the future to check for</span></div>
<div class="line"><span class="lineno"> 2034</span>    <span class="comment"># pytest.PytestUnraisableExceptionWarning:</span></div>
<div class="line"><span class="lineno"> 2035</span>    code = textwrap.dedent(<span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2036</span><span class="stringliteral">        import numpy as np</span></div>
<div class="line"><span class="lineno"> 2037</span><span class="stringliteral">    </span></div>
<div class="line"><span class="lineno"> 2038</span><span class="stringliteral">        it = np.nditer((np.array(1, dtype=&quot;i&quot;),), op_dtypes=[&quot;S1&quot;],</span></div>
<div class="line"><span class="lineno"> 2039</span><span class="stringliteral">                       op_flags=[&quot;writeonly&quot;], casting=&quot;unsafe&quot;, flags=[&quot;buffered&quot;])</span></div>
<div class="line"><span class="lineno"> 2040</span><span class="stringliteral">        buf = next(it)</span></div>
<div class="line"><span class="lineno"> 2041</span><span class="stringliteral">        buf[...] = &quot;a&quot;</span></div>
<div class="line"><span class="lineno"> 2042</span><span class="stringliteral">        del buf, it  # Flushing only happens during deallocate right now.</span></div>
<div class="line"><span class="lineno"> 2043</span><span class="stringliteral">        &quot;&quot;&quot;</span>)</div>
<div class="line"><span class="lineno"> 2044</span>    res = subprocess.check_output([sys.executable, <span class="stringliteral">&quot;-c&quot;</span>, code],</div>
<div class="line"><span class="lineno"> 2045</span>                                  stderr=subprocess.STDOUT, text=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2046</span>    <span class="keyword">assert</span> <span class="stringliteral">&quot;ValueError&quot;</span> <span class="keywordflow">in</span> res</div>
<div class="line"><span class="lineno"> 2047</span> </div>
<div class="line"><span class="lineno"> 2048</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afd6e949e68f8b2bcee3291d7c313e88c" name="afd6e949e68f8b2bcee3291d7c313e88c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd6e949e68f8b2bcee3291d7c313e88c">&#9670;&#160;</a></span>test_close_equivalent()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_close_equivalent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment"> using a context amanger and using nditer.close are equivalent
</pre> <div class="fragment"><div class="line"><span class="lineno"> 3122</span><span class="keyword">def </span>test_close_equivalent():</div>
<div class="line"><span class="lineno"> 3123</span>    <span class="stringliteral">&#39;&#39;&#39; using a context amanger and using nditer.close are equivalent</span></div>
<div class="line"><span class="lineno"> 3124</span><span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno"> 3125</span>    <span class="keyword">def </span>add_close(x, y, out=None):</div>
<div class="line"><span class="lineno"> 3126</span>        addop = np.add</div>
<div class="line"><span class="lineno"> 3127</span>        it = np.nditer([x, y, out], [],</div>
<div class="line"><span class="lineno"> 3128</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>,<span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 3129</span>        <span class="keywordflow">for</span> (a, b, c) <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 3130</span>            addop(a, b, out=c)</div>
<div class="line"><span class="lineno"> 3131</span>        ret = it.operands[2]</div>
<div class="line"><span class="lineno"> 3132</span>        it.close()</div>
<div class="line"><span class="lineno"> 3133</span>        <span class="keywordflow">return</span> ret</div>
<div class="line"><span class="lineno"> 3134</span> </div>
<div class="line"><span class="lineno"> 3135</span>    <span class="keyword">def </span>add_context(x, y, out=None):</div>
<div class="line"><span class="lineno"> 3136</span>        addop = np.add</div>
<div class="line"><span class="lineno"> 3137</span>        it = np.nditer([x, y, out], [],</div>
<div class="line"><span class="lineno"> 3138</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>,<span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 3139</span>        <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3140</span>            <span class="keywordflow">for</span> (a, b, c) <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 3141</span>                addop(a, b, out=c)</div>
<div class="line"><span class="lineno"> 3142</span>            <span class="keywordflow">return</span> it.operands[2]</div>
<div class="line"><span class="lineno"> 3143</span>    z = add_close(range(5), range(5))</div>
<div class="line"><span class="lineno"> 3144</span>    assert_equal(z, range(0, 10, 2))</div>
<div class="line"><span class="lineno"> 3145</span>    z = add_context(range(5), range(5))</div>
<div class="line"><span class="lineno"> 3146</span>    assert_equal(z, range(0, 10, 2))</div>
<div class="line"><span class="lineno"> 3147</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b328724ecb27807c49c2e1dc739ea0d" name="a3b328724ecb27807c49c2e1dc739ea0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b328724ecb27807c49c2e1dc739ea0d">&#9670;&#160;</a></span>test_close_parameters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_close_parameters </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3155</span><span class="keyword">def </span>test_close_parameters():</div>
<div class="line"><span class="lineno"> 3156</span>    it = np.nditer(np.arange(3))</div>
<div class="line"><span class="lineno"> 3157</span>    assert_raises(TypeError, it.close, 1)</div>
<div class="line"><span class="lineno"> 3158</span> </div>
<div class="line"><span class="lineno"> 3159</span><span class="preprocessor">@pytest.mark.skipif(not HAS_REFCOUNT, reason=&quot;Python lacks refcounts&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad90e430d085c2a04127ee2aaa3f91cc1" name="ad90e430d085c2a04127ee2aaa3f91cc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad90e430d085c2a04127ee2aaa3f91cc1">&#9670;&#160;</a></span>test_close_raises()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_close_raises </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3148</span><span class="keyword">def </span>test_close_raises():</div>
<div class="line"><span class="lineno"> 3149</span>    it = np.nditer(np.arange(3))</div>
<div class="line"><span class="lineno"> 3150</span>    assert_equal (next(it), 0)</div>
<div class="line"><span class="lineno"> 3151</span>    it.close()</div>
<div class="line"><span class="lineno"> 3152</span>    assert_raises(StopIteration, next, it)</div>
<div class="line"><span class="lineno"> 3153</span>    assert_raises(ValueError, getattr, it, <span class="stringliteral">&#39;operands&#39;</span>)</div>
<div class="line"><span class="lineno"> 3154</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1056551aeca00f6a0a285e0c9665fd93" name="a1056551aeca00f6a0a285e0c9665fd93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1056551aeca00f6a0a285e0c9665fd93">&#9670;&#160;</a></span>test_debug_print()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_debug_print </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>capfd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Matches the expected output of a debug print with the actual output.
Note that the iterator dump should not be considered stable API,
this test is mainly to ensure the print does not crash.

Currently uses a subprocess to avoid dealing with the C level `printf`s.
</pre> <div class="fragment"><div class="line"><span class="lineno"> 3238</span><span class="keyword">def </span>test_debug_print(capfd):</div>
<div class="line"><span class="lineno"> 3239</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3240</span><span class="stringliteral">    Matches the expected output of a debug print with the actual output.</span></div>
<div class="line"><span class="lineno"> 3241</span><span class="stringliteral">    Note that the iterator dump should not be considered stable API,</span></div>
<div class="line"><span class="lineno"> 3242</span><span class="stringliteral">    this test is mainly to ensure the print does not crash.</span></div>
<div class="line"><span class="lineno"> 3243</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3244</span><span class="stringliteral">    Currently uses a subprocess to avoid dealing with the C level `printf`s.</span></div>
<div class="line"><span class="lineno"> 3245</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3246</span>    <span class="comment"># the expected output with all addresses and sizes stripped (they vary</span></div>
<div class="line"><span class="lineno"> 3247</span>    <span class="comment"># and/or are platform dependent).</span></div>
<div class="line"><span class="lineno"> 3248</span>    expected = <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3249</span><span class="stringliteral">    ------ BEGIN ITERATOR DUMP ------</span></div>
<div class="line"><span class="lineno"> 3250</span><span class="stringliteral">    | Iterator Address:</span></div>
<div class="line"><span class="lineno"> 3251</span><span class="stringliteral">    | ItFlags: BUFFER REDUCE REUSE_REDUCE_LOOPS</span></div>
<div class="line"><span class="lineno"> 3252</span><span class="stringliteral">    | NDim: 2</span></div>
<div class="line"><span class="lineno"> 3253</span><span class="stringliteral">    | NOp: 2</span></div>
<div class="line"><span class="lineno"> 3254</span><span class="stringliteral">    | IterSize: 50</span></div>
<div class="line"><span class="lineno"> 3255</span><span class="stringliteral">    | IterStart: 0</span></div>
<div class="line"><span class="lineno"> 3256</span><span class="stringliteral">    | IterEnd: 50</span></div>
<div class="line"><span class="lineno"> 3257</span><span class="stringliteral">    | IterIndex: 0</span></div>
<div class="line"><span class="lineno"> 3258</span><span class="stringliteral">    | Iterator SizeOf:</span></div>
<div class="line"><span class="lineno"> 3259</span><span class="stringliteral">    | BufferData SizeOf:</span></div>
<div class="line"><span class="lineno"> 3260</span><span class="stringliteral">    | AxisData SizeOf:</span></div>
<div class="line"><span class="lineno"> 3261</span><span class="stringliteral">    |</span></div>
<div class="line"><span class="lineno"> 3262</span><span class="stringliteral">    | Perm: 0 1</span></div>
<div class="line"><span class="lineno"> 3263</span><span class="stringliteral">    | DTypes:</span></div>
<div class="line"><span class="lineno"> 3264</span><span class="stringliteral">    | DTypes: dtype(&#39;float64&#39;) dtype(&#39;int32&#39;)</span></div>
<div class="line"><span class="lineno"> 3265</span><span class="stringliteral">    | InitDataPtrs:</span></div>
<div class="line"><span class="lineno"> 3266</span><span class="stringliteral">    | BaseOffsets: 0 0</span></div>
<div class="line"><span class="lineno"> 3267</span><span class="stringliteral">    | Operands:</span></div>
<div class="line"><span class="lineno"> 3268</span><span class="stringliteral">    | Operand DTypes: dtype(&#39;int64&#39;) dtype(&#39;float64&#39;)</span></div>
<div class="line"><span class="lineno"> 3269</span><span class="stringliteral">    | OpItFlags:</span></div>
<div class="line"><span class="lineno"> 3270</span><span class="stringliteral">    |   Flags[0]: READ CAST ALIGNED</span></div>
<div class="line"><span class="lineno"> 3271</span><span class="stringliteral">    |   Flags[1]: READ WRITE CAST ALIGNED REDUCE</span></div>
<div class="line"><span class="lineno"> 3272</span><span class="stringliteral">    |</span></div>
<div class="line"><span class="lineno"> 3273</span><span class="stringliteral">    | BufferData:</span></div>
<div class="line"><span class="lineno"> 3274</span><span class="stringliteral">    |   BufferSize: 50</span></div>
<div class="line"><span class="lineno"> 3275</span><span class="stringliteral">    |   Size: 5</span></div>
<div class="line"><span class="lineno"> 3276</span><span class="stringliteral">    |   BufIterEnd: 5</span></div>
<div class="line"><span class="lineno"> 3277</span><span class="stringliteral">    |   REDUCE Pos: 0</span></div>
<div class="line"><span class="lineno"> 3278</span><span class="stringliteral">    |   REDUCE OuterSize: 10</span></div>
<div class="line"><span class="lineno"> 3279</span><span class="stringliteral">    |   REDUCE OuterDim: 1</span></div>
<div class="line"><span class="lineno"> 3280</span><span class="stringliteral">    |   Strides: 8 4</span></div>
<div class="line"><span class="lineno"> 3281</span><span class="stringliteral">    |   Ptrs:</span></div>
<div class="line"><span class="lineno"> 3282</span><span class="stringliteral">    |   REDUCE Outer Strides: 40 0</span></div>
<div class="line"><span class="lineno"> 3283</span><span class="stringliteral">    |   REDUCE Outer Ptrs:</span></div>
<div class="line"><span class="lineno"> 3284</span><span class="stringliteral">    |   ReadTransferFn:</span></div>
<div class="line"><span class="lineno"> 3285</span><span class="stringliteral">    |   ReadTransferData:</span></div>
<div class="line"><span class="lineno"> 3286</span><span class="stringliteral">    |   WriteTransferFn:</span></div>
<div class="line"><span class="lineno"> 3287</span><span class="stringliteral">    |   WriteTransferData:</span></div>
<div class="line"><span class="lineno"> 3288</span><span class="stringliteral">    |   Buffers:</span></div>
<div class="line"><span class="lineno"> 3289</span><span class="stringliteral">    |</span></div>
<div class="line"><span class="lineno"> 3290</span><span class="stringliteral">    | AxisData[0]:</span></div>
<div class="line"><span class="lineno"> 3291</span><span class="stringliteral">    |   Shape: 5</span></div>
<div class="line"><span class="lineno"> 3292</span><span class="stringliteral">    |   Index: 0</span></div>
<div class="line"><span class="lineno"> 3293</span><span class="stringliteral">    |   Strides: 16 8</span></div>
<div class="line"><span class="lineno"> 3294</span><span class="stringliteral">    |   Ptrs:</span></div>
<div class="line"><span class="lineno"> 3295</span><span class="stringliteral">    | AxisData[1]:</span></div>
<div class="line"><span class="lineno"> 3296</span><span class="stringliteral">    |   Shape: 10</span></div>
<div class="line"><span class="lineno"> 3297</span><span class="stringliteral">    |   Index: 0</span></div>
<div class="line"><span class="lineno"> 3298</span><span class="stringliteral">    |   Strides: 80 0</span></div>
<div class="line"><span class="lineno"> 3299</span><span class="stringliteral">    |   Ptrs:</span></div>
<div class="line"><span class="lineno"> 3300</span><span class="stringliteral">    ------- END ITERATOR DUMP -------</span></div>
<div class="line"><span class="lineno"> 3301</span><span class="stringliteral">    &quot;&quot;&quot;</span>.strip().splitlines()</div>
<div class="line"><span class="lineno"> 3302</span> </div>
<div class="line"><span class="lineno"> 3303</span>    arr1 = np.arange(100, dtype=np.int64).reshape(10, 10)[:, ::2]</div>
<div class="line"><span class="lineno"> 3304</span>    arr2 = np.arange(5.)</div>
<div class="line"><span class="lineno"> 3305</span>    it = np.nditer((arr1, arr2), op_dtypes=[<span class="stringliteral">&quot;d&quot;</span>, <span class="stringliteral">&quot;i4&quot;</span>], casting=<span class="stringliteral">&quot;unsafe&quot;</span>,</div>
<div class="line"><span class="lineno"> 3306</span>                   flags=[<span class="stringliteral">&quot;reduce_ok&quot;</span>, <span class="stringliteral">&quot;buffered&quot;</span>],</div>
<div class="line"><span class="lineno"> 3307</span>                   op_flags=[[<span class="stringliteral">&quot;readonly&quot;</span>], [<span class="stringliteral">&quot;readwrite&quot;</span>]])</div>
<div class="line"><span class="lineno"> 3308</span>    it.debug_print()</div>
<div class="line"><span class="lineno"> 3309</span>    res = capfd.readouterr().out</div>
<div class="line"><span class="lineno"> 3310</span>    res = res.strip().splitlines()</div>
<div class="line"><span class="lineno"> 3311</span> </div>
<div class="line"><span class="lineno"> 3312</span>    <span class="keyword">assert</span> len(res) == len(expected)</div>
<div class="line"><span class="lineno"> 3313</span>    <span class="keywordflow">for</span> res_line, expected_line <span class="keywordflow">in</span> zip(res, expected):</div>
<div class="line"><span class="lineno"> 3314</span>        <span class="comment"># The actual output may have additional pointers listed that are</span></div>
<div class="line"><span class="lineno"> 3315</span>        <span class="comment"># stripped from the example output:</span></div>
<div class="line"><span class="lineno"> 3316</span>        <span class="keyword">assert</span> res_line.startswith(expected_line.strip())</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b2f5edd18dae638f66f26662ed142bd" name="a3b2f5edd18dae638f66f26662ed142bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b2f5edd18dae638f66f26662ed142bd">&#9670;&#160;</a></span>test_iter_allocate_output_buffered_readwrite()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_buffered_readwrite </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1470</span><span class="keyword">def </span>test_iter_allocate_output_buffered_readwrite():</div>
<div class="line"><span class="lineno"> 1471</span>    <span class="comment"># Allocated output with buffering + delay_bufalloc</span></div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>    a = arange(6)</div>
<div class="line"><span class="lineno"> 1474</span>    i = nditer([a, <span class="keywordtype">None</span>], [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;delay_bufalloc&#39;</span>],</div>
<div class="line"><span class="lineno"> 1475</span>                        [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;allocate&#39;</span>, <span class="stringliteral">&#39;readwrite&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1476</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1477</span>        i.operands[1][:] = 1</div>
<div class="line"><span class="lineno"> 1478</span>        i.reset()</div>
<div class="line"><span class="lineno"> 1479</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1480</span>            x[1][...] += x[0][...]</div>
<div class="line"><span class="lineno"> 1481</span>        assert_equal(i.operands[1], a+1)</div>
<div class="line"><span class="lineno"> 1482</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac487a7ddc5db792d4c2d145566bf2251" name="ac487a7ddc5db792d4c2d145566bf2251"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac487a7ddc5db792d4c2d145566bf2251">&#9670;&#160;</a></span>test_iter_allocate_output_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1584</span><span class="keyword">def </span>test_iter_allocate_output_errors():</div>
<div class="line"><span class="lineno"> 1585</span>    <span class="comment"># Check that the iterator will throw errors for bad output allocations</span></div>
<div class="line"><span class="lineno"> 1586</span> </div>
<div class="line"><span class="lineno"> 1587</span>    <span class="comment"># Need an input if no output data type is specified</span></div>
<div class="line"><span class="lineno"> 1588</span>    a = arange(6)</div>
<div class="line"><span class="lineno"> 1589</span>    assert_raises(TypeError, nditer, [a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1590</span>                        [[<span class="stringliteral">&#39;writeonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1591</span>    <span class="comment"># Allocated output should be flagged for writing</span></div>
<div class="line"><span class="lineno"> 1592</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1593</span>                        [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;allocate&#39;</span>, <span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1594</span>    <span class="comment"># Allocated output can&#39;t have buffering without delayed bufalloc</span></div>
<div class="line"><span class="lineno"> 1595</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [<span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 1596</span>                                            [<span class="stringliteral">&#39;allocate&#39;</span>, <span class="stringliteral">&#39;readwrite&#39;</span>])</div>
<div class="line"><span class="lineno"> 1597</span>    <span class="comment"># Must specify dtype if there are no inputs (cannot promote existing ones;</span></div>
<div class="line"><span class="lineno"> 1598</span>    <span class="comment"># maybe this should use the &#39;f4&#39; here, but it does not historically.)</span></div>
<div class="line"><span class="lineno"> 1599</span>    assert_raises(TypeError, nditer, [<span class="keywordtype">None</span>, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1600</span>                        [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>],</div>
<div class="line"><span class="lineno"> 1601</span>                         [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1602</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1603</span>    <span class="comment"># If using op_axes, must specify all the axes</span></div>
<div class="line"><span class="lineno"> 1604</span>    a = arange(24, dtype=<span class="stringliteral">&#39;i4&#39;</span>).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1605</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1606</span>                        [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1607</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1608</span>                        op_axes=[<span class="keywordtype">None</span>, [0, np.newaxis, 1]])</div>
<div class="line"><span class="lineno"> 1609</span>    <span class="comment"># If using op_axes, the axes must be within bounds</span></div>
<div class="line"><span class="lineno"> 1610</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1611</span>                        [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1612</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1613</span>                        op_axes=[<span class="keywordtype">None</span>, [0, 3, 1]])</div>
<div class="line"><span class="lineno"> 1614</span>    <span class="comment"># If using op_axes, there can&#39;t be duplicates</span></div>
<div class="line"><span class="lineno"> 1615</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1616</span>                        [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1617</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1618</span>                        op_axes=[<span class="keywordtype">None</span>, [0, 2, 1, 0]])</div>
<div class="line"><span class="lineno"> 1619</span>    <span class="comment"># Not all axes may be specified if a reduction. If there is a hole</span></div>
<div class="line"><span class="lineno"> 1620</span>    <span class="comment"># in op_axes, this is an error.</span></div>
<div class="line"><span class="lineno"> 1621</span>    a = arange(24, dtype=<span class="stringliteral">&#39;i4&#39;</span>).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1622</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [<span class="stringliteral">&quot;reduce_ok&quot;</span>],</div>
<div class="line"><span class="lineno"> 1623</span>                        [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1624</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1625</span>                        op_axes=[<span class="keywordtype">None</span>, [0, np.newaxis, 2]])</div>
<div class="line"><span class="lineno"> 1626</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5bbbdc2750e807c7c1d60a9d07076570" name="a5bbbdc2750e807c7c1d60a9d07076570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bbbdc2750e807c7c1d60a9d07076570">&#9670;&#160;</a></span>test_iter_allocate_output_itorder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_itorder </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1483</span><span class="keyword">def </span>test_iter_allocate_output_itorder():</div>
<div class="line"><span class="lineno"> 1484</span>    <span class="comment"># The allocated output should match the iteration order</span></div>
<div class="line"><span class="lineno"> 1485</span> </div>
<div class="line"><span class="lineno"> 1486</span>    <span class="comment"># C-order input, best iteration order</span></div>
<div class="line"><span class="lineno"> 1487</span>    a = arange(6, dtype=<span class="stringliteral">&#39;i4&#39;</span>).reshape(2, 3)</div>
<div class="line"><span class="lineno"> 1488</span>    i = nditer([a, <span class="keywordtype">None</span>], [], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1489</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1490</span>    assert_equal(i.operands[1].shape, a.shape)</div>
<div class="line"><span class="lineno"> 1491</span>    assert_equal(i.operands[1].strides, a.strides)</div>
<div class="line"><span class="lineno"> 1492</span>    assert_equal(i.operands[1].dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1493</span>    <span class="comment"># F-order input, best iteration order</span></div>
<div class="line"><span class="lineno"> 1494</span>    a = arange(24, dtype=<span class="stringliteral">&#39;i4&#39;</span>).reshape(2, 3, 4).T</div>
<div class="line"><span class="lineno"> 1495</span>    i = nditer([a, <span class="keywordtype">None</span>], [], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1496</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1497</span>    assert_equal(i.operands[1].shape, a.shape)</div>
<div class="line"><span class="lineno"> 1498</span>    assert_equal(i.operands[1].strides, a.strides)</div>
<div class="line"><span class="lineno"> 1499</span>    assert_equal(i.operands[1].dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1500</span>    <span class="comment"># Non-contiguous input, C iteration order</span></div>
<div class="line"><span class="lineno"> 1501</span>    a = arange(24, dtype=<span class="stringliteral">&#39;i4&#39;</span>).reshape(2, 3, 4).swapaxes(0, 1)</div>
<div class="line"><span class="lineno"> 1502</span>    i = nditer([a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1503</span>                        [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1504</span>                        order=<span class="stringliteral">&#39;C&#39;</span>,</div>
<div class="line"><span class="lineno"> 1505</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1506</span>    assert_equal(i.operands[1].shape, a.shape)</div>
<div class="line"><span class="lineno"> 1507</span>    assert_equal(i.operands[1].strides, (32, 16, 4))</div>
<div class="line"><span class="lineno"> 1508</span>    assert_equal(i.operands[1].dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1509</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a521fa5266e3f2ab75bc00608efc631" name="a4a521fa5266e3f2ab75bc00608efc631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a521fa5266e3f2ab75bc00608efc631">&#9670;&#160;</a></span>test_iter_allocate_output_opaxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_opaxes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1510</span><span class="keyword">def </span>test_iter_allocate_output_opaxes():</div>
<div class="line"><span class="lineno"> 1511</span>    <span class="comment"># Specifying op_axes should work</span></div>
<div class="line"><span class="lineno"> 1512</span> </div>
<div class="line"><span class="lineno"> 1513</span>    a = arange(24, dtype=<span class="stringliteral">&#39;i4&#39;</span>).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1514</span>    i = nditer([<span class="keywordtype">None</span>, a], [], [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1515</span>                        op_dtypes=[np.dtype(<span class="stringliteral">&#39;u4&#39;</span>), <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 1516</span>                        op_axes=[[1, 2, 0], <span class="keywordtype">None</span>])</div>
<div class="line"><span class="lineno"> 1517</span>    assert_equal(i.operands[0].shape, (4, 2, 3))</div>
<div class="line"><span class="lineno"> 1518</span>    assert_equal(i.operands[0].strides, (4, 48, 16))</div>
<div class="line"><span class="lineno"> 1519</span>    assert_equal(i.operands[0].dtype, np.dtype(<span class="stringliteral">&#39;u4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1520</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a249cad103012ab20c2bc599a2b923b2b" name="a249cad103012ab20c2bc599a2b923b2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a249cad103012ab20c2bc599a2b923b2b">&#9670;&#160;</a></span>test_iter_allocate_output_simple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_simple </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1460</span><span class="keyword">def </span>test_iter_allocate_output_simple():</div>
<div class="line"><span class="lineno"> 1461</span>    <span class="comment"># Check that the iterator will properly allocate outputs</span></div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span>    <span class="comment"># Simple case</span></div>
<div class="line"><span class="lineno"> 1464</span>    a = arange(6)</div>
<div class="line"><span class="lineno"> 1465</span>    i = nditer([a, <span class="keywordtype">None</span>], [], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1466</span>                        op_dtypes=[<span class="keywordtype">None</span>, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1467</span>    assert_equal(i.operands[1].shape, a.shape)</div>
<div class="line"><span class="lineno"> 1468</span>    assert_equal(i.operands[1].dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1469</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acafc89590f208cd2d8fd15f6eace3663" name="acafc89590f208cd2d8fd15f6eace3663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acafc89590f208cd2d8fd15f6eace3663">&#9670;&#160;</a></span>test_iter_allocate_output_subtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_subtype </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1562</span><span class="keyword">def </span>test_iter_allocate_output_subtype():</div>
<div class="line"><span class="lineno"> 1563</span>    <span class="comment"># Make sure that the subtype with priority wins</span></div>
<div class="line"><span class="lineno"> 1564</span>    <span class="keyword">class </span>MyNDArray(np.ndarray):</div>
<div class="line"><span class="lineno"> 1565</span>        __array_priority__ = 15</div>
<div class="line"><span class="lineno"> 1566</span> </div>
<div class="line"><span class="lineno"> 1567</span>    <span class="comment"># subclass vs ndarray</span></div>
<div class="line"><span class="lineno"> 1568</span>    a = np.array([[1, 2], [3, 4]]).view(MyNDArray)</div>
<div class="line"><span class="lineno"> 1569</span>    b = np.arange(4).reshape(2, 2).T</div>
<div class="line"><span class="lineno"> 1570</span>    i = nditer([a, b, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1571</span>               [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1572</span>    assert_equal(type(a), type(i.operands[2]))</div>
<div class="line"><span class="lineno"> 1573</span>    assert_(type(b) <span class="keywordflow">is</span> <span class="keywordflow">not</span> type(i.operands[2]))</div>
<div class="line"><span class="lineno"> 1574</span>    assert_equal(i.operands[2].shape, (2, 2))</div>
<div class="line"><span class="lineno"> 1575</span> </div>
<div class="line"><span class="lineno"> 1576</span>    <span class="comment"># If subtypes are disabled, we should get back an ndarray.</span></div>
<div class="line"><span class="lineno"> 1577</span>    i = nditer([a, b, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1578</span>               [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 1579</span>                [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>, <span class="stringliteral">&#39;no_subtype&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1580</span>    assert_equal(type(b), type(i.operands[2]))</div>
<div class="line"><span class="lineno"> 1581</span>    assert_(type(a) <span class="keywordflow">is</span> <span class="keywordflow">not</span> type(i.operands[2]))</div>
<div class="line"><span class="lineno"> 1582</span>    assert_equal(i.operands[2].shape, (2, 2))</div>
<div class="line"><span class="lineno"> 1583</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a22f923afc6e20035f3eef7822bb4836a" name="a22f923afc6e20035f3eef7822bb4836a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22f923afc6e20035f3eef7822bb4836a">&#9670;&#160;</a></span>test_iter_allocate_output_types_byte_order()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_types_byte_order </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1540</span><span class="keyword">def </span>test_iter_allocate_output_types_byte_order():</div>
<div class="line"><span class="lineno"> 1541</span>    <span class="comment"># Verify the rules for byte order changes</span></div>
<div class="line"><span class="lineno"> 1542</span> </div>
<div class="line"><span class="lineno"> 1543</span>    <span class="comment"># When there&#39;s just one input, the output type exactly matches</span></div>
<div class="line"><span class="lineno"> 1544</span>    a = array([3], dtype=<span class="stringliteral">&#39;u4&#39;</span>).newbyteorder()</div>
<div class="line"><span class="lineno"> 1545</span>    i = nditer([a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1546</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1547</span>    assert_equal(i.dtypes[0], i.dtypes[1])</div>
<div class="line"><span class="lineno"> 1548</span>    <span class="comment"># With two or more inputs, the output type is in native byte order</span></div>
<div class="line"><span class="lineno"> 1549</span>    i = nditer([a, a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1550</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1551</span>    assert_(i.dtypes[0] != i.dtypes[2])</div>
<div class="line"><span class="lineno"> 1552</span>    assert_equal(i.dtypes[0].newbyteorder(<span class="stringliteral">&#39;=&#39;</span>), i.dtypes[2])</div>
<div class="line"><span class="lineno"> 1553</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adc6410b97ef2805c0013cc5089fae698" name="adc6410b97ef2805c0013cc5089fae698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc6410b97ef2805c0013cc5089fae698">&#9670;&#160;</a></span>test_iter_allocate_output_types_promotion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_types_promotion </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1521</span><span class="keyword">def </span>test_iter_allocate_output_types_promotion():</div>
<div class="line"><span class="lineno"> 1522</span>    <span class="comment"># Check type promotion of automatic outputs</span></div>
<div class="line"><span class="lineno"> 1523</span> </div>
<div class="line"><span class="lineno"> 1524</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;f4&#39;</span>), array([0], dtype=<span class="stringliteral">&#39;f8&#39;</span>), <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1525</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2+[[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1526</span>    assert_equal(i.dtypes[2], np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1527</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;i4&#39;</span>), array([0], dtype=<span class="stringliteral">&#39;f4&#39;</span>), <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1528</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2+[[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1529</span>    assert_equal(i.dtypes[2], np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1530</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;f4&#39;</span>), array(0, dtype=<span class="stringliteral">&#39;f8&#39;</span>), <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1531</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2+[[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1532</span>    assert_equal(i.dtypes[2], np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1533</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;u4&#39;</span>), array(0, dtype=<span class="stringliteral">&#39;i4&#39;</span>), <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1534</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2+[[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1535</span>    assert_equal(i.dtypes[2], np.dtype(<span class="stringliteral">&#39;u4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1536</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;u4&#39;</span>), array(-12, dtype=<span class="stringliteral">&#39;i4&#39;</span>), <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 1537</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2+[[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1538</span>    assert_equal(i.dtypes[2], np.dtype(<span class="stringliteral">&#39;i8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1539</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab34db805f08b9be4a7a5608a116fae2d" name="ab34db805f08b9be4a7a5608a116fae2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab34db805f08b9be4a7a5608a116fae2d">&#9670;&#160;</a></span>test_iter_allocate_output_types_scalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocate_output_types_scalar </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1554</span><span class="keyword">def </span>test_iter_allocate_output_types_scalar():</div>
<div class="line"><span class="lineno"> 1555</span>    <span class="comment"># If the inputs are all scalars, the output should be a scalar</span></div>
<div class="line"><span class="lineno"> 1556</span> </div>
<div class="line"><span class="lineno"> 1557</span>    i = nditer([<span class="keywordtype">None</span>, 1, 2.3, np.float32(12), np.complex128(3)], [],</div>
<div class="line"><span class="lineno"> 1558</span>                [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]] + [[<span class="stringliteral">&#39;readonly&#39;</span>]]*4)</div>
<div class="line"><span class="lineno"> 1559</span>    assert_equal(i.operands[0].dtype, np.dtype(<span class="stringliteral">&#39;complex128&#39;</span>))</div>
<div class="line"><span class="lineno"> 1560</span>    assert_equal(i.operands[0].ndim, 0)</div>
<div class="line"><span class="lineno"> 1561</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a559a79791cb65fba542e5a412f156593" name="a559a79791cb65fba542e5a412f156593"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a559a79791cb65fba542e5a412f156593">&#9670;&#160;</a></span>test_iter_allocated_array_dtypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_allocated_array_dtypes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2904</span><span class="keyword">def </span>test_iter_allocated_array_dtypes():</div>
<div class="line"><span class="lineno"> 2905</span>    <span class="comment"># If the dtype of an allocated output has a shape, the shape gets</span></div>
<div class="line"><span class="lineno"> 2906</span>    <span class="comment"># tacked onto the end of the result.</span></div>
<div class="line"><span class="lineno"> 2907</span>    it = np.nditer(([1, 3, 20], <span class="keywordtype">None</span>), op_dtypes=[<span class="keywordtype">None</span>, (<span class="stringliteral">&#39;i4&#39;</span>, (2,))])</div>
<div class="line"><span class="lineno"> 2908</span>    <span class="keywordflow">for</span> a, b <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 2909</span>        b[0] = a - 1</div>
<div class="line"><span class="lineno"> 2910</span>        b[1] = a + 1</div>
<div class="line"><span class="lineno"> 2911</span>    assert_equal(it.operands[1], [[0, 2], [2, 4], [19, 21]])</div>
<div class="line"><span class="lineno"> 2912</span> </div>
<div class="line"><span class="lineno"> 2913</span>    <span class="comment"># Check the same (less sensitive) thing when `op_axes` with -1 is given.</span></div>
<div class="line"><span class="lineno"> 2914</span>    it = np.nditer(([[1, 3, 20]], <span class="keywordtype">None</span>), op_dtypes=[<span class="keywordtype">None</span>, (<span class="stringliteral">&#39;i4&#39;</span>, (2,))],</div>
<div class="line"><span class="lineno"> 2915</span>                   flags=[<span class="stringliteral">&quot;reduce_ok&quot;</span>], op_axes=[<span class="keywordtype">None</span>, (-1, 0)])</div>
<div class="line"><span class="lineno"> 2916</span>    <span class="keywordflow">for</span> a, b <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 2917</span>        b[0] = a - 1</div>
<div class="line"><span class="lineno"> 2918</span>        b[1] = a + 1</div>
<div class="line"><span class="lineno"> 2919</span>    assert_equal(it.operands[1], [[0, 2], [2, 4], [19, 21]])</div>
<div class="line"><span class="lineno"> 2920</span> </div>
<div class="line"><span class="lineno"> 2921</span>    <span class="comment"># Make sure this works for scalars too</span></div>
<div class="line"><span class="lineno"> 2922</span>    it = np.nditer((10, 2, <span class="keywordtype">None</span>), op_dtypes=[<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, (<span class="stringliteral">&#39;i4&#39;</span>, (2, 2))])</div>
<div class="line"><span class="lineno"> 2923</span>    <span class="keywordflow">for</span> a, b, c <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 2924</span>        c[0, 0] = a - b</div>
<div class="line"><span class="lineno"> 2925</span>        c[0, 1] = a + b</div>
<div class="line"><span class="lineno"> 2926</span>        c[1, 0] = a * b</div>
<div class="line"><span class="lineno"> 2927</span>        c[1, 1] = a / b</div>
<div class="line"><span class="lineno"> 2928</span>    assert_equal(it.operands[2], [[8, 12], [20, 5]])</div>
<div class="line"><span class="lineno"> 2929</span> </div>
<div class="line"><span class="lineno"> 2930</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c727c627983d5397e37ead424f31fe8" name="a3c727c627983d5397e37ead424f31fe8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c727c627983d5397e37ead424f31fe8">&#9670;&#160;</a></span>test_iter_array_cast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_array_cast </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  882</span><span class="keyword">def </span>test_iter_array_cast():</div>
<div class="line"><span class="lineno">  883</span>    <span class="comment"># Check that arrays are cast as requested</span></div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>    <span class="comment"># No cast &#39;f4&#39; -&gt; &#39;f4&#39;</span></div>
<div class="line"><span class="lineno">  886</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;f4&#39;</span>).reshape(2, 3)</div>
<div class="line"><span class="lineno">  887</span>    i = nditer(a, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>]], op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  888</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno">  889</span>        assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  890</span>        assert_equal(i.operands[0].dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>    <span class="comment"># Byte-order cast &#39;&lt;f4&#39; -&gt; &#39;&gt;f4&#39;</span></div>
<div class="line"><span class="lineno">  893</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;&lt;f4&#39;</span>).reshape(2, 3)</div>
<div class="line"><span class="lineno">  894</span>    <span class="keyword">with</span> nditer(a, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  895</span>            casting=<span class="stringliteral">&#39;equiv&#39;</span>,</div>
<div class="line"><span class="lineno">  896</span>            op_dtypes=[np.dtype(<span class="stringliteral">&#39;&gt;f4&#39;</span>)]) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno">  897</span>        assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  898</span>        assert_equal(i.operands[0].dtype, np.dtype(<span class="stringliteral">&#39;&gt;f4&#39;</span>))</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>    <span class="comment"># Safe case &#39;f4&#39; -&gt; &#39;f8&#39;</span></div>
<div class="line"><span class="lineno">  901</span>    a = np.arange(24, dtype=<span class="stringliteral">&#39;f4&#39;</span>).reshape(2, 3, 4).swapaxes(1, 2)</div>
<div class="line"><span class="lineno">  902</span>    i = nditer(a, [], [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]],</div>
<div class="line"><span class="lineno">  903</span>            casting=<span class="stringliteral">&#39;safe&#39;</span>,</div>
<div class="line"><span class="lineno">  904</span>            op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno">  905</span>    assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  906</span>    assert_equal(i.operands[0].dtype, np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno">  907</span>    <span class="comment"># The memory layout of the temporary should match a (a is (48,4,16))</span></div>
<div class="line"><span class="lineno">  908</span>    <span class="comment"># except negative strides get flipped to positive strides.</span></div>
<div class="line"><span class="lineno">  909</span>    assert_equal(i.operands[0].strides, (96, 8, 32))</div>
<div class="line"><span class="lineno">  910</span>    a = a[::-1,:, ::-1]</div>
<div class="line"><span class="lineno">  911</span>    i = nditer(a, [], [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]],</div>
<div class="line"><span class="lineno">  912</span>            casting=<span class="stringliteral">&#39;safe&#39;</span>,</div>
<div class="line"><span class="lineno">  913</span>            op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno">  914</span>    assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  915</span>    assert_equal(i.operands[0].dtype, np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno">  916</span>    assert_equal(i.operands[0].strides, (96, 8, 32))</div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>    <span class="comment"># Same-kind cast &#39;f8&#39; -&gt; &#39;f4&#39; -&gt; &#39;f8&#39;</span></div>
<div class="line"><span class="lineno">  919</span>    a = np.arange(24, dtype=<span class="stringliteral">&#39;f8&#39;</span>).reshape(2, 3, 4).T</div>
<div class="line"><span class="lineno">  920</span>    <span class="keyword">with</span> nditer(a, [],</div>
<div class="line"><span class="lineno">  921</span>            [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  922</span>            casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno">  923</span>            op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)]) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno">  924</span>        assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  925</span>        assert_equal(i.operands[0].dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno">  926</span>        assert_equal(i.operands[0].strides, (4, 16, 48))</div>
<div class="line"><span class="lineno">  927</span>        <span class="comment"># Check that WRITEBACKIFCOPY is activated at exit</span></div>
<div class="line"><span class="lineno">  928</span>        i.operands[0][2, 1, 1] = -12.5</div>
<div class="line"><span class="lineno">  929</span>        assert_(a[2, 1, 1] != -12.5)</div>
<div class="line"><span class="lineno">  930</span>    assert_equal(a[2, 1, 1], -12.5)</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;i4&#39;</span>)[::-2]</div>
<div class="line"><span class="lineno">  933</span>    <span class="keyword">with</span> nditer(a, [],</div>
<div class="line"><span class="lineno">  934</span>            [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  935</span>            casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno">  936</span>            op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)]) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno">  937</span>        assert_equal(i.operands[0].dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno">  938</span>        <span class="comment"># Even though the stride was negative in &#39;a&#39;, it</span></div>
<div class="line"><span class="lineno">  939</span>        <span class="comment"># becomes positive in the temporary</span></div>
<div class="line"><span class="lineno">  940</span>        assert_equal(i.operands[0].strides, (4,))</div>
<div class="line"><span class="lineno">  941</span>        i.operands[0][:] = [1, 2, 3]</div>
<div class="line"><span class="lineno">  942</span>    assert_equal(a, [1, 2, 3])</div>
<div class="line"><span class="lineno">  943</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac89032b20c2d0185d989ebf6ed428b4a" name="ac89032b20c2d0185d989ebf6ed428b4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac89032b20c2d0185d989ebf6ed428b4a">&#9670;&#160;</a></span>test_iter_array_cast_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_array_cast_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  944</span><span class="keyword">def </span>test_iter_array_cast_errors():</div>
<div class="line"><span class="lineno">  945</span>    <span class="comment"># Check that invalid casts are caught</span></div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>    <span class="comment"># Need to enable copying for casts to occur</span></div>
<div class="line"><span class="lineno">  948</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;f4&#39;</span>), [],</div>
<div class="line"><span class="lineno">  949</span>                [[<span class="stringliteral">&#39;readonly&#39;</span>]], op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno">  950</span>    <span class="comment"># Also need to allow casting for casts to occur</span></div>
<div class="line"><span class="lineno">  951</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;f4&#39;</span>), [],</div>
<div class="line"><span class="lineno">  952</span>                [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]], casting=<span class="stringliteral">&#39;no&#39;</span>,</div>
<div class="line"><span class="lineno">  953</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno">  954</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;f4&#39;</span>), [],</div>
<div class="line"><span class="lineno">  955</span>                [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]], casting=<span class="stringliteral">&#39;equiv&#39;</span>,</div>
<div class="line"><span class="lineno">  956</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno">  957</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;f8&#39;</span>), [],</div>
<div class="line"><span class="lineno">  958</span>                [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  959</span>                casting=<span class="stringliteral">&#39;no&#39;</span>,</div>
<div class="line"><span class="lineno">  960</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  961</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;f8&#39;</span>), [],</div>
<div class="line"><span class="lineno">  962</span>                [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  963</span>                casting=<span class="stringliteral">&#39;equiv&#39;</span>,</div>
<div class="line"><span class="lineno">  964</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  965</span>    <span class="comment"># &#39;&lt;f4&#39; -&gt; &#39;&gt;f4&#39; should not work with casting=&#39;no&#39;</span></div>
<div class="line"><span class="lineno">  966</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;&lt;f4&#39;</span>), [],</div>
<div class="line"><span class="lineno">  967</span>                [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]], casting=<span class="stringliteral">&#39;no&#39;</span>,</div>
<div class="line"><span class="lineno">  968</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;&gt;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  969</span>    <span class="comment"># &#39;f4&#39; -&gt; &#39;f8&#39; is a safe cast, but &#39;f8&#39; -&gt; &#39;f4&#39; isn&#39;t</span></div>
<div class="line"><span class="lineno">  970</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;f4&#39;</span>), [],</div>
<div class="line"><span class="lineno">  971</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  972</span>                casting=<span class="stringliteral">&#39;safe&#39;</span>,</div>
<div class="line"><span class="lineno">  973</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno">  974</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;f8&#39;</span>), [],</div>
<div class="line"><span class="lineno">  975</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  976</span>                casting=<span class="stringliteral">&#39;safe&#39;</span>,</div>
<div class="line"><span class="lineno">  977</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  978</span>    <span class="comment"># &#39;f4&#39; -&gt; &#39;i4&#39; is neither a safe nor a same-kind cast</span></div>
<div class="line"><span class="lineno">  979</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;f4&#39;</span>), [],</div>
<div class="line"><span class="lineno">  980</span>                [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]],</div>
<div class="line"><span class="lineno">  981</span>                casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno">  982</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;i4&#39;</span>)])</div>
<div class="line"><span class="lineno">  983</span>    assert_raises(TypeError, nditer, arange(2, dtype=<span class="stringliteral">&#39;i4&#39;</span>), [],</div>
<div class="line"><span class="lineno">  984</span>                [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  985</span>                casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno">  986</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  987</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aef1edca25fcdef89f0ebe3a591ed822b" name="aef1edca25fcdef89f0ebe3a591ed822b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef1edca25fcdef89f0ebe3a591ed822b">&#9670;&#160;</a></span>test_iter_assign_mapping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_assign_mapping </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  801</span><span class="keyword">def </span>test_iter_assign_mapping():</div>
<div class="line"><span class="lineno">  802</span>    a = np.arange(24, dtype=<span class="stringliteral">&#39;f8&#39;</span>).reshape(2, 3, 4).T</div>
<div class="line"><span class="lineno">  803</span>    it = np.nditer(a, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  804</span>                       casting=<span class="stringliteral">&#39;same_kind&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  805</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno">  806</span>        it.operands[0][...] = 3</div>
<div class="line"><span class="lineno">  807</span>        it.operands[0][...] = 14</div>
<div class="line"><span class="lineno">  808</span>    assert_equal(a, 14)</div>
<div class="line"><span class="lineno">  809</span>    it = np.nditer(a, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  810</span>                       casting=<span class="stringliteral">&#39;same_kind&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  811</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno">  812</span>        x = it.operands[0][-1:1]</div>
<div class="line"><span class="lineno">  813</span>        x[...] = 14</div>
<div class="line"><span class="lineno">  814</span>        it.operands[0][...] = -1234</div>
<div class="line"><span class="lineno">  815</span>    assert_equal(a, -1234)</div>
<div class="line"><span class="lineno">  816</span>    <span class="comment"># check for no warnings on dealloc</span></div>
<div class="line"><span class="lineno">  817</span>    x = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  818</span>    it = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  819</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a58e946bda93c234c62e7957de80096ad" name="a58e946bda93c234c62e7957de80096ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58e946bda93c234c62e7957de80096ad">&#9670;&#160;</a></span>test_iter_best_order()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   80</span><span class="keyword">def </span>test_iter_best_order():</div>
<div class="line"><span class="lineno">   81</span>    <span class="comment"># The iterator should always find the iteration order</span></div>
<div class="line"><span class="lineno">   82</span>    <span class="comment"># with increasing memory addresses</span></div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    <span class="comment"># Test the ordering for 1-D to 5-D shapes</span></div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">for</span> shape <span class="keywordflow">in</span> [(5,), (3, 4), (2, 3, 4), (2, 3, 4, 3), (2, 3, 2, 2, 3)]:</div>
<div class="line"><span class="lineno">   86</span>        a = arange(np.prod(shape))</div>
<div class="line"><span class="lineno">   87</span>        <span class="comment"># Test each combination of positive and negative strides</span></div>
<div class="line"><span class="lineno">   88</span>        <span class="keywordflow">for</span> dirs <span class="keywordflow">in</span> range(2**len(shape)):</div>
<div class="line"><span class="lineno">   89</span>            dirs_index = [slice(<span class="keywordtype">None</span>)]*len(shape)</div>
<div class="line"><span class="lineno">   90</span>            <span class="keywordflow">for</span> bit <span class="keywordflow">in</span> range(len(shape)):</div>
<div class="line"><span class="lineno">   91</span>                <span class="keywordflow">if</span> ((2**bit) &amp; dirs):</div>
<div class="line"><span class="lineno">   92</span>                    dirs_index[bit] = slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)</div>
<div class="line"><span class="lineno">   93</span>            dirs_index = tuple(dirs_index)</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>            aview = a.reshape(shape)[dirs_index]</div>
<div class="line"><span class="lineno">   96</span>            <span class="comment"># C-order</span></div>
<div class="line"><span class="lineno">   97</span>            i = nditer(aview, [], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">   98</span>            assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a)</div>
<div class="line"><span class="lineno">   99</span>            <span class="comment"># Fortran-order</span></div>
<div class="line"><span class="lineno">  100</span>            i = nditer(aview.T, [], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  101</span>            assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a)</div>
<div class="line"><span class="lineno">  102</span>            <span class="comment"># Other order</span></div>
<div class="line"><span class="lineno">  103</span>            <span class="keywordflow">if</span> len(shape) &gt; 2:</div>
<div class="line"><span class="lineno">  104</span>                i = nditer(aview.swapaxes(0, 1), [], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  105</span>                assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a)</div>
<div class="line"><span class="lineno">  106</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e71d5b5558250ac44174f6b45c717be" name="a2e71d5b5558250ac44174f6b45c717be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e71d5b5558250ac44174f6b45c717be">&#9670;&#160;</a></span>test_iter_best_order_c_index_1d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_c_index_1d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  293</span><span class="keyword">def </span>test_iter_best_order_c_index_1d():</div>
<div class="line"><span class="lineno">  294</span>    <span class="comment"># The C index should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    a = arange(4)</div>
<div class="line"><span class="lineno">  297</span>    <span class="comment"># 1D order</span></div>
<div class="line"><span class="lineno">  298</span>    i = nditer(a, [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  299</span>    assert_equal(iter_indices(i), [0, 1, 2, 3])</div>
<div class="line"><span class="lineno">  300</span>    <span class="comment"># 1D reversed order</span></div>
<div class="line"><span class="lineno">  301</span>    i = nditer(a[::-1], [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  302</span>    assert_equal(iter_indices(i), [3, 2, 1, 0])</div>
<div class="line"><span class="lineno">  303</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad34a113cec31263ae6fa140eaa1974b6" name="ad34a113cec31263ae6fa140eaa1974b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad34a113cec31263ae6fa140eaa1974b6">&#9670;&#160;</a></span>test_iter_best_order_c_index_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_c_index_2d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  304</span><span class="keyword">def </span>test_iter_best_order_c_index_2d():</div>
<div class="line"><span class="lineno">  305</span>    <span class="comment"># The C index should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    a = arange(6)</div>
<div class="line"><span class="lineno">  308</span>    <span class="comment"># 2D C-order</span></div>
<div class="line"><span class="lineno">  309</span>    i = nditer(a.reshape(2, 3), [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  310</span>    assert_equal(iter_indices(i), [0, 1, 2, 3, 4, 5])</div>
<div class="line"><span class="lineno">  311</span>    <span class="comment"># 2D Fortran-order</span></div>
<div class="line"><span class="lineno">  312</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>),</div>
<div class="line"><span class="lineno">  313</span>                                    [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  314</span>    assert_equal(iter_indices(i), [0, 3, 1, 4, 2, 5])</div>
<div class="line"><span class="lineno">  315</span>    <span class="comment"># 2D reversed C-order</span></div>
<div class="line"><span class="lineno">  316</span>    i = nditer(a.reshape(2, 3)[::-1], [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  317</span>    assert_equal(iter_indices(i), [3, 4, 5, 0, 1, 2])</div>
<div class="line"><span class="lineno">  318</span>    i = nditer(a.reshape(2, 3)[:, ::-1], [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  319</span>    assert_equal(iter_indices(i), [2, 1, 0, 5, 4, 3])</div>
<div class="line"><span class="lineno">  320</span>    i = nditer(a.reshape(2, 3)[::-1, ::-1], [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  321</span>    assert_equal(iter_indices(i), [5, 4, 3, 2, 1, 0])</div>
<div class="line"><span class="lineno">  322</span>    <span class="comment"># 2D reversed Fortran-order</span></div>
<div class="line"><span class="lineno">  323</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1],</div>
<div class="line"><span class="lineno">  324</span>                                    [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  325</span>    assert_equal(iter_indices(i), [3, 0, 4, 1, 5, 2])</div>
<div class="line"><span class="lineno">  326</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:, ::-1],</div>
<div class="line"><span class="lineno">  327</span>                                    [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  328</span>    assert_equal(iter_indices(i), [2, 5, 1, 4, 0, 3])</div>
<div class="line"><span class="lineno">  329</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1, ::-1],</div>
<div class="line"><span class="lineno">  330</span>                                    [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  331</span>    assert_equal(iter_indices(i), [5, 2, 4, 1, 3, 0])</div>
<div class="line"><span class="lineno">  332</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a386cc9002f8a76310dfdad225751dd1d" name="a386cc9002f8a76310dfdad225751dd1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a386cc9002f8a76310dfdad225751dd1d">&#9670;&#160;</a></span>test_iter_best_order_c_index_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_c_index_3d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  333</span><span class="keyword">def </span>test_iter_best_order_c_index_3d():</div>
<div class="line"><span class="lineno">  334</span>    <span class="comment"># The C index should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    a = arange(12)</div>
<div class="line"><span class="lineno">  337</span>    <span class="comment"># 3D C-order</span></div>
<div class="line"><span class="lineno">  338</span>    i = nditer(a.reshape(2, 3, 2), [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  339</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  340</span>                            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11])</div>
<div class="line"><span class="lineno">  341</span>    <span class="comment"># 3D Fortran-order</span></div>
<div class="line"><span class="lineno">  342</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>),</div>
<div class="line"><span class="lineno">  343</span>                                    [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  344</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  345</span>                            [0, 6, 2, 8, 4, 10, 1, 7, 3, 9, 5, 11])</div>
<div class="line"><span class="lineno">  346</span>    <span class="comment"># 3D reversed C-order</span></div>
<div class="line"><span class="lineno">  347</span>    i = nditer(a.reshape(2, 3, 2)[::-1], [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  348</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  349</span>                            [6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5])</div>
<div class="line"><span class="lineno">  350</span>    i = nditer(a.reshape(2, 3, 2)[:, ::-1], [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  351</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  352</span>                            [4, 5, 2, 3, 0, 1, 10, 11, 8, 9, 6, 7])</div>
<div class="line"><span class="lineno">  353</span>    i = nditer(a.reshape(2, 3, 2)[:,:, ::-1], [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  354</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  355</span>                            [1, 0, 3, 2, 5, 4, 7, 6, 9, 8, 11, 10])</div>
<div class="line"><span class="lineno">  356</span>    <span class="comment"># 3D reversed Fortran-order</span></div>
<div class="line"><span class="lineno">  357</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1],</div>
<div class="line"><span class="lineno">  358</span>                                    [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  359</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  360</span>                            [6, 0, 8, 2, 10, 4, 7, 1, 9, 3, 11, 5])</div>
<div class="line"><span class="lineno">  361</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:, ::-1],</div>
<div class="line"><span class="lineno">  362</span>                                    [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  363</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  364</span>                            [4, 10, 2, 8, 0, 6, 5, 11, 3, 9, 1, 7])</div>
<div class="line"><span class="lineno">  365</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:,:, ::-1],</div>
<div class="line"><span class="lineno">  366</span>                                    [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  367</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  368</span>                            [1, 7, 3, 9, 5, 11, 0, 6, 2, 8, 4, 10])</div>
<div class="line"><span class="lineno">  369</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a11745a26a36bf96fee89aad5b0d8ff8a" name="a11745a26a36bf96fee89aad5b0d8ff8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11745a26a36bf96fee89aad5b0d8ff8a">&#9670;&#160;</a></span>test_iter_best_order_f_index_1d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_f_index_1d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  370</span><span class="keyword">def </span>test_iter_best_order_f_index_1d():</div>
<div class="line"><span class="lineno">  371</span>    <span class="comment"># The Fortran index should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    a = arange(4)</div>
<div class="line"><span class="lineno">  374</span>    <span class="comment"># 1D order</span></div>
<div class="line"><span class="lineno">  375</span>    i = nditer(a, [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  376</span>    assert_equal(iter_indices(i), [0, 1, 2, 3])</div>
<div class="line"><span class="lineno">  377</span>    <span class="comment"># 1D reversed order</span></div>
<div class="line"><span class="lineno">  378</span>    i = nditer(a[::-1], [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  379</span>    assert_equal(iter_indices(i), [3, 2, 1, 0])</div>
<div class="line"><span class="lineno">  380</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4d64b55781533e3cd992f7b9c4f42d64" name="a4d64b55781533e3cd992f7b9c4f42d64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d64b55781533e3cd992f7b9c4f42d64">&#9670;&#160;</a></span>test_iter_best_order_f_index_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_f_index_2d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  381</span><span class="keyword">def </span>test_iter_best_order_f_index_2d():</div>
<div class="line"><span class="lineno">  382</span>    <span class="comment"># The Fortran index should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>    a = arange(6)</div>
<div class="line"><span class="lineno">  385</span>    <span class="comment"># 2D C-order</span></div>
<div class="line"><span class="lineno">  386</span>    i = nditer(a.reshape(2, 3), [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  387</span>    assert_equal(iter_indices(i), [0, 2, 4, 1, 3, 5])</div>
<div class="line"><span class="lineno">  388</span>    <span class="comment"># 2D Fortran-order</span></div>
<div class="line"><span class="lineno">  389</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>),</div>
<div class="line"><span class="lineno">  390</span>                                    [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  391</span>    assert_equal(iter_indices(i), [0, 1, 2, 3, 4, 5])</div>
<div class="line"><span class="lineno">  392</span>    <span class="comment"># 2D reversed C-order</span></div>
<div class="line"><span class="lineno">  393</span>    i = nditer(a.reshape(2, 3)[::-1], [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  394</span>    assert_equal(iter_indices(i), [1, 3, 5, 0, 2, 4])</div>
<div class="line"><span class="lineno">  395</span>    i = nditer(a.reshape(2, 3)[:, ::-1], [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  396</span>    assert_equal(iter_indices(i), [4, 2, 0, 5, 3, 1])</div>
<div class="line"><span class="lineno">  397</span>    i = nditer(a.reshape(2, 3)[::-1, ::-1], [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  398</span>    assert_equal(iter_indices(i), [5, 3, 1, 4, 2, 0])</div>
<div class="line"><span class="lineno">  399</span>    <span class="comment"># 2D reversed Fortran-order</span></div>
<div class="line"><span class="lineno">  400</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1],</div>
<div class="line"><span class="lineno">  401</span>                                    [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  402</span>    assert_equal(iter_indices(i), [1, 0, 3, 2, 5, 4])</div>
<div class="line"><span class="lineno">  403</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:, ::-1],</div>
<div class="line"><span class="lineno">  404</span>                                    [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  405</span>    assert_equal(iter_indices(i), [4, 5, 2, 3, 0, 1])</div>
<div class="line"><span class="lineno">  406</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1, ::-1],</div>
<div class="line"><span class="lineno">  407</span>                                    [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  408</span>    assert_equal(iter_indices(i), [5, 4, 3, 2, 1, 0])</div>
<div class="line"><span class="lineno">  409</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a234dc9b8919a815cfe032266332370b3" name="a234dc9b8919a815cfe032266332370b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a234dc9b8919a815cfe032266332370b3">&#9670;&#160;</a></span>test_iter_best_order_f_index_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_f_index_3d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  410</span><span class="keyword">def </span>test_iter_best_order_f_index_3d():</div>
<div class="line"><span class="lineno">  411</span>    <span class="comment"># The Fortran index should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    a = arange(12)</div>
<div class="line"><span class="lineno">  414</span>    <span class="comment"># 3D C-order</span></div>
<div class="line"><span class="lineno">  415</span>    i = nditer(a.reshape(2, 3, 2), [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  416</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  417</span>                            [0, 6, 2, 8, 4, 10, 1, 7, 3, 9, 5, 11])</div>
<div class="line"><span class="lineno">  418</span>    <span class="comment"># 3D Fortran-order</span></div>
<div class="line"><span class="lineno">  419</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>),</div>
<div class="line"><span class="lineno">  420</span>                                    [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  421</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  422</span>                            [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11])</div>
<div class="line"><span class="lineno">  423</span>    <span class="comment"># 3D reversed C-order</span></div>
<div class="line"><span class="lineno">  424</span>    i = nditer(a.reshape(2, 3, 2)[::-1], [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  425</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  426</span>                            [1, 7, 3, 9, 5, 11, 0, 6, 2, 8, 4, 10])</div>
<div class="line"><span class="lineno">  427</span>    i = nditer(a.reshape(2, 3, 2)[:, ::-1], [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  428</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  429</span>                            [4, 10, 2, 8, 0, 6, 5, 11, 3, 9, 1, 7])</div>
<div class="line"><span class="lineno">  430</span>    i = nditer(a.reshape(2, 3, 2)[:,:, ::-1], [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  431</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  432</span>                            [6, 0, 8, 2, 10, 4, 7, 1, 9, 3, 11, 5])</div>
<div class="line"><span class="lineno">  433</span>    <span class="comment"># 3D reversed Fortran-order</span></div>
<div class="line"><span class="lineno">  434</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1],</div>
<div class="line"><span class="lineno">  435</span>                                    [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  436</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  437</span>                            [1, 0, 3, 2, 5, 4, 7, 6, 9, 8, 11, 10])</div>
<div class="line"><span class="lineno">  438</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:, ::-1],</div>
<div class="line"><span class="lineno">  439</span>                                    [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  440</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  441</span>                            [4, 5, 2, 3, 0, 1, 10, 11, 8, 9, 6, 7])</div>
<div class="line"><span class="lineno">  442</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:,:, ::-1],</div>
<div class="line"><span class="lineno">  443</span>                                    [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  444</span>    assert_equal(iter_indices(i),</div>
<div class="line"><span class="lineno">  445</span>                            [6, 7, 8, 9, 10, 11, 0, 1, 2, 3, 4, 5])</div>
<div class="line"><span class="lineno">  446</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a719f4907ba6556cc71a0d497e15ebc1b" name="a719f4907ba6556cc71a0d497e15ebc1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a719f4907ba6556cc71a0d497e15ebc1b">&#9670;&#160;</a></span>test_iter_best_order_multi_index_1d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_multi_index_1d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  211</span><span class="keyword">def </span>test_iter_best_order_multi_index_1d():</div>
<div class="line"><span class="lineno">  212</span>    <span class="comment"># The multi-indices should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    a = arange(4)</div>
<div class="line"><span class="lineno">  215</span>    <span class="comment"># 1D order</span></div>
<div class="line"><span class="lineno">  216</span>    i = nditer(a, [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  217</span>    assert_equal(iter_multi_index(i), [(0,), (1,), (2,), (3,)])</div>
<div class="line"><span class="lineno">  218</span>    <span class="comment"># 1D reversed order</span></div>
<div class="line"><span class="lineno">  219</span>    i = nditer(a[::-1], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  220</span>    assert_equal(iter_multi_index(i), [(3,), (2,), (1,), (0,)])</div>
<div class="line"><span class="lineno">  221</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a01004062959a2e33d64318dcb6622a7c" name="a01004062959a2e33d64318dcb6622a7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01004062959a2e33d64318dcb6622a7c">&#9670;&#160;</a></span>test_iter_best_order_multi_index_2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_multi_index_2d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  222</span><span class="keyword">def </span>test_iter_best_order_multi_index_2d():</div>
<div class="line"><span class="lineno">  223</span>    <span class="comment"># The multi-indices should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    a = arange(6)</div>
<div class="line"><span class="lineno">  226</span>    <span class="comment"># 2D C-order</span></div>
<div class="line"><span class="lineno">  227</span>    i = nditer(a.reshape(2, 3), [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  228</span>    assert_equal(iter_multi_index(i), [(0, 0), (0, 1), (0, 2), (1, 0), (1, 1), (1, 2)])</div>
<div class="line"><span class="lineno">  229</span>    <span class="comment"># 2D Fortran-order</span></div>
<div class="line"><span class="lineno">  230</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>), [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  231</span>    assert_equal(iter_multi_index(i), [(0, 0), (1, 0), (0, 1), (1, 1), (0, 2), (1, 2)])</div>
<div class="line"><span class="lineno">  232</span>    <span class="comment"># 2D reversed C-order</span></div>
<div class="line"><span class="lineno">  233</span>    i = nditer(a.reshape(2, 3)[::-1], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  234</span>    assert_equal(iter_multi_index(i), [(1, 0), (1, 1), (1, 2), (0, 0), (0, 1), (0, 2)])</div>
<div class="line"><span class="lineno">  235</span>    i = nditer(a.reshape(2, 3)[:, ::-1], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  236</span>    assert_equal(iter_multi_index(i), [(0, 2), (0, 1), (0, 0), (1, 2), (1, 1), (1, 0)])</div>
<div class="line"><span class="lineno">  237</span>    i = nditer(a.reshape(2, 3)[::-1, ::-1], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  238</span>    assert_equal(iter_multi_index(i), [(1, 2), (1, 1), (1, 0), (0, 2), (0, 1), (0, 0)])</div>
<div class="line"><span class="lineno">  239</span>    <span class="comment"># 2D reversed Fortran-order</span></div>
<div class="line"><span class="lineno">  240</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  241</span>    assert_equal(iter_multi_index(i), [(1, 0), (0, 0), (1, 1), (0, 1), (1, 2), (0, 2)])</div>
<div class="line"><span class="lineno">  242</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:, ::-1],</div>
<div class="line"><span class="lineno">  243</span>                                                   [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  244</span>    assert_equal(iter_multi_index(i), [(0, 2), (1, 2), (0, 1), (1, 1), (0, 0), (1, 0)])</div>
<div class="line"><span class="lineno">  245</span>    i = nditer(a.reshape(2, 3).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1, ::-1],</div>
<div class="line"><span class="lineno">  246</span>                                                   [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  247</span>    assert_equal(iter_multi_index(i), [(1, 2), (0, 2), (1, 1), (0, 1), (1, 0), (0, 0)])</div>
<div class="line"><span class="lineno">  248</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b58639676c388062b088478c2880725" name="a3b58639676c388062b088478c2880725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b58639676c388062b088478c2880725">&#9670;&#160;</a></span>test_iter_best_order_multi_index_3d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_best_order_multi_index_3d </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  249</span><span class="keyword">def </span>test_iter_best_order_multi_index_3d():</div>
<div class="line"><span class="lineno">  250</span>    <span class="comment"># The multi-indices should be correct with any reordering</span></div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>    a = arange(12)</div>
<div class="line"><span class="lineno">  253</span>    <span class="comment"># 3D C-order</span></div>
<div class="line"><span class="lineno">  254</span>    i = nditer(a.reshape(2, 3, 2), [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  255</span>    assert_equal(iter_multi_index(i),</div>
<div class="line"><span class="lineno">  256</span>                            [(0, 0, 0), (0, 0, 1), (0, 1, 0), (0, 1, 1), (0, 2, 0), (0, 2, 1),</div>
<div class="line"><span class="lineno">  257</span>                             (1, 0, 0), (1, 0, 1), (1, 1, 0), (1, 1, 1), (1, 2, 0), (1, 2, 1)])</div>
<div class="line"><span class="lineno">  258</span>    <span class="comment"># 3D Fortran-order</span></div>
<div class="line"><span class="lineno">  259</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>), [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  260</span>    assert_equal(iter_multi_index(i),</div>
<div class="line"><span class="lineno">  261</span>                            [(0, 0, 0), (1, 0, 0), (0, 1, 0), (1, 1, 0), (0, 2, 0), (1, 2, 0),</div>
<div class="line"><span class="lineno">  262</span>                             (0, 0, 1), (1, 0, 1), (0, 1, 1), (1, 1, 1), (0, 2, 1), (1, 2, 1)])</div>
<div class="line"><span class="lineno">  263</span>    <span class="comment"># 3D reversed C-order</span></div>
<div class="line"><span class="lineno">  264</span>    i = nditer(a.reshape(2, 3, 2)[::-1], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  265</span>    assert_equal(iter_multi_index(i),</div>
<div class="line"><span class="lineno">  266</span>                            [(1, 0, 0), (1, 0, 1), (1, 1, 0), (1, 1, 1), (1, 2, 0), (1, 2, 1),</div>
<div class="line"><span class="lineno">  267</span>                             (0, 0, 0), (0, 0, 1), (0, 1, 0), (0, 1, 1), (0, 2, 0), (0, 2, 1)])</div>
<div class="line"><span class="lineno">  268</span>    i = nditer(a.reshape(2, 3, 2)[:, ::-1], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  269</span>    assert_equal(iter_multi_index(i),</div>
<div class="line"><span class="lineno">  270</span>                            [(0, 2, 0), (0, 2, 1), (0, 1, 0), (0, 1, 1), (0, 0, 0), (0, 0, 1),</div>
<div class="line"><span class="lineno">  271</span>                             (1, 2, 0), (1, 2, 1), (1, 1, 0), (1, 1, 1), (1, 0, 0), (1, 0, 1)])</div>
<div class="line"><span class="lineno">  272</span>    i = nditer(a.reshape(2, 3, 2)[:,:, ::-1], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  273</span>    assert_equal(iter_multi_index(i),</div>
<div class="line"><span class="lineno">  274</span>                            [(0, 0, 1), (0, 0, 0), (0, 1, 1), (0, 1, 0), (0, 2, 1), (0, 2, 0),</div>
<div class="line"><span class="lineno">  275</span>                             (1, 0, 1), (1, 0, 0), (1, 1, 1), (1, 1, 0), (1, 2, 1), (1, 2, 0)])</div>
<div class="line"><span class="lineno">  276</span>    <span class="comment"># 3D reversed Fortran-order</span></div>
<div class="line"><span class="lineno">  277</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[::-1],</div>
<div class="line"><span class="lineno">  278</span>                                                    [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  279</span>    assert_equal(iter_multi_index(i),</div>
<div class="line"><span class="lineno">  280</span>                            [(1, 0, 0), (0, 0, 0), (1, 1, 0), (0, 1, 0), (1, 2, 0), (0, 2, 0),</div>
<div class="line"><span class="lineno">  281</span>                             (1, 0, 1), (0, 0, 1), (1, 1, 1), (0, 1, 1), (1, 2, 1), (0, 2, 1)])</div>
<div class="line"><span class="lineno">  282</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:, ::-1],</div>
<div class="line"><span class="lineno">  283</span>                                                    [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  284</span>    assert_equal(iter_multi_index(i),</div>
<div class="line"><span class="lineno">  285</span>                            [(0, 2, 0), (1, 2, 0), (0, 1, 0), (1, 1, 0), (0, 0, 0), (1, 0, 0),</div>
<div class="line"><span class="lineno">  286</span>                             (0, 2, 1), (1, 2, 1), (0, 1, 1), (1, 1, 1), (0, 0, 1), (1, 0, 1)])</div>
<div class="line"><span class="lineno">  287</span>    i = nditer(a.reshape(2, 3, 2).copy(order=<span class="stringliteral">&#39;F&#39;</span>)[:,:, ::-1],</div>
<div class="line"><span class="lineno">  288</span>                                                    [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  289</span>    assert_equal(iter_multi_index(i),</div>
<div class="line"><span class="lineno">  290</span>                            [(0, 0, 1), (1, 0, 1), (0, 1, 1), (1, 1, 1), (0, 2, 1), (1, 2, 1),</div>
<div class="line"><span class="lineno">  291</span>                             (0, 0, 0), (1, 0, 0), (0, 1, 0), (1, 1, 0), (0, 2, 0), (1, 2, 0)])</div>
<div class="line"><span class="lineno">  292</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aae94475d90288824b3c0dfcd3b46f761" name="aae94475d90288824b3c0dfcd3b46f761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae94475d90288824b3c0dfcd3b46f761">&#9670;&#160;</a></span>test_iter_broadcasting()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_broadcasting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  537</span><span class="keyword">def </span>test_iter_broadcasting():</div>
<div class="line"><span class="lineno">  538</span>    <span class="comment"># Standard NumPy broadcasting rules</span></div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>    <span class="comment"># 1D with scalar</span></div>
<div class="line"><span class="lineno">  541</span>    i = nditer([arange(6), np.int32(2)], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  542</span>    assert_equal(i.itersize, 6)</div>
<div class="line"><span class="lineno">  543</span>    assert_equal(i.shape, (6,))</div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>    <span class="comment"># 2D with scalar</span></div>
<div class="line"><span class="lineno">  546</span>    i = nditer([arange(6).reshape(2, 3), np.int32(2)],</div>
<div class="line"><span class="lineno">  547</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  548</span>    assert_equal(i.itersize, 6)</div>
<div class="line"><span class="lineno">  549</span>    assert_equal(i.shape, (2, 3))</div>
<div class="line"><span class="lineno">  550</span>    <span class="comment"># 2D with 1D</span></div>
<div class="line"><span class="lineno">  551</span>    i = nditer([arange(6).reshape(2, 3), arange(3)],</div>
<div class="line"><span class="lineno">  552</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  553</span>    assert_equal(i.itersize, 6)</div>
<div class="line"><span class="lineno">  554</span>    assert_equal(i.shape, (2, 3))</div>
<div class="line"><span class="lineno">  555</span>    i = nditer([arange(2).reshape(2, 1), arange(3)],</div>
<div class="line"><span class="lineno">  556</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  557</span>    assert_equal(i.itersize, 6)</div>
<div class="line"><span class="lineno">  558</span>    assert_equal(i.shape, (2, 3))</div>
<div class="line"><span class="lineno">  559</span>    <span class="comment"># 2D with 2D</span></div>
<div class="line"><span class="lineno">  560</span>    i = nditer([arange(2).reshape(2, 1), arange(3).reshape(1, 3)],</div>
<div class="line"><span class="lineno">  561</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  562</span>    assert_equal(i.itersize, 6)</div>
<div class="line"><span class="lineno">  563</span>    assert_equal(i.shape, (2, 3))</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="comment"># 3D with scalar</span></div>
<div class="line"><span class="lineno">  566</span>    i = nditer([np.int32(2), arange(24).reshape(4, 2, 3)],</div>
<div class="line"><span class="lineno">  567</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  568</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  569</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  570</span>    <span class="comment"># 3D with 1D</span></div>
<div class="line"><span class="lineno">  571</span>    i = nditer([arange(3), arange(24).reshape(4, 2, 3)],</div>
<div class="line"><span class="lineno">  572</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  573</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  574</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  575</span>    i = nditer([arange(3), arange(8).reshape(4, 2, 1)],</div>
<div class="line"><span class="lineno">  576</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  577</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  578</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  579</span>    <span class="comment"># 3D with 2D</span></div>
<div class="line"><span class="lineno">  580</span>    i = nditer([arange(6).reshape(2, 3), arange(24).reshape(4, 2, 3)],</div>
<div class="line"><span class="lineno">  581</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  582</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  583</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  584</span>    i = nditer([arange(2).reshape(2, 1), arange(24).reshape(4, 2, 3)],</div>
<div class="line"><span class="lineno">  585</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  586</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  587</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  588</span>    i = nditer([arange(3).reshape(1, 3), arange(8).reshape(4, 2, 1)],</div>
<div class="line"><span class="lineno">  589</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  590</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  591</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  592</span>    <span class="comment"># 3D with 3D</span></div>
<div class="line"><span class="lineno">  593</span>    i = nditer([arange(2).reshape(1, 2, 1), arange(3).reshape(1, 1, 3),</div>
<div class="line"><span class="lineno">  594</span>                        arange(4).reshape(4, 1, 1)],</div>
<div class="line"><span class="lineno">  595</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*3)</div>
<div class="line"><span class="lineno">  596</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  597</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  598</span>    i = nditer([arange(6).reshape(1, 2, 3), arange(4).reshape(4, 1, 1)],</div>
<div class="line"><span class="lineno">  599</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  600</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  601</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  602</span>    i = nditer([arange(24).reshape(4, 2, 3), arange(12).reshape(4, 1, 3)],</div>
<div class="line"><span class="lineno">  603</span>                        [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  604</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno">  605</span>    assert_equal(i.shape, (4, 2, 3))</div>
<div class="line"><span class="lineno">  606</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a71548b23cd7f45f6e75db11b4da2b96b" name="a71548b23cd7f45f6e75db11b4da2b96b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71548b23cd7f45f6e75db11b4da2b96b">&#9670;&#160;</a></span>test_iter_broadcasting_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_broadcasting_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  638</span><span class="keyword">def </span>test_iter_broadcasting_errors():</div>
<div class="line"><span class="lineno">  639</span>    <span class="comment"># Check that errors are thrown for bad broadcasting shapes</span></div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>    <span class="comment"># 1D with 1D</span></div>
<div class="line"><span class="lineno">  642</span>    assert_raises(ValueError, nditer, [arange(2), arange(3)],</div>
<div class="line"><span class="lineno">  643</span>                    [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  644</span>    <span class="comment"># 2D with 1D</span></div>
<div class="line"><span class="lineno">  645</span>    assert_raises(ValueError, nditer,</div>
<div class="line"><span class="lineno">  646</span>                    [arange(6).reshape(2, 3), arange(2)],</div>
<div class="line"><span class="lineno">  647</span>                    [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  648</span>    <span class="comment"># 2D with 2D</span></div>
<div class="line"><span class="lineno">  649</span>    assert_raises(ValueError, nditer,</div>
<div class="line"><span class="lineno">  650</span>                    [arange(6).reshape(2, 3), arange(9).reshape(3, 3)],</div>
<div class="line"><span class="lineno">  651</span>                    [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  652</span>    assert_raises(ValueError, nditer,</div>
<div class="line"><span class="lineno">  653</span>                    [arange(6).reshape(2, 3), arange(4).reshape(2, 2)],</div>
<div class="line"><span class="lineno">  654</span>                    [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  655</span>    <span class="comment"># 3D with 3D</span></div>
<div class="line"><span class="lineno">  656</span>    assert_raises(ValueError, nditer,</div>
<div class="line"><span class="lineno">  657</span>                    [arange(36).reshape(3, 3, 4), arange(24).reshape(2, 3, 4)],</div>
<div class="line"><span class="lineno">  658</span>                    [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  659</span>    assert_raises(ValueError, nditer,</div>
<div class="line"><span class="lineno">  660</span>                    [arange(8).reshape(2, 4, 1), arange(24).reshape(2, 3, 4)],</div>
<div class="line"><span class="lineno">  661</span>                    [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="comment"># Verify that the error message mentions the right shapes</span></div>
<div class="line"><span class="lineno">  664</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  665</span>        nditer([arange(2).reshape(1, 2, 1),</div>
<div class="line"><span class="lineno">  666</span>                arange(3).reshape(1, 3),</div>
<div class="line"><span class="lineno">  667</span>                arange(6).reshape(2, 3)],</div>
<div class="line"><span class="lineno">  668</span>               [],</div>
<div class="line"><span class="lineno">  669</span>               [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;no_broadcast&#39;</span>]])</div>
<div class="line"><span class="lineno">  670</span>        <span class="keywordflow">raise</span> AssertionError(<span class="stringliteral">&#39;Should have raised a broadcast error&#39;</span>)</div>
<div class="line"><span class="lineno">  671</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  672</span>        msg = str(e)</div>
<div class="line"><span class="lineno">  673</span>        <span class="comment"># The message should contain the shape of the 3rd operand</span></div>
<div class="line"><span class="lineno">  674</span>        assert_(msg.find(<span class="stringliteral">&#39;(2,3)&#39;</span>) &gt;= 0,</div>
<div class="line"><span class="lineno">  675</span>                <span class="stringliteral">&#39;Message &quot;%s&quot; doesn\&#39;t contain operand shape (2,3)&#39;</span> % msg)</div>
<div class="line"><span class="lineno">  676</span>        <span class="comment"># The message should contain the broadcast shape</span></div>
<div class="line"><span class="lineno">  677</span>        assert_(msg.find(<span class="stringliteral">&#39;(1,2,3)&#39;</span>) &gt;= 0,</div>
<div class="line"><span class="lineno">  678</span>                <span class="stringliteral">&#39;Message &quot;%s&quot; doesn\&#39;t contain broadcast shape (1,2,3)&#39;</span> % msg)</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  681</span>        nditer([arange(6).reshape(2, 3), arange(2)],</div>
<div class="line"><span class="lineno">  682</span>               [],</div>
<div class="line"><span class="lineno">  683</span>               [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]],</div>
<div class="line"><span class="lineno">  684</span>               op_axes=[[0, 1], [0, np.newaxis]],</div>
<div class="line"><span class="lineno">  685</span>               itershape=(4, 3))</div>
<div class="line"><span class="lineno">  686</span>        <span class="keywordflow">raise</span> AssertionError(<span class="stringliteral">&#39;Should have raised a broadcast error&#39;</span>)</div>
<div class="line"><span class="lineno">  687</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  688</span>        msg = str(e)</div>
<div class="line"><span class="lineno">  689</span>        <span class="comment"># The message should contain &quot;shape-&gt;remappedshape&quot; for each operand</span></div>
<div class="line"><span class="lineno">  690</span>        assert_(msg.find(<span class="stringliteral">&#39;(2,3)-&gt;(2,3)&#39;</span>) &gt;= 0,</div>
<div class="line"><span class="lineno">  691</span>            <span class="stringliteral">&#39;Message &quot;%s&quot; doesn\&#39;t contain operand shape (2,3)-&gt;(2,3)&#39;</span> % msg)</div>
<div class="line"><span class="lineno">  692</span>        assert_(msg.find(<span class="stringliteral">&#39;(2,)-&gt;(2,newaxis)&#39;</span>) &gt;= 0,</div>
<div class="line"><span class="lineno">  693</span>                (<span class="stringliteral">&#39;Message &quot;%s&quot; doesn\&#39;t contain remapped operand shape&#39;</span> +</div>
<div class="line"><span class="lineno">  694</span>                <span class="stringliteral">&#39;(2,)-&gt;(2,newaxis)&#39;</span>) % msg)</div>
<div class="line"><span class="lineno">  695</span>        <span class="comment"># The message should contain the itershape parameter</span></div>
<div class="line"><span class="lineno">  696</span>        assert_(msg.find(<span class="stringliteral">&#39;(4,3)&#39;</span>) &gt;= 0,</div>
<div class="line"><span class="lineno">  697</span>                <span class="stringliteral">&#39;Message &quot;%s&quot; doesn\&#39;t contain itershape parameter (4,3)&#39;</span> % msg)</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  700</span>        nditer([np.zeros((2, 1, 1)), np.zeros((2,))],</div>
<div class="line"><span class="lineno">  701</span>               [],</div>
<div class="line"><span class="lineno">  702</span>               [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;no_broadcast&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  703</span>        <span class="keywordflow">raise</span> AssertionError(<span class="stringliteral">&#39;Should have raised a broadcast error&#39;</span>)</div>
<div class="line"><span class="lineno">  704</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> e:</div>
<div class="line"><span class="lineno">  705</span>        msg = str(e)</div>
<div class="line"><span class="lineno">  706</span>        <span class="comment"># The message should contain the shape of the bad operand</span></div>
<div class="line"><span class="lineno">  707</span>        assert_(msg.find(<span class="stringliteral">&#39;(2,1,1)&#39;</span>) &gt;= 0,</div>
<div class="line"><span class="lineno">  708</span>            <span class="stringliteral">&#39;Message &quot;%s&quot; doesn\&#39;t contain operand shape (2,1,1)&#39;</span> % msg)</div>
<div class="line"><span class="lineno">  709</span>        <span class="comment"># The message should contain the broadcast shape</span></div>
<div class="line"><span class="lineno">  710</span>        assert_(msg.find(<span class="stringliteral">&#39;(2,1,2)&#39;</span>) &gt;= 0,</div>
<div class="line"><span class="lineno">  711</span>                <span class="stringliteral">&#39;Message &quot;%s&quot; doesn\&#39;t contain the broadcast shape (2,1,2)&#39;</span> % msg)</div>
<div class="line"><span class="lineno">  712</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a20d71406500bc9a800c5e41abfc6320b" name="a20d71406500bc9a800c5e41abfc6320b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20d71406500bc9a800c5e41abfc6320b">&#9670;&#160;</a></span>test_iter_buffered_cast_byteswapped()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffered_cast_byteswapped </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1841</span><span class="keyword">def </span>test_iter_buffered_cast_byteswapped():</div>
<div class="line"><span class="lineno"> 1842</span>    <span class="comment"># Test that buffering can handle a cast which requires swap-&gt;cast-&gt;swap</span></div>
<div class="line"><span class="lineno"> 1843</span> </div>
<div class="line"><span class="lineno"> 1844</span>    a = np.arange(10, dtype=<span class="stringliteral">&#39;f4&#39;</span>).newbyteorder().byteswap()</div>
<div class="line"><span class="lineno"> 1845</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1846</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1847</span>                   casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno"> 1848</span>                   op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>).newbyteorder()],</div>
<div class="line"><span class="lineno"> 1849</span>                   buffersize=3)</div>
<div class="line"><span class="lineno"> 1850</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1851</span>        <span class="keywordflow">for</span> v <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1852</span>            v[...] *= 2</div>
<div class="line"><span class="lineno"> 1853</span> </div>
<div class="line"><span class="lineno"> 1854</span>    assert_equal(a, 2*np.arange(10, dtype=<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1855</span> </div>
<div class="line"><span class="lineno"> 1856</span>    <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno"> 1857</span>        sup.filter(np.ComplexWarning)</div>
<div class="line"><span class="lineno"> 1858</span> </div>
<div class="line"><span class="lineno"> 1859</span>        a = np.arange(10, dtype=<span class="stringliteral">&#39;f8&#39;</span>).newbyteorder().byteswap()</div>
<div class="line"><span class="lineno"> 1860</span>        i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1861</span>                       [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1862</span>                       casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1863</span>                       op_dtypes=[np.dtype(<span class="stringliteral">&#39;c8&#39;</span>).newbyteorder()],</div>
<div class="line"><span class="lineno"> 1864</span>                       buffersize=3)</div>
<div class="line"><span class="lineno"> 1865</span>        <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1866</span>            <span class="keywordflow">for</span> v <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1867</span>                v[...] *= 2</div>
<div class="line"><span class="lineno"> 1868</span> </div>
<div class="line"><span class="lineno"> 1869</span>        assert_equal(a, 2*np.arange(10, dtype=<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1870</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8dbf1a786bcc5cf2a5d13adb12f31293" name="a8dbf1a786bcc5cf2a5d13adb12f31293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dbf1a786bcc5cf2a5d13adb12f31293">&#9670;&#160;</a></span>test_iter_buffered_cast_byteswapped_complex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffered_cast_byteswapped_complex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1871</span><span class="keyword">def </span>test_iter_buffered_cast_byteswapped_complex():</div>
<div class="line"><span class="lineno"> 1872</span>    <span class="comment"># Test that buffering can handle a cast which requires swap-&gt;cast-&gt;copy</span></div>
<div class="line"><span class="lineno"> 1873</span> </div>
<div class="line"><span class="lineno"> 1874</span>    a = np.arange(10, dtype=<span class="stringliteral">&#39;c8&#39;</span>).newbyteorder().byteswap()</div>
<div class="line"><span class="lineno"> 1875</span>    a += 2j</div>
<div class="line"><span class="lineno"> 1876</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1877</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1878</span>                   casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno"> 1879</span>                   op_dtypes=[np.dtype(<span class="stringliteral">&#39;c16&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1880</span>                   buffersize=3)</div>
<div class="line"><span class="lineno"> 1881</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1882</span>        <span class="keywordflow">for</span> v <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1883</span>            v[...] *= 2</div>
<div class="line"><span class="lineno"> 1884</span>    assert_equal(a, 2*np.arange(10, dtype=<span class="stringliteral">&#39;c8&#39;</span>) + 4j)</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span>    a = np.arange(10, dtype=<span class="stringliteral">&#39;c8&#39;</span>)</div>
<div class="line"><span class="lineno"> 1887</span>    a += 2j</div>
<div class="line"><span class="lineno"> 1888</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1889</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1890</span>                   casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno"> 1891</span>                   op_dtypes=[np.dtype(<span class="stringliteral">&#39;c16&#39;</span>).newbyteorder()],</div>
<div class="line"><span class="lineno"> 1892</span>                   buffersize=3)</div>
<div class="line"><span class="lineno"> 1893</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1894</span>        <span class="keywordflow">for</span> v <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1895</span>            v[...] *= 2</div>
<div class="line"><span class="lineno"> 1896</span>    assert_equal(a, 2*np.arange(10, dtype=<span class="stringliteral">&#39;c8&#39;</span>) + 4j)</div>
<div class="line"><span class="lineno"> 1897</span> </div>
<div class="line"><span class="lineno"> 1898</span>    a = np.arange(10, dtype=np.clongdouble).newbyteorder().byteswap()</div>
<div class="line"><span class="lineno"> 1899</span>    a += 2j</div>
<div class="line"><span class="lineno"> 1900</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1901</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1902</span>                   casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno"> 1903</span>                   op_dtypes=[np.dtype(<span class="stringliteral">&#39;c16&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1904</span>                   buffersize=3)</div>
<div class="line"><span class="lineno"> 1905</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1906</span>        <span class="keywordflow">for</span> v <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1907</span>            v[...] *= 2</div>
<div class="line"><span class="lineno"> 1908</span>    assert_equal(a, 2*np.arange(10, dtype=np.clongdouble) + 4j)</div>
<div class="line"><span class="lineno"> 1909</span> </div>
<div class="line"><span class="lineno"> 1910</span>    a = np.arange(10, dtype=np.longdouble).newbyteorder().byteswap()</div>
<div class="line"><span class="lineno"> 1911</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1912</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1913</span>                   casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno"> 1914</span>                   op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1915</span>                   buffersize=7)</div>
<div class="line"><span class="lineno"> 1916</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1917</span>        <span class="keywordflow">for</span> v <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1918</span>            v[...] *= 2</div>
<div class="line"><span class="lineno"> 1919</span>    assert_equal(a, 2*np.arange(10, dtype=np.longdouble))</div>
<div class="line"><span class="lineno"> 1920</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a32fe2f504617a5a676e16d3a57b2e878" name="a32fe2f504617a5a676e16d3a57b2e878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a32fe2f504617a5a676e16d3a57b2e878">&#9670;&#160;</a></span>test_iter_buffered_cast_simple()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffered_cast_simple </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1826</span><span class="keyword">def </span>test_iter_buffered_cast_simple():</div>
<div class="line"><span class="lineno"> 1827</span>    <span class="comment"># Test that buffering can handle a simple cast</span></div>
<div class="line"><span class="lineno"> 1828</span> </div>
<div class="line"><span class="lineno"> 1829</span>    a = np.arange(10, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno"> 1830</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1831</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1832</span>                   casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno"> 1833</span>                   op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1834</span>                   buffersize=3)</div>
<div class="line"><span class="lineno"> 1835</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1836</span>        <span class="keywordflow">for</span> v <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1837</span>            v[...] *= 2</div>
<div class="line"><span class="lineno"> 1838</span> </div>
<div class="line"><span class="lineno"> 1839</span>    assert_equal(a, 2*np.arange(10, dtype=<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1840</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a67ec2e43549df5114143c9dfa92a00c6" name="a67ec2e43549df5114143c9dfa92a00c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67ec2e43549df5114143c9dfa92a00c6">&#9670;&#160;</a></span>test_iter_buffered_cast_structured_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffered_cast_structured_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1921</span><span class="keyword">def </span>test_iter_buffered_cast_structured_type():</div>
<div class="line"><span class="lineno"> 1922</span>    <span class="comment"># Tests buffering of structured types</span></div>
<div class="line"><span class="lineno"> 1923</span> </div>
<div class="line"><span class="lineno"> 1924</span>    <span class="comment"># simple -&gt; struct type (duplicates the value)</span></div>
<div class="line"><span class="lineno"> 1925</span>    sdt = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>), (<span class="stringliteral">&#39;b&#39;</span>, <span class="stringliteral">&#39;i8&#39;</span>), (<span class="stringliteral">&#39;c&#39;</span>, <span class="stringliteral">&#39;c8&#39;</span>, (2, 3)), (<span class="stringliteral">&#39;d&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>)]</div>
<div class="line"><span class="lineno"> 1926</span>    a = np.arange(3, dtype=<span class="stringliteral">&#39;f4&#39;</span>) + 0.5</div>
<div class="line"><span class="lineno"> 1927</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 1928</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1929</span>                    op_dtypes=sdt)</div>
<div class="line"><span class="lineno"> 1930</span>    vals = [np.array(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i]</div>
<div class="line"><span class="lineno"> 1931</span>    assert_equal(vals[0][<span class="stringliteral">&#39;a&#39;</span>], 0.5)</div>
<div class="line"><span class="lineno"> 1932</span>    assert_equal(vals[0][<span class="stringliteral">&#39;b&#39;</span>], 0)</div>
<div class="line"><span class="lineno"> 1933</span>    assert_equal(vals[0][<span class="stringliteral">&#39;c&#39;</span>], [[(0.5)]*3]*2)</div>
<div class="line"><span class="lineno"> 1934</span>    assert_equal(vals[0][<span class="stringliteral">&#39;d&#39;</span>], 0.5)</div>
<div class="line"><span class="lineno"> 1935</span>    assert_equal(vals[1][<span class="stringliteral">&#39;a&#39;</span>], 1.5)</div>
<div class="line"><span class="lineno"> 1936</span>    assert_equal(vals[1][<span class="stringliteral">&#39;b&#39;</span>], 1)</div>
<div class="line"><span class="lineno"> 1937</span>    assert_equal(vals[1][<span class="stringliteral">&#39;c&#39;</span>], [[(1.5)]*3]*2)</div>
<div class="line"><span class="lineno"> 1938</span>    assert_equal(vals[1][<span class="stringliteral">&#39;d&#39;</span>], 1.5)</div>
<div class="line"><span class="lineno"> 1939</span>    assert_equal(vals[0].dtype, np.dtype(sdt))</div>
<div class="line"><span class="lineno"> 1940</span> </div>
<div class="line"><span class="lineno"> 1941</span>    <span class="comment"># object -&gt; struct type</span></div>
<div class="line"><span class="lineno"> 1942</span>    sdt = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>), (<span class="stringliteral">&#39;b&#39;</span>, <span class="stringliteral">&#39;i8&#39;</span>), (<span class="stringliteral">&#39;c&#39;</span>, <span class="stringliteral">&#39;c8&#39;</span>, (2, 3)), (<span class="stringliteral">&#39;d&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>)]</div>
<div class="line"><span class="lineno"> 1943</span>    a = np.zeros((3,), dtype=<span class="stringliteral">&#39;O&#39;</span>)</div>
<div class="line"><span class="lineno"> 1944</span>    a[0] = (0.5, 0.5, [[0.5, 0.5, 0.5], [0.5, 0.5, 0.5]], 0.5)</div>
<div class="line"><span class="lineno"> 1945</span>    a[1] = (1.5, 1.5, [[1.5, 1.5, 1.5], [1.5, 1.5, 1.5]], 1.5)</div>
<div class="line"><span class="lineno"> 1946</span>    a[2] = (2.5, 2.5, [[2.5, 2.5, 2.5], [2.5, 2.5, 2.5]], 2.5)</div>
<div class="line"><span class="lineno"> 1947</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1948</span>        rc = sys.getrefcount(a[0])</div>
<div class="line"><span class="lineno"> 1949</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 1950</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1951</span>                    op_dtypes=sdt)</div>
<div class="line"><span class="lineno"> 1952</span>    vals = [x.copy() <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i]</div>
<div class="line"><span class="lineno"> 1953</span>    assert_equal(vals[0][<span class="stringliteral">&#39;a&#39;</span>], 0.5)</div>
<div class="line"><span class="lineno"> 1954</span>    assert_equal(vals[0][<span class="stringliteral">&#39;b&#39;</span>], 0)</div>
<div class="line"><span class="lineno"> 1955</span>    assert_equal(vals[0][<span class="stringliteral">&#39;c&#39;</span>], [[(0.5)]*3]*2)</div>
<div class="line"><span class="lineno"> 1956</span>    assert_equal(vals[0][<span class="stringliteral">&#39;d&#39;</span>], 0.5)</div>
<div class="line"><span class="lineno"> 1957</span>    assert_equal(vals[1][<span class="stringliteral">&#39;a&#39;</span>], 1.5)</div>
<div class="line"><span class="lineno"> 1958</span>    assert_equal(vals[1][<span class="stringliteral">&#39;b&#39;</span>], 1)</div>
<div class="line"><span class="lineno"> 1959</span>    assert_equal(vals[1][<span class="stringliteral">&#39;c&#39;</span>], [[(1.5)]*3]*2)</div>
<div class="line"><span class="lineno"> 1960</span>    assert_equal(vals[1][<span class="stringliteral">&#39;d&#39;</span>], 1.5)</div>
<div class="line"><span class="lineno"> 1961</span>    assert_equal(vals[0].dtype, np.dtype(sdt))</div>
<div class="line"><span class="lineno"> 1962</span>    vals, i, x = [<span class="keywordtype">None</span>]*3</div>
<div class="line"><span class="lineno"> 1963</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1964</span>        assert_equal(sys.getrefcount(a[0]), rc)</div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span>    <span class="comment"># single-field struct type -&gt; simple</span></div>
<div class="line"><span class="lineno"> 1967</span>    sdt = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>)]</div>
<div class="line"><span class="lineno"> 1968</span>    a = np.array([(5.5,), (8,)], dtype=sdt)</div>
<div class="line"><span class="lineno"> 1969</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 1970</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1971</span>                    op_dtypes=<span class="stringliteral">&#39;i4&#39;</span>)</div>
<div class="line"><span class="lineno"> 1972</span>    assert_equal([x_[()] <span class="keywordflow">for</span> x_ <span class="keywordflow">in</span> i], [5, 8])</div>
<div class="line"><span class="lineno"> 1973</span> </div>
<div class="line"><span class="lineno"> 1974</span>    <span class="comment"># make sure multi-field struct type -&gt; simple doesn&#39;t work</span></div>
<div class="line"><span class="lineno"> 1975</span>    sdt = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>), (<span class="stringliteral">&#39;b&#39;</span>, <span class="stringliteral">&#39;i8&#39;</span>), (<span class="stringliteral">&#39;d&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>)]</div>
<div class="line"><span class="lineno"> 1976</span>    a = np.array([(5.5, 7, <span class="stringliteral">&#39;test&#39;</span>), (8, 10, 11)], dtype=sdt)</div>
<div class="line"><span class="lineno"> 1977</span>    assert_raises(TypeError, <span class="keyword">lambda</span>: (</div>
<div class="line"><span class="lineno"> 1978</span>        nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 1979</span>               casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1980</span>               op_dtypes=<span class="stringliteral">&#39;i4&#39;</span>)))</div>
<div class="line"><span class="lineno"> 1981</span> </div>
<div class="line"><span class="lineno"> 1982</span>    <span class="comment"># struct type -&gt; struct type (field-wise copy)</span></div>
<div class="line"><span class="lineno"> 1983</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>), (<span class="stringliteral">&#39;b&#39;</span>, <span class="stringliteral">&#39;i8&#39;</span>), (<span class="stringliteral">&#39;d&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>)]</div>
<div class="line"><span class="lineno"> 1984</span>    sdt2 = [(<span class="stringliteral">&#39;d&#39;</span>, <span class="stringliteral">&#39;u2&#39;</span>), (<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>), (<span class="stringliteral">&#39;b&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>)]</div>
<div class="line"><span class="lineno"> 1985</span>    a = np.array([(1, 2, 3), (4, 5, 6)], dtype=sdt1)</div>
<div class="line"><span class="lineno"> 1986</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 1987</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1988</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 1989</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 1990</span>    assert_equal([np.array(x_) <span class="keywordflow">for</span> x_ <span class="keywordflow">in</span> i],</div>
<div class="line"><span class="lineno"> 1991</span>                 [np.array((1, 2, 3), dtype=sdt2),</div>
<div class="line"><span class="lineno"> 1992</span>                  np.array((4, 5, 6), dtype=sdt2)])</div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a672e106cd4066de8d2e9191663fd10a6" name="a672e106cd4066de8d2e9191663fd10a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a672e106cd4066de8d2e9191663fd10a6">&#9670;&#160;</a></span>test_iter_buffered_cast_structured_type_failure_with_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffered_cast_structured_type_failure_with_cleanup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1995</span><span class="keyword">def </span>test_iter_buffered_cast_structured_type_failure_with_cleanup():</div>
<div class="line"><span class="lineno"> 1996</span>    <span class="comment"># make sure struct type -&gt; struct type with different</span></div>
<div class="line"><span class="lineno"> 1997</span>    <span class="comment"># number of fields fails</span></div>
<div class="line"><span class="lineno"> 1998</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>), (<span class="stringliteral">&#39;b&#39;</span>, <span class="stringliteral">&#39;i8&#39;</span>), (<span class="stringliteral">&#39;d&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>)]</div>
<div class="line"><span class="lineno"> 1999</span>    sdt2 = [(<span class="stringliteral">&#39;b&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>), (<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>)]</div>
<div class="line"><span class="lineno"> 2000</span>    a = np.array([(1, 2, 3), (4, 5, 6)], dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2001</span> </div>
<div class="line"><span class="lineno"> 2002</span>    <span class="keywordflow">for</span> intent <span class="keywordflow">in</span> [<span class="stringliteral">&quot;readwrite&quot;</span>, <span class="stringliteral">&quot;readonly&quot;</span>, <span class="stringliteral">&quot;writeonly&quot;</span>]:</div>
<div class="line"><span class="lineno"> 2003</span>        <span class="comment"># This test was initially designed to test an error at a different</span></div>
<div class="line"><span class="lineno"> 2004</span>        <span class="comment"># place, but will now raise earlier to to the cast not being possible:</span></div>
<div class="line"><span class="lineno"> 2005</span>        <span class="comment"># `assert np.can_cast(a.dtype, sdt2, casting=&quot;unsafe&quot;)` fails.</span></div>
<div class="line"><span class="lineno"> 2006</span>        <span class="comment"># Without a faulty DType, there is probably no reliable</span></div>
<div class="line"><span class="lineno"> 2007</span>        <span class="comment"># way to get the initial tested behaviour.</span></div>
<div class="line"><span class="lineno"> 2008</span>        simple_arr = np.array([1, 2], dtype=<span class="stringliteral">&quot;i,i&quot;</span>)  <span class="comment"># requires clean up</span></div>
<div class="line"><span class="lineno"> 2009</span>        <span class="keyword">with</span> pytest.raises(TypeError):</div>
<div class="line"><span class="lineno"> 2010</span>            nditer((simple_arr, a), [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [intent, intent],</div>
<div class="line"><span class="lineno"> 2011</span>                   casting=<span class="stringliteral">&#39;unsafe&#39;</span>, op_dtypes=[<span class="stringliteral">&quot;f,f&quot;</span>, sdt2])</div>
<div class="line"><span class="lineno"> 2012</span> </div>
<div class="line"><span class="lineno"> 2013</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b5260d49860868b702a9cf4007c07e6" name="a6b5260d49860868b702a9cf4007c07e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b5260d49860868b702a9cf4007c07e6">&#9670;&#160;</a></span>test_iter_buffered_cast_subarray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffered_cast_subarray </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2049</span><span class="keyword">def </span>test_iter_buffered_cast_subarray():</div>
<div class="line"><span class="lineno"> 2050</span>    <span class="comment"># Tests buffering of subarrays</span></div>
<div class="line"><span class="lineno"> 2051</span> </div>
<div class="line"><span class="lineno"> 2052</span>    <span class="comment"># one element -&gt; many (copies it to all)</span></div>
<div class="line"><span class="lineno"> 2053</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>)]</div>
<div class="line"><span class="lineno"> 2054</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>, (3, 2, 2))]</div>
<div class="line"><span class="lineno"> 2055</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2056</span>    a[<span class="stringliteral">&#39;a&#39;</span>] = np.arange(6)</div>
<div class="line"><span class="lineno"> 2057</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2058</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2059</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2060</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2061</span>    <span class="keywordflow">for</span> x, count <span class="keywordflow">in</span> zip(i, list(range(6))):</div>
<div class="line"><span class="lineno"> 2062</span>        assert_(np.all(x[<span class="stringliteral">&#39;a&#39;</span>] == count))</div>
<div class="line"><span class="lineno"> 2063</span> </div>
<div class="line"><span class="lineno"> 2064</span>    <span class="comment"># one element -&gt; many -&gt; back (copies it to all)</span></div>
<div class="line"><span class="lineno"> 2065</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>, (1, 1))]</div>
<div class="line"><span class="lineno"> 2066</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>, (3, 2, 2))]</div>
<div class="line"><span class="lineno"> 2067</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2068</span>    a[<span class="stringliteral">&#39;a&#39;</span>][:, 0, 0] = np.arange(6)</div>
<div class="line"><span class="lineno"> 2069</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>],</div>
<div class="line"><span class="lineno"> 2070</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2071</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2072</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 2073</span>        assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2074</span>        count = 0</div>
<div class="line"><span class="lineno"> 2075</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2076</span>            assert_(np.all(x[<span class="stringliteral">&#39;a&#39;</span>] == count))</div>
<div class="line"><span class="lineno"> 2077</span>            x[<span class="stringliteral">&#39;a&#39;</span>][0] += 2</div>
<div class="line"><span class="lineno"> 2078</span>            count += 1</div>
<div class="line"><span class="lineno"> 2079</span>    assert_equal(a[<span class="stringliteral">&#39;a&#39;</span>], np.arange(6).reshape(6, 1, 1)+2)</div>
<div class="line"><span class="lineno"> 2080</span> </div>
<div class="line"><span class="lineno"> 2081</span>    <span class="comment"># many -&gt; one element -&gt; back (copies just element 0)</span></div>
<div class="line"><span class="lineno"> 2082</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>, (3, 2, 2))]</div>
<div class="line"><span class="lineno"> 2083</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>, (1,))]</div>
<div class="line"><span class="lineno"> 2084</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2085</span>    a[<span class="stringliteral">&#39;a&#39;</span>][:, 0, 0, 0] = np.arange(6)</div>
<div class="line"><span class="lineno"> 2086</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>],</div>
<div class="line"><span class="lineno"> 2087</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2088</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2089</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 2090</span>        assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2091</span>        count = 0</div>
<div class="line"><span class="lineno"> 2092</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2093</span>            assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>], count)</div>
<div class="line"><span class="lineno"> 2094</span>            x[<span class="stringliteral">&#39;a&#39;</span>] += 2</div>
<div class="line"><span class="lineno"> 2095</span>            count += 1</div>
<div class="line"><span class="lineno"> 2096</span>    assert_equal(a[<span class="stringliteral">&#39;a&#39;</span>], np.arange(6).reshape(6, 1, 1, 1)*np.ones((1, 3, 2, 2))+2)</div>
<div class="line"><span class="lineno"> 2097</span> </div>
<div class="line"><span class="lineno"> 2098</span>    <span class="comment"># many -&gt; one element -&gt; back (copies just element 0)</span></div>
<div class="line"><span class="lineno"> 2099</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>, (3, 2, 2))]</div>
<div class="line"><span class="lineno"> 2100</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>, (1,))]</div>
<div class="line"><span class="lineno"> 2101</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2102</span>    a[<span class="stringliteral">&#39;a&#39;</span>][:, 0, 0, 0] = np.arange(6)</div>
<div class="line"><span class="lineno"> 2103</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2104</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2105</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2106</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2107</span>    count = 0</div>
<div class="line"><span class="lineno"> 2108</span>    <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2109</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>], count)</div>
<div class="line"><span class="lineno"> 2110</span>        count += 1</div>
<div class="line"><span class="lineno"> 2111</span> </div>
<div class="line"><span class="lineno"> 2112</span>    <span class="comment"># many -&gt; one element (copies just element 0)</span></div>
<div class="line"><span class="lineno"> 2113</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>, (3, 2, 2))]</div>
<div class="line"><span class="lineno"> 2114</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>, (1,))]</div>
<div class="line"><span class="lineno"> 2115</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2116</span>    a[<span class="stringliteral">&#39;a&#39;</span>][:, 0, 0, 0] = np.arange(6)</div>
<div class="line"><span class="lineno"> 2117</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2118</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2119</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2120</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2121</span>    count = 0</div>
<div class="line"><span class="lineno"> 2122</span>    <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2123</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>], count)</div>
<div class="line"><span class="lineno"> 2124</span>        count += 1</div>
<div class="line"><span class="lineno"> 2125</span> </div>
<div class="line"><span class="lineno"> 2126</span>    <span class="comment"># many -&gt; matching shape (straightforward copy)</span></div>
<div class="line"><span class="lineno"> 2127</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>, (3, 2, 2))]</div>
<div class="line"><span class="lineno"> 2128</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>, (3, 2, 2))]</div>
<div class="line"><span class="lineno"> 2129</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2130</span>    a[<span class="stringliteral">&#39;a&#39;</span>] = np.arange(6*3*2*2).reshape(6, 3, 2, 2)</div>
<div class="line"><span class="lineno"> 2131</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2132</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2133</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2134</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2135</span>    count = 0</div>
<div class="line"><span class="lineno"> 2136</span>    <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2137</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>], a[count][<span class="stringliteral">&#39;a&#39;</span>])</div>
<div class="line"><span class="lineno"> 2138</span>        count += 1</div>
<div class="line"><span class="lineno"> 2139</span> </div>
<div class="line"><span class="lineno"> 2140</span>    <span class="comment"># vector -&gt; smaller vector (truncates)</span></div>
<div class="line"><span class="lineno"> 2141</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>, (6,))]</div>
<div class="line"><span class="lineno"> 2142</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>, (2,))]</div>
<div class="line"><span class="lineno"> 2143</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2144</span>    a[<span class="stringliteral">&#39;a&#39;</span>] = np.arange(6*6).reshape(6, 6)</div>
<div class="line"><span class="lineno"> 2145</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2146</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2147</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2148</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2149</span>    count = 0</div>
<div class="line"><span class="lineno"> 2150</span>    <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2151</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>], a[count][<span class="stringliteral">&#39;a&#39;</span>][:2])</div>
<div class="line"><span class="lineno"> 2152</span>        count += 1</div>
<div class="line"><span class="lineno"> 2153</span> </div>
<div class="line"><span class="lineno"> 2154</span>    <span class="comment"># vector -&gt; bigger vector (pads with zeros)</span></div>
<div class="line"><span class="lineno"> 2155</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>, (2,))]</div>
<div class="line"><span class="lineno"> 2156</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>, (6,))]</div>
<div class="line"><span class="lineno"> 2157</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2158</span>    a[<span class="stringliteral">&#39;a&#39;</span>] = np.arange(6*2).reshape(6, 2)</div>
<div class="line"><span class="lineno"> 2159</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2160</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2161</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2162</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2163</span>    count = 0</div>
<div class="line"><span class="lineno"> 2164</span>    <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2165</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][:2], a[count][<span class="stringliteral">&#39;a&#39;</span>])</div>
<div class="line"><span class="lineno"> 2166</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][2:], [0, 0, 0, 0])</div>
<div class="line"><span class="lineno"> 2167</span>        count += 1</div>
<div class="line"><span class="lineno"> 2168</span> </div>
<div class="line"><span class="lineno"> 2169</span>    <span class="comment"># vector -&gt; matrix (broadcasts)</span></div>
<div class="line"><span class="lineno"> 2170</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>, (2,))]</div>
<div class="line"><span class="lineno"> 2171</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>, (2, 2))]</div>
<div class="line"><span class="lineno"> 2172</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2173</span>    a[<span class="stringliteral">&#39;a&#39;</span>] = np.arange(6*2).reshape(6, 2)</div>
<div class="line"><span class="lineno"> 2174</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2175</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2176</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2177</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2178</span>    count = 0</div>
<div class="line"><span class="lineno"> 2179</span>    <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2180</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][0], a[count][<span class="stringliteral">&#39;a&#39;</span>])</div>
<div class="line"><span class="lineno"> 2181</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][1], a[count][<span class="stringliteral">&#39;a&#39;</span>])</div>
<div class="line"><span class="lineno"> 2182</span>        count += 1</div>
<div class="line"><span class="lineno"> 2183</span> </div>
<div class="line"><span class="lineno"> 2184</span>    <span class="comment"># vector -&gt; matrix (broadcasts and zero-pads)</span></div>
<div class="line"><span class="lineno"> 2185</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>, (2, 1))]</div>
<div class="line"><span class="lineno"> 2186</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>, (3, 2))]</div>
<div class="line"><span class="lineno"> 2187</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2188</span>    a[<span class="stringliteral">&#39;a&#39;</span>] = np.arange(6*2).reshape(6, 2, 1)</div>
<div class="line"><span class="lineno"> 2189</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2190</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2191</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2192</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2193</span>    count = 0</div>
<div class="line"><span class="lineno"> 2194</span>    <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2195</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][:2, 0], a[count][<span class="stringliteral">&#39;a&#39;</span>][:, 0])</div>
<div class="line"><span class="lineno"> 2196</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][:2, 1], a[count][<span class="stringliteral">&#39;a&#39;</span>][:, 0])</div>
<div class="line"><span class="lineno"> 2197</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][2,:], [0, 0])</div>
<div class="line"><span class="lineno"> 2198</span>        count += 1</div>
<div class="line"><span class="lineno"> 2199</span> </div>
<div class="line"><span class="lineno"> 2200</span>    <span class="comment"># matrix -&gt; matrix (truncates and zero-pads)</span></div>
<div class="line"><span class="lineno"> 2201</span>    sdt1 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f8&#39;</span>, (2, 3))]</div>
<div class="line"><span class="lineno"> 2202</span>    sdt2 = [(<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;f4&#39;</span>, (3, 2))]</div>
<div class="line"><span class="lineno"> 2203</span>    a = np.zeros((6,), dtype=sdt1)</div>
<div class="line"><span class="lineno"> 2204</span>    a[<span class="stringliteral">&#39;a&#39;</span>] = np.arange(6*2*3).reshape(6, 2, 3)</div>
<div class="line"><span class="lineno"> 2205</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2206</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 2207</span>                    op_dtypes=sdt2)</div>
<div class="line"><span class="lineno"> 2208</span>    assert_equal(i[0].dtype, np.dtype(sdt2))</div>
<div class="line"><span class="lineno"> 2209</span>    count = 0</div>
<div class="line"><span class="lineno"> 2210</span>    <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2211</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][:2, 0], a[count][<span class="stringliteral">&#39;a&#39;</span>][:, 0])</div>
<div class="line"><span class="lineno"> 2212</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][:2, 1], a[count][<span class="stringliteral">&#39;a&#39;</span>][:, 1])</div>
<div class="line"><span class="lineno"> 2213</span>        assert_equal(x[<span class="stringliteral">&#39;a&#39;</span>][2,:], [0, 0])</div>
<div class="line"><span class="lineno"> 2214</span>        count += 1</div>
<div class="line"><span class="lineno"> 2215</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a40b697dddaf43dd4786c34d57df21ac0" name="a40b697dddaf43dd4786c34d57df21ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40b697dddaf43dd4786c34d57df21ac0">&#9670;&#160;</a></span>test_iter_buffered_reduce_reuse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffered_reduce_reuse </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2278</span><span class="keyword">def </span>test_iter_buffered_reduce_reuse():</div>
<div class="line"><span class="lineno"> 2279</span>    <span class="comment"># large enough array for all views, including negative strides.</span></div>
<div class="line"><span class="lineno"> 2280</span>    a = np.arange(2*3**5)[3**5:3**5+1]</div>
<div class="line"><span class="lineno"> 2281</span>    flags = [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;delay_bufalloc&#39;</span>, <span class="stringliteral">&#39;multi_index&#39;</span>, <span class="stringliteral">&#39;reduce_ok&#39;</span>, <span class="stringliteral">&#39;refs_ok&#39;</span>]</div>
<div class="line"><span class="lineno"> 2282</span>    op_flags = [(<span class="stringliteral">&#39;readonly&#39;</span>,), (<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>)]</div>
<div class="line"><span class="lineno"> 2283</span>    op_axes_list = [[(0, 1, 2), (0, 1, -1)], [(0, 1, 2), (0, -1, -1)]]</div>
<div class="line"><span class="lineno"> 2284</span>    <span class="comment"># wrong dtype to force buffering</span></div>
<div class="line"><span class="lineno"> 2285</span>    op_dtypes = [float, a.dtype]</div>
<div class="line"><span class="lineno"> 2286</span> </div>
<div class="line"><span class="lineno"> 2287</span>    <span class="keyword">def </span>get_params():</div>
<div class="line"><span class="lineno"> 2288</span>        <span class="keywordflow">for</span> xs <span class="keywordflow">in</span> range(-3**2, 3**2 + 1):</div>
<div class="line"><span class="lineno"> 2289</span>            <span class="keywordflow">for</span> ys <span class="keywordflow">in</span> range(xs, 3**2 + 1):</div>
<div class="line"><span class="lineno"> 2290</span>                <span class="keywordflow">for</span> op_axes <span class="keywordflow">in</span> op_axes_list:</div>
<div class="line"><span class="lineno"> 2291</span>                    <span class="comment"># last stride is reduced and because of that not</span></div>
<div class="line"><span class="lineno"> 2292</span>                    <span class="comment"># important for this test, as it is the inner stride.</span></div>
<div class="line"><span class="lineno"> 2293</span>                    strides = (xs * a.itemsize, ys * a.itemsize, a.itemsize)</div>
<div class="line"><span class="lineno"> 2294</span>                    arr = np.lib.stride_tricks.as_strided(a, (3, 3, 3), strides)</div>
<div class="line"><span class="lineno"> 2295</span> </div>
<div class="line"><span class="lineno"> 2296</span>                    <span class="keywordflow">for</span> skip <span class="keywordflow">in</span> [0, 1]:</div>
<div class="line"><span class="lineno"> 2297</span>                        <span class="keywordflow">yield</span> arr, op_axes, skip</div>
<div class="line"><span class="lineno"> 2298</span> </div>
<div class="line"><span class="lineno"> 2299</span>    <span class="keywordflow">for</span> arr, op_axes, skip <span class="keywordflow">in</span> get_params():</div>
<div class="line"><span class="lineno"> 2300</span>        nditer2 = np.nditer([arr.copy(), <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 2301</span>                            op_axes=op_axes, flags=flags, op_flags=op_flags,</div>
<div class="line"><span class="lineno"> 2302</span>                            op_dtypes=op_dtypes)</div>
<div class="line"><span class="lineno"> 2303</span>        <span class="keyword">with</span> nditer2:</div>
<div class="line"><span class="lineno"> 2304</span>            nditer2.operands[-1][...] = 0</div>
<div class="line"><span class="lineno"> 2305</span>            nditer2.reset()</div>
<div class="line"><span class="lineno"> 2306</span>            nditer2.iterindex = skip</div>
<div class="line"><span class="lineno"> 2307</span> </div>
<div class="line"><span class="lineno"> 2308</span>            <span class="keywordflow">for</span> (a2_in, b2_in) <span class="keywordflow">in</span> nditer2:</div>
<div class="line"><span class="lineno"> 2309</span>                b2_in += a2_in.astype(np.int_)</div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span>            comp_res = nditer2.operands[-1]</div>
<div class="line"><span class="lineno"> 2312</span> </div>
<div class="line"><span class="lineno"> 2313</span>        <span class="keywordflow">for</span> bufsize <span class="keywordflow">in</span> range(0, 3**3):</div>
<div class="line"><span class="lineno"> 2314</span>            nditer1 = np.nditer([arr, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 2315</span>                                op_axes=op_axes, flags=flags, op_flags=op_flags,</div>
<div class="line"><span class="lineno"> 2316</span>                                buffersize=bufsize, op_dtypes=op_dtypes)</div>
<div class="line"><span class="lineno"> 2317</span>            <span class="keyword">with</span> nditer1:</div>
<div class="line"><span class="lineno"> 2318</span>                nditer1.operands[-1][...] = 0</div>
<div class="line"><span class="lineno"> 2319</span>                nditer1.reset()</div>
<div class="line"><span class="lineno"> 2320</span>                nditer1.iterindex = skip</div>
<div class="line"><span class="lineno"> 2321</span> </div>
<div class="line"><span class="lineno"> 2322</span>                <span class="keywordflow">for</span> (a1_in, b1_in) <span class="keywordflow">in</span> nditer1:</div>
<div class="line"><span class="lineno"> 2323</span>                    b1_in += a1_in.astype(np.int_)</div>
<div class="line"><span class="lineno"> 2324</span> </div>
<div class="line"><span class="lineno"> 2325</span>                res = nditer1.operands[-1]</div>
<div class="line"><span class="lineno"> 2326</span>            assert_array_equal(res, comp_res)</div>
<div class="line"><span class="lineno"> 2327</span> </div>
<div class="line"><span class="lineno"> 2328</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9cc2dedafdf85391e5c03b564bfbbb34" name="a9cc2dedafdf85391e5c03b564bfbbb34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cc2dedafdf85391e5c03b564bfbbb34">&#9670;&#160;</a></span>test_iter_buffering()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1752</span><span class="keyword">def </span>test_iter_buffering():</div>
<div class="line"><span class="lineno"> 1753</span>    <span class="comment"># Test buffering with several buffer sizes and types</span></div>
<div class="line"><span class="lineno"> 1754</span>    arrays = []</div>
<div class="line"><span class="lineno"> 1755</span>    <span class="comment"># F-order swapped array</span></div>
<div class="line"><span class="lineno"> 1756</span>    arrays.append(np.arange(24,</div>
<div class="line"><span class="lineno"> 1757</span>                    dtype=<span class="stringliteral">&#39;c16&#39;</span>).reshape(2, 3, 4).T.newbyteorder().byteswap())</div>
<div class="line"><span class="lineno"> 1758</span>    <span class="comment"># Contiguous 1-dimensional array</span></div>
<div class="line"><span class="lineno"> 1759</span>    arrays.append(np.arange(10, dtype=<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1760</span>    <span class="comment"># Unaligned array</span></div>
<div class="line"><span class="lineno"> 1761</span>    a = np.zeros((4*16+1,), dtype=<span class="stringliteral">&#39;i1&#39;</span>)[1:]</div>
<div class="line"><span class="lineno"> 1762</span>    a.dtype = <span class="stringliteral">&#39;i4&#39;</span></div>
<div class="line"><span class="lineno"> 1763</span>    a[:] = np.arange(16, dtype=<span class="stringliteral">&#39;i4&#39;</span>)</div>
<div class="line"><span class="lineno"> 1764</span>    arrays.append(a)</div>
<div class="line"><span class="lineno"> 1765</span>    <span class="comment"># 4-D F-order array</span></div>
<div class="line"><span class="lineno"> 1766</span>    arrays.append(np.arange(120, dtype=<span class="stringliteral">&#39;i4&#39;</span>).reshape(5, 3, 2, 4).T)</div>
<div class="line"><span class="lineno"> 1767</span>    <span class="keywordflow">for</span> a <span class="keywordflow">in</span> arrays:</div>
<div class="line"><span class="lineno"> 1768</span>        <span class="keywordflow">for</span> buffersize <span class="keywordflow">in</span> (1, 2, 3, 5, 8, 11, 16, 1024):</div>
<div class="line"><span class="lineno"> 1769</span>            vals = []</div>
<div class="line"><span class="lineno"> 1770</span>            i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1771</span>                           [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1772</span>                           order=<span class="stringliteral">&#39;C&#39;</span>,</div>
<div class="line"><span class="lineno"> 1773</span>                           casting=<span class="stringliteral">&#39;equiv&#39;</span>,</div>
<div class="line"><span class="lineno"> 1774</span>                           buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1775</span>            <span class="keywordflow">while</span> <span class="keywordflow">not</span> i.finished:</div>
<div class="line"><span class="lineno"> 1776</span>                assert_(i[0].size &lt;= buffersize)</div>
<div class="line"><span class="lineno"> 1777</span>                vals.append(i[0].copy())</div>
<div class="line"><span class="lineno"> 1778</span>                i.iternext()</div>
<div class="line"><span class="lineno"> 1779</span>            assert_equal(np.concatenate(vals), a.ravel(order=<span class="stringliteral">&#39;C&#39;</span>))</div>
<div class="line"><span class="lineno"> 1780</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad0b81eafbae268d511b397caa82292a5" name="ad0b81eafbae268d511b397caa82292a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0b81eafbae268d511b397caa82292a5">&#9670;&#160;</a></span>test_iter_buffering_badwriteback()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffering_badwriteback </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2216</span><span class="keyword">def </span>test_iter_buffering_badwriteback():</div>
<div class="line"><span class="lineno"> 2217</span>    <span class="comment"># Writing back from a buffer cannot combine elements</span></div>
<div class="line"><span class="lineno"> 2218</span> </div>
<div class="line"><span class="lineno"> 2219</span>    <span class="comment"># a needs write buffering, but had a broadcast dimension</span></div>
<div class="line"><span class="lineno"> 2220</span>    a = np.arange(6).reshape(2, 3, 1)</div>
<div class="line"><span class="lineno"> 2221</span>    b = np.arange(12).reshape(2, 3, 2)</div>
<div class="line"><span class="lineno"> 2222</span>    assert_raises(ValueError, nditer, [a, b],</div>
<div class="line"><span class="lineno"> 2223</span>                  [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2224</span>                  [[<span class="stringliteral">&#39;readwrite&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2225</span>                  order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno"> 2226</span> </div>
<div class="line"><span class="lineno"> 2227</span>    <span class="comment"># But if a is readonly, it&#39;s fine</span></div>
<div class="line"><span class="lineno"> 2228</span>    nditer([a, b], [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2229</span>           [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2230</span>           order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno"> 2231</span> </div>
<div class="line"><span class="lineno"> 2232</span>    <span class="comment"># If a has just one element, it&#39;s fine too (constant 0 stride, a reduction)</span></div>
<div class="line"><span class="lineno"> 2233</span>    a = np.arange(1).reshape(1, 1, 1)</div>
<div class="line"><span class="lineno"> 2234</span>    nditer([a, b], [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>, <span class="stringliteral">&#39;reduce_ok&#39;</span>],</div>
<div class="line"><span class="lineno"> 2235</span>           [[<span class="stringliteral">&#39;readwrite&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2236</span>           order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno"> 2237</span> </div>
<div class="line"><span class="lineno"> 2238</span>    <span class="comment"># check that it fails on other dimensions too</span></div>
<div class="line"><span class="lineno"> 2239</span>    a = np.arange(6).reshape(1, 3, 2)</div>
<div class="line"><span class="lineno"> 2240</span>    assert_raises(ValueError, nditer, [a, b],</div>
<div class="line"><span class="lineno"> 2241</span>                  [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2242</span>                  [[<span class="stringliteral">&#39;readwrite&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2243</span>                  order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno"> 2244</span>    a = np.arange(4).reshape(2, 1, 2)</div>
<div class="line"><span class="lineno"> 2245</span>    assert_raises(ValueError, nditer, [a, b],</div>
<div class="line"><span class="lineno"> 2246</span>                  [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2247</span>                  [[<span class="stringliteral">&#39;readwrite&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2248</span>                  order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno"> 2249</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a72829cd2cc7fc091aa5a401f0835679d" name="a72829cd2cc7fc091aa5a401f0835679d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72829cd2cc7fc091aa5a401f0835679d">&#9670;&#160;</a></span>test_iter_buffering_delayed_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffering_delayed_alloc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1799</span><span class="keyword">def </span>test_iter_buffering_delayed_alloc():</div>
<div class="line"><span class="lineno"> 1800</span>    <span class="comment"># Test that delaying buffer allocation works</span></div>
<div class="line"><span class="lineno"> 1801</span> </div>
<div class="line"><span class="lineno"> 1802</span>    a = np.arange(6)</div>
<div class="line"><span class="lineno"> 1803</span>    b = np.arange(1, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno"> 1804</span>    i = nditer([a, b], [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;delay_bufalloc&#39;</span>, <span class="stringliteral">&#39;multi_index&#39;</span>, <span class="stringliteral">&#39;reduce_ok&#39;</span>],</div>
<div class="line"><span class="lineno"> 1805</span>                    [<span class="stringliteral">&#39;readwrite&#39;</span>],</div>
<div class="line"><span class="lineno"> 1806</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1807</span>                    op_dtypes=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno"> 1808</span>    assert_(i.has_delayed_bufalloc)</div>
<div class="line"><span class="lineno"> 1809</span>    assert_raises(ValueError, <span class="keyword">lambda</span> i:i.multi_index, i)</div>
<div class="line"><span class="lineno"> 1810</span>    assert_raises(ValueError, <span class="keyword">lambda</span> i:i[0], i)</div>
<div class="line"><span class="lineno"> 1811</span>    assert_raises(ValueError, <span class="keyword">lambda</span> i:i[0:2], i)</div>
<div class="line"><span class="lineno"> 1812</span> </div>
<div class="line"><span class="lineno"> 1813</span>    <span class="keyword">def </span>assign_iter(i):</div>
<div class="line"><span class="lineno"> 1814</span>        i[0] = 0</div>
<div class="line"><span class="lineno"> 1815</span>    assert_raises(ValueError, assign_iter, i)</div>
<div class="line"><span class="lineno"> 1816</span> </div>
<div class="line"><span class="lineno"> 1817</span>    i.reset()</div>
<div class="line"><span class="lineno"> 1818</span>    assert_(<span class="keywordflow">not</span> i.has_delayed_bufalloc)</div>
<div class="line"><span class="lineno"> 1819</span>    assert_equal(i.multi_index, (0,))</div>
<div class="line"><span class="lineno"> 1820</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1821</span>        assert_equal(i[0], 0)</div>
<div class="line"><span class="lineno"> 1822</span>        i[1] = 1</div>
<div class="line"><span class="lineno"> 1823</span>        assert_equal(i[0:2], [0, 1])</div>
<div class="line"><span class="lineno"> 1824</span>        assert_equal([[x[0][()], x[1][()]] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], list(zip(range(6), [1]*6)))</div>
<div class="line"><span class="lineno"> 1825</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa9e165128658f622c2178821df73e5e5" name="aa9e165128658f622c2178821df73e5e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9e165128658f622c2178821df73e5e5">&#9670;&#160;</a></span>test_iter_buffering_growinner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffering_growinner </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2268</span><span class="keyword">def </span>test_iter_buffering_growinner():</div>
<div class="line"><span class="lineno"> 2269</span>    <span class="comment"># Test that the inner loop grows when no buffering is needed</span></div>
<div class="line"><span class="lineno"> 2270</span>    a = np.arange(30)</div>
<div class="line"><span class="lineno"> 2271</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;growinner&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2272</span>                           buffersize=5)</div>
<div class="line"><span class="lineno"> 2273</span>    <span class="comment"># Should end up with just one inner loop here</span></div>
<div class="line"><span class="lineno"> 2274</span>    assert_equal(i[0].size, a.size)</div>
<div class="line"><span class="lineno"> 2275</span> </div>
<div class="line"><span class="lineno"> 2276</span> </div>
<div class="line"><span class="lineno"> 2277</span><span class="preprocessor">@pytest.mark.slow</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a94beae8767dc23577d6f1e7019b6ea4a" name="a94beae8767dc23577d6f1e7019b6ea4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94beae8767dc23577d6f1e7019b6ea4a">&#9670;&#160;</a></span>test_iter_buffering_reduction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffering_reduction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2596</span><span class="keyword">def </span>test_iter_buffering_reduction():</div>
<div class="line"><span class="lineno"> 2597</span>    <span class="comment"># Test doing buffered reductions with the iterator</span></div>
<div class="line"><span class="lineno"> 2598</span> </div>
<div class="line"><span class="lineno"> 2599</span>    a = np.arange(6)</div>
<div class="line"><span class="lineno"> 2600</span>    b = np.array(0., dtype=<span class="stringliteral">&#39;f8&#39;</span>).byteswap().newbyteorder()</div>
<div class="line"><span class="lineno"> 2601</span>    i = nditer([a, b], [<span class="stringliteral">&#39;reduce_ok&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 2602</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2603</span>                    op_axes=[[0], [-1]])</div>
<div class="line"><span class="lineno"> 2604</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 2605</span>        assert_equal(i[1].dtype, np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 2606</span>        assert_(i[1].dtype != b.dtype)</div>
<div class="line"><span class="lineno"> 2607</span>        <span class="comment"># Do the reduction</span></div>
<div class="line"><span class="lineno"> 2608</span>        <span class="keywordflow">for</span> x, y <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2609</span>            y[...] += x</div>
<div class="line"><span class="lineno"> 2610</span>    <span class="comment"># Since no axes were specified, should have allocated a scalar</span></div>
<div class="line"><span class="lineno"> 2611</span>    assert_equal(b, np.sum(a))</div>
<div class="line"><span class="lineno"> 2612</span> </div>
<div class="line"><span class="lineno"> 2613</span>    a = np.arange(6).reshape(2, 3)</div>
<div class="line"><span class="lineno"> 2614</span>    b = np.array([0, 0], dtype=<span class="stringliteral">&#39;f8&#39;</span>).byteswap().newbyteorder()</div>
<div class="line"><span class="lineno"> 2615</span>    i = nditer([a, b], [<span class="stringliteral">&#39;reduce_ok&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 2616</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2617</span>                    op_axes=[[0, 1], [0, -1]])</div>
<div class="line"><span class="lineno"> 2618</span>    <span class="comment"># Reduction shape/strides for the output</span></div>
<div class="line"><span class="lineno"> 2619</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 2620</span>        assert_equal(i[1].shape, (3,))</div>
<div class="line"><span class="lineno"> 2621</span>        assert_equal(i[1].strides, (0,))</div>
<div class="line"><span class="lineno"> 2622</span>        <span class="comment"># Do the reduction</span></div>
<div class="line"><span class="lineno"> 2623</span>        <span class="keywordflow">for</span> x, y <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2624</span>            <span class="comment"># Use a for loop instead of ``y[...] += x``</span></div>
<div class="line"><span class="lineno"> 2625</span>            <span class="comment"># (equivalent to ``y[...] = y[...].copy() + x``),</span></div>
<div class="line"><span class="lineno"> 2626</span>            <span class="comment"># because y has zero strides we use for the reduction</span></div>
<div class="line"><span class="lineno"> 2627</span>            <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(len(y)):</div>
<div class="line"><span class="lineno"> 2628</span>                y[j] += x[j]</div>
<div class="line"><span class="lineno"> 2629</span>    assert_equal(b, np.sum(a, axis=1))</div>
<div class="line"><span class="lineno"> 2630</span> </div>
<div class="line"><span class="lineno"> 2631</span>    <span class="comment"># Iterator inner double loop was wrong on this one</span></div>
<div class="line"><span class="lineno"> 2632</span>    p = np.arange(2) + 1</div>
<div class="line"><span class="lineno"> 2633</span>    it = np.nditer([p, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 2634</span>            [<span class="stringliteral">&#39;delay_bufalloc&#39;</span>, <span class="stringliteral">&#39;reduce_ok&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2635</span>            [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2636</span>            op_axes=[[-1, 0], [-1, -1]],</div>
<div class="line"><span class="lineno"> 2637</span>            itershape=(2, 2))</div>
<div class="line"><span class="lineno"> 2638</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 2639</span>        it.operands[1].fill(0)</div>
<div class="line"><span class="lineno"> 2640</span>        it.reset()</div>
<div class="line"><span class="lineno"> 2641</span>        assert_equal(it[0], [1, 2, 1, 2])</div>
<div class="line"><span class="lineno"> 2642</span> </div>
<div class="line"><span class="lineno"> 2643</span>    <span class="comment"># Iterator inner loop should take argument contiguity into account</span></div>
<div class="line"><span class="lineno"> 2644</span>    x = np.ones((7, 13, 8), np.int8)[4:6,1:11:6,1:5].transpose(1, 2, 0)</div>
<div class="line"><span class="lineno"> 2645</span>    x[...] = np.arange(x.size).reshape(x.shape)</div>
<div class="line"><span class="lineno"> 2646</span>    y_base = np.arange(4*4, dtype=np.int8).reshape(4, 4)</div>
<div class="line"><span class="lineno"> 2647</span>    y_base_copy = y_base.copy()</div>
<div class="line"><span class="lineno"> 2648</span>    y = y_base[::2,:,<span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno"> 2649</span> </div>
<div class="line"><span class="lineno"> 2650</span>    it = np.nditer([y, x],</div>
<div class="line"><span class="lineno"> 2651</span>                   [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>, <span class="stringliteral">&#39;reduce_ok&#39;</span>],</div>
<div class="line"><span class="lineno"> 2652</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2653</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 2654</span>        <span class="keywordflow">for</span> a, b <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 2655</span>            a.fill(2)</div>
<div class="line"><span class="lineno"> 2656</span> </div>
<div class="line"><span class="lineno"> 2657</span>    assert_equal(y_base[1::2], y_base_copy[1::2])</div>
<div class="line"><span class="lineno"> 2658</span>    assert_equal(y_base[::2], 2)</div>
<div class="line"><span class="lineno"> 2659</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a29099d9ed9fba0960fa6a5794e50c6c0" name="a29099d9ed9fba0960fa6a5794e50c6c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29099d9ed9fba0960fa6a5794e50c6c0">&#9670;&#160;</a></span>test_iter_buffering_reduction_reuse_reduce_loops()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffering_reduction_reuse_reduce_loops </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2660</span><span class="keyword">def </span>test_iter_buffering_reduction_reuse_reduce_loops():</div>
<div class="line"><span class="lineno"> 2661</span>    <span class="comment"># There was a bug triggering reuse of the reduce loop inappropriately,</span></div>
<div class="line"><span class="lineno"> 2662</span>    <span class="comment"># which caused processing to happen in unnecessarily small chunks</span></div>
<div class="line"><span class="lineno"> 2663</span>    <span class="comment"># and overran the buffer.</span></div>
<div class="line"><span class="lineno"> 2664</span> </div>
<div class="line"><span class="lineno"> 2665</span>    a = np.zeros((2, 7))</div>
<div class="line"><span class="lineno"> 2666</span>    b = np.zeros((1, 7))</div>
<div class="line"><span class="lineno"> 2667</span>    it = np.nditer([a, b], flags=[<span class="stringliteral">&#39;reduce_ok&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 2668</span>                    op_flags=[[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2669</span>                    buffersize=5)</div>
<div class="line"><span class="lineno"> 2670</span> </div>
<div class="line"><span class="lineno"> 2671</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 2672</span>        bufsizes = [x.shape[0] <span class="keywordflow">for</span> x, y <span class="keywordflow">in</span> it]</div>
<div class="line"><span class="lineno"> 2673</span>    assert_equal(bufsizes, [5, 2, 5, 2])</div>
<div class="line"><span class="lineno"> 2674</span>    assert_equal(sum(bufsizes), a.size)</div>
<div class="line"><span class="lineno"> 2675</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a087951853dd6672a4b9a56c110cda3dc" name="a087951853dd6672a4b9a56c110cda3dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a087951853dd6672a4b9a56c110cda3dc">&#9670;&#160;</a></span>test_iter_buffering_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_buffering_string </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2250</span><span class="keyword">def </span>test_iter_buffering_string():</div>
<div class="line"><span class="lineno"> 2251</span>    <span class="comment"># Safe casting disallows shrinking strings</span></div>
<div class="line"><span class="lineno"> 2252</span>    a = np.array([<span class="stringliteral">&#39;abc&#39;</span>, <span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;abcd&#39;</span>], dtype=np.bytes_)</div>
<div class="line"><span class="lineno"> 2253</span>    assert_equal(a.dtype, np.dtype(<span class="stringliteral">&#39;S4&#39;</span>))</div>
<div class="line"><span class="lineno"> 2254</span>    assert_raises(TypeError, nditer, a, [<span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2255</span>                  op_dtypes=<span class="stringliteral">&#39;S2&#39;</span>)</div>
<div class="line"><span class="lineno"> 2256</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], op_dtypes=<span class="stringliteral">&#39;S6&#39;</span>)</div>
<div class="line"><span class="lineno"> 2257</span>    assert_equal(i[0], b<span class="stringliteral">&#39;abc&#39;</span>)</div>
<div class="line"><span class="lineno"> 2258</span>    assert_equal(i[0].dtype, np.dtype(<span class="stringliteral">&#39;S6&#39;</span>))</div>
<div class="line"><span class="lineno"> 2259</span> </div>
<div class="line"><span class="lineno"> 2260</span>    a = np.array([<span class="stringliteral">&#39;abc&#39;</span>, <span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;abcd&#39;</span>], dtype=np.unicode_)</div>
<div class="line"><span class="lineno"> 2261</span>    assert_equal(a.dtype, np.dtype(<span class="stringliteral">&#39;U4&#39;</span>))</div>
<div class="line"><span class="lineno"> 2262</span>    assert_raises(TypeError, nditer, a, [<span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2263</span>                    op_dtypes=<span class="stringliteral">&#39;U2&#39;</span>)</div>
<div class="line"><span class="lineno"> 2264</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], op_dtypes=<span class="stringliteral">&#39;U6&#39;</span>)</div>
<div class="line"><span class="lineno"> 2265</span>    assert_equal(i[0], <span class="stringliteral">&#39;abc&#39;</span>)</div>
<div class="line"><span class="lineno"> 2266</span>    assert_equal(i[0].dtype, np.dtype(<span class="stringliteral">&#39;U6&#39;</span>))</div>
<div class="line"><span class="lineno"> 2267</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa4518dcd877a74990101f4f668b852bd" name="aa4518dcd877a74990101f4f668b852bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4518dcd877a74990101f4f668b852bd">&#9670;&#160;</a></span>test_iter_c_or_f_order()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_c_or_f_order </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  161</span><span class="keyword">def </span>test_iter_c_or_f_order():</div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># Test forcing any contiguous (C or F) order</span></div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>    <span class="comment"># Test the ordering for 1-D to 5-D shapes</span></div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">for</span> shape <span class="keywordflow">in</span> [(5,), (3, 4), (2, 3, 4), (2, 3, 4, 3), (2, 3, 2, 2, 3)]:</div>
<div class="line"><span class="lineno">  166</span>        a = arange(np.prod(shape))</div>
<div class="line"><span class="lineno">  167</span>        <span class="comment"># Test each combination of positive and negative strides</span></div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">for</span> dirs <span class="keywordflow">in</span> range(2**len(shape)):</div>
<div class="line"><span class="lineno">  169</span>            dirs_index = [slice(<span class="keywordtype">None</span>)]*len(shape)</div>
<div class="line"><span class="lineno">  170</span>            <span class="keywordflow">for</span> bit <span class="keywordflow">in</span> range(len(shape)):</div>
<div class="line"><span class="lineno">  171</span>                <span class="keywordflow">if</span> ((2**bit) &amp; dirs):</div>
<div class="line"><span class="lineno">  172</span>                    dirs_index[bit] = slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)</div>
<div class="line"><span class="lineno">  173</span>            dirs_index = tuple(dirs_index)</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>            aview = a.reshape(shape)[dirs_index]</div>
<div class="line"><span class="lineno">  176</span>            <span class="comment"># C-order</span></div>
<div class="line"><span class="lineno">  177</span>            i = nditer(aview, order=<span class="stringliteral">&#39;A&#39;</span>)</div>
<div class="line"><span class="lineno">  178</span>            assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], aview.ravel(order=<span class="stringliteral">&#39;A&#39;</span>))</div>
<div class="line"><span class="lineno">  179</span>            <span class="comment"># Fortran-order</span></div>
<div class="line"><span class="lineno">  180</span>            i = nditer(aview.T, order=<span class="stringliteral">&#39;A&#39;</span>)</div>
<div class="line"><span class="lineno">  181</span>            assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], aview.T.ravel(order=<span class="stringliteral">&#39;A&#39;</span>))</div>
<div class="line"><span class="lineno">  182</span>            <span class="comment"># Other order</span></div>
<div class="line"><span class="lineno">  183</span>            <span class="keywordflow">if</span> len(shape) &gt; 2:</div>
<div class="line"><span class="lineno">  184</span>                i = nditer(aview.swapaxes(0, 1), order=<span class="stringliteral">&#39;A&#39;</span>)</div>
<div class="line"><span class="lineno">  185</span>                assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i],</div>
<div class="line"><span class="lineno">  186</span>                                    aview.swapaxes(0, 1).ravel(order=<span class="stringliteral">&#39;A&#39;</span>))</div>
<div class="line"><span class="lineno">  187</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7484b1c6e4cc1cf233acc0e90259e8b2" name="a7484b1c6e4cc1cf233acc0e90259e8b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7484b1c6e4cc1cf233acc0e90259e8b2">&#9670;&#160;</a></span>test_iter_c_order()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_c_order </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  107</span><span class="keyword">def </span>test_iter_c_order():</div>
<div class="line"><span class="lineno">  108</span>    <span class="comment"># Test forcing C order</span></div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="comment"># Test the ordering for 1-D to 5-D shapes</span></div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">for</span> shape <span class="keywordflow">in</span> [(5,), (3, 4), (2, 3, 4), (2, 3, 4, 3), (2, 3, 2, 2, 3)]:</div>
<div class="line"><span class="lineno">  112</span>        a = arange(np.prod(shape))</div>
<div class="line"><span class="lineno">  113</span>        <span class="comment"># Test each combination of positive and negative strides</span></div>
<div class="line"><span class="lineno">  114</span>        <span class="keywordflow">for</span> dirs <span class="keywordflow">in</span> range(2**len(shape)):</div>
<div class="line"><span class="lineno">  115</span>            dirs_index = [slice(<span class="keywordtype">None</span>)]*len(shape)</div>
<div class="line"><span class="lineno">  116</span>            <span class="keywordflow">for</span> bit <span class="keywordflow">in</span> range(len(shape)):</div>
<div class="line"><span class="lineno">  117</span>                <span class="keywordflow">if</span> ((2**bit) &amp; dirs):</div>
<div class="line"><span class="lineno">  118</span>                    dirs_index[bit] = slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)</div>
<div class="line"><span class="lineno">  119</span>            dirs_index = tuple(dirs_index)</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>            aview = a.reshape(shape)[dirs_index]</div>
<div class="line"><span class="lineno">  122</span>            <span class="comment"># C-order</span></div>
<div class="line"><span class="lineno">  123</span>            i = nditer(aview, order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno">  124</span>            assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], aview.ravel(order=<span class="stringliteral">&#39;C&#39;</span>))</div>
<div class="line"><span class="lineno">  125</span>            <span class="comment"># Fortran-order</span></div>
<div class="line"><span class="lineno">  126</span>            i = nditer(aview.T, order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno">  127</span>            assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], aview.T.ravel(order=<span class="stringliteral">&#39;C&#39;</span>))</div>
<div class="line"><span class="lineno">  128</span>            <span class="comment"># Other order</span></div>
<div class="line"><span class="lineno">  129</span>            <span class="keywordflow">if</span> len(shape) &gt; 2:</div>
<div class="line"><span class="lineno">  130</span>                i = nditer(aview.swapaxes(0, 1), order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno">  131</span>                assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i],</div>
<div class="line"><span class="lineno">  132</span>                                    aview.swapaxes(0, 1).ravel(order=<span class="stringliteral">&#39;C&#39;</span>))</div>
<div class="line"><span class="lineno">  133</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac428ff0cc17ced64320553131a277c56" name="ac428ff0cc17ced64320553131a277c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac428ff0cc17ced64320553131a277c56">&#9670;&#160;</a></span>test_iter_common_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_common_dtype </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1129</span><span class="keyword">def </span>test_iter_common_dtype():</div>
<div class="line"><span class="lineno"> 1130</span>    <span class="comment"># Check that the iterator finds a common data type correctly</span></div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;f4&#39;</span>), array([0], dtype=<span class="stringliteral">&#39;f8&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1133</span>                    [<span class="stringliteral">&#39;common_dtype&#39;</span>],</div>
<div class="line"><span class="lineno"> 1134</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1135</span>                    casting=<span class="stringliteral">&#39;safe&#39;</span>)</div>
<div class="line"><span class="lineno"> 1136</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1137</span>    assert_equal(i.dtypes[1], np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1138</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;i4&#39;</span>), array([0], dtype=<span class="stringliteral">&#39;f4&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1139</span>                    [<span class="stringliteral">&#39;common_dtype&#39;</span>],</div>
<div class="line"><span class="lineno"> 1140</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1141</span>                    casting=<span class="stringliteral">&#39;safe&#39;</span>)</div>
<div class="line"><span class="lineno"> 1142</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1143</span>    assert_equal(i.dtypes[1], np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1144</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;f4&#39;</span>), array(0, dtype=<span class="stringliteral">&#39;f8&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1145</span>                    [<span class="stringliteral">&#39;common_dtype&#39;</span>],</div>
<div class="line"><span class="lineno"> 1146</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1147</span>                    casting=<span class="stringliteral">&#39;same_kind&#39;</span>)</div>
<div class="line"><span class="lineno"> 1148</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1149</span>    assert_equal(i.dtypes[1], np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1150</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;u4&#39;</span>), array(0, dtype=<span class="stringliteral">&#39;i4&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1151</span>                    [<span class="stringliteral">&#39;common_dtype&#39;</span>],</div>
<div class="line"><span class="lineno"> 1152</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1153</span>                    casting=<span class="stringliteral">&#39;safe&#39;</span>)</div>
<div class="line"><span class="lineno"> 1154</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;u4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1155</span>    assert_equal(i.dtypes[1], np.dtype(<span class="stringliteral">&#39;u4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1156</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;u4&#39;</span>), array(-12, dtype=<span class="stringliteral">&#39;i4&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1157</span>                    [<span class="stringliteral">&#39;common_dtype&#39;</span>],</div>
<div class="line"><span class="lineno"> 1158</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1159</span>                    casting=<span class="stringliteral">&#39;safe&#39;</span>)</div>
<div class="line"><span class="lineno"> 1160</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;i8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1161</span>    assert_equal(i.dtypes[1], np.dtype(<span class="stringliteral">&#39;i8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1162</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;u4&#39;</span>), array(-12, dtype=<span class="stringliteral">&#39;i4&#39;</span>),</div>
<div class="line"><span class="lineno"> 1163</span>                 array([2j], dtype=<span class="stringliteral">&#39;c8&#39;</span>), array([9], dtype=<span class="stringliteral">&#39;f8&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1164</span>                    [<span class="stringliteral">&#39;common_dtype&#39;</span>],</div>
<div class="line"><span class="lineno"> 1165</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]]*4,</div>
<div class="line"><span class="lineno"> 1166</span>                    casting=<span class="stringliteral">&#39;safe&#39;</span>)</div>
<div class="line"><span class="lineno"> 1167</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;c16&#39;</span>))</div>
<div class="line"><span class="lineno"> 1168</span>    assert_equal(i.dtypes[1], np.dtype(<span class="stringliteral">&#39;c16&#39;</span>))</div>
<div class="line"><span class="lineno"> 1169</span>    assert_equal(i.dtypes[2], np.dtype(<span class="stringliteral">&#39;c16&#39;</span>))</div>
<div class="line"><span class="lineno"> 1170</span>    assert_equal(i.dtypes[3], np.dtype(<span class="stringliteral">&#39;c16&#39;</span>))</div>
<div class="line"><span class="lineno"> 1171</span>    assert_equal(i.value, (3, -12, 2j, 9))</div>
<div class="line"><span class="lineno"> 1172</span> </div>
<div class="line"><span class="lineno"> 1173</span>    <span class="comment"># When allocating outputs, other outputs aren&#39;t factored in</span></div>
<div class="line"><span class="lineno"> 1174</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;i4&#39;</span>), <span class="keywordtype">None</span>, array([2j], dtype=<span class="stringliteral">&#39;c16&#39;</span>)], [],</div>
<div class="line"><span class="lineno"> 1175</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>],</div>
<div class="line"><span class="lineno"> 1176</span>                     [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>],</div>
<div class="line"><span class="lineno"> 1177</span>                     [<span class="stringliteral">&#39;writeonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1178</span>                    casting=<span class="stringliteral">&#39;safe&#39;</span>)</div>
<div class="line"><span class="lineno"> 1179</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;i4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1180</span>    assert_equal(i.dtypes[1], np.dtype(<span class="stringliteral">&#39;i4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1181</span>    assert_equal(i.dtypes[2], np.dtype(<span class="stringliteral">&#39;c16&#39;</span>))</div>
<div class="line"><span class="lineno"> 1182</span>    <span class="comment"># But, if common data types are requested, they are</span></div>
<div class="line"><span class="lineno"> 1183</span>    i = nditer([array([3], dtype=<span class="stringliteral">&#39;i4&#39;</span>), <span class="keywordtype">None</span>, array([2j], dtype=<span class="stringliteral">&#39;c16&#39;</span>)],</div>
<div class="line"><span class="lineno"> 1184</span>                    [<span class="stringliteral">&#39;common_dtype&#39;</span>],</div>
<div class="line"><span class="lineno"> 1185</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>],</div>
<div class="line"><span class="lineno"> 1186</span>                     [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>],</div>
<div class="line"><span class="lineno"> 1187</span>                     [<span class="stringliteral">&#39;writeonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1188</span>                    casting=<span class="stringliteral">&#39;safe&#39;</span>)</div>
<div class="line"><span class="lineno"> 1189</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;c16&#39;</span>))</div>
<div class="line"><span class="lineno"> 1190</span>    assert_equal(i.dtypes[1], np.dtype(<span class="stringliteral">&#39;c16&#39;</span>))</div>
<div class="line"><span class="lineno"> 1191</span>    assert_equal(i.dtypes[2], np.dtype(<span class="stringliteral">&#39;c16&#39;</span>))</div>
<div class="line"><span class="lineno"> 1192</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a320bcc59ac19bcbfad5aec8ffff25ed0" name="a320bcc59ac19bcbfad5aec8ffff25ed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a320bcc59ac19bcbfad5aec8ffff25ed0">&#9670;&#160;</a></span>test_iter_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_copy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1347</span><span class="keyword">def </span>test_iter_copy():</div>
<div class="line"><span class="lineno"> 1348</span>    <span class="comment"># Check that copying the iterator works correctly</span></div>
<div class="line"><span class="lineno"> 1349</span>    a = arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1350</span> </div>
<div class="line"><span class="lineno"> 1351</span>    <span class="comment"># Simple iterator</span></div>
<div class="line"><span class="lineno"> 1352</span>    i = nditer(a)</div>
<div class="line"><span class="lineno"> 1353</span>    j = i.copy()</div>
<div class="line"><span class="lineno"> 1354</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], [x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> j])</div>
<div class="line"><span class="lineno"> 1355</span> </div>
<div class="line"><span class="lineno"> 1356</span>    i.iterindex = 3</div>
<div class="line"><span class="lineno"> 1357</span>    j = i.copy()</div>
<div class="line"><span class="lineno"> 1358</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], [x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> j])</div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span>    <span class="comment"># Buffered iterator</span></div>
<div class="line"><span class="lineno"> 1361</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;ranged&#39;</span>], order=<span class="stringliteral">&#39;F&#39;</span>, buffersize=3)</div>
<div class="line"><span class="lineno"> 1362</span>    j = i.copy()</div>
<div class="line"><span class="lineno"> 1363</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], [x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> j])</div>
<div class="line"><span class="lineno"> 1364</span> </div>
<div class="line"><span class="lineno"> 1365</span>    i.iterindex = 3</div>
<div class="line"><span class="lineno"> 1366</span>    j = i.copy()</div>
<div class="line"><span class="lineno"> 1367</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], [x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> j])</div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span>    i.iterrange = (3, 9)</div>
<div class="line"><span class="lineno"> 1370</span>    j = i.copy()</div>
<div class="line"><span class="lineno"> 1371</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], [x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> j])</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>    i.iterrange = (2, 18)</div>
<div class="line"><span class="lineno"> 1374</span>    next(i)</div>
<div class="line"><span class="lineno"> 1375</span>    next(i)</div>
<div class="line"><span class="lineno"> 1376</span>    j = i.copy()</div>
<div class="line"><span class="lineno"> 1377</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], [x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> j])</div>
<div class="line"><span class="lineno"> 1378</span> </div>
<div class="line"><span class="lineno"> 1379</span>    <span class="comment"># Casting iterator</span></div>
<div class="line"><span class="lineno"> 1380</span>    <span class="keyword">with</span> nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>], order=<span class="stringliteral">&#39;F&#39;</span>, casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1381</span>                op_dtypes=<span class="stringliteral">&#39;f8&#39;</span>, buffersize=5) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno"> 1382</span>        j = i.copy()</div>
<div class="line"><span class="lineno"> 1383</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> j], a.ravel(order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span>    a = arange(24, dtype=<span class="stringliteral">&#39;&lt;i4&#39;</span>).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1386</span>    <span class="keyword">with</span> nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>], order=<span class="stringliteral">&#39;F&#39;</span>, casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1387</span>                op_dtypes=<span class="stringliteral">&#39;&gt;f8&#39;</span>, buffersize=5) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno"> 1388</span>        j = i.copy()</div>
<div class="line"><span class="lineno"> 1389</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> j], a.ravel(order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span> </div>
<div class="line"><span class="lineno"> 1392</span><span class="preprocessor">@pytest.mark.parametrize(&quot;dtype&quot;, np.typecodes[&quot;All&quot;])</span></div>
<div class="line"><span class="lineno"> 1393</span><span class="preprocessor">@pytest.mark.parametrize(&quot;loop_dtype&quot;, np.typecodes[&quot;All&quot;])</span></div>
<div class="line"><span class="lineno"> 1394</span><span class="preprocessor">@pytest.mark.filterwarnings(&quot;ignore::numpy.ComplexWarning&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d3d360351b13d424b829d09d1692c7a" name="a3d3d360351b13d424b829d09d1692c7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d3d360351b13d424b829d09d1692c7a">&#9670;&#160;</a></span>test_iter_copy_casts()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_copy_casts </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>loop_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1395</span><span class="keyword">def </span>test_iter_copy_casts(dtype, loop_dtype):</div>
<div class="line"><span class="lineno"> 1396</span>    <span class="comment"># Ensure the dtype is never flexible:</span></div>
<div class="line"><span class="lineno"> 1397</span>    <span class="keywordflow">if</span> loop_dtype.lower() == <span class="stringliteral">&quot;m&quot;</span>:</div>
<div class="line"><span class="lineno"> 1398</span>        loop_dtype = loop_dtype + <span class="stringliteral">&quot;[ms]&quot;</span></div>
<div class="line"><span class="lineno"> 1399</span>    <span class="keywordflow">elif</span> np.dtype(loop_dtype).itemsize == 0:</div>
<div class="line"><span class="lineno"> 1400</span>        loop_dtype = loop_dtype + <span class="stringliteral">&quot;50&quot;</span></div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span>    <span class="comment"># Make things a bit more interesting by requiring a byte-swap as well:</span></div>
<div class="line"><span class="lineno"> 1403</span>    arr = np.ones(1000, dtype=np.dtype(dtype).newbyteorder())</div>
<div class="line"><span class="lineno"> 1404</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 1405</span>        expected = arr.astype(loop_dtype)</div>
<div class="line"><span class="lineno"> 1406</span>    <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno"> 1407</span>        <span class="comment"># Some casts are not possible, do not worry about them</span></div>
<div class="line"><span class="lineno"> 1408</span>        <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>    it = np.nditer((arr,), [<span class="stringliteral">&quot;buffered&quot;</span>, <span class="stringliteral">&quot;external_loop&quot;</span>, <span class="stringliteral">&quot;refs_ok&quot;</span>],</div>
<div class="line"><span class="lineno"> 1411</span>                   op_dtypes=[loop_dtype], casting=<span class="stringliteral">&quot;unsafe&quot;</span>)</div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span>    <span class="keywordflow">if</span> np.issubdtype(np.dtype(loop_dtype), np.number):</div>
<div class="line"><span class="lineno"> 1414</span>        <span class="comment"># Casting to strings may be strange, but for simple dtypes do not rely</span></div>
<div class="line"><span class="lineno"> 1415</span>        <span class="comment"># on the cast being correct:</span></div>
<div class="line"><span class="lineno"> 1416</span>        assert_array_equal(expected, np.ones(1000, dtype=loop_dtype))</div>
<div class="line"><span class="lineno"> 1417</span> </div>
<div class="line"><span class="lineno"> 1418</span>    it_copy = it.copy()</div>
<div class="line"><span class="lineno"> 1419</span>    res = next(it)</div>
<div class="line"><span class="lineno"> 1420</span>    del it</div>
<div class="line"><span class="lineno"> 1421</span>    res_copy = next(it_copy)</div>
<div class="line"><span class="lineno"> 1422</span>    del it_copy</div>
<div class="line"><span class="lineno"> 1423</span> </div>
<div class="line"><span class="lineno"> 1424</span>    assert_array_equal(res, expected)</div>
<div class="line"><span class="lineno"> 1425</span>    assert_array_equal(res_copy, expected)</div>
<div class="line"><span class="lineno"> 1426</span> </div>
<div class="line"><span class="lineno"> 1427</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a000f3a911dd779ca675af0c4118ce5ee" name="a000f3a911dd779ca675af0c4118ce5ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a000f3a911dd779ca675af0c4118ce5ee">&#9670;&#160;</a></span>test_iter_copy_casts_structured()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_copy_casts_structured </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1428</span><span class="keyword">def </span>test_iter_copy_casts_structured():</div>
<div class="line"><span class="lineno"> 1429</span>    <span class="comment"># Test a complicated structured dtype for casting, as it requires</span></div>
<div class="line"><span class="lineno"> 1430</span>    <span class="comment"># both multiple steps and a more complex casting setup.</span></div>
<div class="line"><span class="lineno"> 1431</span>    <span class="comment"># Includes a structured -&gt; unstructured (any to object), and many other</span></div>
<div class="line"><span class="lineno"> 1432</span>    <span class="comment"># casts, which cause this to require all steps in the casting machinery</span></div>
<div class="line"><span class="lineno"> 1433</span>    <span class="comment"># one level down as well as the iterator copy (which uses NpyAuxData clone)</span></div>
<div class="line"><span class="lineno"> 1434</span>    in_dtype = np.dtype([(<span class="stringliteral">&quot;a&quot;</span>, np.dtype(<span class="stringliteral">&quot;i,&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1435</span>                         (<span class="stringliteral">&quot;b&quot;</span>, np.dtype(<span class="stringliteral">&quot;&gt;i,&lt;i,&gt;d,S17,&gt;d,(3)f,O,i1&quot;</span>))])</div>
<div class="line"><span class="lineno"> 1436</span>    out_dtype = np.dtype([(<span class="stringliteral">&quot;a&quot;</span>, np.dtype(<span class="stringliteral">&quot;O&quot;</span>)),</div>
<div class="line"><span class="lineno"> 1437</span>                          (<span class="stringliteral">&quot;b&quot;</span>, np.dtype(<span class="stringliteral">&quot;&gt;i,&gt;i,S17,&gt;d,&gt;U3,(3)d,i1,O&quot;</span>))])</div>
<div class="line"><span class="lineno"> 1438</span>    arr = np.ones(1000, dtype=in_dtype)</div>
<div class="line"><span class="lineno"> 1439</span> </div>
<div class="line"><span class="lineno"> 1440</span>    it = np.nditer((arr,), [<span class="stringliteral">&quot;buffered&quot;</span>, <span class="stringliteral">&quot;external_loop&quot;</span>, <span class="stringliteral">&quot;refs_ok&quot;</span>],</div>
<div class="line"><span class="lineno"> 1441</span>                   op_dtypes=[out_dtype], casting=<span class="stringliteral">&quot;unsafe&quot;</span>)</div>
<div class="line"><span class="lineno"> 1442</span>    it_copy = it.copy()</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>    res1 = next(it)</div>
<div class="line"><span class="lineno"> 1445</span>    del it</div>
<div class="line"><span class="lineno"> 1446</span>    res2 = next(it_copy)</div>
<div class="line"><span class="lineno"> 1447</span>    del it_copy</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>    expected = arr[<span class="stringliteral">&quot;a&quot;</span>].astype(out_dtype[<span class="stringliteral">&quot;a&quot;</span>])</div>
<div class="line"><span class="lineno"> 1450</span>    assert_array_equal(res1[<span class="stringliteral">&quot;a&quot;</span>], expected)</div>
<div class="line"><span class="lineno"> 1451</span>    assert_array_equal(res2[<span class="stringliteral">&quot;a&quot;</span>], expected)</div>
<div class="line"><span class="lineno"> 1452</span> </div>
<div class="line"><span class="lineno"> 1453</span>    <span class="keywordflow">for</span> field <span class="keywordflow">in</span> in_dtype[<span class="stringliteral">&quot;b&quot;</span>].names:</div>
<div class="line"><span class="lineno"> 1454</span>        <span class="comment"># Note that the .base avoids the subarray field</span></div>
<div class="line"><span class="lineno"> 1455</span>        expected = arr[<span class="stringliteral">&quot;b&quot;</span>][field].astype(out_dtype[<span class="stringliteral">&quot;b&quot;</span>][field].base)</div>
<div class="line"><span class="lineno"> 1456</span>        assert_array_equal(res1[<span class="stringliteral">&quot;b&quot;</span>][field], expected)</div>
<div class="line"><span class="lineno"> 1457</span>        assert_array_equal(res2[<span class="stringliteral">&quot;b&quot;</span>][field], expected)</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f11f8ee8f601d552e2e10c1e96698d1" name="a7f11f8ee8f601d552e2e10c1e96698d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f11f8ee8f601d552e2e10c1e96698d1">&#9670;&#160;</a></span>test_iter_copy_if_overlap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_copy_if_overlap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1193</span><span class="keyword">def </span>test_iter_copy_if_overlap():</div>
<div class="line"><span class="lineno"> 1194</span>    <span class="comment"># Ensure the iterator makes copies on read/write overlap, if requested</span></div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>    <span class="comment"># Copy not needed, 1 op</span></div>
<div class="line"><span class="lineno"> 1197</span>    <span class="keywordflow">for</span> flag <span class="keywordflow">in</span> [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;readwrite&#39;</span>]:</div>
<div class="line"><span class="lineno"> 1198</span>        a = arange(10)</div>
<div class="line"><span class="lineno"> 1199</span>        i = nditer([a], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>], [[flag]])</div>
<div class="line"><span class="lineno"> 1200</span>        <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1201</span>            assert_(i.operands[0] <span class="keywordflow">is</span> a)</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span>    <span class="comment"># Copy needed, 2 ops, read-write overlap</span></div>
<div class="line"><span class="lineno"> 1204</span>    x = arange(10)</div>
<div class="line"><span class="lineno"> 1205</span>    a = x[1:]</div>
<div class="line"><span class="lineno"> 1206</span>    b = x[:-1]</div>
<div class="line"><span class="lineno"> 1207</span>    <span class="keyword">with</span> nditer([a, b], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>]]) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno"> 1208</span>        assert_(<span class="keywordflow">not</span> np.shares_memory(*i.operands))</div>
<div class="line"><span class="lineno"> 1209</span> </div>
<div class="line"><span class="lineno"> 1210</span>    <span class="comment"># Copy not needed with elementwise, 2 ops, exactly same arrays</span></div>
<div class="line"><span class="lineno"> 1211</span>    x = arange(10)</div>
<div class="line"><span class="lineno"> 1212</span>    a = x</div>
<div class="line"><span class="lineno"> 1213</span>    b = x</div>
<div class="line"><span class="lineno"> 1214</span>    i = nditer([a, b], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;overlap_assume_elementwise&#39;</span>],</div>
<div class="line"><span class="lineno"> 1215</span>                                             [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;overlap_assume_elementwise&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1216</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1217</span>        assert_(i.operands[0] <span class="keywordflow">is</span> a <span class="keywordflow">and</span> i.operands[1] <span class="keywordflow">is</span> b)</div>
<div class="line"><span class="lineno"> 1218</span>    <span class="keyword">with</span> nditer([a, b], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>]]) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno"> 1219</span>        assert_(i.operands[0] <span class="keywordflow">is</span> a <span class="keywordflow">and</span> <span class="keywordflow">not</span> np.shares_memory(i.operands[1], b))</div>
<div class="line"><span class="lineno"> 1220</span> </div>
<div class="line"><span class="lineno"> 1221</span>    <span class="comment"># Copy not needed, 2 ops, no overlap</span></div>
<div class="line"><span class="lineno"> 1222</span>    x = arange(10)</div>
<div class="line"><span class="lineno"> 1223</span>    a = x[::2]</div>
<div class="line"><span class="lineno"> 1224</span>    b = x[1::2]</div>
<div class="line"><span class="lineno"> 1225</span>    i = nditer([a, b], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1226</span>    assert_(i.operands[0] <span class="keywordflow">is</span> a <span class="keywordflow">and</span> i.operands[1] <span class="keywordflow">is</span> b)</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>    <span class="comment"># Copy needed, 2 ops, read-write overlap</span></div>
<div class="line"><span class="lineno"> 1229</span>    x = arange(4, dtype=np.int8)</div>
<div class="line"><span class="lineno"> 1230</span>    a = x[3:]</div>
<div class="line"><span class="lineno"> 1231</span>    b = x.view(np.int32)[:1]</div>
<div class="line"><span class="lineno"> 1232</span>    <span class="keyword">with</span> nditer([a, b], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>]]) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno"> 1233</span>        assert_(<span class="keywordflow">not</span> np.shares_memory(*i.operands))</div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>    <span class="comment"># Copy needed, 3 ops, read-write overlap</span></div>
<div class="line"><span class="lineno"> 1236</span>    <span class="keywordflow">for</span> flag <span class="keywordflow">in</span> [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;readwrite&#39;</span>]:</div>
<div class="line"><span class="lineno"> 1237</span>        x = np.ones([10, 10])</div>
<div class="line"><span class="lineno"> 1238</span>        a = x</div>
<div class="line"><span class="lineno"> 1239</span>        b = x.T</div>
<div class="line"><span class="lineno"> 1240</span>        c = x</div>
<div class="line"><span class="lineno"> 1241</span>        <span class="keyword">with</span> nditer([a, b, c], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>],</div>
<div class="line"><span class="lineno"> 1242</span>                   [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], [flag]]) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno"> 1243</span>            a2, b2, c2 = i.operands</div>
<div class="line"><span class="lineno"> 1244</span>            assert_(<span class="keywordflow">not</span> np.shares_memory(a2, c2))</div>
<div class="line"><span class="lineno"> 1245</span>            assert_(<span class="keywordflow">not</span> np.shares_memory(b2, c2))</div>
<div class="line"><span class="lineno"> 1246</span> </div>
<div class="line"><span class="lineno"> 1247</span>    <span class="comment"># Copy not needed, 3 ops, read-only overlap</span></div>
<div class="line"><span class="lineno"> 1248</span>    x = np.ones([10, 10])</div>
<div class="line"><span class="lineno"> 1249</span>    a = x</div>
<div class="line"><span class="lineno"> 1250</span>    b = x.T</div>
<div class="line"><span class="lineno"> 1251</span>    c = x</div>
<div class="line"><span class="lineno"> 1252</span>    i = nditer([a, b, c], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>],</div>
<div class="line"><span class="lineno"> 1253</span>               [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1254</span>    a2, b2, c2 = i.operands</div>
<div class="line"><span class="lineno"> 1255</span>    assert_(a <span class="keywordflow">is</span> a2)</div>
<div class="line"><span class="lineno"> 1256</span>    assert_(b <span class="keywordflow">is</span> b2)</div>
<div class="line"><span class="lineno"> 1257</span>    assert_(c <span class="keywordflow">is</span> c2)</div>
<div class="line"><span class="lineno"> 1258</span> </div>
<div class="line"><span class="lineno"> 1259</span>    <span class="comment"># Copy not needed, 3 ops, read-only overlap</span></div>
<div class="line"><span class="lineno"> 1260</span>    x = np.ones([10, 10])</div>
<div class="line"><span class="lineno"> 1261</span>    a = x</div>
<div class="line"><span class="lineno"> 1262</span>    b = np.ones([10, 10])</div>
<div class="line"><span class="lineno"> 1263</span>    c = x.T</div>
<div class="line"><span class="lineno"> 1264</span>    i = nditer([a, b, c], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>],</div>
<div class="line"><span class="lineno"> 1265</span>               [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1266</span>    a2, b2, c2 = i.operands</div>
<div class="line"><span class="lineno"> 1267</span>    assert_(a <span class="keywordflow">is</span> a2)</div>
<div class="line"><span class="lineno"> 1268</span>    assert_(b <span class="keywordflow">is</span> b2)</div>
<div class="line"><span class="lineno"> 1269</span>    assert_(c <span class="keywordflow">is</span> c2)</div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span>    <span class="comment"># Copy not needed, 3 ops, write-only overlap</span></div>
<div class="line"><span class="lineno"> 1272</span>    x = np.arange(7)</div>
<div class="line"><span class="lineno"> 1273</span>    a = x[:3]</div>
<div class="line"><span class="lineno"> 1274</span>    b = x[3:6]</div>
<div class="line"><span class="lineno"> 1275</span>    c = x[4:7]</div>
<div class="line"><span class="lineno"> 1276</span>    i = nditer([a, b, c], [<span class="stringliteral">&#39;copy_if_overlap&#39;</span>],</div>
<div class="line"><span class="lineno"> 1277</span>               [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 1278</span>    a2, b2, c2 = i.operands</div>
<div class="line"><span class="lineno"> 1279</span>    assert_(a <span class="keywordflow">is</span> a2)</div>
<div class="line"><span class="lineno"> 1280</span>    assert_(b <span class="keywordflow">is</span> b2)</div>
<div class="line"><span class="lineno"> 1281</span>    assert_(c <span class="keywordflow">is</span> c2)</div>
<div class="line"><span class="lineno"> 1282</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a86ad552d873201bcce1bfca166297476" name="a86ad552d873201bcce1bfca166297476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86ad552d873201bcce1bfca166297476">&#9670;&#160;</a></span>test_iter_dim_coalescing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_dim_coalescing </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  501</span><span class="keyword">def </span>test_iter_dim_coalescing():</div>
<div class="line"><span class="lineno">  502</span>    <span class="comment"># Check that the correct number of dimensions are coalesced</span></div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="comment"># Tracking a multi-index disables coalescing</span></div>
<div class="line"><span class="lineno">  505</span>    a = arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno">  506</span>    i = nditer(a, [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  507</span>    assert_equal(i.ndim, 3)</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>    <span class="comment"># A tracked index can allow coalescing if it&#39;s compatible with the array</span></div>
<div class="line"><span class="lineno">  510</span>    a3d = arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno">  511</span>    i = nditer(a3d, [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  512</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  513</span>    i = nditer(a3d.swapaxes(0, 1), [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  514</span>    assert_equal(i.ndim, 3)</div>
<div class="line"><span class="lineno">  515</span>    i = nditer(a3d.T, [<span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  516</span>    assert_equal(i.ndim, 3)</div>
<div class="line"><span class="lineno">  517</span>    i = nditer(a3d.T, [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  518</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  519</span>    i = nditer(a3d.T.swapaxes(0, 1), [<span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  520</span>    assert_equal(i.ndim, 3)</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="comment"># When C or F order is forced, coalescing may still occur</span></div>
<div class="line"><span class="lineno">  523</span>    a3d = arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno">  524</span>    i = nditer(a3d, order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno">  525</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  526</span>    i = nditer(a3d.T, order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno">  527</span>    assert_equal(i.ndim, 3)</div>
<div class="line"><span class="lineno">  528</span>    i = nditer(a3d, order=<span class="stringliteral">&#39;F&#39;</span>)</div>
<div class="line"><span class="lineno">  529</span>    assert_equal(i.ndim, 3)</div>
<div class="line"><span class="lineno">  530</span>    i = nditer(a3d.T, order=<span class="stringliteral">&#39;F&#39;</span>)</div>
<div class="line"><span class="lineno">  531</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  532</span>    i = nditer(a3d, order=<span class="stringliteral">&#39;A&#39;</span>)</div>
<div class="line"><span class="lineno">  533</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  534</span>    i = nditer(a3d.T, order=<span class="stringliteral">&#39;A&#39;</span>)</div>
<div class="line"><span class="lineno">  535</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  536</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3af524c5adc22f76b466026d72fe9ae" name="ad3af524c5adc22f76b466026d72fe9ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3af524c5adc22f76b466026d72fe9ae">&#9670;&#160;</a></span>test_iter_element_deletion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_element_deletion </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2894</span><span class="keyword">def </span>test_iter_element_deletion():</div>
<div class="line"><span class="lineno"> 2895</span>    it = np.nditer(np.ones(3))</div>
<div class="line"><span class="lineno"> 2896</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2897</span>        del it[1]</div>
<div class="line"><span class="lineno"> 2898</span>        del it[1:2]</div>
<div class="line"><span class="lineno"> 2899</span>    <span class="keywordflow">except</span> TypeError:</div>
<div class="line"><span class="lineno"> 2900</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 2901</span>    <span class="keywordflow">except</span> Exception:</div>
<div class="line"><span class="lineno"> 2902</span>        <span class="keywordflow">raise</span> AssertionError</div>
<div class="line"><span class="lineno"> 2903</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a68d841bafa9244a92620a16fef86a01f" name="a68d841bafa9244a92620a16fef86a01f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68d841bafa9244a92620a16fef86a01f">&#9670;&#160;</a></span>test_iter_f_order()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_f_order </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  134</span><span class="keyword">def </span>test_iter_f_order():</div>
<div class="line"><span class="lineno">  135</span>    <span class="comment"># Test forcing F order</span></div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="comment"># Test the ordering for 1-D to 5-D shapes</span></div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordflow">for</span> shape <span class="keywordflow">in</span> [(5,), (3, 4), (2, 3, 4), (2, 3, 4, 3), (2, 3, 2, 2, 3)]:</div>
<div class="line"><span class="lineno">  139</span>        a = arange(np.prod(shape))</div>
<div class="line"><span class="lineno">  140</span>        <span class="comment"># Test each combination of positive and negative strides</span></div>
<div class="line"><span class="lineno">  141</span>        <span class="keywordflow">for</span> dirs <span class="keywordflow">in</span> range(2**len(shape)):</div>
<div class="line"><span class="lineno">  142</span>            dirs_index = [slice(<span class="keywordtype">None</span>)]*len(shape)</div>
<div class="line"><span class="lineno">  143</span>            <span class="keywordflow">for</span> bit <span class="keywordflow">in</span> range(len(shape)):</div>
<div class="line"><span class="lineno">  144</span>                <span class="keywordflow">if</span> ((2**bit) &amp; dirs):</div>
<div class="line"><span class="lineno">  145</span>                    dirs_index[bit] = slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)</div>
<div class="line"><span class="lineno">  146</span>            dirs_index = tuple(dirs_index)</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>            aview = a.reshape(shape)[dirs_index]</div>
<div class="line"><span class="lineno">  149</span>            <span class="comment"># C-order</span></div>
<div class="line"><span class="lineno">  150</span>            i = nditer(aview, order=<span class="stringliteral">&#39;F&#39;</span>)</div>
<div class="line"><span class="lineno">  151</span>            assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], aview.ravel(order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno">  152</span>            <span class="comment"># Fortran-order</span></div>
<div class="line"><span class="lineno">  153</span>            i = nditer(aview.T, order=<span class="stringliteral">&#39;F&#39;</span>)</div>
<div class="line"><span class="lineno">  154</span>            assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], aview.T.ravel(order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno">  155</span>            <span class="comment"># Other order</span></div>
<div class="line"><span class="lineno">  156</span>            <span class="keywordflow">if</span> len(shape) &gt; 2:</div>
<div class="line"><span class="lineno">  157</span>                i = nditer(aview.swapaxes(0, 1), order=<span class="stringliteral">&#39;F&#39;</span>)</div>
<div class="line"><span class="lineno">  158</span>                assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i],</div>
<div class="line"><span class="lineno">  159</span>                                    aview.swapaxes(0, 1).ravel(order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno">  160</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a57f9cd3747e27c18ac7f28cd2966cbd9" name="a57f9cd3747e27c18ac7f28cd2966cbd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57f9cd3747e27c18ac7f28cd2966cbd9">&#9670;&#160;</a></span>test_iter_flags_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_flags_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  713</span><span class="keyword">def </span>test_iter_flags_errors():</div>
<div class="line"><span class="lineno">  714</span>    <span class="comment"># Check that bad combinations of flags produce errors</span></div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>    a = arange(6)</div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>    <span class="comment"># Not enough operands</span></div>
<div class="line"><span class="lineno">  719</span>    assert_raises(ValueError, nditer, [], [], [])</div>
<div class="line"><span class="lineno">  720</span>    <span class="comment"># Too many operands</span></div>
<div class="line"><span class="lineno">  721</span>    assert_raises(ValueError, nditer, [a]*100, [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*100)</div>
<div class="line"><span class="lineno">  722</span>    <span class="comment"># Bad global flag</span></div>
<div class="line"><span class="lineno">  723</span>    assert_raises(ValueError, nditer, [a], [<span class="stringliteral">&#39;bad flag&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  724</span>    <span class="comment"># Bad op flag</span></div>
<div class="line"><span class="lineno">  725</span>    assert_raises(ValueError, nditer, [a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;bad flag&#39;</span>]])</div>
<div class="line"><span class="lineno">  726</span>    <span class="comment"># Bad order parameter</span></div>
<div class="line"><span class="lineno">  727</span>    assert_raises(ValueError, nditer, [a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]], order=<span class="stringliteral">&#39;G&#39;</span>)</div>
<div class="line"><span class="lineno">  728</span>    <span class="comment"># Bad casting parameter</span></div>
<div class="line"><span class="lineno">  729</span>    assert_raises(ValueError, nditer, [a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]], casting=<span class="stringliteral">&#39;noon&#39;</span>)</div>
<div class="line"><span class="lineno">  730</span>    <span class="comment"># op_flags must match ops</span></div>
<div class="line"><span class="lineno">  731</span>    assert_raises(ValueError, nditer, [a]*3, [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2)</div>
<div class="line"><span class="lineno">  732</span>    <span class="comment"># Cannot track both a C and an F index</span></div>
<div class="line"><span class="lineno">  733</span>    assert_raises(ValueError, nditer, a,</div>
<div class="line"><span class="lineno">  734</span>                [<span class="stringliteral">&#39;c_index&#39;</span>, <span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  735</span>    <span class="comment"># Inner iteration and multi-indices/indices are incompatible</span></div>
<div class="line"><span class="lineno">  736</span>    assert_raises(ValueError, nditer, a,</div>
<div class="line"><span class="lineno">  737</span>                [<span class="stringliteral">&#39;external_loop&#39;</span>, <span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  738</span>    assert_raises(ValueError, nditer, a,</div>
<div class="line"><span class="lineno">  739</span>                [<span class="stringliteral">&#39;external_loop&#39;</span>, <span class="stringliteral">&#39;c_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  740</span>    assert_raises(ValueError, nditer, a,</div>
<div class="line"><span class="lineno">  741</span>                [<span class="stringliteral">&#39;external_loop&#39;</span>, <span class="stringliteral">&#39;f_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  742</span>    <span class="comment"># Must specify exactly one of readwrite/readonly/writeonly per operand</span></div>
<div class="line"><span class="lineno">  743</span>    assert_raises(ValueError, nditer, a, [], [[]])</div>
<div class="line"><span class="lineno">  744</span>    assert_raises(ValueError, nditer, a, [], [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;writeonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  745</span>    assert_raises(ValueError, nditer, a, [], [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;readwrite&#39;</span>]])</div>
<div class="line"><span class="lineno">  746</span>    assert_raises(ValueError, nditer, a, [], [[<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;readwrite&#39;</span>]])</div>
<div class="line"><span class="lineno">  747</span>    assert_raises(ValueError, nditer, a,</div>
<div class="line"><span class="lineno">  748</span>                [], [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;readwrite&#39;</span>]])</div>
<div class="line"><span class="lineno">  749</span>    <span class="comment"># Python scalars are always readonly</span></div>
<div class="line"><span class="lineno">  750</span>    assert_raises(TypeError, nditer, 1.5, [], [[<span class="stringliteral">&#39;writeonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  751</span>    assert_raises(TypeError, nditer, 1.5, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>]])</div>
<div class="line"><span class="lineno">  752</span>    <span class="comment"># Array scalars are always readonly</span></div>
<div class="line"><span class="lineno">  753</span>    assert_raises(TypeError, nditer, np.int32(1), [], [[<span class="stringliteral">&#39;writeonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  754</span>    assert_raises(TypeError, nditer, np.int32(1), [], [[<span class="stringliteral">&#39;readwrite&#39;</span>]])</div>
<div class="line"><span class="lineno">  755</span>    <span class="comment"># Check readonly array</span></div>
<div class="line"><span class="lineno">  756</span>    a.flags.writeable = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  757</span>    assert_raises(ValueError, nditer, a, [], [[<span class="stringliteral">&#39;writeonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  758</span>    assert_raises(ValueError, nditer, a, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>]])</div>
<div class="line"><span class="lineno">  759</span>    a.flags.writeable = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  760</span>    <span class="comment"># Multi-indices available only with the multi_index flag</span></div>
<div class="line"><span class="lineno">  761</span>    i = nditer(arange(6), [], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  762</span>    assert_raises(ValueError, <span class="keyword">lambda</span> i:i.multi_index, i)</div>
<div class="line"><span class="lineno">  763</span>    <span class="comment"># Index available only with an index flag</span></div>
<div class="line"><span class="lineno">  764</span>    assert_raises(ValueError, <span class="keyword">lambda</span> i:i.index, i)</div>
<div class="line"><span class="lineno">  765</span>    <span class="comment"># GotoCoords and GotoIndex incompatible with buffering or no_inner</span></div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span>    <span class="keyword">def </span>assign_multi_index(i):</div>
<div class="line"><span class="lineno">  768</span>        i.multi_index = (0,)</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>    <span class="keyword">def </span>assign_index(i):</div>
<div class="line"><span class="lineno">  771</span>        i.index = 0</div>
<div class="line"><span class="lineno">  772</span> </div>
<div class="line"><span class="lineno">  773</span>    <span class="keyword">def </span>assign_iterindex(i):</div>
<div class="line"><span class="lineno">  774</span>        i.iterindex = 0</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>    <span class="keyword">def </span>assign_iterrange(i):</div>
<div class="line"><span class="lineno">  777</span>        i.iterrange = (0, 1)</div>
<div class="line"><span class="lineno">  778</span>    i = nditer(arange(6), [<span class="stringliteral">&#39;external_loop&#39;</span>])</div>
<div class="line"><span class="lineno">  779</span>    assert_raises(ValueError, assign_multi_index, i)</div>
<div class="line"><span class="lineno">  780</span>    assert_raises(ValueError, assign_index, i)</div>
<div class="line"><span class="lineno">  781</span>    assert_raises(ValueError, assign_iterindex, i)</div>
<div class="line"><span class="lineno">  782</span>    assert_raises(ValueError, assign_iterrange, i)</div>
<div class="line"><span class="lineno">  783</span>    i = nditer(arange(6), [<span class="stringliteral">&#39;buffered&#39;</span>])</div>
<div class="line"><span class="lineno">  784</span>    assert_raises(ValueError, assign_multi_index, i)</div>
<div class="line"><span class="lineno">  785</span>    assert_raises(ValueError, assign_index, i)</div>
<div class="line"><span class="lineno">  786</span>    assert_raises(ValueError, assign_iterrange, i)</div>
<div class="line"><span class="lineno">  787</span>    <span class="comment"># Can&#39;t iterate if size is zero</span></div>
<div class="line"><span class="lineno">  788</span>    assert_raises(ValueError, nditer, np.array([]))</div>
<div class="line"><span class="lineno">  789</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a386ffa75bcf829caab32fa4a1b542d10" name="a386ffa75bcf829caab32fa4a1b542d10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a386ffa75bcf829caab32fa4a1b542d10">&#9670;&#160;</a></span>test_iter_iterindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_iterindex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1677</span><span class="keyword">def </span>test_iter_iterindex():</div>
<div class="line"><span class="lineno"> 1678</span>    <span class="comment"># Make sure iterindex works</span></div>
<div class="line"><span class="lineno"> 1679</span> </div>
<div class="line"><span class="lineno"> 1680</span>    buffersize = 5</div>
<div class="line"><span class="lineno"> 1681</span>    a = arange(24).reshape(4, 3, 2)</div>
<div class="line"><span class="lineno"> 1682</span>    <span class="keywordflow">for</span> flags <span class="keywordflow">in</span> ([], [<span class="stringliteral">&#39;buffered&#39;</span>]):</div>
<div class="line"><span class="lineno"> 1683</span>        i = nditer(a, flags, buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1684</span>        assert_equal(iter_iterindices(i), list(range(24)))</div>
<div class="line"><span class="lineno"> 1685</span>        i.iterindex = 2</div>
<div class="line"><span class="lineno"> 1686</span>        assert_equal(iter_iterindices(i), list(range(2, 24)))</div>
<div class="line"><span class="lineno"> 1687</span> </div>
<div class="line"><span class="lineno"> 1688</span>        i = nditer(a, flags, order=<span class="stringliteral">&#39;F&#39;</span>, buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1689</span>        assert_equal(iter_iterindices(i), list(range(24)))</div>
<div class="line"><span class="lineno"> 1690</span>        i.iterindex = 5</div>
<div class="line"><span class="lineno"> 1691</span>        assert_equal(iter_iterindices(i), list(range(5, 24)))</div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>        i = nditer(a[::-1], flags, order=<span class="stringliteral">&#39;F&#39;</span>, buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1694</span>        assert_equal(iter_iterindices(i), list(range(24)))</div>
<div class="line"><span class="lineno"> 1695</span>        i.iterindex = 9</div>
<div class="line"><span class="lineno"> 1696</span>        assert_equal(iter_iterindices(i), list(range(9, 24)))</div>
<div class="line"><span class="lineno"> 1697</span> </div>
<div class="line"><span class="lineno"> 1698</span>        i = nditer(a[::-1, ::-1], flags, order=<span class="stringliteral">&#39;C&#39;</span>, buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1699</span>        assert_equal(iter_iterindices(i), list(range(24)))</div>
<div class="line"><span class="lineno"> 1700</span>        i.iterindex = 13</div>
<div class="line"><span class="lineno"> 1701</span>        assert_equal(iter_iterindices(i), list(range(13, 24)))</div>
<div class="line"><span class="lineno"> 1702</span> </div>
<div class="line"><span class="lineno"> 1703</span>        i = nditer(a[::1, ::-1], flags, buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1704</span>        assert_equal(iter_iterindices(i), list(range(24)))</div>
<div class="line"><span class="lineno"> 1705</span>        i.iterindex = 23</div>
<div class="line"><span class="lineno"> 1706</span>        assert_equal(iter_iterindices(i), list(range(23, 24)))</div>
<div class="line"><span class="lineno"> 1707</span>        i.reset()</div>
<div class="line"><span class="lineno"> 1708</span>        i.iterindex = 2</div>
<div class="line"><span class="lineno"> 1709</span>        assert_equal(iter_iterindices(i), list(range(2, 24)))</div>
<div class="line"><span class="lineno"> 1710</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0c63d517a3694a7bf1f50bc244c56de" name="ac0c63d517a3694a7bf1f50bc244c56de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0c63d517a3694a7bf1f50bc244c56de">&#9670;&#160;</a></span>test_iter_iterrange()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_iterrange </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1711</span><span class="keyword">def </span>test_iter_iterrange():</div>
<div class="line"><span class="lineno"> 1712</span>    <span class="comment"># Make sure getting and resetting the iterrange works</span></div>
<div class="line"><span class="lineno"> 1713</span> </div>
<div class="line"><span class="lineno"> 1714</span>    buffersize = 5</div>
<div class="line"><span class="lineno"> 1715</span>    a = arange(24, dtype=<span class="stringliteral">&#39;i4&#39;</span>).reshape(4, 3, 2)</div>
<div class="line"><span class="lineno"> 1716</span>    a_fort = a.ravel(order=<span class="stringliteral">&#39;F&#39;</span>)</div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span>    i = nditer(a, [<span class="stringliteral">&#39;ranged&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], order=<span class="stringliteral">&#39;F&#39;</span>,</div>
<div class="line"><span class="lineno"> 1719</span>                buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1720</span>    assert_equal(i.iterrange, (0, 24))</div>
<div class="line"><span class="lineno"> 1721</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a_fort)</div>
<div class="line"><span class="lineno"> 1722</span>    <span class="keywordflow">for</span> r <span class="keywordflow">in</span> [(0, 24), (1, 2), (3, 24), (5, 5), (0, 20), (23, 24)]:</div>
<div class="line"><span class="lineno"> 1723</span>        i.iterrange = r</div>
<div class="line"><span class="lineno"> 1724</span>        assert_equal(i.iterrange, r)</div>
<div class="line"><span class="lineno"> 1725</span>        assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a_fort[r[0]:r[1]])</div>
<div class="line"><span class="lineno"> 1726</span> </div>
<div class="line"><span class="lineno"> 1727</span>    i = nditer(a, [<span class="stringliteral">&#39;ranged&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], order=<span class="stringliteral">&#39;F&#39;</span>,</div>
<div class="line"><span class="lineno"> 1728</span>                op_dtypes=<span class="stringliteral">&#39;f8&#39;</span>, buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1729</span>    assert_equal(i.iterrange, (0, 24))</div>
<div class="line"><span class="lineno"> 1730</span>    assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a_fort)</div>
<div class="line"><span class="lineno"> 1731</span>    <span class="keywordflow">for</span> r <span class="keywordflow">in</span> [(0, 24), (1, 2), (3, 24), (5, 5), (0, 20), (23, 24)]:</div>
<div class="line"><span class="lineno"> 1732</span>        i.iterrange = r</div>
<div class="line"><span class="lineno"> 1733</span>        assert_equal(i.iterrange, r)</div>
<div class="line"><span class="lineno"> 1734</span>        assert_equal([x[()] <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a_fort[r[0]:r[1]])</div>
<div class="line"><span class="lineno"> 1735</span> </div>
<div class="line"><span class="lineno"> 1736</span>    <span class="keyword">def </span>get_array(i):</div>
<div class="line"><span class="lineno"> 1737</span>        val = np.array([], dtype=<span class="stringliteral">&#39;f8&#39;</span>)</div>
<div class="line"><span class="lineno"> 1738</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1739</span>            val = np.concatenate((val, x))</div>
<div class="line"><span class="lineno"> 1740</span>        <span class="keywordflow">return</span> val</div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span>    i = nditer(a, [<span class="stringliteral">&#39;ranged&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 1743</span>                [<span class="stringliteral">&#39;readonly&#39;</span>], order=<span class="stringliteral">&#39;F&#39;</span>,</div>
<div class="line"><span class="lineno"> 1744</span>                op_dtypes=<span class="stringliteral">&#39;f8&#39;</span>, buffersize=buffersize)</div>
<div class="line"><span class="lineno"> 1745</span>    assert_equal(i.iterrange, (0, 24))</div>
<div class="line"><span class="lineno"> 1746</span>    assert_equal(get_array(i), a_fort)</div>
<div class="line"><span class="lineno"> 1747</span>    <span class="keywordflow">for</span> r <span class="keywordflow">in</span> [(0, 24), (1, 2), (3, 24), (5, 5), (0, 20), (23, 24)]:</div>
<div class="line"><span class="lineno"> 1748</span>        i.iterrange = r</div>
<div class="line"><span class="lineno"> 1749</span>        assert_equal(i.iterrange, r)</div>
<div class="line"><span class="lineno"> 1750</span>        assert_equal(get_array(i), a_fort[r[0]:r[1]])</div>
<div class="line"><span class="lineno"> 1751</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a85aba8c4384c52f13b0d20fed38fb4cc" name="a85aba8c4384c52f13b0d20fed38fb4cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85aba8c4384c52f13b0d20fed38fb4cc">&#9670;&#160;</a></span>test_iter_itershape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_itershape </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  607</span><span class="keyword">def </span>test_iter_itershape():</div>
<div class="line"><span class="lineno">  608</span>    <span class="comment"># Check that allocated outputs work with a specified shape</span></div>
<div class="line"><span class="lineno">  609</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;i2&#39;</span>).reshape(2, 3)</div>
<div class="line"><span class="lineno">  610</span>    i = nditer([a, <span class="keywordtype">None</span>], [], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno">  611</span>                            op_axes=[[0, 1, <span class="keywordtype">None</span>], <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  612</span>                            itershape=(-1, -1, 4))</div>
<div class="line"><span class="lineno">  613</span>    assert_equal(i.operands[1].shape, (2, 3, 4))</div>
<div class="line"><span class="lineno">  614</span>    assert_equal(i.operands[1].strides, (24, 8, 2))</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>    i = nditer([a.T, <span class="keywordtype">None</span>], [], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno">  617</span>                            op_axes=[[0, 1, <span class="keywordtype">None</span>], <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  618</span>                            itershape=(-1, -1, 4))</div>
<div class="line"><span class="lineno">  619</span>    assert_equal(i.operands[1].shape, (3, 2, 4))</div>
<div class="line"><span class="lineno">  620</span>    assert_equal(i.operands[1].strides, (8, 24, 2))</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    i = nditer([a.T, <span class="keywordtype">None</span>], [], [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno">  623</span>                            order=<span class="stringliteral">&#39;F&#39;</span>,</div>
<div class="line"><span class="lineno">  624</span>                            op_axes=[[0, 1, <span class="keywordtype">None</span>], <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  625</span>                            itershape=(-1, -1, 4))</div>
<div class="line"><span class="lineno">  626</span>    assert_equal(i.operands[1].shape, (3, 2, 4))</div>
<div class="line"><span class="lineno">  627</span>    assert_equal(i.operands[1].strides, (2, 6, 12))</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>    <span class="comment"># If we specify 1 in the itershape, it shouldn&#39;t allow broadcasting</span></div>
<div class="line"><span class="lineno">  630</span>    <span class="comment"># of that dimension to a bigger value</span></div>
<div class="line"><span class="lineno">  631</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno">  632</span>                            [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;writeonly&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno">  633</span>                            op_axes=[[0, 1, <span class="keywordtype">None</span>], <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno">  634</span>                            itershape=(-1, 1, 4))</div>
<div class="line"><span class="lineno">  635</span>    <span class="comment"># Test bug that for no op_axes but itershape, they are NULLed correctly</span></div>
<div class="line"><span class="lineno">  636</span>    i = np.nditer([np.ones(2), <span class="keywordtype">None</span>, <span class="keywordtype">None</span>], itershape=(2,))</div>
<div class="line"><span class="lineno">  637</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ed854ac74a30ba10697f88468c11161" name="a2ed854ac74a30ba10697f88468c11161"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ed854ac74a30ba10697f88468c11161">&#9670;&#160;</a></span>test_iter_nbo_align_contig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_nbo_align_contig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  820</span><span class="keyword">def </span>test_iter_nbo_align_contig():</div>
<div class="line"><span class="lineno">  821</span>    <span class="comment"># Check that byte order, alignment, and contig changes work</span></div>
<div class="line"><span class="lineno">  822</span> </div>
<div class="line"><span class="lineno">  823</span>    <span class="comment"># Byte order change by requesting a specific dtype</span></div>
<div class="line"><span class="lineno">  824</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno">  825</span>    au = a.byteswap().newbyteorder()</div>
<div class="line"><span class="lineno">  826</span>    assert_(a.dtype.byteorder != au.dtype.byteorder)</div>
<div class="line"><span class="lineno">  827</span>    i = nditer(au, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">  828</span>                        casting=<span class="stringliteral">&#39;equiv&#39;</span>,</div>
<div class="line"><span class="lineno">  829</span>                        op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  830</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno">  831</span>        <span class="comment"># context manager triggers WRITEBACKIFCOPY on i at exit</span></div>
<div class="line"><span class="lineno">  832</span>        assert_equal(i.dtypes[0].byteorder, a.dtype.byteorder)</div>
<div class="line"><span class="lineno">  833</span>        assert_equal(i.operands[0].dtype.byteorder, a.dtype.byteorder)</div>
<div class="line"><span class="lineno">  834</span>        assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  835</span>        i.operands[0][:] = 2</div>
<div class="line"><span class="lineno">  836</span>    assert_equal(au, [2]*6)</div>
<div class="line"><span class="lineno">  837</span>    del i  <span class="comment"># should not raise a warning</span></div>
<div class="line"><span class="lineno">  838</span>    <span class="comment"># Byte order change by requesting NBO</span></div>
<div class="line"><span class="lineno">  839</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno">  840</span>    au = a.byteswap().newbyteorder()</div>
<div class="line"><span class="lineno">  841</span>    assert_(a.dtype.byteorder != au.dtype.byteorder)</div>
<div class="line"><span class="lineno">  842</span>    <span class="keyword">with</span> nditer(au, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>]],</div>
<div class="line"><span class="lineno">  843</span>                        casting=<span class="stringliteral">&#39;equiv&#39;</span>) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno">  844</span>        <span class="comment"># context manager triggers UPDATEIFCOPY on i at exit</span></div>
<div class="line"><span class="lineno">  845</span>        assert_equal(i.dtypes[0].byteorder, a.dtype.byteorder)</div>
<div class="line"><span class="lineno">  846</span>        assert_equal(i.operands[0].dtype.byteorder, a.dtype.byteorder)</div>
<div class="line"><span class="lineno">  847</span>        assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  848</span>        i.operands[0][:] = 12345</div>
<div class="line"><span class="lineno">  849</span>        i.operands[0][:] = 2</div>
<div class="line"><span class="lineno">  850</span>    assert_equal(au, [2]*6)</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>    <span class="comment"># Unaligned input</span></div>
<div class="line"><span class="lineno">  853</span>    a = np.zeros((6*4+1,), dtype=<span class="stringliteral">&#39;i1&#39;</span>)[1:]</div>
<div class="line"><span class="lineno">  854</span>    a.dtype = <span class="stringliteral">&#39;f4&#39;</span></div>
<div class="line"><span class="lineno">  855</span>    a[:] = np.arange(6, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno">  856</span>    assert_(<span class="keywordflow">not</span> a.flags.aligned)</div>
<div class="line"><span class="lineno">  857</span>    <span class="comment"># Without &#39;aligned&#39;, shouldn&#39;t copy</span></div>
<div class="line"><span class="lineno">  858</span>    i = nditer(a, [], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  859</span>    assert_(<span class="keywordflow">not</span> i.operands[0].flags.aligned)</div>
<div class="line"><span class="lineno">  860</span>    assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  861</span>    <span class="comment"># With &#39;aligned&#39;, should make a copy</span></div>
<div class="line"><span class="lineno">  862</span>    <span class="keyword">with</span> nditer(a, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]]) <span class="keyword">as</span> i:</div>
<div class="line"><span class="lineno">  863</span>        assert_(i.operands[0].flags.aligned)</div>
<div class="line"><span class="lineno">  864</span>        <span class="comment"># context manager triggers UPDATEIFCOPY on i at exit</span></div>
<div class="line"><span class="lineno">  865</span>        assert_equal(i.operands[0], a)</div>
<div class="line"><span class="lineno">  866</span>        i.operands[0][:] = 3</div>
<div class="line"><span class="lineno">  867</span>    assert_equal(a, [3]*6)</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>    <span class="comment"># Discontiguous input</span></div>
<div class="line"><span class="lineno">  870</span>    a = arange(12)</div>
<div class="line"><span class="lineno">  871</span>    <span class="comment"># If it is contiguous, shouldn&#39;t copy</span></div>
<div class="line"><span class="lineno">  872</span>    i = nditer(a[:6], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  873</span>    assert_(i.operands[0].flags.contiguous)</div>
<div class="line"><span class="lineno">  874</span>    assert_equal(i.operands[0], a[:6])</div>
<div class="line"><span class="lineno">  875</span>    <span class="comment"># If it isn&#39;t contiguous, should buffer</span></div>
<div class="line"><span class="lineno">  876</span>    i = nditer(a[::2], [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno">  877</span>                        [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;contig&#39;</span>]],</div>
<div class="line"><span class="lineno">  878</span>                        buffersize=10)</div>
<div class="line"><span class="lineno">  879</span>    assert_(i[0].flags.contiguous)</div>
<div class="line"><span class="lineno">  880</span>    assert_equal(i[0], a[::2])</div>
<div class="line"><span class="lineno">  881</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af22b46408f833830bd47671108c48eb5" name="af22b46408f833830bd47671108c48eb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af22b46408f833830bd47671108c48eb5">&#9670;&#160;</a></span>test_iter_no_broadcast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_no_broadcast </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2329</span><span class="keyword">def </span>test_iter_no_broadcast():</div>
<div class="line"><span class="lineno"> 2330</span>    <span class="comment"># Test that the no_broadcast flag works</span></div>
<div class="line"><span class="lineno"> 2331</span>    a = np.arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 2332</span>    b = np.arange(6).reshape(2, 3, 1)</div>
<div class="line"><span class="lineno"> 2333</span>    c = np.arange(12).reshape(3, 4)</div>
<div class="line"><span class="lineno"> 2334</span> </div>
<div class="line"><span class="lineno"> 2335</span>    nditer([a, b, c], [],</div>
<div class="line"><span class="lineno"> 2336</span>           [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;no_broadcast&#39;</span>],</div>
<div class="line"><span class="lineno"> 2337</span>            [<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2338</span>    assert_raises(ValueError, nditer, [a, b, c], [],</div>
<div class="line"><span class="lineno"> 2339</span>                  [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;no_broadcast&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2340</span>    assert_raises(ValueError, nditer, [a, b, c], [],</div>
<div class="line"><span class="lineno"> 2341</span>                  [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;no_broadcast&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2342</span> </div>
<div class="line"><span class="lineno"> 2343</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a83fb62244406025592994cb55c98eb" name="a9a83fb62244406025592994cb55c98eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a83fb62244406025592994cb55c98eb">&#9670;&#160;</a></span>test_iter_no_inner_dim_coalescing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_no_inner_dim_coalescing </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  477</span><span class="keyword">def </span>test_iter_no_inner_dim_coalescing():</div>
<div class="line"><span class="lineno">  478</span>    <span class="comment"># Check no_inner iterators whose dimensions may not coalesce completely</span></div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="comment"># Skipping the last element in a dimension prevents coalescing</span></div>
<div class="line"><span class="lineno">  481</span>    <span class="comment"># with the next-bigger dimension</span></div>
<div class="line"><span class="lineno">  482</span>    a = arange(24).reshape(2, 3, 4)[:,:, :-1]</div>
<div class="line"><span class="lineno">  483</span>    i = nditer(a, [<span class="stringliteral">&#39;external_loop&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  484</span>    assert_equal(i.ndim, 2)</div>
<div class="line"><span class="lineno">  485</span>    assert_equal(i[0].shape, (3,))</div>
<div class="line"><span class="lineno">  486</span>    a = arange(24).reshape(2, 3, 4)[:, :-1,:]</div>
<div class="line"><span class="lineno">  487</span>    i = nditer(a, [<span class="stringliteral">&#39;external_loop&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  488</span>    assert_equal(i.ndim, 2)</div>
<div class="line"><span class="lineno">  489</span>    assert_equal(i[0].shape, (8,))</div>
<div class="line"><span class="lineno">  490</span>    a = arange(24).reshape(2, 3, 4)[:-1,:,:]</div>
<div class="line"><span class="lineno">  491</span>    i = nditer(a, [<span class="stringliteral">&#39;external_loop&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  492</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  493</span>    assert_equal(i[0].shape, (12,))</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    <span class="comment"># Even with lots of 1-sized dimensions, should still coalesce</span></div>
<div class="line"><span class="lineno">  496</span>    a = arange(24).reshape(1, 1, 2, 1, 1, 3, 1, 1, 4, 1, 1)</div>
<div class="line"><span class="lineno">  497</span>    i = nditer(a, [<span class="stringliteral">&#39;external_loop&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  498</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  499</span>    assert_equal(i[0].shape, (24,))</div>
<div class="line"><span class="lineno">  500</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad2648404370c162e7ea2d0c36dfcf977" name="ad2648404370c162e7ea2d0c36dfcf977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad2648404370c162e7ea2d0c36dfcf977">&#9670;&#160;</a></span>test_iter_no_inner_full_coalesce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_no_inner_full_coalesce </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  447</span><span class="keyword">def </span>test_iter_no_inner_full_coalesce():</div>
<div class="line"><span class="lineno">  448</span>    <span class="comment"># Check no_inner iterators which coalesce into a single inner loop</span></div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">for</span> shape <span class="keywordflow">in</span> [(5,), (3, 4), (2, 3, 4), (2, 3, 4, 3), (2, 3, 2, 2, 3)]:</div>
<div class="line"><span class="lineno">  451</span>        size = np.prod(shape)</div>
<div class="line"><span class="lineno">  452</span>        a = arange(size)</div>
<div class="line"><span class="lineno">  453</span>        <span class="comment"># Test each combination of forward and backwards indexing</span></div>
<div class="line"><span class="lineno">  454</span>        <span class="keywordflow">for</span> dirs <span class="keywordflow">in</span> range(2**len(shape)):</div>
<div class="line"><span class="lineno">  455</span>            dirs_index = [slice(<span class="keywordtype">None</span>)]*len(shape)</div>
<div class="line"><span class="lineno">  456</span>            <span class="keywordflow">for</span> bit <span class="keywordflow">in</span> range(len(shape)):</div>
<div class="line"><span class="lineno">  457</span>                <span class="keywordflow">if</span> ((2**bit) &amp; dirs):</div>
<div class="line"><span class="lineno">  458</span>                    dirs_index[bit] = slice(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, -1)</div>
<div class="line"><span class="lineno">  459</span>            dirs_index = tuple(dirs_index)</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>            aview = a.reshape(shape)[dirs_index]</div>
<div class="line"><span class="lineno">  462</span>            <span class="comment"># C-order</span></div>
<div class="line"><span class="lineno">  463</span>            i = nditer(aview, [<span class="stringliteral">&#39;external_loop&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  464</span>            assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  465</span>            assert_equal(i[0].shape, (size,))</div>
<div class="line"><span class="lineno">  466</span>            <span class="comment"># Fortran-order</span></div>
<div class="line"><span class="lineno">  467</span>            i = nditer(aview.T, [<span class="stringliteral">&#39;external_loop&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  468</span>            assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  469</span>            assert_equal(i[0].shape, (size,))</div>
<div class="line"><span class="lineno">  470</span>            <span class="comment"># Other order</span></div>
<div class="line"><span class="lineno">  471</span>            <span class="keywordflow">if</span> len(shape) &gt; 2:</div>
<div class="line"><span class="lineno">  472</span>                i = nditer(aview.swapaxes(0, 1),</div>
<div class="line"><span class="lineno">  473</span>                                    [<span class="stringliteral">&#39;external_loop&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno">  474</span>                assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno">  475</span>                assert_equal(i[0].shape, (size,))</div>
<div class="line"><span class="lineno">  476</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aba00d7a622c9f08fe1e41330f59f0317" name="aba00d7a622c9f08fe1e41330f59f0317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba00d7a622c9f08fe1e41330f59f0317">&#9670;&#160;</a></span>test_iter_non_writable_attribute_deletion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_non_writable_attribute_deletion </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2877</span><span class="keyword">def </span>test_iter_non_writable_attribute_deletion():</div>
<div class="line"><span class="lineno"> 2878</span>    it = np.nditer(np.ones(2))</div>
<div class="line"><span class="lineno"> 2879</span>    attr = [<span class="stringliteral">&quot;value&quot;</span>, <span class="stringliteral">&quot;shape&quot;</span>, <span class="stringliteral">&quot;operands&quot;</span>, <span class="stringliteral">&quot;itviews&quot;</span>, <span class="stringliteral">&quot;has_delayed_bufalloc&quot;</span>,</div>
<div class="line"><span class="lineno"> 2880</span>            <span class="stringliteral">&quot;iterationneedsapi&quot;</span>, <span class="stringliteral">&quot;has_multi_index&quot;</span>, <span class="stringliteral">&quot;has_index&quot;</span>, <span class="stringliteral">&quot;dtypes&quot;</span>,</div>
<div class="line"><span class="lineno"> 2881</span>            <span class="stringliteral">&quot;ndim&quot;</span>, <span class="stringliteral">&quot;nop&quot;</span>, <span class="stringliteral">&quot;itersize&quot;</span>, <span class="stringliteral">&quot;finished&quot;</span>]</div>
<div class="line"><span class="lineno"> 2882</span> </div>
<div class="line"><span class="lineno"> 2883</span>    <span class="keywordflow">for</span> s <span class="keywordflow">in</span> attr:</div>
<div class="line"><span class="lineno"> 2884</span>        assert_raises(AttributeError, delattr, it, s)</div>
<div class="line"><span class="lineno"> 2885</span> </div>
<div class="line"><span class="lineno"> 2886</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4103ae092ccdf911766cf5e331a9caab" name="a4103ae092ccdf911766cf5e331a9caab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4103ae092ccdf911766cf5e331a9caab">&#9670;&#160;</a></span>test_iter_object_arrays_basic()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_object_arrays_basic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1045</span><span class="keyword">def </span>test_iter_object_arrays_basic():</div>
<div class="line"><span class="lineno"> 1046</span>    <span class="comment"># Check that object arrays work</span></div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>    obj = {<span class="stringliteral">&#39;a&#39;</span>:3,<span class="stringliteral">&#39;b&#39;</span>:<span class="stringliteral">&#39;d&#39;</span>}</div>
<div class="line"><span class="lineno"> 1049</span>    a = np.array([[1, 2, 3], <span class="keywordtype">None</span>, obj, <span class="keywordtype">None</span>], dtype=<span class="stringliteral">&#39;O&#39;</span>)</div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1051</span>        rc = sys.getrefcount(obj)</div>
<div class="line"><span class="lineno"> 1052</span> </div>
<div class="line"><span class="lineno"> 1053</span>    <span class="comment"># Need to allow references for object arrays</span></div>
<div class="line"><span class="lineno"> 1054</span>    assert_raises(TypeError, nditer, a)</div>
<div class="line"><span class="lineno"> 1055</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1056</span>        assert_equal(sys.getrefcount(obj), rc)</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>    i = nditer(a, [<span class="stringliteral">&#39;refs_ok&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>])</div>
<div class="line"><span class="lineno"> 1059</span>    vals = [x_[()] <span class="keywordflow">for</span> x_ <span class="keywordflow">in</span> i]</div>
<div class="line"><span class="lineno"> 1060</span>    assert_equal(np.array(vals, dtype=<span class="stringliteral">&#39;O&#39;</span>), a)</div>
<div class="line"><span class="lineno"> 1061</span>    vals, i, x = [<span class="keywordtype">None</span>]*3</div>
<div class="line"><span class="lineno"> 1062</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1063</span>        assert_equal(sys.getrefcount(obj), rc)</div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span>    i = nditer(a.reshape(2, 2).T, [<span class="stringliteral">&#39;refs_ok&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 1066</span>                        [<span class="stringliteral">&#39;readonly&#39;</span>], order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno"> 1067</span>    assert_(i.iterationneedsapi)</div>
<div class="line"><span class="lineno"> 1068</span>    vals = [x_[()] <span class="keywordflow">for</span> x_ <span class="keywordflow">in</span> i]</div>
<div class="line"><span class="lineno"> 1069</span>    assert_equal(np.array(vals, dtype=<span class="stringliteral">&#39;O&#39;</span>), a.reshape(2, 2).ravel(order=<span class="stringliteral">&#39;F&#39;</span>))</div>
<div class="line"><span class="lineno"> 1070</span>    vals, i, x = [<span class="keywordtype">None</span>]*3</div>
<div class="line"><span class="lineno"> 1071</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1072</span>        assert_equal(sys.getrefcount(obj), rc)</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>    i = nditer(a.reshape(2, 2).T, [<span class="stringliteral">&#39;refs_ok&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 1075</span>                        [<span class="stringliteral">&#39;readwrite&#39;</span>], order=<span class="stringliteral">&#39;C&#39;</span>)</div>
<div class="line"><span class="lineno"> 1076</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1077</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1078</span>            x[...] = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 1079</span>        vals, i, x = [<span class="keywordtype">None</span>]*3</div>
<div class="line"><span class="lineno"> 1080</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1081</span>        assert_(sys.getrefcount(obj) == rc-1)</div>
<div class="line"><span class="lineno"> 1082</span>    assert_equal(a, np.array([<span class="keywordtype">None</span>]*4, dtype=<span class="stringliteral">&#39;O&#39;</span>))</div>
<div class="line"><span class="lineno"> 1083</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3403d93157dcc045212f0bccefd296e8" name="a3403d93157dcc045212f0bccefd296e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3403d93157dcc045212f0bccefd296e8">&#9670;&#160;</a></span>test_iter_object_arrays_conversions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_object_arrays_conversions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1084</span><span class="keyword">def </span>test_iter_object_arrays_conversions():</div>
<div class="line"><span class="lineno"> 1085</span>    <span class="comment"># Conversions to/from objects</span></div>
<div class="line"><span class="lineno"> 1086</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;O&#39;</span>)</div>
<div class="line"><span class="lineno"> 1087</span>    i = nditer(a, [<span class="stringliteral">&#39;refs_ok&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>],</div>
<div class="line"><span class="lineno"> 1088</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>, op_dtypes=<span class="stringliteral">&#39;i4&#39;</span>)</div>
<div class="line"><span class="lineno"> 1089</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1090</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1091</span>            x[...] += 1</div>
<div class="line"><span class="lineno"> 1092</span>    assert_equal(a, np.arange(6)+1)</div>
<div class="line"><span class="lineno"> 1093</span> </div>
<div class="line"><span class="lineno"> 1094</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;i4&#39;</span>)</div>
<div class="line"><span class="lineno"> 1095</span>    i = nditer(a, [<span class="stringliteral">&#39;refs_ok&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>],</div>
<div class="line"><span class="lineno"> 1096</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>, op_dtypes=<span class="stringliteral">&#39;O&#39;</span>)</div>
<div class="line"><span class="lineno"> 1097</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1098</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1099</span>            x[...] += 1</div>
<div class="line"><span class="lineno"> 1100</span>    assert_equal(a, np.arange(6)+1)</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>    <span class="comment"># Non-contiguous object array</span></div>
<div class="line"><span class="lineno"> 1103</span>    a = np.zeros((6,), dtype=[(<span class="stringliteral">&#39;p&#39;</span>, <span class="stringliteral">&#39;i1&#39;</span>), (<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;O&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1104</span>    a = a[<span class="stringliteral">&#39;a&#39;</span>]</div>
<div class="line"><span class="lineno"> 1105</span>    a[:] = np.arange(6)</div>
<div class="line"><span class="lineno"> 1106</span>    i = nditer(a, [<span class="stringliteral">&#39;refs_ok&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>],</div>
<div class="line"><span class="lineno"> 1107</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>, op_dtypes=<span class="stringliteral">&#39;i4&#39;</span>)</div>
<div class="line"><span class="lineno"> 1108</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1109</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1110</span>            x[...] += 1</div>
<div class="line"><span class="lineno"> 1111</span>    assert_equal(a, np.arange(6)+1)</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>    <span class="comment">#Non-contiguous value array</span></div>
<div class="line"><span class="lineno"> 1114</span>    a = np.zeros((6,), dtype=[(<span class="stringliteral">&#39;p&#39;</span>, <span class="stringliteral">&#39;i1&#39;</span>), (<span class="stringliteral">&#39;a&#39;</span>, <span class="stringliteral">&#39;i4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1115</span>    a = a[<span class="stringliteral">&#39;a&#39;</span>]</div>
<div class="line"><span class="lineno"> 1116</span>    a[:] = np.arange(6) + 98172488</div>
<div class="line"><span class="lineno"> 1117</span>    i = nditer(a, [<span class="stringliteral">&#39;refs_ok&#39;</span>, <span class="stringliteral">&#39;buffered&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>],</div>
<div class="line"><span class="lineno"> 1118</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>, op_dtypes=<span class="stringliteral">&#39;O&#39;</span>)</div>
<div class="line"><span class="lineno"> 1119</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1120</span>        ob = i[0][()]</div>
<div class="line"><span class="lineno"> 1121</span>        <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1122</span>            rc = sys.getrefcount(ob)</div>
<div class="line"><span class="lineno"> 1123</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 1124</span>            x[...] += 1</div>
<div class="line"><span class="lineno"> 1125</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 1126</span>        assert_(sys.getrefcount(ob) == rc-1)</div>
<div class="line"><span class="lineno"> 1127</span>    assert_equal(a, np.arange(6)+98172489)</div>
<div class="line"><span class="lineno"> 1128</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4fbde5643f7f2914732b99a3f43b581" name="ac4fbde5643f7f2914732b99a3f43b581"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4fbde5643f7f2914732b99a3f43b581">&#9670;&#160;</a></span>test_iter_op_axes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_op_axes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1283</span><span class="keyword">def </span>test_iter_op_axes():</div>
<div class="line"><span class="lineno"> 1284</span>    <span class="comment"># Check that custom axes work</span></div>
<div class="line"><span class="lineno"> 1285</span> </div>
<div class="line"><span class="lineno"> 1286</span>    <span class="comment"># Reverse the axes</span></div>
<div class="line"><span class="lineno"> 1287</span>    a = arange(6).reshape(2, 3)</div>
<div class="line"><span class="lineno"> 1288</span>    i = nditer([a, a.T], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2, op_axes=[[0, 1], [1, 0]])</div>
<div class="line"><span class="lineno"> 1289</span>    assert_(all([x == y <span class="keywordflow">for</span> (x, y) <span class="keywordflow">in</span> i]))</div>
<div class="line"><span class="lineno"> 1290</span>    a = arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1291</span>    i = nditer([a.T, a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2, op_axes=[[2, 1, 0], <span class="keywordtype">None</span>])</div>
<div class="line"><span class="lineno"> 1292</span>    assert_(all([x == y <span class="keywordflow">for</span> (x, y) <span class="keywordflow">in</span> i]))</div>
<div class="line"><span class="lineno"> 1293</span> </div>
<div class="line"><span class="lineno"> 1294</span>    <span class="comment"># Broadcast 1D to any dimension</span></div>
<div class="line"><span class="lineno"> 1295</span>    a = arange(1, 31).reshape(2, 3, 5)</div>
<div class="line"><span class="lineno"> 1296</span>    b = arange(1, 3)</div>
<div class="line"><span class="lineno"> 1297</span>    i = nditer([a, b], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2, op_axes=[<span class="keywordtype">None</span>, [0, -1, -1]])</div>
<div class="line"><span class="lineno"> 1298</span>    assert_equal([x*y <span class="keywordflow">for</span> (x, y) <span class="keywordflow">in</span> i], (a*b.reshape(2, 1, 1)).ravel())</div>
<div class="line"><span class="lineno"> 1299</span>    b = arange(1, 4)</div>
<div class="line"><span class="lineno"> 1300</span>    i = nditer([a, b], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2, op_axes=[<span class="keywordtype">None</span>, [-1, 0, -1]])</div>
<div class="line"><span class="lineno"> 1301</span>    assert_equal([x*y <span class="keywordflow">for</span> (x, y) <span class="keywordflow">in</span> i], (a*b.reshape(1, 3, 1)).ravel())</div>
<div class="line"><span class="lineno"> 1302</span>    b = arange(1, 6)</div>
<div class="line"><span class="lineno"> 1303</span>    i = nditer([a, b], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1304</span>                            op_axes=[<span class="keywordtype">None</span>, [np.newaxis, np.newaxis, 0]])</div>
<div class="line"><span class="lineno"> 1305</span>    assert_equal([x*y <span class="keywordflow">for</span> (x, y) <span class="keywordflow">in</span> i], (a*b.reshape(1, 1, 5)).ravel())</div>
<div class="line"><span class="lineno"> 1306</span> </div>
<div class="line"><span class="lineno"> 1307</span>    <span class="comment"># Inner product-style broadcasting</span></div>
<div class="line"><span class="lineno"> 1308</span>    a = arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1309</span>    b = arange(40).reshape(5, 2, 4)</div>
<div class="line"><span class="lineno"> 1310</span>    i = nditer([a, b], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1311</span>                            op_axes=[[0, 1, -1, -1], [-1, -1, 0, 1]])</div>
<div class="line"><span class="lineno"> 1312</span>    assert_equal(i.shape, (2, 3, 5, 2))</div>
<div class="line"><span class="lineno"> 1313</span> </div>
<div class="line"><span class="lineno"> 1314</span>    <span class="comment"># Matrix product-style broadcasting</span></div>
<div class="line"><span class="lineno"> 1315</span>    a = arange(12).reshape(3, 4)</div>
<div class="line"><span class="lineno"> 1316</span>    b = arange(20).reshape(4, 5)</div>
<div class="line"><span class="lineno"> 1317</span>    i = nditer([a, b], [<span class="stringliteral">&#39;multi_index&#39;</span>], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1318</span>                            op_axes=[[0, -1], [-1, 1]])</div>
<div class="line"><span class="lineno"> 1319</span>    assert_equal(i.shape, (3, 5))</div>
<div class="line"><span class="lineno"> 1320</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae9efc276ed97ec815ca4c7bc3d0a5565" name="ae9efc276ed97ec815ca4c7bc3d0a5565"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9efc276ed97ec815ca4c7bc3d0a5565">&#9670;&#160;</a></span>test_iter_op_axes_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_op_axes_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1321</span><span class="keyword">def </span>test_iter_op_axes_errors():</div>
<div class="line"><span class="lineno"> 1322</span>    <span class="comment"># Check that custom axes throws errors for bad inputs</span></div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>    <span class="comment"># Wrong number of items in op_axes</span></div>
<div class="line"><span class="lineno"> 1325</span>    a = arange(6).reshape(2, 3)</div>
<div class="line"><span class="lineno"> 1326</span>    assert_raises(ValueError, nditer, [a, a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1327</span>                                    op_axes=[[0], [1], [0]])</div>
<div class="line"><span class="lineno"> 1328</span>    <span class="comment"># Out of bounds items in op_axes</span></div>
<div class="line"><span class="lineno"> 1329</span>    assert_raises(ValueError, nditer, [a, a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1330</span>                                    op_axes=[[2, 1], [0, 1]])</div>
<div class="line"><span class="lineno"> 1331</span>    assert_raises(ValueError, nditer, [a, a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1332</span>                                    op_axes=[[0, 1], [2, -1]])</div>
<div class="line"><span class="lineno"> 1333</span>    <span class="comment"># Duplicate items in op_axes</span></div>
<div class="line"><span class="lineno"> 1334</span>    assert_raises(ValueError, nditer, [a, a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1335</span>                                    op_axes=[[0, 0], [0, 1]])</div>
<div class="line"><span class="lineno"> 1336</span>    assert_raises(ValueError, nditer, [a, a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1337</span>                                    op_axes=[[0, 1], [1, 1]])</div>
<div class="line"><span class="lineno"> 1338</span> </div>
<div class="line"><span class="lineno"> 1339</span>    <span class="comment"># Different sized arrays in op_axes</span></div>
<div class="line"><span class="lineno"> 1340</span>    assert_raises(ValueError, nditer, [a, a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1341</span>                                    op_axes=[[0, 1], [0, 1, 0]])</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>    <span class="comment"># Non-broadcastable dimensions in the result</span></div>
<div class="line"><span class="lineno"> 1344</span>    assert_raises(ValueError, nditer, [a, a], [], [[<span class="stringliteral">&#39;readonly&#39;</span>]]*2,</div>
<div class="line"><span class="lineno"> 1345</span>                                    op_axes=[[0, 1], [1, 0]])</div>
<div class="line"><span class="lineno"> 1346</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab04db4f7d5b6e447754f7e39c9731ceb" name="ab04db4f7d5b6e447754f7e39c9731ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab04db4f7d5b6e447754f7e39c9731ceb">&#9670;&#160;</a></span>test_iter_reduction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_reduction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2537</span><span class="keyword">def </span>test_iter_reduction():</div>
<div class="line"><span class="lineno"> 2538</span>    <span class="comment"># Test doing reductions with the iterator</span></div>
<div class="line"><span class="lineno"> 2539</span> </div>
<div class="line"><span class="lineno"> 2540</span>    a = np.arange(6)</div>
<div class="line"><span class="lineno"> 2541</span>    i = nditer([a, <span class="keywordtype">None</span>], [<span class="stringliteral">&#39;reduce_ok&#39;</span>],</div>
<div class="line"><span class="lineno"> 2542</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2543</span>                    op_axes=[[0], [-1]])</div>
<div class="line"><span class="lineno"> 2544</span>    <span class="comment"># Need to initialize the output operand to the addition unit</span></div>
<div class="line"><span class="lineno"> 2545</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 2546</span>        i.operands[1][...] = 0</div>
<div class="line"><span class="lineno"> 2547</span>        <span class="comment"># Do the reduction</span></div>
<div class="line"><span class="lineno"> 2548</span>        <span class="keywordflow">for</span> x, y <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2549</span>            y[...] += x</div>
<div class="line"><span class="lineno"> 2550</span>        <span class="comment"># Since no axes were specified, should have allocated a scalar</span></div>
<div class="line"><span class="lineno"> 2551</span>        assert_equal(i.operands[1].ndim, 0)</div>
<div class="line"><span class="lineno"> 2552</span>        assert_equal(i.operands[1], np.sum(a))</div>
<div class="line"><span class="lineno"> 2553</span> </div>
<div class="line"><span class="lineno"> 2554</span>    a = np.arange(6).reshape(2, 3)</div>
<div class="line"><span class="lineno"> 2555</span>    i = nditer([a, <span class="keywordtype">None</span>], [<span class="stringliteral">&#39;reduce_ok&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2556</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2557</span>                    op_axes=[[0, 1], [-1, -1]])</div>
<div class="line"><span class="lineno"> 2558</span>    <span class="comment"># Need to initialize the output operand to the addition unit</span></div>
<div class="line"><span class="lineno"> 2559</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 2560</span>        i.operands[1][...] = 0</div>
<div class="line"><span class="lineno"> 2561</span>        <span class="comment"># Reduction shape/strides for the output</span></div>
<div class="line"><span class="lineno"> 2562</span>        assert_equal(i[1].shape, (6,))</div>
<div class="line"><span class="lineno"> 2563</span>        assert_equal(i[1].strides, (0,))</div>
<div class="line"><span class="lineno"> 2564</span>        <span class="comment"># Do the reduction</span></div>
<div class="line"><span class="lineno"> 2565</span>        <span class="keywordflow">for</span> x, y <span class="keywordflow">in</span> i:</div>
<div class="line"><span class="lineno"> 2566</span>            <span class="comment"># Use a for loop instead of ``y[...] += x``</span></div>
<div class="line"><span class="lineno"> 2567</span>            <span class="comment"># (equivalent to ``y[...] = y[...].copy() + x``),</span></div>
<div class="line"><span class="lineno"> 2568</span>            <span class="comment"># because y has zero strides we use for the reduction</span></div>
<div class="line"><span class="lineno"> 2569</span>            <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(len(y)):</div>
<div class="line"><span class="lineno"> 2570</span>                y[j] += x[j]</div>
<div class="line"><span class="lineno"> 2571</span>        <span class="comment"># Since no axes were specified, should have allocated a scalar</span></div>
<div class="line"><span class="lineno"> 2572</span>        assert_equal(i.operands[1].ndim, 0)</div>
<div class="line"><span class="lineno"> 2573</span>        assert_equal(i.operands[1], np.sum(a))</div>
<div class="line"><span class="lineno"> 2574</span> </div>
<div class="line"><span class="lineno"> 2575</span>    <span class="comment"># This is a tricky reduction case for the buffering double loop</span></div>
<div class="line"><span class="lineno"> 2576</span>    <span class="comment"># to handle</span></div>
<div class="line"><span class="lineno"> 2577</span>    a = np.ones((2, 3, 5))</div>
<div class="line"><span class="lineno"> 2578</span>    it1 = nditer([a, <span class="keywordtype">None</span>], [<span class="stringliteral">&#39;reduce_ok&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2579</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2580</span>                    op_axes=[<span class="keywordtype">None</span>, [0, -1, 1]])</div>
<div class="line"><span class="lineno"> 2581</span>    it2 = nditer([a, <span class="keywordtype">None</span>], [<span class="stringliteral">&#39;reduce_ok&#39;</span>, <span class="stringliteral">&#39;external_loop&#39;</span>,</div>
<div class="line"><span class="lineno"> 2582</span>                            <span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&#39;delay_bufalloc&#39;</span>],</div>
<div class="line"><span class="lineno"> 2583</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2584</span>                    op_axes=[<span class="keywordtype">None</span>, [0, -1, 1]], buffersize=10)</div>
<div class="line"><span class="lineno"> 2585</span>    <span class="keyword">with</span> it1, it2:</div>
<div class="line"><span class="lineno"> 2586</span>        it1.operands[1].fill(0)</div>
<div class="line"><span class="lineno"> 2587</span>        it2.operands[1].fill(0)</div>
<div class="line"><span class="lineno"> 2588</span>        it2.reset()</div>
<div class="line"><span class="lineno"> 2589</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> it1:</div>
<div class="line"><span class="lineno"> 2590</span>            x[1][...] += x[0]</div>
<div class="line"><span class="lineno"> 2591</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> it2:</div>
<div class="line"><span class="lineno"> 2592</span>            x[1][...] += x[0]</div>
<div class="line"><span class="lineno"> 2593</span>        assert_equal(it1.operands[1], it2.operands[1])</div>
<div class="line"><span class="lineno"> 2594</span>        assert_equal(it2.operands[1].sum(), a.size)</div>
<div class="line"><span class="lineno"> 2595</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4683344487d5cab3c31ac6cf1aa9f706" name="a4683344487d5cab3c31ac6cf1aa9f706"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4683344487d5cab3c31ac6cf1aa9f706">&#9670;&#160;</a></span>test_iter_reduction_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_reduction_error </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2525</span><span class="keyword">def </span>test_iter_reduction_error():</div>
<div class="line"><span class="lineno"> 2526</span> </div>
<div class="line"><span class="lineno"> 2527</span>    a = np.arange(6)</div>
<div class="line"><span class="lineno"> 2528</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [],</div>
<div class="line"><span class="lineno"> 2529</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2530</span>                    op_axes=[[0], [-1]])</div>
<div class="line"><span class="lineno"> 2531</span> </div>
<div class="line"><span class="lineno"> 2532</span>    a = np.arange(6).reshape(2, 3)</div>
<div class="line"><span class="lineno"> 2533</span>    assert_raises(ValueError, nditer, [a, <span class="keywordtype">None</span>], [<span class="stringliteral">&#39;external_loop&#39;</span>],</div>
<div class="line"><span class="lineno"> 2534</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;allocate&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2535</span>                    op_axes=[[0, 1], [-1, -1]])</div>
<div class="line"><span class="lineno"> 2536</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c53e67d057e4639dd01fb8882e125bb" name="a0c53e67d057e4639dd01fb8882e125bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c53e67d057e4639dd01fb8882e125bb">&#9670;&#160;</a></span>test_iter_refcount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_refcount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   38</span><span class="keyword">def </span>test_iter_refcount():</div>
<div class="line"><span class="lineno">   39</span>    <span class="comment"># Make sure the iterator doesn&#39;t leak</span></div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>    <span class="comment"># Basic</span></div>
<div class="line"><span class="lineno">   42</span>    a = arange(6)</div>
<div class="line"><span class="lineno">   43</span>    dt = np.dtype(<span class="stringliteral">&#39;f4&#39;</span>).newbyteorder()</div>
<div class="line"><span class="lineno">   44</span>    rc_a = sys.getrefcount(a)</div>
<div class="line"><span class="lineno">   45</span>    rc_dt = sys.getrefcount(dt)</div>
<div class="line"><span class="lineno">   46</span>    <span class="keyword">with</span> nditer(a, [],</div>
<div class="line"><span class="lineno">   47</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno">   48</span>                casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno">   49</span>                op_dtypes=[dt]) <span class="keyword">as</span> it:</div>
<div class="line"><span class="lineno">   50</span>        assert_(<span class="keywordflow">not</span> it.iterationneedsapi)</div>
<div class="line"><span class="lineno">   51</span>        assert_(sys.getrefcount(a) &gt; rc_a)</div>
<div class="line"><span class="lineno">   52</span>        assert_(sys.getrefcount(dt) &gt; rc_dt)</div>
<div class="line"><span class="lineno">   53</span>    <span class="comment"># del &#39;it&#39;</span></div>
<div class="line"><span class="lineno">   54</span>    it = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   55</span>    assert_equal(sys.getrefcount(a), rc_a)</div>
<div class="line"><span class="lineno">   56</span>    assert_equal(sys.getrefcount(dt), rc_dt)</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>    <span class="comment"># With a copy</span></div>
<div class="line"><span class="lineno">   59</span>    a = arange(6, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno">   60</span>    dt = np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno">   61</span>    rc_a = sys.getrefcount(a)</div>
<div class="line"><span class="lineno">   62</span>    rc_dt = sys.getrefcount(dt)</div>
<div class="line"><span class="lineno">   63</span>    it = nditer(a, [],</div>
<div class="line"><span class="lineno">   64</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>]],</div>
<div class="line"><span class="lineno">   65</span>                op_dtypes=[dt])</div>
<div class="line"><span class="lineno">   66</span>    rc2_a = sys.getrefcount(a)</div>
<div class="line"><span class="lineno">   67</span>    rc2_dt = sys.getrefcount(dt)</div>
<div class="line"><span class="lineno">   68</span>    it2 = it.copy()</div>
<div class="line"><span class="lineno">   69</span>    assert_(sys.getrefcount(a) &gt; rc2_a)</div>
<div class="line"><span class="lineno">   70</span>    assert_(sys.getrefcount(dt) &gt; rc2_dt)</div>
<div class="line"><span class="lineno">   71</span>    it = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   72</span>    assert_equal(sys.getrefcount(a), rc2_a)</div>
<div class="line"><span class="lineno">   73</span>    assert_equal(sys.getrefcount(dt), rc2_dt)</div>
<div class="line"><span class="lineno">   74</span>    it2 = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   75</span>    assert_equal(sys.getrefcount(a), rc_a)</div>
<div class="line"><span class="lineno">   76</span>    assert_equal(sys.getrefcount(dt), rc_dt)</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>    del it2  <span class="comment"># avoid pyflakes unused variable warning</span></div>
<div class="line"><span class="lineno">   79</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af623e19dc12722a168cb9f6ab6689165" name="af623e19dc12722a168cb9f6ab6689165"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af623e19dc12722a168cb9f6ab6689165">&#9670;&#160;</a></span>test_iter_remove_axis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_remove_axis </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1636</span><span class="keyword">def </span>test_iter_remove_axis():</div>
<div class="line"><span class="lineno"> 1637</span>    a = arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>    i = nditer(a, [<span class="stringliteral">&#39;multi_index&#39;</span>])</div>
<div class="line"><span class="lineno"> 1640</span>    i.remove_axis(1)</div>
<div class="line"><span class="lineno"> 1641</span>    assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a[:, 0,:].ravel())</div>
<div class="line"><span class="lineno"> 1642</span> </div>
<div class="line"><span class="lineno"> 1643</span>    a = a[::-1,:,:]</div>
<div class="line"><span class="lineno"> 1644</span>    i = nditer(a, [<span class="stringliteral">&#39;multi_index&#39;</span>])</div>
<div class="line"><span class="lineno"> 1645</span>    i.remove_axis(0)</div>
<div class="line"><span class="lineno"> 1646</span>    assert_equal([x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i], a[0,:,:].ravel())</div>
<div class="line"><span class="lineno"> 1647</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d88c3b7a831a49cb6f9a7cc8ead2878" name="a1d88c3b7a831a49cb6f9a7cc8ead2878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d88c3b7a831a49cb6f9a7cc8ead2878">&#9670;&#160;</a></span>test_iter_remove_multi_index_inner_loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_remove_multi_index_inner_loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1648</span><span class="keyword">def </span>test_iter_remove_multi_index_inner_loop():</div>
<div class="line"><span class="lineno"> 1649</span>    <span class="comment"># Check that removing multi-index support works</span></div>
<div class="line"><span class="lineno"> 1650</span> </div>
<div class="line"><span class="lineno"> 1651</span>    a = arange(24).reshape(2, 3, 4)</div>
<div class="line"><span class="lineno"> 1652</span> </div>
<div class="line"><span class="lineno"> 1653</span>    i = nditer(a, [<span class="stringliteral">&#39;multi_index&#39;</span>])</div>
<div class="line"><span class="lineno"> 1654</span>    assert_equal(i.ndim, 3)</div>
<div class="line"><span class="lineno"> 1655</span>    assert_equal(i.shape, (2, 3, 4))</div>
<div class="line"><span class="lineno"> 1656</span>    assert_equal(i.itviews[0].shape, (2, 3, 4))</div>
<div class="line"><span class="lineno"> 1657</span> </div>
<div class="line"><span class="lineno"> 1658</span>    <span class="comment"># Removing the multi-index tracking causes all dimensions to coalesce</span></div>
<div class="line"><span class="lineno"> 1659</span>    before = [x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i]</div>
<div class="line"><span class="lineno"> 1660</span>    i.remove_multi_index()</div>
<div class="line"><span class="lineno"> 1661</span>    after = [x <span class="keywordflow">for</span> x <span class="keywordflow">in</span> i]</div>
<div class="line"><span class="lineno"> 1662</span> </div>
<div class="line"><span class="lineno"> 1663</span>    assert_equal(before, after)</div>
<div class="line"><span class="lineno"> 1664</span>    assert_equal(i.ndim, 1)</div>
<div class="line"><span class="lineno"> 1665</span>    assert_raises(ValueError, <span class="keyword">lambda</span> i:i.shape, i)</div>
<div class="line"><span class="lineno"> 1666</span>    assert_equal(i.itviews[0].shape, (24,))</div>
<div class="line"><span class="lineno"> 1667</span> </div>
<div class="line"><span class="lineno"> 1668</span>    <span class="comment"># Removing the inner loop means there&#39;s just one iteration</span></div>
<div class="line"><span class="lineno"> 1669</span>    i.reset()</div>
<div class="line"><span class="lineno"> 1670</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno"> 1671</span>    assert_equal(i[0].shape, tuple())</div>
<div class="line"><span class="lineno"> 1672</span>    i.enable_external_loop()</div>
<div class="line"><span class="lineno"> 1673</span>    assert_equal(i.itersize, 24)</div>
<div class="line"><span class="lineno"> 1674</span>    assert_equal(i[0].shape, (24,))</div>
<div class="line"><span class="lineno"> 1675</span>    assert_equal(i.value, arange(24))</div>
<div class="line"><span class="lineno"> 1676</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac1de306e4d18fe5460952ea9f90b56e3" name="ac1de306e4d18fe5460952ea9f90b56e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1de306e4d18fe5460952ea9f90b56e3">&#9670;&#160;</a></span>test_iter_scalar_cast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_scalar_cast </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  988</span><span class="keyword">def </span>test_iter_scalar_cast():</div>
<div class="line"><span class="lineno">  989</span>    <span class="comment"># Check that scalars are cast as requested</span></div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>    <span class="comment"># No cast &#39;f4&#39; -&gt; &#39;f4&#39;</span></div>
<div class="line"><span class="lineno">  992</span>    i = nditer(np.float32(2.5), [], [[<span class="stringliteral">&#39;readonly&#39;</span>]],</div>
<div class="line"><span class="lineno">  993</span>                    op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno">  994</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno">  995</span>    assert_equal(i.value.dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno">  996</span>    assert_equal(i.value, 2.5)</div>
<div class="line"><span class="lineno">  997</span>    <span class="comment"># Safe cast &#39;f4&#39; -&gt; &#39;f8&#39;</span></div>
<div class="line"><span class="lineno">  998</span>    i = nditer(np.float32(2.5), [],</div>
<div class="line"><span class="lineno">  999</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1000</span>                    casting=<span class="stringliteral">&#39;safe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1001</span>                    op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1002</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1003</span>    assert_equal(i.value.dtype, np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1004</span>    assert_equal(i.value, 2.5)</div>
<div class="line"><span class="lineno"> 1005</span>    <span class="comment"># Same-kind cast &#39;f8&#39; -&gt; &#39;f4&#39;</span></div>
<div class="line"><span class="lineno"> 1006</span>    i = nditer(np.float64(2.5), [],</div>
<div class="line"><span class="lineno"> 1007</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1008</span>                    casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno"> 1009</span>                    op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1010</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1011</span>    assert_equal(i.value.dtype, np.dtype(<span class="stringliteral">&#39;f4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1012</span>    assert_equal(i.value, 2.5)</div>
<div class="line"><span class="lineno"> 1013</span>    <span class="comment"># Unsafe cast &#39;f8&#39; -&gt; &#39;i4&#39;</span></div>
<div class="line"><span class="lineno"> 1014</span>    i = nditer(np.float64(3.0), [],</div>
<div class="line"><span class="lineno"> 1015</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;copy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1016</span>                    casting=<span class="stringliteral">&#39;unsafe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1017</span>                    op_dtypes=[np.dtype(<span class="stringliteral">&#39;i4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1018</span>    assert_equal(i.dtypes[0], np.dtype(<span class="stringliteral">&#39;i4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1019</span>    assert_equal(i.value.dtype, np.dtype(<span class="stringliteral">&#39;i4&#39;</span>))</div>
<div class="line"><span class="lineno"> 1020</span>    assert_equal(i.value, 3)</div>
<div class="line"><span class="lineno"> 1021</span>    <span class="comment"># Readonly scalars may be cast even without setting COPY or BUFFERED</span></div>
<div class="line"><span class="lineno"> 1022</span>    i = nditer(3, [], [[<span class="stringliteral">&#39;readonly&#39;</span>]], op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1023</span>    assert_equal(i[0].dtype, np.dtype(<span class="stringliteral">&#39;f8&#39;</span>))</div>
<div class="line"><span class="lineno"> 1024</span>    assert_equal(i[0], 3.)</div>
<div class="line"><span class="lineno"> 1025</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6ddce2e8bedc1670fd130f1a79ab644d" name="a6ddce2e8bedc1670fd130f1a79ab644d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ddce2e8bedc1670fd130f1a79ab644d">&#9670;&#160;</a></span>test_iter_scalar_cast_errors()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_scalar_cast_errors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1026</span><span class="keyword">def </span>test_iter_scalar_cast_errors():</div>
<div class="line"><span class="lineno"> 1027</span>    <span class="comment"># Check that invalid casts are caught</span></div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span>    <span class="comment"># Need to allow copying/buffering for write casts of scalars to occur</span></div>
<div class="line"><span class="lineno"> 1030</span>    assert_raises(TypeError, nditer, np.float32(2), [],</div>
<div class="line"><span class="lineno"> 1031</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>]], op_dtypes=[np.dtype(<span class="stringliteral">&#39;f8&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1032</span>    assert_raises(TypeError, nditer, 2.5, [],</div>
<div class="line"><span class="lineno"> 1033</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>]], op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1034</span>    <span class="comment"># &#39;f8&#39; -&gt; &#39;f4&#39; isn&#39;t a safe cast if the value would overflow</span></div>
<div class="line"><span class="lineno"> 1035</span>    assert_raises(TypeError, nditer, np.float64(1e60), [],</div>
<div class="line"><span class="lineno"> 1036</span>                [[<span class="stringliteral">&#39;readonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1037</span>                casting=<span class="stringliteral">&#39;safe&#39;</span>,</div>
<div class="line"><span class="lineno"> 1038</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1039</span>    <span class="comment"># &#39;f4&#39; -&gt; &#39;i4&#39; is neither a safe nor a same-kind cast</span></div>
<div class="line"><span class="lineno"> 1040</span>    assert_raises(TypeError, nditer, np.float32(2), [],</div>
<div class="line"><span class="lineno"> 1041</span>                [[<span class="stringliteral">&#39;readonly&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1042</span>                casting=<span class="stringliteral">&#39;same_kind&#39;</span>,</div>
<div class="line"><span class="lineno"> 1043</span>                op_dtypes=[np.dtype(<span class="stringliteral">&#39;i4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 1044</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad036cc8de2a9ff8d455935e08daeb51a" name="ad036cc8de2a9ff8d455935e08daeb51a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad036cc8de2a9ff8d455935e08daeb51a">&#9670;&#160;</a></span>test_iter_slice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_slice </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  790</span><span class="keyword">def </span>test_iter_slice():</div>
<div class="line"><span class="lineno">  791</span>    a, b, c = np.arange(3), np.arange(3), np.arange(3.)</div>
<div class="line"><span class="lineno">  792</span>    i = nditer([a, b, c], [], [<span class="stringliteral">&#39;readwrite&#39;</span>])</div>
<div class="line"><span class="lineno">  793</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno">  794</span>        i[0:2] = (3, 3)</div>
<div class="line"><span class="lineno">  795</span>        assert_equal(a, [3, 1, 2])</div>
<div class="line"><span class="lineno">  796</span>        assert_equal(b, [3, 1, 2])</div>
<div class="line"><span class="lineno">  797</span>        assert_equal(c, [0, 1, 2])</div>
<div class="line"><span class="lineno">  798</span>        i[1] = 12</div>
<div class="line"><span class="lineno">  799</span>        assert_equal(i[0:2], [3, 12])</div>
<div class="line"><span class="lineno">  800</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a51ebae33d472f29ca76b3799ee5cdea4" name="a51ebae33d472f29ca76b3799ee5cdea4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a51ebae33d472f29ca76b3799ee5cdea4">&#9670;&#160;</a></span>test_iter_too_large()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_too_large </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3010</span><span class="keyword">def </span>test_iter_too_large():</div>
<div class="line"><span class="lineno"> 3011</span>    <span class="comment"># The total size of the iterator must not exceed the maximum intp due</span></div>
<div class="line"><span class="lineno"> 3012</span>    <span class="comment"># to broadcasting. Dividing by 1024 will keep it small enough to</span></div>
<div class="line"><span class="lineno"> 3013</span>    <span class="comment"># give a legal array.</span></div>
<div class="line"><span class="lineno"> 3014</span>    size = np.iinfo(np.intp).max // 1024</div>
<div class="line"><span class="lineno"> 3015</span>    arr = np.lib.stride_tricks.as_strided(np.zeros(1), (size,), (0,))</div>
<div class="line"><span class="lineno"> 3016</span>    assert_raises(ValueError, nditer, (arr, arr[:, <span class="keywordtype">None</span>]))</div>
<div class="line"><span class="lineno"> 3017</span>    <span class="comment"># test the same for multiindex. That may get more interesting when</span></div>
<div class="line"><span class="lineno"> 3018</span>    <span class="comment"># removing 0 dimensional axis is allowed (since an iterator can grow then)</span></div>
<div class="line"><span class="lineno"> 3019</span>    assert_raises(ValueError, nditer,</div>
<div class="line"><span class="lineno"> 3020</span>                  (arr, arr[:, <span class="keywordtype">None</span>]), flags=[<span class="stringliteral">&#39;multi_index&#39;</span>])</div>
<div class="line"><span class="lineno"> 3021</span> </div>
<div class="line"><span class="lineno"> 3022</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abb221ebebf658e9106d881856a6d625d" name="abb221ebebf658e9106d881856a6d625d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb221ebebf658e9106d881856a6d625d">&#9670;&#160;</a></span>test_iter_too_large_with_multiindex()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_too_large_with_multiindex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3023</span><span class="keyword">def </span>test_iter_too_large_with_multiindex():</div>
<div class="line"><span class="lineno"> 3024</span>    <span class="comment"># When a multi index is being tracked, the error is delayed this</span></div>
<div class="line"><span class="lineno"> 3025</span>    <span class="comment"># checks the delayed error messages and getting below that by</span></div>
<div class="line"><span class="lineno"> 3026</span>    <span class="comment"># removing an axis.</span></div>
<div class="line"><span class="lineno"> 3027</span>    base_size = 2**10</div>
<div class="line"><span class="lineno"> 3028</span>    num = 1</div>
<div class="line"><span class="lineno"> 3029</span>    <span class="keywordflow">while</span> base_size**num &lt; np.iinfo(np.intp).max:</div>
<div class="line"><span class="lineno"> 3030</span>        num += 1</div>
<div class="line"><span class="lineno"> 3031</span> </div>
<div class="line"><span class="lineno"> 3032</span>    shape_template = [1, 1] * num</div>
<div class="line"><span class="lineno"> 3033</span>    arrays = []</div>
<div class="line"><span class="lineno"> 3034</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(num):</div>
<div class="line"><span class="lineno"> 3035</span>        shape = shape_template[:]</div>
<div class="line"><span class="lineno"> 3036</span>        shape[i * 2] = 2**10</div>
<div class="line"><span class="lineno"> 3037</span>        arrays.append(np.empty(shape))</div>
<div class="line"><span class="lineno"> 3038</span>    arrays = tuple(arrays)</div>
<div class="line"><span class="lineno"> 3039</span> </div>
<div class="line"><span class="lineno"> 3040</span>    <span class="comment"># arrays are now too large to be broadcast. The different modes test</span></div>
<div class="line"><span class="lineno"> 3041</span>    <span class="comment"># different nditer functionality with or without GIL.</span></div>
<div class="line"><span class="lineno"> 3042</span>    <span class="keywordflow">for</span> mode <span class="keywordflow">in</span> range(6):</div>
<div class="line"><span class="lineno"> 3043</span>        <span class="keyword">with</span> assert_raises(ValueError):</div>
<div class="line"><span class="lineno"> 3044</span>            _multiarray_tests.test_nditer_too_large(arrays, -1, mode)</div>
<div class="line"><span class="lineno"> 3045</span>    <span class="comment"># but if we do nothing with the nditer, it can be constructed:</span></div>
<div class="line"><span class="lineno"> 3046</span>    _multiarray_tests.test_nditer_too_large(arrays, -1, 7)</div>
<div class="line"><span class="lineno"> 3047</span> </div>
<div class="line"><span class="lineno"> 3048</span>    <span class="comment"># When an axis is removed, things should work again (half the time):</span></div>
<div class="line"><span class="lineno"> 3049</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(num):</div>
<div class="line"><span class="lineno"> 3050</span>        <span class="keywordflow">for</span> mode <span class="keywordflow">in</span> range(6):</div>
<div class="line"><span class="lineno"> 3051</span>            <span class="comment"># an axis with size 1024 is removed:</span></div>
<div class="line"><span class="lineno"> 3052</span>            _multiarray_tests.test_nditer_too_large(arrays, i*2, mode)</div>
<div class="line"><span class="lineno"> 3053</span>            <span class="comment"># an axis with size 1 is removed:</span></div>
<div class="line"><span class="lineno"> 3054</span>            <span class="keyword">with</span> assert_raises(ValueError):</div>
<div class="line"><span class="lineno"> 3055</span>                _multiarray_tests.test_nditer_too_large(arrays, i*2 + 1, mode)</div>
<div class="line"><span class="lineno"> 3056</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aee631428c5d499b2031dfe3dc9ab5a91" name="aee631428c5d499b2031dfe3dc9ab5a91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee631428c5d499b2031dfe3dc9ab5a91">&#9670;&#160;</a></span>test_iter_writable_attribute_deletion()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_writable_attribute_deletion </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2887</span><span class="keyword">def </span>test_iter_writable_attribute_deletion():</div>
<div class="line"><span class="lineno"> 2888</span>    it = np.nditer(np.ones(2))</div>
<div class="line"><span class="lineno"> 2889</span>    attr = [ <span class="stringliteral">&quot;multi_index&quot;</span>, <span class="stringliteral">&quot;index&quot;</span>, <span class="stringliteral">&quot;iterrange&quot;</span>, <span class="stringliteral">&quot;iterindex&quot;</span>]</div>
<div class="line"><span class="lineno"> 2890</span>    <span class="keywordflow">for</span> s <span class="keywordflow">in</span> attr:</div>
<div class="line"><span class="lineno"> 2891</span>        assert_raises(AttributeError, delattr, it, s)</div>
<div class="line"><span class="lineno"> 2892</span> </div>
<div class="line"><span class="lineno"> 2893</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1edaffd1f8775550604b47e22109612" name="ad1edaffd1f8775550604b47e22109612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1edaffd1f8775550604b47e22109612">&#9670;&#160;</a></span>test_iter_write_buffering()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_write_buffering </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1781</span><span class="keyword">def </span>test_iter_write_buffering():</div>
<div class="line"><span class="lineno"> 1782</span>    <span class="comment"># Test that buffering of writes is working</span></div>
<div class="line"><span class="lineno"> 1783</span> </div>
<div class="line"><span class="lineno"> 1784</span>    <span class="comment"># F-order swapped array</span></div>
<div class="line"><span class="lineno"> 1785</span>    a = np.arange(24).reshape(2, 3, 4).T.newbyteorder().byteswap()</div>
<div class="line"><span class="lineno"> 1786</span>    i = nditer(a, [<span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 1787</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;nbo&#39;</span>, <span class="stringliteral">&#39;aligned&#39;</span>]],</div>
<div class="line"><span class="lineno"> 1788</span>                   casting=<span class="stringliteral">&#39;equiv&#39;</span>,</div>
<div class="line"><span class="lineno"> 1789</span>                   order=<span class="stringliteral">&#39;C&#39;</span>,</div>
<div class="line"><span class="lineno"> 1790</span>                   buffersize=16)</div>
<div class="line"><span class="lineno"> 1791</span>    x = 0</div>
<div class="line"><span class="lineno"> 1792</span>    <span class="keyword">with</span> i:</div>
<div class="line"><span class="lineno"> 1793</span>        <span class="keywordflow">while</span> <span class="keywordflow">not</span> i.finished:</div>
<div class="line"><span class="lineno"> 1794</span>            i[0] = x</div>
<div class="line"><span class="lineno"> 1795</span>            x += 1</div>
<div class="line"><span class="lineno"> 1796</span>            i.iternext()</div>
<div class="line"><span class="lineno"> 1797</span>    assert_equal(a.ravel(order=<span class="stringliteral">&#39;C&#39;</span>), np.arange(24))</div>
<div class="line"><span class="lineno"> 1798</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a68e1e7e20912d6dcf9dda995e3d28a13" name="a68e1e7e20912d6dcf9dda995e3d28a13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68e1e7e20912d6dcf9dda995e3d28a13">&#9670;&#160;</a></span>test_iter_writemasked()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_writemasked </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2759</span><span class="keyword">def </span>test_iter_writemasked(a):</div>
<div class="line"><span class="lineno"> 2760</span>    <span class="comment"># Note, the slicing above is to ensure that nditer cannot combine multiple</span></div>
<div class="line"><span class="lineno"> 2761</span>    <span class="comment"># axes into one.  The repetition is just to make things a bit more</span></div>
<div class="line"><span class="lineno"> 2762</span>    <span class="comment"># interesting.</span></div>
<div class="line"><span class="lineno"> 2763</span>    shape = a.shape</div>
<div class="line"><span class="lineno"> 2764</span>    reps = shape[-1] // 3</div>
<div class="line"><span class="lineno"> 2765</span>    msk = np.empty(shape, dtype=bool)</div>
<div class="line"><span class="lineno"> 2766</span>    msk[...] = [<span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">False</span>] * reps</div>
<div class="line"><span class="lineno"> 2767</span> </div>
<div class="line"><span class="lineno"> 2768</span>    <span class="comment"># When buffering is unused, &#39;writemasked&#39; effectively does nothing.</span></div>
<div class="line"><span class="lineno"> 2769</span>    <span class="comment"># It&#39;s up to the user of the iterator to obey the requested semantics.</span></div>
<div class="line"><span class="lineno"> 2770</span>    it = np.nditer([a, msk], [],</div>
<div class="line"><span class="lineno"> 2771</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2772</span>                 [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2773</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 2774</span>        <span class="keywordflow">for</span> x, m <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 2775</span>            x[...] = 1</div>
<div class="line"><span class="lineno"> 2776</span>    <span class="comment"># Because we violated the semantics, all the values became 1</span></div>
<div class="line"><span class="lineno"> 2777</span>    assert_equal(a, np.broadcast_to([1, 1, 1] * reps, shape))</div>
<div class="line"><span class="lineno"> 2778</span> </div>
<div class="line"><span class="lineno"> 2779</span>    <span class="comment"># Even if buffering is enabled, we still may be accessing the array</span></div>
<div class="line"><span class="lineno"> 2780</span>    <span class="comment"># directly.</span></div>
<div class="line"><span class="lineno"> 2781</span>    it = np.nditer([a, msk], [<span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 2782</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2783</span>                 [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2784</span>    <span class="comment"># @seberg: I honestly don&#39;t currently understand why a &quot;buffered&quot; iterator</span></div>
<div class="line"><span class="lineno"> 2785</span>    <span class="comment"># would end up not using a buffer for the small array here at least when</span></div>
<div class="line"><span class="lineno"> 2786</span>    <span class="comment"># &quot;writemasked&quot; is used, that seems confusing...  Check by testing for</span></div>
<div class="line"><span class="lineno"> 2787</span>    <span class="comment"># actual memory overlap!</span></div>
<div class="line"><span class="lineno"> 2788</span>    is_buffered = <span class="keyword">True</span></div>
<div class="line"><span class="lineno"> 2789</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 2790</span>        <span class="keywordflow">for</span> x, m <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 2791</span>            x[...] = 2.5</div>
<div class="line"><span class="lineno"> 2792</span>            <span class="keywordflow">if</span> np.may_share_memory(x, a):</div>
<div class="line"><span class="lineno"> 2793</span>                is_buffered = <span class="keyword">False</span></div>
<div class="line"><span class="lineno"> 2794</span> </div>
<div class="line"><span class="lineno"> 2795</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_buffered:</div>
<div class="line"><span class="lineno"> 2796</span>        <span class="comment"># Because we violated the semantics, all the values became 2.5</span></div>
<div class="line"><span class="lineno"> 2797</span>        assert_equal(a, np.broadcast_to([2.5, 2.5, 2.5] * reps, shape))</div>
<div class="line"><span class="lineno"> 2798</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2799</span>        <span class="comment"># For large sizes, the iterator may be buffered:</span></div>
<div class="line"><span class="lineno"> 2800</span>        assert_equal(a, np.broadcast_to([2.5, 2.5, 1] * reps, shape))</div>
<div class="line"><span class="lineno"> 2801</span>        a[...] = 2.5</div>
<div class="line"><span class="lineno"> 2802</span> </div>
<div class="line"><span class="lineno"> 2803</span>    <span class="comment"># If buffering will definitely happening, for instance because of</span></div>
<div class="line"><span class="lineno"> 2804</span>    <span class="comment"># a cast, only the items selected by the mask will be copied back from</span></div>
<div class="line"><span class="lineno"> 2805</span>    <span class="comment"># the buffer.</span></div>
<div class="line"><span class="lineno"> 2806</span>    it = np.nditer([a, msk], [<span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 2807</span>                [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2808</span>                 [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2809</span>                op_dtypes=[<span class="stringliteral">&#39;i8&#39;</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 2810</span>                casting=<span class="stringliteral">&#39;unsafe&#39;</span>)</div>
<div class="line"><span class="lineno"> 2811</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 2812</span>        <span class="keywordflow">for</span> x, m <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 2813</span>            x[...] = 3</div>
<div class="line"><span class="lineno"> 2814</span>    <span class="comment"># Even though we violated the semantics, only the selected values</span></div>
<div class="line"><span class="lineno"> 2815</span>    <span class="comment"># were copied back</span></div>
<div class="line"><span class="lineno"> 2816</span>    assert_equal(a, np.broadcast_to([3, 3, 2.5] * reps, shape))</div>
<div class="line"><span class="lineno"> 2817</span> </div>
<div class="line"><span class="lineno"> 2818</span> </div>
<div class="line"><span class="lineno"> 2819</span><span class="preprocessor">@pytest.mark.parametrize</span>([<span class="stringliteral">&quot;mask&quot;</span>, <span class="stringliteral">&quot;mask_axes&quot;</span>], [</div>
<div class="line"><span class="lineno"> 2820</span>        <span class="comment"># Allocated operand (only broadcasts with -1)</span></div>
<div class="line"><span class="lineno"> 2821</span>        (<span class="keywordtype">None</span>, [-1, 0]),</div>
<div class="line"><span class="lineno"> 2822</span>        <span class="comment"># Reduction along the first dimension (with and without op_axes)</span></div>
<div class="line"><span class="lineno"> 2823</span>        (np.zeros((1, 4), dtype=<span class="stringliteral">&quot;bool&quot;</span>), [0, 1]),</div>
<div class="line"><span class="lineno"> 2824</span>        (np.zeros((1, 4), dtype=<span class="stringliteral">&quot;bool&quot;</span>), <span class="keywordtype">None</span>),</div>
<div class="line"><span class="lineno"> 2825</span>        <span class="comment"># Test 0-D and -1 op_axes</span></div>
<div class="line"><span class="lineno"> 2826</span>        (np.zeros(4, dtype=<span class="stringliteral">&quot;bool&quot;</span>), [-1, 0]),</div>
<div class="line"><span class="lineno"> 2827</span>        (np.zeros((), dtype=<span class="stringliteral">&quot;bool&quot;</span>), [-1, -1]),</div>
<div class="line"><span class="lineno"> 2828</span>        (np.zeros((), dtype=<span class="stringliteral">&quot;bool&quot;</span>), <span class="keywordtype">None</span>)])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4aca3fe1b32f5ede3dca95f04695643e" name="a4aca3fe1b32f5ede3dca95f04695643e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4aca3fe1b32f5ede3dca95f04695643e">&#9670;&#160;</a></span>test_iter_writemasked_badinput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_writemasked_badinput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2676</span><span class="keyword">def </span>test_iter_writemasked_badinput():</div>
<div class="line"><span class="lineno"> 2677</span>    a = np.zeros((2, 3))</div>
<div class="line"><span class="lineno"> 2678</span>    b = np.zeros((3,))</div>
<div class="line"><span class="lineno"> 2679</span>    m = np.array([[<span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">False</span>], [<span class="keyword">False</span>, <span class="keyword">True</span>, <span class="keyword">False</span>]])</div>
<div class="line"><span class="lineno"> 2680</span>    m2 = np.array([<span class="keyword">True</span>, <span class="keyword">True</span>, <span class="keyword">False</span>])</div>
<div class="line"><span class="lineno"> 2681</span>    m3 = np.array([0, 1, 1], dtype=<span class="stringliteral">&#39;u1&#39;</span>)</div>
<div class="line"><span class="lineno"> 2682</span>    mbad1 = np.array([0, 1, 1], dtype=<span class="stringliteral">&#39;i1&#39;</span>)</div>
<div class="line"><span class="lineno"> 2683</span>    mbad2 = np.array([0, 1, 1], dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno"> 2684</span> </div>
<div class="line"><span class="lineno"> 2685</span>    <span class="comment"># Need an &#39;arraymask&#39; if any operand is &#39;writemasked&#39;</span></div>
<div class="line"><span class="lineno"> 2686</span>    assert_raises(ValueError, nditer, [a, m], [],</div>
<div class="line"><span class="lineno"> 2687</span>                    [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2688</span> </div>
<div class="line"><span class="lineno"> 2689</span>    <span class="comment"># A &#39;writemasked&#39; operand must not be readonly</span></div>
<div class="line"><span class="lineno"> 2690</span>    assert_raises(ValueError, nditer, [a, m], [],</div>
<div class="line"><span class="lineno"> 2691</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2692</span> </div>
<div class="line"><span class="lineno"> 2693</span>    <span class="comment"># &#39;writemasked&#39; and &#39;arraymask&#39; may not be used together</span></div>
<div class="line"><span class="lineno"> 2694</span>    assert_raises(ValueError, nditer, [a, m], [],</div>
<div class="line"><span class="lineno"> 2695</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>], [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2696</span> </div>
<div class="line"><span class="lineno"> 2697</span>    <span class="comment"># &#39;arraymask&#39; may only be specified once</span></div>
<div class="line"><span class="lineno"> 2698</span>    assert_raises(ValueError, nditer, [a, m, m2], [],</div>
<div class="line"><span class="lineno"> 2699</span>                    [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2700</span>                     [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>],</div>
<div class="line"><span class="lineno"> 2701</span>                     [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2702</span> </div>
<div class="line"><span class="lineno"> 2703</span>    <span class="comment"># An &#39;arraymask&#39; with nothing &#39;writemasked&#39; also doesn&#39;t make sense</span></div>
<div class="line"><span class="lineno"> 2704</span>    assert_raises(ValueError, nditer, [a, m], [],</div>
<div class="line"><span class="lineno"> 2705</span>                    [[<span class="stringliteral">&#39;readwrite&#39;</span>], [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2706</span> </div>
<div class="line"><span class="lineno"> 2707</span>    <span class="comment"># A writemasked reduction requires a similarly smaller mask</span></div>
<div class="line"><span class="lineno"> 2708</span>    assert_raises(ValueError, nditer, [a, b, m], [<span class="stringliteral">&#39;reduce_ok&#39;</span>],</div>
<div class="line"><span class="lineno"> 2709</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2710</span>                     [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2711</span>                     [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2712</span>    <span class="comment"># But this should work with a smaller/equal mask to the reduction operand</span></div>
<div class="line"><span class="lineno"> 2713</span>    np.nditer([a, b, m2], [<span class="stringliteral">&#39;reduce_ok&#39;</span>],</div>
<div class="line"><span class="lineno"> 2714</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2715</span>                     [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2716</span>                     [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2717</span>    <span class="comment"># The arraymask itself cannot be a reduction</span></div>
<div class="line"><span class="lineno"> 2718</span>    assert_raises(ValueError, nditer, [a, b, m2], [<span class="stringliteral">&#39;reduce_ok&#39;</span>],</div>
<div class="line"><span class="lineno"> 2719</span>                    [[<span class="stringliteral">&#39;readonly&#39;</span>],</div>
<div class="line"><span class="lineno"> 2720</span>                     [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2721</span>                     [<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]])</div>
<div class="line"><span class="lineno"> 2722</span> </div>
<div class="line"><span class="lineno"> 2723</span>    <span class="comment"># A uint8 mask is ok too</span></div>
<div class="line"><span class="lineno"> 2724</span>    np.nditer([a, m3], [<span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 2725</span>                    [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2726</span>                     [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2727</span>                    op_dtypes=[<span class="stringliteral">&#39;f4&#39;</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 2728</span>                    casting=<span class="stringliteral">&#39;same_kind&#39;</span>)</div>
<div class="line"><span class="lineno"> 2729</span>    <span class="comment"># An int8 mask isn&#39;t ok</span></div>
<div class="line"><span class="lineno"> 2730</span>    assert_raises(TypeError, np.nditer, [a, mbad1], [<span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 2731</span>                    [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2732</span>                     [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2733</span>                    op_dtypes=[<span class="stringliteral">&#39;f4&#39;</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 2734</span>                    casting=<span class="stringliteral">&#39;same_kind&#39;</span>)</div>
<div class="line"><span class="lineno"> 2735</span>    <span class="comment"># A float32 mask isn&#39;t ok</span></div>
<div class="line"><span class="lineno"> 2736</span>    assert_raises(TypeError, np.nditer, [a, mbad2], [<span class="stringliteral">&#39;buffered&#39;</span>],</div>
<div class="line"><span class="lineno"> 2737</span>                    [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2738</span>                     [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2739</span>                    op_dtypes=[<span class="stringliteral">&#39;f4&#39;</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 2740</span>                    casting=<span class="stringliteral">&#39;same_kind&#39;</span>)</div>
<div class="line"><span class="lineno"> 2741</span> </div>
<div class="line"><span class="lineno"> 2742</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a77cbb43a1c29fdb3d3be07e6f1f407f3" name="a77cbb43a1c29fdb3d3be07e6f1f407f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77cbb43a1c29fdb3d3be07e6f1f407f3">&#9670;&#160;</a></span>test_iter_writemasked_broadcast_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_writemasked_broadcast_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>mask_axes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2829</span><span class="keyword">def </span>test_iter_writemasked_broadcast_error(mask, mask_axes):</div>
<div class="line"><span class="lineno"> 2830</span>    <span class="comment"># This assumes that a readwrite mask makes sense. This is likely not the</span></div>
<div class="line"><span class="lineno"> 2831</span>    <span class="comment"># case and should simply be deprecated.</span></div>
<div class="line"><span class="lineno"> 2832</span>    arr = np.zeros((3, 4))</div>
<div class="line"><span class="lineno"> 2833</span>    itflags = [<span class="stringliteral">&quot;reduce_ok&quot;</span>]</div>
<div class="line"><span class="lineno"> 2834</span>    mask_flags = [<span class="stringliteral">&quot;arraymask&quot;</span>, <span class="stringliteral">&quot;readwrite&quot;</span>, <span class="stringliteral">&quot;allocate&quot;</span>]</div>
<div class="line"><span class="lineno"> 2835</span>    a_flags = [<span class="stringliteral">&quot;writeonly&quot;</span>, <span class="stringliteral">&quot;writemasked&quot;</span>]</div>
<div class="line"><span class="lineno"> 2836</span>    <span class="keywordflow">if</span> mask_axes <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2837</span>        op_axes = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2838</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2839</span>        op_axes = [mask_axes, [0, 1]]</div>
<div class="line"><span class="lineno"> 2840</span> </div>
<div class="line"><span class="lineno"> 2841</span>    <span class="keyword">with</span> assert_raises(ValueError):</div>
<div class="line"><span class="lineno"> 2842</span>        np.nditer((mask, arr), flags=itflags, op_flags=[mask_flags, a_flags],</div>
<div class="line"><span class="lineno"> 2843</span>                  op_axes=op_axes)</div>
<div class="line"><span class="lineno"> 2844</span> </div>
<div class="line"><span class="lineno"> 2845</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a6c2146b6bf7df9548ea898370e961ae9" name="a6c2146b6bf7df9548ea898370e961ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c2146b6bf7df9548ea898370e961ae9">&#9670;&#160;</a></span>test_iter_writemasked_decref()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_iter_writemasked_decref </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2846</span><span class="keyword">def </span>test_iter_writemasked_decref():</div>
<div class="line"><span class="lineno"> 2847</span>    <span class="comment"># force casting (to make it interesting) by using a structured dtype.</span></div>
<div class="line"><span class="lineno"> 2848</span>    arr = np.arange(10000).astype(<span class="stringliteral">&quot;&gt;i,O&quot;</span>)</div>
<div class="line"><span class="lineno"> 2849</span>    original = arr.copy()</div>
<div class="line"><span class="lineno"> 2850</span>    mask = np.random.randint(0, 2, size=10000).astype(bool)</div>
<div class="line"><span class="lineno"> 2851</span> </div>
<div class="line"><span class="lineno"> 2852</span>    it = np.nditer([arr, mask], [<span class="stringliteral">&#39;buffered&#39;</span>, <span class="stringliteral">&quot;refs_ok&quot;</span>],</div>
<div class="line"><span class="lineno"> 2853</span>                   [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;writemasked&#39;</span>],</div>
<div class="line"><span class="lineno"> 2854</span>                    [<span class="stringliteral">&#39;readonly&#39;</span>, <span class="stringliteral">&#39;arraymask&#39;</span>]],</div>
<div class="line"><span class="lineno"> 2855</span>                   op_dtypes=[<span class="stringliteral">&quot;&lt;i,O&quot;</span>, <span class="stringliteral">&quot;?&quot;</span>])</div>
<div class="line"><span class="lineno"> 2856</span>    singleton = object()</div>
<div class="line"><span class="lineno"> 2857</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 2858</span>        count = sys.getrefcount(singleton)</div>
<div class="line"><span class="lineno"> 2859</span>    <span class="keywordflow">for</span> buf, mask_buf <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 2860</span>        buf[...] = (3, singleton)</div>
<div class="line"><span class="lineno"> 2861</span> </div>
<div class="line"><span class="lineno"> 2862</span>    del buf, mask_buf, it   <span class="comment"># delete everything to ensure correct cleanup</span></div>
<div class="line"><span class="lineno"> 2863</span> </div>
<div class="line"><span class="lineno"> 2864</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 2865</span>        <span class="comment"># The buffer would have included additional items, they must be</span></div>
<div class="line"><span class="lineno"> 2866</span>        <span class="comment"># cleared correctly:</span></div>
<div class="line"><span class="lineno"> 2867</span>        <span class="keyword">assert</span> sys.getrefcount(singleton) - count == np.count_nonzero(mask)</div>
<div class="line"><span class="lineno"> 2868</span> </div>
<div class="line"><span class="lineno"> 2869</span>    assert_array_equal(arr[~mask], original[~mask])</div>
<div class="line"><span class="lineno"> 2870</span>    <span class="keyword">assert</span> (arr[mask] == np.array((3, singleton), arr.dtype)).all()</div>
<div class="line"><span class="lineno"> 2871</span>    del arr</div>
<div class="line"><span class="lineno"> 2872</span> </div>
<div class="line"><span class="lineno"> 2873</span>    <span class="keywordflow">if</span> HAS_REFCOUNT:</div>
<div class="line"><span class="lineno"> 2874</span>        <span class="keyword">assert</span> sys.getrefcount(singleton) == count</div>
<div class="line"><span class="lineno"> 2875</span> </div>
<div class="line"><span class="lineno"> 2876</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a24e6d498951c94b468fb5741a49fa2a1" name="a24e6d498951c94b468fb5741a49fa2a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24e6d498951c94b468fb5741a49fa2a1">&#9670;&#160;</a></span>test_nditer_multi_index_set()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_nditer_multi_index_set </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  188</span><span class="keyword">def </span>test_nditer_multi_index_set():</div>
<div class="line"><span class="lineno">  189</span>    <span class="comment"># Test the multi_index set</span></div>
<div class="line"><span class="lineno">  190</span>    a = np.arange(6).reshape(2, 3)</div>
<div class="line"><span class="lineno">  191</span>    it = np.nditer(a, flags=[<span class="stringliteral">&#39;multi_index&#39;</span>])</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>    <span class="comment"># Removes the iteration on two first elements of a[0]</span></div>
<div class="line"><span class="lineno">  194</span>    it.multi_index = (0, 2,)</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    assert_equal([i <span class="keywordflow">for</span> i <span class="keywordflow">in</span> it], [2, 3, 4, 5])</div>
<div class="line"><span class="lineno">  197</span>    </div>
<div class="line"><span class="lineno">  198</span><span class="preprocessor">@pytest.mark.skipif(not HAS_REFCOUNT, reason=&quot;Python lacks refcounts&quot;)</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="add45242cd0d4fdff21227a06945b8459" name="add45242cd0d4fdff21227a06945b8459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add45242cd0d4fdff21227a06945b8459">&#9670;&#160;</a></span>test_nditer_multi_index_set_refcount()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_nditer_multi_index_set_refcount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  199</span><span class="keyword">def </span>test_nditer_multi_index_set_refcount():</div>
<div class="line"><span class="lineno">  200</span>    <span class="comment"># Test if the reference count on index variable is decreased</span></div>
<div class="line"><span class="lineno">  201</span>    </div>
<div class="line"><span class="lineno">  202</span>    index = 0</div>
<div class="line"><span class="lineno">  203</span>    i = np.nditer(np.array([111, 222, 333, 444]), flags=[<span class="stringliteral">&#39;multi_index&#39;</span>])</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    start_count = sys.getrefcount(index)</div>
<div class="line"><span class="lineno">  206</span>    i.multi_index = (index,)</div>
<div class="line"><span class="lineno">  207</span>    end_count = sys.getrefcount(index)</div>
<div class="line"><span class="lineno">  208</span>    </div>
<div class="line"><span class="lineno">  209</span>    assert_equal(start_count, end_count)</div>
<div class="line"><span class="lineno">  210</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c2e18e66aacfdf0a86bb31e5316e4c5" name="a9c2e18e66aacfdf0a86bb31e5316e4c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c2e18e66aacfdf0a86bb31e5316e4c5">&#9670;&#160;</a></span>test_object_iter_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_object_iter_cleanup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2969</span><span class="keyword">def </span>test_object_iter_cleanup():</div>
<div class="line"><span class="lineno"> 2970</span>    <span class="comment"># see gh-18450</span></div>
<div class="line"><span class="lineno"> 2971</span>    <span class="comment"># object arrays can raise a python exception in ufunc inner loops using</span></div>
<div class="line"><span class="lineno"> 2972</span>    <span class="comment"># nditer, which should cause iteration to stop &amp; cleanup. There were bugs</span></div>
<div class="line"><span class="lineno"> 2973</span>    <span class="comment"># in the nditer cleanup when decref&#39;ing object arrays.</span></div>
<div class="line"><span class="lineno"> 2974</span>    <span class="comment"># This test would trigger valgrind &quot;uninitialized read&quot; before the bugfix.</span></div>
<div class="line"><span class="lineno"> 2975</span>    assert_raises(TypeError, <span class="keyword">lambda</span>: np.zeros((17000, 2), dtype=<span class="stringliteral">&#39;f4&#39;</span>) * <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 2976</span> </div>
<div class="line"><span class="lineno"> 2977</span>    <span class="comment"># this more explicit code also triggers the invalid access</span></div>
<div class="line"><span class="lineno"> 2978</span>    arr = np.arange(np.BUFSIZE * 10).reshape(10, -1).astype(str)</div>
<div class="line"><span class="lineno"> 2979</span>    oarr = arr.astype(object)</div>
<div class="line"><span class="lineno"> 2980</span>    oarr[:, -1] = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2981</span>    assert_raises(TypeError, <span class="keyword">lambda</span>: np.add(oarr[:, ::-1], arr[:, ::-1]))</div>
<div class="line"><span class="lineno"> 2982</span> </div>
<div class="line"><span class="lineno"> 2983</span>    <span class="comment"># followup: this tests for a bug introduced in the first pass of gh-18450,</span></div>
<div class="line"><span class="lineno"> 2984</span>    <span class="comment"># caused by an incorrect fallthrough of the TypeError</span></div>
<div class="line"><span class="lineno"> 2985</span>    <span class="keyword">class </span>T:</div>
<div class="line"><span class="lineno"> 2986</span>        <span class="keyword">def </span>__bool__(self):</div>
<div class="line"><span class="lineno"> 2987</span>            <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&quot;Ambiguous&quot;</span>)</div>
<div class="line"><span class="lineno"> 2988</span>    assert_raises(TypeError, np.logical_or.reduce, </div>
<div class="line"><span class="lineno"> 2989</span>                             np.array([T(), T()], dtype=<span class="stringliteral">&#39;O&#39;</span>))</div>
<div class="line"><span class="lineno"> 2990</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a62e477c5a035d2c77bcab84e4a1df933" name="a62e477c5a035d2c77bcab84e4a1df933"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62e477c5a035d2c77bcab84e4a1df933">&#9670;&#160;</a></span>test_object_iter_cleanup_large_reduce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_object_iter_cleanup_large_reduce </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>arr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3003</span><span class="keyword">def </span>test_object_iter_cleanup_large_reduce(arr):</div>
<div class="line"><span class="lineno"> 3004</span>    <span class="comment"># More complicated calls are possible for large arrays:</span></div>
<div class="line"><span class="lineno"> 3005</span>    out = np.ones(8000, dtype=np.intp)</div>
<div class="line"><span class="lineno"> 3006</span>    <span class="comment"># force casting with `dtype=object`</span></div>
<div class="line"><span class="lineno"> 3007</span>    res = np.sum(arr, axis=(1, 2), dtype=object, out=out)</div>
<div class="line"><span class="lineno"> 3008</span>    assert_array_equal(res, np.full(8000, 4, dtype=object))</div>
<div class="line"><span class="lineno"> 3009</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a93705830d435fe0b20bb766e056e855e" name="a93705830d435fe0b20bb766e056e855e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93705830d435fe0b20bb766e056e855e">&#9670;&#160;</a></span>test_object_iter_cleanup_reduce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_object_iter_cleanup_reduce </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2991</span><span class="keyword">def </span>test_object_iter_cleanup_reduce():</div>
<div class="line"><span class="lineno"> 2992</span>    <span class="comment"># Similar as above, but a complex reduction case that was previously</span></div>
<div class="line"><span class="lineno"> 2993</span>    <span class="comment"># missed (see gh-18810).</span></div>
<div class="line"><span class="lineno"> 2994</span>    <span class="comment"># The following array is special in that it cannot be flattened:</span></div>
<div class="line"><span class="lineno"> 2995</span>    arr = np.array([[<span class="keywordtype">None</span>, 1], [-1, -1], [<span class="keywordtype">None</span>, 2], [-1, -1]])[::2]</div>
<div class="line"><span class="lineno"> 2996</span>    <span class="keyword">with</span> pytest.raises(TypeError):</div>
<div class="line"><span class="lineno"> 2997</span>        np.sum(arr)</div>
<div class="line"><span class="lineno"> 2998</span> </div>
<div class="line"><span class="lineno"> 2999</span><span class="preprocessor">@pytest.mark.parametrize</span>(<span class="stringliteral">&quot;arr&quot;</span>, [</div>
<div class="line"><span class="lineno"> 3000</span>        np.ones((8000, 4, 2), dtype=object)[:, ::2, :],</div>
<div class="line"><span class="lineno"> 3001</span>        np.ones((8000, 4, 2), dtype=object, order=<span class="stringliteral">&quot;F&quot;</span>)[:, ::2, :],</div>
<div class="line"><span class="lineno"> 3002</span>        np.ones((8000, 4, 2), dtype=object)[:, ::2, :].copy(<span class="stringliteral">&quot;F&quot;</span>)])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4146ccefeaf3f116ddfe3001d863d96a" name="a4146ccefeaf3f116ddfe3001d863d96a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4146ccefeaf3f116ddfe3001d863d96a">&#9670;&#160;</a></span>test_partial_iteration_cleanup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_partial_iteration_cleanup </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>in_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>buf_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>steps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Checks for reference counting leaks during cleanup.  Using explicit
reference counts lead to occasional false positives (at least in parallel
test setups).  This test now should still test leaks correctly when
run e.g. with pytest-valgrind or pytest-leaks
</pre> <div class="fragment"><div class="line"><span class="lineno"> 3179</span><span class="keyword">def </span>test_partial_iteration_cleanup(in_dtype, buf_dtype, steps):</div>
<div class="line"><span class="lineno"> 3180</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3181</span><span class="stringliteral">    Checks for reference counting leaks during cleanup.  Using explicit</span></div>
<div class="line"><span class="lineno"> 3182</span><span class="stringliteral">    reference counts lead to occasional false positives (at least in parallel</span></div>
<div class="line"><span class="lineno"> 3183</span><span class="stringliteral">    test setups).  This test now should still test leaks correctly when</span></div>
<div class="line"><span class="lineno"> 3184</span><span class="stringliteral">    run e.g. with pytest-valgrind or pytest-leaks</span></div>
<div class="line"><span class="lineno"> 3185</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3186</span>    value = 2**30 + 1  <span class="comment"># just a random value that Python won&#39;t intern</span></div>
<div class="line"><span class="lineno"> 3187</span>    arr = np.full(int(np.BUFSIZE * 2.5), value).astype(in_dtype)</div>
<div class="line"><span class="lineno"> 3188</span> </div>
<div class="line"><span class="lineno"> 3189</span>    it = np.nditer(arr, op_dtypes=[np.dtype(buf_dtype)],</div>
<div class="line"><span class="lineno"> 3190</span>            flags=[<span class="stringliteral">&quot;buffered&quot;</span>, <span class="stringliteral">&quot;external_loop&quot;</span>, <span class="stringliteral">&quot;refs_ok&quot;</span>], casting=<span class="stringliteral">&quot;unsafe&quot;</span>)</div>
<div class="line"><span class="lineno"> 3191</span>    <span class="keywordflow">for</span> step <span class="keywordflow">in</span> range(steps):</div>
<div class="line"><span class="lineno"> 3192</span>        <span class="comment"># The iteration finishes in 3 steps, the first two are partial</span></div>
<div class="line"><span class="lineno"> 3193</span>        next(it)</div>
<div class="line"><span class="lineno"> 3194</span> </div>
<div class="line"><span class="lineno"> 3195</span>    del it  <span class="comment"># not necessary, but we test the cleanup</span></div>
<div class="line"><span class="lineno"> 3196</span> </div>
<div class="line"><span class="lineno"> 3197</span>    <span class="comment"># Repeat the test with `iternext`</span></div>
<div class="line"><span class="lineno"> 3198</span>    it = np.nditer(arr, op_dtypes=[np.dtype(buf_dtype)],</div>
<div class="line"><span class="lineno"> 3199</span>                   flags=[<span class="stringliteral">&quot;buffered&quot;</span>, <span class="stringliteral">&quot;external_loop&quot;</span>, <span class="stringliteral">&quot;refs_ok&quot;</span>], casting=<span class="stringliteral">&quot;unsafe&quot;</span>)</div>
<div class="line"><span class="lineno"> 3200</span>    <span class="keywordflow">for</span> step <span class="keywordflow">in</span> range(steps):</div>
<div class="line"><span class="lineno"> 3201</span>        it.iternext()</div>
<div class="line"><span class="lineno"> 3202</span> </div>
<div class="line"><span class="lineno"> 3203</span>    del it  <span class="comment"># not necessary, but we test the cleanup</span></div>
<div class="line"><span class="lineno"> 3204</span> </div>
<div class="line"><span class="lineno"> 3205</span><span class="preprocessor">@pytest.mark.skipif(not HAS_REFCOUNT, reason=&quot;Python lacks refcounts&quot;)</span></div>
<div class="line"><span class="lineno"> 3206</span><span class="preprocessor">@pytest.mark.parametrize</span>([<span class="stringliteral">&quot;in_dtype&quot;</span>, <span class="stringliteral">&quot;buf_dtype&quot;</span>],</div>
<div class="line"><span class="lineno"> 3207</span>         [(<span class="stringliteral">&quot;O&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>),  <span class="comment"># most simple cases</span></div>
<div class="line"><span class="lineno"> 3208</span>          (<span class="stringliteral">&quot;O,i&quot;</span>, <span class="stringliteral">&quot;i,O&quot;</span>),  <span class="comment"># structured casting to and from O</span></div>
<div class="line"><span class="lineno"> 3209</span>          ])</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9bd5b95d7d37fcdaf80bf758374ec847" name="a9bd5b95d7d37fcdaf80bf758374ec847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bd5b95d7d37fcdaf80bf758374ec847">&#9670;&#160;</a></span>test_partial_iteration_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_partial_iteration_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>in_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>buf_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3210</span><span class="keyword">def </span>test_partial_iteration_error(in_dtype, buf_dtype):</div>
<div class="line"><span class="lineno"> 3211</span>    value = 123  <span class="comment"># relies on python cache (leak-check will still find it)</span></div>
<div class="line"><span class="lineno"> 3212</span>    arr = np.full(int(np.BUFSIZE * 2.5), value).astype(in_dtype)</div>
<div class="line"><span class="lineno"> 3213</span>    <span class="keywordflow">if</span> in_dtype == <span class="stringliteral">&quot;O&quot;</span>:</div>
<div class="line"><span class="lineno"> 3214</span>        arr[int(np.BUFSIZE * 1.5)] = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3215</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3216</span>        arr[int(np.BUFSIZE * 1.5)][<span class="stringliteral">&quot;f0&quot;</span>] = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3217</span> </div>
<div class="line"><span class="lineno"> 3218</span>    count = sys.getrefcount(value)</div>
<div class="line"><span class="lineno"> 3219</span> </div>
<div class="line"><span class="lineno"> 3220</span>    it = np.nditer(arr, op_dtypes=[np.dtype(buf_dtype)],</div>
<div class="line"><span class="lineno"> 3221</span>            flags=[<span class="stringliteral">&quot;buffered&quot;</span>, <span class="stringliteral">&quot;external_loop&quot;</span>, <span class="stringliteral">&quot;refs_ok&quot;</span>], casting=<span class="stringliteral">&quot;unsafe&quot;</span>)</div>
<div class="line"><span class="lineno"> 3222</span>    <span class="keyword">with</span> pytest.raises(TypeError):</div>
<div class="line"><span class="lineno"> 3223</span>        <span class="comment"># pytest.raises seems to have issues with the error originating</span></div>
<div class="line"><span class="lineno"> 3224</span>        <span class="comment"># in the for loop, so manually unravel:</span></div>
<div class="line"><span class="lineno"> 3225</span>        next(it)</div>
<div class="line"><span class="lineno"> 3226</span>        next(it)  <span class="comment"># raises TypeError</span></div>
<div class="line"><span class="lineno"> 3227</span> </div>
<div class="line"><span class="lineno"> 3228</span>    <span class="comment"># Repeat the test with `iternext` after resetting, the buffers should</span></div>
<div class="line"><span class="lineno"> 3229</span>    <span class="comment"># already be cleared from any references, so resetting is sufficient.</span></div>
<div class="line"><span class="lineno"> 3230</span>    it.reset()</div>
<div class="line"><span class="lineno"> 3231</span>    <span class="keyword">with</span> pytest.raises(TypeError):</div>
<div class="line"><span class="lineno"> 3232</span>        it.iternext()</div>
<div class="line"><span class="lineno"> 3233</span>        it.iternext()</div>
<div class="line"><span class="lineno"> 3234</span> </div>
<div class="line"><span class="lineno"> 3235</span>    <span class="keyword">assert</span> count == sys.getrefcount(value)</div>
<div class="line"><span class="lineno"> 3236</span> </div>
<div class="line"><span class="lineno"> 3237</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7271d446a13573e40db57d84c3b103c7" name="a7271d446a13573e40db57d84c3b103c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7271d446a13573e40db57d84c3b103c7">&#9670;&#160;</a></span>test_warn_noclose()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_warn_noclose </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3160</span><span class="keyword">def </span>test_warn_noclose():</div>
<div class="line"><span class="lineno"> 3161</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno"> 3162</span>    au = a.byteswap().newbyteorder()</div>
<div class="line"><span class="lineno"> 3163</span>    <span class="keyword">with</span> suppress_warnings() <span class="keyword">as</span> sup:</div>
<div class="line"><span class="lineno"> 3164</span>        sup.record(RuntimeWarning)</div>
<div class="line"><span class="lineno"> 3165</span>        it = np.nditer(au, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 3166</span>                        casting=<span class="stringliteral">&#39;equiv&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 3167</span>        del it</div>
<div class="line"><span class="lineno"> 3168</span>        <span class="keyword">assert</span> len(sup.log) == 1</div>
<div class="line"><span class="lineno"> 3169</span> </div>
<div class="line"><span class="lineno"> 3170</span> </div>
<div class="line"><span class="lineno"> 3171</span><span class="preprocessor">@pytest.mark.skipif(sys.version_info[:2] == (3, 9)</span> <span class="keywordflow">and</span> sys.platform == <span class="stringliteral">&quot;win32&quot;</span>,</div>
<div class="line"><span class="lineno"> 3172</span>                    reason=<span class="stringliteral">&quot;Errors with Python 3.9 on Windows&quot;</span>)</div>
<div class="line"><span class="lineno"> 3173</span><span class="preprocessor">@pytest.mark.parametrize</span>([<span class="stringliteral">&quot;in_dtype&quot;</span>, <span class="stringliteral">&quot;buf_dtype&quot;</span>],</div>
<div class="line"><span class="lineno"> 3174</span>        [(<span class="stringliteral">&quot;i&quot;</span>, <span class="stringliteral">&quot;O&quot;</span>), (<span class="stringliteral">&quot;O&quot;</span>, <span class="stringliteral">&quot;i&quot;</span>),  <span class="comment"># most simple cases</span></div>
<div class="line"><span class="lineno"> 3175</span>         (<span class="stringliteral">&quot;i,O&quot;</span>, <span class="stringliteral">&quot;O,O&quot;</span>),  <span class="comment"># structured partially only copying O</span></div>
<div class="line"><span class="lineno"> 3176</span>         (<span class="stringliteral">&quot;O,i&quot;</span>, <span class="stringliteral">&quot;i,O&quot;</span>),  <span class="comment"># structured casting to and from O</span></div>
<div class="line"><span class="lineno"> 3177</span>         ])</div>
<div class="line"><span class="lineno"> 3178</span><span class="preprocessor">@pytest.mark.parametrize(&quot;steps&quot;, [1, 2, 3])</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad519625a6bbde4b80d7f31fec1acfc6e" name="ad519625a6bbde4b80d7f31fec1acfc6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad519625a6bbde4b80d7f31fec1acfc6e">&#9670;&#160;</a></span>test_writebacks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">numpy.core.tests.test_nditer.test_writebacks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 3057</span><span class="keyword">def </span>test_writebacks():</div>
<div class="line"><span class="lineno"> 3058</span>    a = np.arange(6, dtype=<span class="stringliteral">&#39;f4&#39;</span>)</div>
<div class="line"><span class="lineno"> 3059</span>    au = a.byteswap().newbyteorder()</div>
<div class="line"><span class="lineno"> 3060</span>    assert_(a.dtype.byteorder != au.dtype.byteorder)</div>
<div class="line"><span class="lineno"> 3061</span>    it = nditer(au, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 3062</span>                        casting=<span class="stringliteral">&#39;equiv&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 3063</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3064</span>        it.operands[0][:] = 100</div>
<div class="line"><span class="lineno"> 3065</span>    assert_equal(au, 100)</div>
<div class="line"><span class="lineno"> 3066</span>    <span class="comment"># do it again, this time raise an error,</span></div>
<div class="line"><span class="lineno"> 3067</span>    it = nditer(au, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 3068</span>                        casting=<span class="stringliteral">&#39;equiv&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 3069</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 3070</span>        <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3071</span>            assert_equal(au.flags.writeable, <span class="keyword">False</span>)</div>
<div class="line"><span class="lineno"> 3072</span>            it.operands[0][:] = 0</div>
<div class="line"><span class="lineno"> 3073</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;exit context manager on exception&#39;</span>)</div>
<div class="line"><span class="lineno"> 3074</span>    <span class="keywordflow">except</span>:</div>
<div class="line"><span class="lineno"> 3075</span>        <span class="keywordflow">pass</span></div>
<div class="line"><span class="lineno"> 3076</span>    assert_equal(au, 0)</div>
<div class="line"><span class="lineno"> 3077</span>    assert_equal(au.flags.writeable, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 3078</span>    <span class="comment"># cannot reuse i outside context manager</span></div>
<div class="line"><span class="lineno"> 3079</span>    assert_raises(ValueError, getattr, it, <span class="stringliteral">&#39;operands&#39;</span>)</div>
<div class="line"><span class="lineno"> 3080</span> </div>
<div class="line"><span class="lineno"> 3081</span>    it = nditer(au, [], [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 3082</span>                        casting=<span class="stringliteral">&#39;equiv&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 3083</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3084</span>        x = it.operands[0]</div>
<div class="line"><span class="lineno"> 3085</span>        x[:] = 6</div>
<div class="line"><span class="lineno"> 3086</span>        assert_(x.flags.writebackifcopy)</div>
<div class="line"><span class="lineno"> 3087</span>    assert_equal(au, 6)</div>
<div class="line"><span class="lineno"> 3088</span>    assert_(<span class="keywordflow">not</span> x.flags.writebackifcopy)</div>
<div class="line"><span class="lineno"> 3089</span>    x[:] = 123 <span class="comment"># x.data still valid</span></div>
<div class="line"><span class="lineno"> 3090</span>    assert_equal(au, 6) <span class="comment"># but not connected to au</span></div>
<div class="line"><span class="lineno"> 3091</span> </div>
<div class="line"><span class="lineno"> 3092</span>    it = nditer(au, [],</div>
<div class="line"><span class="lineno"> 3093</span>                 [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 3094</span>                 casting=<span class="stringliteral">&#39;equiv&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 3095</span>    <span class="comment"># reentering works</span></div>
<div class="line"><span class="lineno"> 3096</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3097</span>        <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3098</span>            <span class="keywordflow">for</span> x <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 3099</span>                x[...] = 123</div>
<div class="line"><span class="lineno"> 3100</span> </div>
<div class="line"><span class="lineno"> 3101</span>    it = nditer(au, [],</div>
<div class="line"><span class="lineno"> 3102</span>                 [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 3103</span>                 casting=<span class="stringliteral">&#39;equiv&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 3104</span>    <span class="comment"># make sure exiting the inner context manager closes the iterator</span></div>
<div class="line"><span class="lineno"> 3105</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3106</span>        <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3107</span>            <span class="keywordflow">for</span> x <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 3108</span>                x[...] = 123</div>
<div class="line"><span class="lineno"> 3109</span>        assert_raises(ValueError, getattr, it, <span class="stringliteral">&#39;operands&#39;</span>)</div>
<div class="line"><span class="lineno"> 3110</span>    <span class="comment"># do not crash if original data array is decrefed</span></div>
<div class="line"><span class="lineno"> 3111</span>    it = nditer(au, [],</div>
<div class="line"><span class="lineno"> 3112</span>                 [[<span class="stringliteral">&#39;readwrite&#39;</span>, <span class="stringliteral">&#39;updateifcopy&#39;</span>]],</div>
<div class="line"><span class="lineno"> 3113</span>                 casting=<span class="stringliteral">&#39;equiv&#39;</span>, op_dtypes=[np.dtype(<span class="stringliteral">&#39;f4&#39;</span>)])</div>
<div class="line"><span class="lineno"> 3114</span>    del au</div>
<div class="line"><span class="lineno"> 3115</span>    <span class="keyword">with</span> it:</div>
<div class="line"><span class="lineno"> 3116</span>        <span class="keywordflow">for</span> x <span class="keywordflow">in</span> it:</div>
<div class="line"><span class="lineno"> 3117</span>            x[...] = 123</div>
<div class="line"><span class="lineno"> 3118</span>    <span class="comment"># make sure we cannot reenter the closed iterator</span></div>
<div class="line"><span class="lineno"> 3119</span>    enter = it.__enter__</div>
<div class="line"><span class="lineno"> 3120</span>    assert_raises(RuntimeError, enter)</div>
<div class="line"><span class="lineno"> 3121</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
