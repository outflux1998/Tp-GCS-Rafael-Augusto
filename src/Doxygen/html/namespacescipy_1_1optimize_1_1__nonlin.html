<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.optimize._nonlin Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize.html">optimize</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html">_nonlin</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.optimize._nonlin Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_anderson.html">Anderson</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_broyden_first.html">BroydenFirst</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_broyden_second.html">BroydenSecond</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_diag_broyden.html">DiagBroyden</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_exciting_mixing.html">ExcitingMixing</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_generic_broyden.html">GenericBroyden</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_inverse_jacobian.html">InverseJacobian</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_jacobian.html">Jacobian</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_krylov_jacobian.html">KrylovJacobian</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_linear_mixing.html">LinearMixing</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_low_rank_matrix.html">LowRankMatrix</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_no_convergence.html">NoConvergence</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_termination_condition.html">TerminationCondition</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4a2bf30a71a47635995e387d2d0f66fc" id="r_a4a2bf30a71a47635995e387d2d0f66fc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a4a2bf30a71a47635995e387d2d0f66fc">maxnorm</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>)</td></tr>
<tr class="separator:a4a2bf30a71a47635995e387d2d0f66fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a465a0c91498c3fbefb6291c38f4f9e71" id="r_a465a0c91498c3fbefb6291c38f4f9e71"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a465a0c91498c3fbefb6291c38f4f9e71">_as_inexact</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>)</td></tr>
<tr class="separator:a465a0c91498c3fbefb6291c38f4f9e71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b17f68d7d0342df1a132b49cb7a6de4" id="r_a0b17f68d7d0342df1a132b49cb7a6de4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a0b17f68d7d0342df1a132b49cb7a6de4">_array_like</a> (<a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, x0)</td></tr>
<tr class="separator:a0b17f68d7d0342df1a132b49cb7a6de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc733e2d67253e0a2f4cc32c362c3e5" id="r_a3dc733e2d67253e0a2f4cc32c362c3e5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a3dc733e2d67253e0a2f4cc32c362c3e5">_safe_norm</a> (v)</td></tr>
<tr class="separator:a3dc733e2d67253e0a2f4cc32c362c3e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7a36c0fac9c54dbe88f3b7c84cc9935" id="r_ab7a36c0fac9c54dbe88f3b7c84cc9935"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ab7a36c0fac9c54dbe88f3b7c84cc9935">_set_doc</a> (obj)</td></tr>
<tr class="separator:ab7a36c0fac9c54dbe88f3b7c84cc9935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60896f6465b3f210ec1925713efa5f9d" id="r_a60896f6465b3f210ec1925713efa5f9d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a60896f6465b3f210ec1925713efa5f9d">nonlin_solve</a> (F, x0, jacobian='krylov', <a class="el" href="__lapack__subroutines_8h.html#a60590d91febfcb54d88443940cd5f23e">iter</a>=None, verbose=False, maxiter=None, f_tol=None, f_rtol=None, x_tol=None, x_rtol=None, tol_norm=None, line_search='armijo', callback=None, full_output=False, raise_exception=True)</td></tr>
<tr class="separator:a60896f6465b3f210ec1925713efa5f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6ab1b14338fa4ee2c6fa297f5203e87" id="r_ad6ab1b14338fa4ee2c6fa297f5203e87"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ad6ab1b14338fa4ee2c6fa297f5203e87">_nonlin_line_search</a> (<a class="el" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>, <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a>, Fx, <a class="el" href="__blas__subroutines_8h.html#a6b1e36c081feb196285c9fc4062b28ed">dx</a>, search_type='armijo', rdiff=1e-8, <a class="el" href="__lapack__subroutines_8h.html#a43c48817eaa0e6597bfa6c89a0c53659">smin</a>=1e-2)</td></tr>
<tr class="separator:ad6ab1b14338fa4ee2c6fa297f5203e87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17d73f0db99058e81a44d0dbba6e0718" id="r_a17d73f0db99058e81a44d0dbba6e0718"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a17d73f0db99058e81a44d0dbba6e0718">asjacobian</a> (J)</td></tr>
<tr class="separator:a17d73f0db99058e81a44d0dbba6e0718"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac151c7dfa06595bb04665e90c96a076b" id="r_ac151c7dfa06595bb04665e90c96a076b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a> (name, jac)</td></tr>
<tr class="separator:ac151c7dfa06595bb04665e90c96a076b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9f3ba5c46d27d6162fe541e20230cb6d" id="r_a9f3ba5c46d27d6162fe541e20230cb6d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f3ba5c46d27d6162fe541e20230cb6d">_doc_parts</a></td></tr>
<tr class="separator:a9f3ba5c46d27d6162fe541e20230cb6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a823133389f1e2493f404f43680103537" id="r_a823133389f1e2493f404f43680103537"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a823133389f1e2493f404f43680103537">broyden1</a> = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('broyden1', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_broyden_first.html">BroydenFirst</a>)</td></tr>
<tr class="separator:a823133389f1e2493f404f43680103537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76f0b288f7d6cfb40c00e9f070561506" id="r_a76f0b288f7d6cfb40c00e9f070561506"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a76f0b288f7d6cfb40c00e9f070561506">broyden2</a> = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('broyden2', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_broyden_second.html">BroydenSecond</a>)</td></tr>
<tr class="separator:a76f0b288f7d6cfb40c00e9f070561506"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a356ca47aa9ae48900de5650954af9e6b" id="r_a356ca47aa9ae48900de5650954af9e6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a356ca47aa9ae48900de5650954af9e6b">anderson</a> = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('anderson', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_anderson.html">Anderson</a>)</td></tr>
<tr class="separator:a356ca47aa9ae48900de5650954af9e6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d6d875811c45b5750bbca6797570953" id="r_a4d6d875811c45b5750bbca6797570953"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a4d6d875811c45b5750bbca6797570953">linearmixing</a> = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('linearmixing', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_linear_mixing.html">LinearMixing</a>)</td></tr>
<tr class="separator:a4d6d875811c45b5750bbca6797570953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4f1dca18f852b2a19620b7c129e556c" id="r_ac4f1dca18f852b2a19620b7c129e556c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac4f1dca18f852b2a19620b7c129e556c">diagbroyden</a> = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('diagbroyden', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_diag_broyden.html">DiagBroyden</a>)</td></tr>
<tr class="separator:ac4f1dca18f852b2a19620b7c129e556c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e2d070db1f534e7bdc8ba68f2459b89" id="r_a0e2d070db1f534e7bdc8ba68f2459b89"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a0e2d070db1f534e7bdc8ba68f2459b89">excitingmixing</a> = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('excitingmixing', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_exciting_mixing.html">ExcitingMixing</a>)</td></tr>
<tr class="separator:a0e2d070db1f534e7bdc8ba68f2459b89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a575ab148cca0b0fc86f88693a4f5f888" id="r_a575ab148cca0b0fc86f88693a4f5f888"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a575ab148cca0b0fc86f88693a4f5f888">newton_krylov</a> = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('newton_krylov', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_krylov_jacobian.html">KrylovJacobian</a>)</td></tr>
<tr class="separator:a575ab148cca0b0fc86f88693a4f5f888"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f63beec99dbf869db2b02f71b2dd31e" id="r_a9f63beec99dbf869db2b02f71b2dd31e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#a9f63beec99dbf869db2b02f71b2dd31e">x</a></td></tr>
<tr class="separator:a9f63beec99dbf869db2b02f71b2dd31e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0b17f68d7d0342df1a132b49cb7a6de4" name="a0b17f68d7d0342df1a132b49cb7a6de4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b17f68d7d0342df1a132b49cb7a6de4">&#9670;&#160;</a></span>_array_like()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin._array_like </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return ndarray `x` as same array subclass and shape as `x0`</pre> <div class="fragment"><div class="line"><span class="lineno">   41</span><span class="keyword">def </span>_array_like(x, x0):</div>
<div class="line"><span class="lineno">   42</span>    <span class="stringliteral">&quot;&quot;&quot;Return ndarray `x` as same array subclass and shape as `x0`&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   43</span>    x = np.reshape(x, np.shape(x0))</div>
<div class="line"><span class="lineno">   44</span>    wrap = getattr(x0, <span class="stringliteral">&#39;__array_wrap__&#39;</span>, x.__array_wrap__)</div>
<div class="line"><span class="lineno">   45</span>    <span class="keywordflow">return</span> wrap(x)</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a465a0c91498c3fbefb6291c38f4f9e71" name="a465a0c91498c3fbefb6291c38f4f9e71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a465a0c91498c3fbefb6291c38f4f9e71">&#9670;&#160;</a></span>_as_inexact()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin._as_inexact </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return `x` as an array, of either floats or complex floats</pre> <div class="fragment"><div class="line"><span class="lineno">   33</span><span class="keyword">def </span>_as_inexact(x):</div>
<div class="line"><span class="lineno">   34</span>    <span class="stringliteral">&quot;&quot;&quot;Return `x` as an array, of either floats or complex floats&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   35</span>    x = asarray(x)</div>
<div class="line"><span class="lineno">   36</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.issubdtype(x.dtype, np.inexact):</div>
<div class="line"><span class="lineno">   37</span>        <span class="keywordflow">return</span> asarray(x, dtype=np.float_)</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">return</span> x</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6ab1b14338fa4ee2c6fa297f5203e87" name="ad6ab1b14338fa4ee2c6fa297f5203e87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6ab1b14338fa4ee2c6fa297f5203e87">&#9670;&#160;</a></span>_nonlin_line_search()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin._nonlin_line_search </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>Fx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>search_type</em> = <code>'armijo'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>rdiff</em> = <code>1e-8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>smin</em> = <code>1e-2</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  265</span>                        smin=1e-2):</div>
<div class="line"><span class="lineno">  266</span>    tmp_s = [0]</div>
<div class="line"><span class="lineno">  267</span>    tmp_Fx = [Fx]</div>
<div class="line"><span class="lineno">  268</span>    tmp_phi = [norm(Fx)**2]</div>
<div class="line"><span class="lineno">  269</span>    s_norm = norm(x) / norm(dx)</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>    <span class="keyword">def </span><a class="code hl_variable" href="__lapack__subroutines_8h.html#a669c8fdab00d4ac25ffbcb378b5bc260">phi</a>(s, store=True):</div>
<div class="line"><span class="lineno">  272</span>        <span class="keywordflow">if</span> s == tmp_s[0]:</div>
<div class="line"><span class="lineno">  273</span>            <span class="keywordflow">return</span> tmp_phi[0]</div>
<div class="line"><span class="lineno">  274</span>        xt = x + s*dx</div>
<div class="line"><span class="lineno">  275</span>        v = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(xt)</div>
<div class="line"><span class="lineno">  276</span>        p = _safe_norm(v)**2</div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordflow">if</span> store:</div>
<div class="line"><span class="lineno">  278</span>            tmp_s[0] = s</div>
<div class="line"><span class="lineno">  279</span>            tmp_phi[0] = p</div>
<div class="line"><span class="lineno">  280</span>            tmp_Fx[0] = v</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">return</span> p</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>    <span class="keyword">def </span>derphi(s):</div>
<div class="line"><span class="lineno">  284</span>        ds = (abs(s) + s_norm + 1) * rdiff</div>
<div class="line"><span class="lineno">  285</span>        <span class="keywordflow">return</span> (<a class="code hl_variable" href="__lapack__subroutines_8h.html#a669c8fdab00d4ac25ffbcb378b5bc260">phi</a>(s+ds, store=<span class="keyword">False</span>) - <a class="code hl_variable" href="__lapack__subroutines_8h.html#a669c8fdab00d4ac25ffbcb378b5bc260">phi</a>(s)) / ds</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>    <span class="keywordflow">if</span> search_type == <span class="stringliteral">&#39;wolfe&#39;</span>:</div>
<div class="line"><span class="lineno">  288</span>        s, phi1, phi0 = scalar_search_wolfe1(phi, derphi, tmp_phi[0],</div>
<div class="line"><span class="lineno">  289</span>                                             xtol=1e-2, amin=smin)</div>
<div class="line"><span class="lineno">  290</span>    <span class="keywordflow">elif</span> search_type == <span class="stringliteral">&#39;armijo&#39;</span>:</div>
<div class="line"><span class="lineno">  291</span>        s, phi1 = scalar_search_armijo(phi, tmp_phi[0], -tmp_phi[0],</div>
<div class="line"><span class="lineno">  292</span>                                       amin=smin)</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">if</span> s <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  295</span>        <span class="comment"># XXX: No suitable step length found. Take the full Newton step,</span></div>
<div class="line"><span class="lineno">  296</span>        <span class="comment">#      and hope for the best.</span></div>
<div class="line"><span class="lineno">  297</span>        s = 1.0</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    x = x + s*dx</div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">if</span> s == tmp_s[0]:</div>
<div class="line"><span class="lineno">  301</span>        Fx = tmp_Fx[0]</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  303</span>        Fx = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x)</div>
<div class="line"><span class="lineno">  304</span>    Fx_norm = norm(Fx)</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">return</span> s, x, Fx, Fx_norm</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="ttc" id="a__lapack__subroutines_8h_html_a669c8fdab00d4ac25ffbcb378b5bc260"><div class="ttname"><a href="__lapack__subroutines_8h.html#a669c8fdab00d4ac25ffbcb378b5bc260">phi</a></div><div class="ttdeci">void char char char char int int int float float * phi</div><div class="ttdef"><b>Definition</b> _lapack_subroutines.h:105</div></div>
<div class="ttc" id="acallback_2foo_8f_html_a565fe2cc583df102f120752b0011c330"><div class="ttname"><a href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a></div><div class="ttdeci">subroutine func(a)</div><div class="ttdef"><b>Definition</b> foo.f:9</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac151c7dfa06595bb04665e90c96a076b" name="ac151c7dfa06595bb04665e90c96a076b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac151c7dfa06595bb04665e90c96a076b">&#9670;&#160;</a></span>_nonlin_wrapper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin._nonlin_wrapper </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Construct a solver wrapper with given name and Jacobian approx.

It inspects the keyword arguments of ``jac.__init__``, and allows to
use the same arguments in the wrapper function, in addition to the
keyword arguments of `nonlin_solve`</pre> <div class="fragment"><div class="line"><span class="lineno"> 1515</span><span class="keyword">def </span>_nonlin_wrapper(name, jac):</div>
<div class="line"><span class="lineno"> 1516</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1517</span><span class="stringliteral">    Construct a solver wrapper with given name and Jacobian approx.</span></div>
<div class="line"><span class="lineno"> 1518</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1519</span><span class="stringliteral">    It inspects the keyword arguments of ``jac.__init__``, and allows to</span></div>
<div class="line"><span class="lineno"> 1520</span><span class="stringliteral">    use the same arguments in the wrapper function, in addition to the</span></div>
<div class="line"><span class="lineno"> 1521</span><span class="stringliteral">    keyword arguments of `nonlin_solve`</span></div>
<div class="line"><span class="lineno"> 1522</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1523</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1524</span>    signature = _getfullargspec(jac.__init__)</div>
<div class="line"><span class="lineno"> 1525</span>    args, varargs, varkw, defaults, kwonlyargs, kwdefaults, _ = signature</div>
<div class="line"><span class="lineno"> 1526</span>    kwargs = list(zip(args[-len(defaults):], defaults))</div>
<div class="line"><span class="lineno"> 1527</span>    kw_str = <span class="stringliteral">&quot;, &quot;</span>.join([<span class="stringliteral">&quot;%s=%r&quot;</span> % (k, v) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> kwargs])</div>
<div class="line"><span class="lineno"> 1528</span>    <span class="keywordflow">if</span> kw_str:</div>
<div class="line"><span class="lineno"> 1529</span>        kw_str = <span class="stringliteral">&quot;, &quot;</span> + kw_str</div>
<div class="line"><span class="lineno"> 1530</span>    kwkw_str = <span class="stringliteral">&quot;, &quot;</span>.join([<span class="stringliteral">&quot;%s=%s&quot;</span> % (k, k) <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> kwargs])</div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordflow">if</span> kwkw_str:</div>
<div class="line"><span class="lineno"> 1532</span>        kwkw_str = kwkw_str + <span class="stringliteral">&quot;, &quot;</span></div>
<div class="line"><span class="lineno"> 1533</span>    <span class="keywordflow">if</span> kwonlyargs:</div>
<div class="line"><span class="lineno"> 1534</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Unexpected signature %s&#39;</span> % signature)</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>    <span class="comment"># Construct the wrapper function so that its keyword arguments</span></div>
<div class="line"><span class="lineno"> 1537</span>    <span class="comment"># are visible in pydoc.help etc.</span></div>
<div class="line"><span class="lineno"> 1538</span>    wrapper = <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1539</span><span class="stringliteral">def %(name)s(F, xin, iter=None %(kw)s, verbose=False, maxiter=None,</span></div>
<div class="line"><span class="lineno"> 1540</span><span class="stringliteral">             f_tol=None, f_rtol=None, x_tol=None, x_rtol=None,</span></div>
<div class="line"><span class="lineno"> 1541</span><span class="stringliteral">             tol_norm=None, line_search=&#39;armijo&#39;, callback=None, **kw):</span></div>
<div class="line"><span class="lineno"> 1542</span><span class="stringliteral">    jac = %(jac)s(%(kwkw)s **kw)</span></div>
<div class="line"><span class="lineno"> 1543</span><span class="stringliteral">    return nonlin_solve(F, xin, jac, iter, verbose, maxiter,</span></div>
<div class="line"><span class="lineno"> 1544</span><span class="stringliteral">                        f_tol, f_rtol, x_tol, x_rtol, tol_norm, line_search,</span></div>
<div class="line"><span class="lineno"> 1545</span><span class="stringliteral">                        callback)</span></div>
<div class="line"><span class="lineno"> 1546</span><span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>    wrapper = wrapper % dict(name=name, kw=kw_str, jac=jac.__name__,</div>
<div class="line"><span class="lineno"> 1549</span>                             kwkw=kwkw_str)</div>
<div class="line"><span class="lineno"> 1550</span>    ns = {}</div>
<div class="line"><span class="lineno"> 1551</span>    ns.update(globals())</div>
<div class="line"><span class="lineno"> 1552</span>    exec(wrapper, ns)</div>
<div class="line"><span class="lineno"> 1553</span>    func = ns[name]</div>
<div class="line"><span class="lineno"> 1554</span>    func.__doc__ = jac.__doc__</div>
<div class="line"><span class="lineno"> 1555</span>    _set_doc(func)</div>
<div class="line"><span class="lineno"> 1556</span>    <span class="keywordflow">return</span> func</div>
<div class="line"><span class="lineno"> 1557</span> </div>
<div class="line"><span class="lineno"> 1558</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3dc733e2d67253e0a2f4cc32c362c3e5" name="a3dc733e2d67253e0a2f4cc32c362c3e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dc733e2d67253e0a2f4cc32c362c3e5">&#9670;&#160;</a></span>_safe_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin._safe_norm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   48</span><span class="keyword">def </span>_safe_norm(v):</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.isfinite(v).all():</div>
<div class="line"><span class="lineno">   50</span>        <span class="keywordflow">return</span> np.array(np.inf)</div>
<div class="line"><span class="lineno">   51</span>    <span class="keywordflow">return</span> norm(v)</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span><span class="comment">#------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">   54</span><span class="comment"># Generic nonlinear solver machinery</span></div>
<div class="line"><span class="lineno">   55</span><span class="comment">#------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7a36c0fac9c54dbe88f3b7c84cc9935" name="ab7a36c0fac9c54dbe88f3b7c84cc9935"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7a36c0fac9c54dbe88f3b7c84cc9935">&#9670;&#160;</a></span>_set_doc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin._set_doc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  110</span><span class="keyword">def </span>_set_doc(obj):</div>
<div class="line"><span class="lineno">  111</span>    <span class="keywordflow">if</span> obj.__doc__:</div>
<div class="line"><span class="lineno">  112</span>        obj.__doc__ = obj.__doc__ % _doc_parts</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a17d73f0db99058e81a44d0dbba6e0718" name="a17d73f0db99058e81a44d0dbba6e0718"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17d73f0db99058e81a44d0dbba6e0718">&#9670;&#160;</a></span>asjacobian()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.asjacobian </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>J</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert given object to one suitable for use as a Jacobian.
</pre> <div class="fragment"><div class="line"><span class="lineno">  460</span><span class="keyword">def </span>asjacobian(J):</div>
<div class="line"><span class="lineno">  461</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  462</span><span class="stringliteral">    Convert given object to one suitable for use as a Jacobian.</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  464</span>    spsolve = scipy.sparse.linalg.spsolve</div>
<div class="line"><span class="lineno">  465</span>    <span class="keywordflow">if</span> isinstance(J, Jacobian):</div>
<div class="line"><span class="lineno">  466</span>        <span class="keywordflow">return</span> J</div>
<div class="line"><span class="lineno">  467</span>    <span class="keywordflow">elif</span> inspect.isclass(J) <span class="keywordflow">and</span> issubclass(J, Jacobian):</div>
<div class="line"><span class="lineno">  468</span>        <span class="keywordflow">return</span> J()</div>
<div class="line"><span class="lineno">  469</span>    <span class="keywordflow">elif</span> isinstance(J, np.ndarray):</div>
<div class="line"><span class="lineno">  470</span>        <span class="keywordflow">if</span> J.ndim &gt; 2:</div>
<div class="line"><span class="lineno">  471</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;array must have rank &lt;= 2&#39;</span>)</div>
<div class="line"><span class="lineno">  472</span>        J = np.atleast_2d(np.asarray(J))</div>
<div class="line"><span class="lineno">  473</span>        <span class="keywordflow">if</span> J.shape[0] != J.shape[1]:</div>
<div class="line"><span class="lineno">  474</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;array must be square&#39;</span>)</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>        <span class="keywordflow">return</span> Jacobian(matvec=<span class="keyword">lambda</span> v: dot(J, v),</div>
<div class="line"><span class="lineno">  477</span>                        rmatvec=<span class="keyword">lambda</span> v: dot(J.conj().T, v),</div>
<div class="line"><span class="lineno">  478</span>                        solve=<span class="keyword">lambda</span> v: solve(J, v),</div>
<div class="line"><span class="lineno">  479</span>                        rsolve=<span class="keyword">lambda</span> v: solve(J.conj().T, v),</div>
<div class="line"><span class="lineno">  480</span>                        dtype=J.dtype, shape=J.shape)</div>
<div class="line"><span class="lineno">  481</span>    <span class="keywordflow">elif</span> scipy.sparse.isspmatrix(J):</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordflow">if</span> J.shape[0] != J.shape[1]:</div>
<div class="line"><span class="lineno">  483</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;matrix must be square&#39;</span>)</div>
<div class="line"><span class="lineno">  484</span>        <span class="keywordflow">return</span> Jacobian(matvec=<span class="keyword">lambda</span> v: J*v,</div>
<div class="line"><span class="lineno">  485</span>                        rmatvec=<span class="keyword">lambda</span> v: J.conj().T * v,</div>
<div class="line"><span class="lineno">  486</span>                        solve=<span class="keyword">lambda</span> v: spsolve(J, v),</div>
<div class="line"><span class="lineno">  487</span>                        rsolve=<span class="keyword">lambda</span> v: spsolve(J.conj().T, v),</div>
<div class="line"><span class="lineno">  488</span>                        dtype=J.dtype, shape=J.shape)</div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">elif</span> hasattr(J, <span class="stringliteral">&#39;shape&#39;</span>) <span class="keywordflow">and</span> hasattr(J, <span class="stringliteral">&#39;dtype&#39;</span>) <span class="keywordflow">and</span> hasattr(J, <span class="stringliteral">&#39;solve&#39;</span>):</div>
<div class="line"><span class="lineno">  490</span>        <span class="keywordflow">return</span> Jacobian(matvec=getattr(J, <span class="stringliteral">&#39;matvec&#39;</span>),</div>
<div class="line"><span class="lineno">  491</span>                        rmatvec=getattr(J, <span class="stringliteral">&#39;rmatvec&#39;</span>),</div>
<div class="line"><span class="lineno">  492</span>                        solve=J.solve,</div>
<div class="line"><span class="lineno">  493</span>                        rsolve=getattr(J, <span class="stringliteral">&#39;rsolve&#39;</span>),</div>
<div class="line"><span class="lineno">  494</span>                        update=getattr(J, <span class="stringliteral">&#39;update&#39;</span>),</div>
<div class="line"><span class="lineno">  495</span>                        setup=getattr(J, <span class="stringliteral">&#39;setup&#39;</span>),</div>
<div class="line"><span class="lineno">  496</span>                        dtype=J.dtype,</div>
<div class="line"><span class="lineno">  497</span>                        shape=J.shape)</div>
<div class="line"><span class="lineno">  498</span>    <span class="keywordflow">elif</span> callable(J):</div>
<div class="line"><span class="lineno">  499</span>        <span class="comment"># Assume it&#39;s a function J(x) that returns the Jacobian</span></div>
<div class="line"><span class="lineno">  500</span>        <span class="keyword">class </span>Jac(Jacobian):</div>
<div class="line"><span class="lineno">  501</span>            <span class="keyword">def </span>update(self, x, F):</div>
<div class="line"><span class="lineno">  502</span>                self.x = x</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>            <span class="keyword">def </span>solve(self, v, tol=0):</div>
<div class="line"><span class="lineno">  505</span>                m = J(self.x)</div>
<div class="line"><span class="lineno">  506</span>                <span class="keywordflow">if</span> isinstance(m, np.ndarray):</div>
<div class="line"><span class="lineno">  507</span>                    <span class="keywordflow">return</span> solve(m, v)</div>
<div class="line"><span class="lineno">  508</span>                <span class="keywordflow">elif</span> scipy.sparse.isspmatrix(m):</div>
<div class="line"><span class="lineno">  509</span>                    <span class="keywordflow">return</span> spsolve(m, v)</div>
<div class="line"><span class="lineno">  510</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  511</span>                    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unknown matrix type&quot;</span>)</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>            <span class="keyword">def </span>matvec(self, v):</div>
<div class="line"><span class="lineno">  514</span>                m = J(self.x)</div>
<div class="line"><span class="lineno">  515</span>                <span class="keywordflow">if</span> isinstance(m, np.ndarray):</div>
<div class="line"><span class="lineno">  516</span>                    <span class="keywordflow">return</span> dot(m, v)</div>
<div class="line"><span class="lineno">  517</span>                <span class="keywordflow">elif</span> scipy.sparse.isspmatrix(m):</div>
<div class="line"><span class="lineno">  518</span>                    <span class="keywordflow">return</span> m*v</div>
<div class="line"><span class="lineno">  519</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  520</span>                    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unknown matrix type&quot;</span>)</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>            <span class="keyword">def </span>rsolve(self, v, tol=0):</div>
<div class="line"><span class="lineno">  523</span>                m = J(self.x)</div>
<div class="line"><span class="lineno">  524</span>                <span class="keywordflow">if</span> isinstance(m, np.ndarray):</div>
<div class="line"><span class="lineno">  525</span>                    <span class="keywordflow">return</span> solve(m.conj().T, v)</div>
<div class="line"><span class="lineno">  526</span>                <span class="keywordflow">elif</span> scipy.sparse.isspmatrix(m):</div>
<div class="line"><span class="lineno">  527</span>                    <span class="keywordflow">return</span> spsolve(m.conj().T, v)</div>
<div class="line"><span class="lineno">  528</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  529</span>                    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unknown matrix type&quot;</span>)</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>            <span class="keyword">def </span>rmatvec(self, v):</div>
<div class="line"><span class="lineno">  532</span>                m = J(self.x)</div>
<div class="line"><span class="lineno">  533</span>                <span class="keywordflow">if</span> isinstance(m, np.ndarray):</div>
<div class="line"><span class="lineno">  534</span>                    <span class="keywordflow">return</span> dot(m.conj().T, v)</div>
<div class="line"><span class="lineno">  535</span>                <span class="keywordflow">elif</span> scipy.sparse.isspmatrix(m):</div>
<div class="line"><span class="lineno">  536</span>                    <span class="keywordflow">return</span> m.conj().T * v</div>
<div class="line"><span class="lineno">  537</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  538</span>                    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Unknown matrix type&quot;</span>)</div>
<div class="line"><span class="lineno">  539</span>        <span class="keywordflow">return</span> Jac()</div>
<div class="line"><span class="lineno">  540</span>    <span class="keywordflow">elif</span> isinstance(J, str):</div>
<div class="line"><span class="lineno">  541</span>        <span class="keywordflow">return</span> dict(broyden1=BroydenFirst,</div>
<div class="line"><span class="lineno">  542</span>                    broyden2=BroydenSecond,</div>
<div class="line"><span class="lineno">  543</span>                    anderson=Anderson,</div>
<div class="line"><span class="lineno">  544</span>                    diagbroyden=DiagBroyden,</div>
<div class="line"><span class="lineno">  545</span>                    linearmixing=LinearMixing,</div>
<div class="line"><span class="lineno">  546</span>                    excitingmixing=ExcitingMixing,</div>
<div class="line"><span class="lineno">  547</span>                    krylov=KrylovJacobian)[J]()</div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">raise</span> TypeError(<span class="stringliteral">&#39;Cannot convert object to a Jacobian&#39;</span>)</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span><span class="comment">#------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  553</span><span class="comment"># Broyden</span></div>
<div class="line"><span class="lineno">  554</span><span class="comment">#------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  555</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a2bf30a71a47635995e387d2d0f66fc" name="a4a2bf30a71a47635995e387d2d0f66fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a2bf30a71a47635995e387d2d0f66fc">&#9670;&#160;</a></span>maxnorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.maxnorm </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   29</span><span class="keyword">def </span>maxnorm(x):</div>
<div class="line"><span class="lineno">   30</span>    <span class="keywordflow">return</span> np.absolute(x).max()</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a60896f6465b3f210ec1925713efa5f9d" name="a60896f6465b3f210ec1925713efa5f9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60896f6465b3f210ec1925713efa5f9d">&#9670;&#160;</a></span>nonlin_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.nonlin_solve </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>F</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>jacobian</em> = <code>'krylov'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f_tol</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>f_rtol</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_tol</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x_rtol</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tol_norm</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>line_search</em> = <code>'armijo'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>full_output</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>raise_exception</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Find a root of a function, in a way suitable for large-scale problems.

Parameters
----------
%(params_basic)s
jacobian : Jacobian
    A Jacobian approximation: `Jacobian` object or something that
    `asjacobian` can transform to one. Alternatively, a string specifying
    which of the builtin Jacobian approximations to use:

        krylov, broyden1, broyden2, anderson
        diagbroyden, linearmixing, excitingmixing

%(params_extra)s
full_output : bool
    If true, returns a dictionary `info` containing convergence
    information.
raise_exception : bool
    If True, a `NoConvergence` exception is raise if no solution is found.

See Also
--------
asjacobian, Jacobian

Notes
-----
This algorithm implements the inexact Newton method, with
backtracking or full line searches. Several Jacobian
approximations are available, including Krylov and Quasi-Newton
methods.

References
----------
.. [KIM] C. T. Kelley, \"Iterative Methods for Linear and Nonlinear
   Equations\". Society for Industrial and Applied Mathematics. (1995)
   https://archive.siam.org/books/kelley/fr16/</pre> <div class="fragment"><div class="line"><span class="lineno">  118</span>                 full_output=<span class="keyword">False</span>, raise_exception=<span class="keyword">True</span>):</div>
<div class="line"><span class="lineno">  119</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">    Find a root of a function, in a way suitable for large-scale problems.</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    %(params_basic)s</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">    jacobian : Jacobian</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral">        A Jacobian approximation: `Jacobian` object or something that</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">        `asjacobian` can transform to one. Alternatively, a string specifying</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">        which of the builtin Jacobian approximations to use:</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">            krylov, broyden1, broyden2, anderson</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">            diagbroyden, linearmixing, excitingmixing</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    %(params_extra)s</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    full_output : bool</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">        If true, returns a dictionary `info` containing convergence</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">        information.</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    raise_exception : bool</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">        If True, a `NoConvergence` exception is raise if no solution is found.</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral">    asjacobian, Jacobian</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    This algorithm implements the inexact Newton method, with</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    backtracking or full line searches. Several Jacobian</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">    approximations are available, including Krylov and Quasi-Newton</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">    methods.</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">    .. [KIM] C. T. Kelley, \&quot;Iterative Methods for Linear and Nonlinear</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">       Equations\&quot;. Society for Industrial and Applied Mathematics. (1995)</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral">       https://archive.siam.org/books/kelley/fr16/</span></div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  157</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  158</span>    <span class="comment"># Can&#39;t use default parameters because it&#39;s being explicitly passed as None</span></div>
<div class="line"><span class="lineno">  159</span>    <span class="comment"># from the calling function, so we need to set it here.</span></div>
<div class="line"><span class="lineno">  160</span>    tol_norm = maxnorm <span class="keywordflow">if</span> tol_norm <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> tol_norm</div>
<div class="line"><span class="lineno">  161</span>    condition = TerminationCondition(f_tol=f_tol, f_rtol=f_rtol,</div>
<div class="line"><span class="lineno">  162</span>                                     x_tol=x_tol, x_rtol=x_rtol,</div>
<div class="line"><span class="lineno">  163</span>                                     iter=iter, norm=tol_norm)</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    x0 = _as_inexact(x0)</div>
<div class="line"><span class="lineno">  166</span>    func = <span class="keyword">lambda</span> z: _as_inexact(F(_array_like(z, x0))).flatten()</div>
<div class="line"><span class="lineno">  167</span>    x = x0.flatten()</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    dx = np.full_like(x, np.inf)</div>
<div class="line"><span class="lineno">  170</span>    Fx = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x)</div>
<div class="line"><span class="lineno">  171</span>    Fx_norm = norm(Fx)</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    jacobian = asjacobian(jacobian)</div>
<div class="line"><span class="lineno">  174</span>    jacobian.setup(x.copy(), Fx, func)</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">if</span> maxiter <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  177</span>        <span class="keywordflow">if</span> iter <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  178</span>            maxiter = iter + 1</div>
<div class="line"><span class="lineno">  179</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  180</span>            maxiter = 100*(x.size+1)</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordflow">if</span> line_search <span class="keywordflow">is</span> <span class="keyword">True</span>:</div>
<div class="line"><span class="lineno">  183</span>        line_search = <span class="stringliteral">&#39;armijo&#39;</span></div>
<div class="line"><span class="lineno">  184</span>    <span class="keywordflow">elif</span> line_search <span class="keywordflow">is</span> <span class="keyword">False</span>:</div>
<div class="line"><span class="lineno">  185</span>        line_search = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">if</span> line_search <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="keywordtype">None</span>, <span class="stringliteral">&#39;armijo&#39;</span>, <span class="stringliteral">&#39;wolfe&#39;</span>):</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Invalid line search&quot;</span>)</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <span class="comment"># Solver tolerance selection</span></div>
<div class="line"><span class="lineno">  191</span>    gamma = 0.9</div>
<div class="line"><span class="lineno">  192</span>    eta_max = 0.9999</div>
<div class="line"><span class="lineno">  193</span>    eta_treshold = 0.1</div>
<div class="line"><span class="lineno">  194</span>    eta = 1e-3</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordflow">for</span> n <span class="keywordflow">in</span> range(maxiter):</div>
<div class="line"><span class="lineno">  197</span>        status = condition.check(Fx, x, dx)</div>
<div class="line"><span class="lineno">  198</span>        <span class="keywordflow">if</span> status:</div>
<div class="line"><span class="lineno">  199</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>        <span class="comment"># The tolerance, as computed for scipy.sparse.linalg.* routines</span></div>
<div class="line"><span class="lineno">  202</span>        tol = min(eta, eta*Fx_norm)</div>
<div class="line"><span class="lineno">  203</span>        dx = -jacobian.solve(Fx, tol=tol)</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordflow">if</span> norm(dx) == 0:</div>
<div class="line"><span class="lineno">  206</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Jacobian inversion yielded zero vector. &quot;</span></div>
<div class="line"><span class="lineno">  207</span>                             <span class="stringliteral">&quot;This indicates a bug in the Jacobian &quot;</span></div>
<div class="line"><span class="lineno">  208</span>                             <span class="stringliteral">&quot;approximation.&quot;</span>)</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>        <span class="comment"># Line search, or Newton step</span></div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">if</span> line_search:</div>
<div class="line"><span class="lineno">  212</span>            s, x, Fx, Fx_norm_new = _nonlin_line_search(func, x, Fx, dx,</div>
<div class="line"><span class="lineno">  213</span>                                                        line_search)</div>
<div class="line"><span class="lineno">  214</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  215</span>            s = 1.0</div>
<div class="line"><span class="lineno">  216</span>            x = x + dx</div>
<div class="line"><span class="lineno">  217</span>            Fx = <a class="code hl_function" href="callback_2foo_8f.html#a565fe2cc583df102f120752b0011c330">func</a>(x)</div>
<div class="line"><span class="lineno">  218</span>            Fx_norm_new = norm(Fx)</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>        jacobian.update(x.copy(), Fx)</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>        <span class="keywordflow">if</span> callback:</div>
<div class="line"><span class="lineno">  223</span>            callback(x, Fx)</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>        <span class="comment"># Adjust forcing parameters for inexact methods</span></div>
<div class="line"><span class="lineno">  226</span>        eta_A = gamma * Fx_norm_new**2 / Fx_norm**2</div>
<div class="line"><span class="lineno">  227</span>        <span class="keywordflow">if</span> gamma * eta**2 &lt; eta_treshold:</div>
<div class="line"><span class="lineno">  228</span>            eta = min(eta_max, eta_A)</div>
<div class="line"><span class="lineno">  229</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  230</span>            eta = min(eta_max, max(eta_A, gamma*eta**2))</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>        Fx_norm = Fx_norm_new</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>        <span class="comment"># Print status</span></div>
<div class="line"><span class="lineno">  235</span>        <span class="keywordflow">if</span> verbose:</div>
<div class="line"><span class="lineno">  236</span>            sys.stdout.write(<span class="stringliteral">&quot;%d:  |F(x)| = %g; step %g\n&quot;</span> % (</div>
<div class="line"><span class="lineno">  237</span>                n, tol_norm(Fx), s))</div>
<div class="line"><span class="lineno">  238</span>            sys.stdout.flush()</div>
<div class="line"><span class="lineno">  239</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  240</span>        <span class="keywordflow">if</span> raise_exception:</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordflow">raise</span> NoConvergence(_array_like(x, x0))</div>
<div class="line"><span class="lineno">  242</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  243</span>            status = 2</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">if</span> full_output:</div>
<div class="line"><span class="lineno">  246</span>        info = {<span class="stringliteral">&#39;nit&#39;</span>: condition.iteration,</div>
<div class="line"><span class="lineno">  247</span>                <span class="stringliteral">&#39;fun&#39;</span>: Fx,</div>
<div class="line"><span class="lineno">  248</span>                <span class="stringliteral">&#39;status&#39;</span>: status,</div>
<div class="line"><span class="lineno">  249</span>                <span class="stringliteral">&#39;success&#39;</span>: status == 1,</div>
<div class="line"><span class="lineno">  250</span>                <span class="stringliteral">&#39;message&#39;</span>: {1: <span class="stringliteral">&#39;A solution was found at the specified &#39;</span></div>
<div class="line"><span class="lineno">  251</span>                               <span class="stringliteral">&#39;tolerance.&#39;</span>,</div>
<div class="line"><span class="lineno">  252</span>                            2: <span class="stringliteral">&#39;The maximum number of iterations allowed &#39;</span></div>
<div class="line"><span class="lineno">  253</span>                               <span class="stringliteral">&#39;has been reached.&#39;</span></div>
<div class="line"><span class="lineno">  254</span>                            }[status]</div>
<div class="line"><span class="lineno">  255</span>                }</div>
<div class="line"><span class="lineno">  256</span>        <span class="keywordflow">return</span> _array_like(x, x0), info</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  258</span>        <span class="keywordflow">return</span> _array_like(x, x0)</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a9f3ba5c46d27d6162fe541e20230cb6d" name="a9f3ba5c46d27d6162fe541e20230cb6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f3ba5c46d27d6162fe541e20230cb6d">&#9670;&#160;</a></span>_doc_parts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin._doc_parts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><span class="lineno">    1</span>=  dict(</div>
<div class="line"><span class="lineno">    2</span>    params_basic=.strip(),</div>
<div class="line"><span class="lineno">    3</span>    params_extra=.strip()</div>
<div class="line"><span class="lineno">    4</span>)</div>
</div><!-- fragment -->
</div>
</div>
<a id="a356ca47aa9ae48900de5650954af9e6b" name="a356ca47aa9ae48900de5650954af9e6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a356ca47aa9ae48900de5650954af9e6b">&#9670;&#160;</a></span>anderson</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.anderson = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('anderson', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_anderson.html">Anderson</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a823133389f1e2493f404f43680103537" name="a823133389f1e2493f404f43680103537"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a823133389f1e2493f404f43680103537">&#9670;&#160;</a></span>broyden1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.broyden1 = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('broyden1', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_broyden_first.html">BroydenFirst</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a76f0b288f7d6cfb40c00e9f070561506" name="a76f0b288f7d6cfb40c00e9f070561506"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76f0b288f7d6cfb40c00e9f070561506">&#9670;&#160;</a></span>broyden2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.broyden2 = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('broyden2', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_broyden_second.html">BroydenSecond</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac4f1dca18f852b2a19620b7c129e556c" name="ac4f1dca18f852b2a19620b7c129e556c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4f1dca18f852b2a19620b7c129e556c">&#9670;&#160;</a></span>diagbroyden</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.diagbroyden = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('diagbroyden', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_diag_broyden.html">DiagBroyden</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0e2d070db1f534e7bdc8ba68f2459b89" name="a0e2d070db1f534e7bdc8ba68f2459b89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e2d070db1f534e7bdc8ba68f2459b89">&#9670;&#160;</a></span>excitingmixing</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.excitingmixing = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('excitingmixing', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_exciting_mixing.html">ExcitingMixing</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a4d6d875811c45b5750bbca6797570953" name="a4d6d875811c45b5750bbca6797570953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d6d875811c45b5750bbca6797570953">&#9670;&#160;</a></span>linearmixing</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.linearmixing = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('linearmixing', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_linear_mixing.html">LinearMixing</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a575ab148cca0b0fc86f88693a4f5f888" name="a575ab148cca0b0fc86f88693a4f5f888"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a575ab148cca0b0fc86f88693a4f5f888">&#9670;&#160;</a></span>newton_krylov</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.newton_krylov = <a class="el" href="namespacescipy_1_1optimize_1_1__nonlin.html#ac151c7dfa06595bb04665e90c96a076b">_nonlin_wrapper</a>('newton_krylov', <a class="el" href="classscipy_1_1optimize_1_1__nonlin_1_1_krylov_jacobian.html">KrylovJacobian</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a9f63beec99dbf869db2b02f71b2dd31e" name="a9f63beec99dbf869db2b02f71b2dd31e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f63beec99dbf869db2b02f71b2dd31e">&#9670;&#160;</a></span>x</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.optimize._nonlin.x</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
