<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.stats._qmc Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html">_qmc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats._qmc Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__qmc_1_1_halton.html">Halton</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__qmc_1_1_latin_hypercube.html">LatinHypercube</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__qmc_1_1_multinomial_q_m_c.html">MultinomialQMC</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__qmc_1_1_multivariate_normal_q_m_c.html">MultivariateNormalQMC</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__qmc_1_1_poisson_disk.html">PoissonDisk</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__qmc_1_1_q_m_c_engine.html">QMCEngine</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__qmc_1_1_sobol.html">Sobol</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5026854a646a0716daed51af6693c29c" id="r_a5026854a646a0716daed51af6693c29c"><td class="memItemLeft" align="right" valign="top">np.random.Generator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a5026854a646a0716daed51af6693c29c">check_random_state</a> (Optional[IntNumber] seed=...)</td></tr>
<tr class="separator:a5026854a646a0716daed51af6693c29c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f2c5dc8605784ba0fdf9936b59df395" id="r_a2f2c5dc8605784ba0fdf9936b59df395"><td class="memItemLeft" align="right" valign="top">GeneratorType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a2f2c5dc8605784ba0fdf9936b59df395">check_random_state</a> (GeneratorType seed)</td></tr>
<tr class="separator:a2f2c5dc8605784ba0fdf9936b59df395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af3e5c60b0fbc5c4d257feb9e2a9423" id="r_a1af3e5c60b0fbc5c4d257feb9e2a9423"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a1af3e5c60b0fbc5c4d257feb9e2a9423">check_random_state</a> (seed=None)</td></tr>
<tr class="separator:a1af3e5c60b0fbc5c4d257feb9e2a9423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f6010e0d6b7b2c3128b2f7cbadfff1a" id="r_a9f6010e0d6b7b2c3128b2f7cbadfff1a"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a9f6010e0d6b7b2c3128b2f7cbadfff1a">scale</a> (npt.ArrayLike sample, npt.ArrayLike l_bounds, npt.ArrayLike u_bounds, *bool reverse=False)</td></tr>
<tr class="separator:a9f6010e0d6b7b2c3128b2f7cbadfff1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49ddc52a2dce0cb5824f8f925e181206" id="r_a49ddc52a2dce0cb5824f8f925e181206"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a49ddc52a2dce0cb5824f8f925e181206">discrepancy</a> (npt.ArrayLike sample, *bool iterative=False, Literal[&quot;CD&quot;, &quot;WD&quot;, &quot;MD&quot;, &quot;L2-star&quot;] <a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>=&quot;CD&quot;, IntNumber workers=1)</td></tr>
<tr class="separator:a49ddc52a2dce0cb5824f8f925e181206"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33205602634d9d5ce04705a48d798551" id="r_a33205602634d9d5ce04705a48d798551"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a33205602634d9d5ce04705a48d798551">update_discrepancy</a> (npt.ArrayLike x_new, npt.ArrayLike sample, DecimalNumber initial_disc)</td></tr>
<tr class="separator:a33205602634d9d5ce04705a48d798551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c28a8dac5cfeaeacca8c1cf345f9b05" id="r_a5c28a8dac5cfeaeacca8c1cf345f9b05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a5c28a8dac5cfeaeacca8c1cf345f9b05">_perturb_discrepancy</a> (np.ndarray sample, int <a class="el" href="__lapack__subroutines_8h.html#a7e2d1226b0c42e2029942297d3bb231e">i1</a>, int <a class="el" href="__lapack__subroutines_8h.html#a6a7815df5038f88d26abb42d89c44f49">i2</a>, int <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, float disc)</td></tr>
<tr class="separator:a5c28a8dac5cfeaeacca8c1cf345f9b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73db6f8ac0e878841d09657004b0649c" id="r_a73db6f8ac0e878841d09657004b0649c"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a73db6f8ac0e878841d09657004b0649c">primes_from_2_to</a> (int <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a73db6f8ac0e878841d09657004b0649c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a056dd358acc3cd2c82d696183d5d878f" id="r_a056dd358acc3cd2c82d696183d5d878f"><td class="memItemLeft" align="right" valign="top">List[int]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a056dd358acc3cd2c82d696183d5d878f">n_primes</a> (IntNumber <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>)</td></tr>
<tr class="separator:a056dd358acc3cd2c82d696183d5d878f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7024f63085bf763b5b4a2db05e4f8b6d" id="r_a7024f63085bf763b5b4a2db05e4f8b6d"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a7024f63085bf763b5b4a2db05e4f8b6d">van_der_corput</a> (IntNumber <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, IntNumber base=2, *IntNumber start_index=0, bool scramble=False, SeedType seed=None, IntNumber workers=1)</td></tr>
<tr class="separator:a7024f63085bf763b5b4a2db05e4f8b6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1560e2d0fcca8df9754edd2c64589cf6" id="r_a1560e2d0fcca8df9754edd2c64589cf6"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a1560e2d0fcca8df9754edd2c64589cf6">_l1_norm</a> (np.ndarray sample)</td></tr>
<tr class="separator:a1560e2d0fcca8df9754edd2c64589cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af91c556cf73f004b06178a948aefc779" id="r_af91c556cf73f004b06178a948aefc779"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#af91c556cf73f004b06178a948aefc779">_lloyd_centroidal_voronoi_tessellation</a> (np.ndarray sample, float decay, str qhull_options)</td></tr>
<tr class="separator:af91c556cf73f004b06178a948aefc779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab4a2dedc07c083865e9f31dc94f402f" id="r_aab4a2dedc07c083865e9f31dc94f402f"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#aab4a2dedc07c083865e9f31dc94f402f">lloyd_centroidal_voronoi_tessellation</a> (npt.ArrayLike sample, *DecimalNumber <a class="el" href="__lapack__subroutines_8h.html#a0357339a1a1f7b51953875ca01447445">tol</a>=1e-5, IntNumber maxiter=10, Optional[str] qhull_options=None)</td></tr>
<tr class="separator:aab4a2dedc07c083865e9f31dc94f402f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50556dec8eaef56be3606788d98bd945" id="r_a50556dec8eaef56be3606788d98bd945"><td class="memItemLeft" align="right" valign="top">IntNumber&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a50556dec8eaef56be3606788d98bd945">_validate_workers</a> (IntNumber workers=1)</td></tr>
<tr class="separator:a50556dec8eaef56be3606788d98bd945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16f6d554e8ef8ec252de1f9b039c51a5" id="r_a16f6d554e8ef8ec252de1f9b039c51a5"><td class="memItemLeft" align="right" valign="top">Tuple[np.ndarray,...]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__qmc.html#a16f6d554e8ef8ec252de1f9b039c51a5">_validate_bounds</a> (npt.ArrayLike l_bounds, npt.ArrayLike u_bounds, int <a class="el" href="__lapack__subroutines_8h.html#a4c293bae27b15a76659be28378992185">d</a>)</td></tr>
<tr class="separator:a16f6d554e8ef8ec252de1f9b039c51a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Quasi-Monte Carlo engines and helpers.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a1560e2d0fcca8df9754edd2c64589cf6" name="a1560e2d0fcca8df9754edd2c64589cf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1560e2d0fcca8df9754edd2c64589cf6">&#9670;&#160;</a></span>_l1_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> float scipy.stats._qmc._l1_norm </td>
          <td>(</td>
          <td class="paramtype">np.ndarray&#160;</td>
          <td class="paramname"><em>sample</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 2132</span><span class="keyword">def </span>_l1_norm(sample: np.ndarray) -&gt; float:</div>
<div class="line"><span class="lineno"> 2133</span>    <span class="keywordflow">return</span> distance.pdist(sample, <span class="stringliteral">&#39;cityblock&#39;</span>).min()</div>
<div class="line"><span class="lineno"> 2134</span> </div>
<div class="line"><span class="lineno"> 2135</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af91c556cf73f004b06178a948aefc779" name="af91c556cf73f004b06178a948aefc779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af91c556cf73f004b06178a948aefc779">&#9670;&#160;</a></span>_lloyd_centroidal_voronoi_tessellation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc._lloyd_centroidal_voronoi_tessellation </td>
          <td>(</td>
          <td class="paramtype">np.ndarray&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>decay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>qhull_options</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Lloyd-Max algorithm iteration.

Based on the implementation of Stéfan van der Walt:

https://github.com/stefanv/lloyd

which is:

    Copyright (c) 2021-04-21 Stéfan van der Walt
    https://github.com/stefanv/lloyd
    MIT License

Parameters
----------
sample : array_like (n, d)
    The sample to iterate on.
decay : float
    Relaxation decay. A positive value would move the samples toward
    their centroid, and negative value would move them away.
    1 would move the samples to their centroid.
qhull_options : str
    Additional options to pass to Qhull. See Qhull manual
    for details. (Default: "Qbb Qc Qz Qj Qx" for ndim &gt; 4 and
    "Qbb Qc Qz Qj" otherwise.)

Returns
-------
sample : array_like (n, d)
    The sample after an iteration of Lloyd's algorithm.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2140</span>) -&gt; np.ndarray:</div>
<div class="line"><span class="lineno"> 2141</span>    <span class="stringliteral">&quot;&quot;&quot;Lloyd-Max algorithm iteration.</span></div>
<div class="line"><span class="lineno"> 2142</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2143</span><span class="stringliteral">    Based on the implementation of Stéfan van der Walt:</span></div>
<div class="line"><span class="lineno"> 2144</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2145</span><span class="stringliteral">    https://github.com/stefanv/lloyd</span></div>
<div class="line"><span class="lineno"> 2146</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2147</span><span class="stringliteral">    which is:</span></div>
<div class="line"><span class="lineno"> 2148</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2149</span><span class="stringliteral">        Copyright (c) 2021-04-21 Stéfan van der Walt</span></div>
<div class="line"><span class="lineno"> 2150</span><span class="stringliteral">        https://github.com/stefanv/lloyd</span></div>
<div class="line"><span class="lineno"> 2151</span><span class="stringliteral">        MIT License</span></div>
<div class="line"><span class="lineno"> 2152</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2153</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2154</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2155</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno"> 2156</span><span class="stringliteral">        The sample to iterate on.</span></div>
<div class="line"><span class="lineno"> 2157</span><span class="stringliteral">    decay : float</span></div>
<div class="line"><span class="lineno"> 2158</span><span class="stringliteral">        Relaxation decay. A positive value would move the samples toward</span></div>
<div class="line"><span class="lineno"> 2159</span><span class="stringliteral">        their centroid, and negative value would move them away.</span></div>
<div class="line"><span class="lineno"> 2160</span><span class="stringliteral">        1 would move the samples to their centroid.</span></div>
<div class="line"><span class="lineno"> 2161</span><span class="stringliteral">    qhull_options : str</span></div>
<div class="line"><span class="lineno"> 2162</span><span class="stringliteral">        Additional options to pass to Qhull. See Qhull manual</span></div>
<div class="line"><span class="lineno"> 2163</span><span class="stringliteral">        for details. (Default: &quot;Qbb Qc Qz Qj Qx&quot; for ndim &gt; 4 and</span></div>
<div class="line"><span class="lineno"> 2164</span><span class="stringliteral">        &quot;Qbb Qc Qz Qj&quot; otherwise.)</span></div>
<div class="line"><span class="lineno"> 2165</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2166</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2167</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2168</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno"> 2169</span><span class="stringliteral">        The sample after an iteration of Lloyd&#39;s algorithm.</span></div>
<div class="line"><span class="lineno"> 2170</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2171</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2172</span>    new_sample = np.empty_like(sample)</div>
<div class="line"><span class="lineno"> 2173</span> </div>
<div class="line"><span class="lineno"> 2174</span>    voronoi = Voronoi(sample, qhull_options=qhull_options)</div>
<div class="line"><span class="lineno"> 2175</span> </div>
<div class="line"><span class="lineno"> 2176</span>    <span class="keywordflow">for</span> ii, idx <span class="keywordflow">in</span> enumerate(voronoi.point_region):</div>
<div class="line"><span class="lineno"> 2177</span>        <span class="comment"># the region is a series of indices into self.voronoi.vertices</span></div>
<div class="line"><span class="lineno"> 2178</span>        <span class="comment"># remove samples at infinity, designated by index -1</span></div>
<div class="line"><span class="lineno"> 2179</span>        region = [i <span class="keywordflow">for</span> i <span class="keywordflow">in</span> voronoi.regions[idx] <span class="keywordflow">if</span> i != -1]</div>
<div class="line"><span class="lineno"> 2180</span> </div>
<div class="line"><span class="lineno"> 2181</span>        <span class="comment"># get the vertices for this region</span></div>
<div class="line"><span class="lineno"> 2182</span>        verts = voronoi.vertices[region]</div>
<div class="line"><span class="lineno"> 2183</span> </div>
<div class="line"><span class="lineno"> 2184</span>        <span class="comment"># clipping would be wrong, we need to intersect</span></div>
<div class="line"><span class="lineno"> 2185</span>        <span class="comment"># verts = np.clip(verts, 0, 1)</span></div>
<div class="line"><span class="lineno"> 2186</span> </div>
<div class="line"><span class="lineno"> 2187</span>        <span class="comment"># move samples towards centroids:</span></div>
<div class="line"><span class="lineno"> 2188</span>        <span class="comment"># Centroid in n-D is the mean for uniformly distributed nodes</span></div>
<div class="line"><span class="lineno"> 2189</span>        <span class="comment"># of a geometry.</span></div>
<div class="line"><span class="lineno"> 2190</span>        centroid = np.mean(verts, axis=0)</div>
<div class="line"><span class="lineno"> 2191</span>        new_sample[ii] = sample[ii] + (centroid - sample[ii]) * decay</div>
<div class="line"><span class="lineno"> 2192</span> </div>
<div class="line"><span class="lineno"> 2193</span>    <span class="comment"># only update sample to centroid within the region</span></div>
<div class="line"><span class="lineno"> 2194</span>    is_valid = np.all(np.logical_and(new_sample &gt;= 0, new_sample &lt;= 1), axis=1)</div>
<div class="line"><span class="lineno"> 2195</span>    sample[is_valid] = new_sample[is_valid]</div>
<div class="line"><span class="lineno"> 2196</span> </div>
<div class="line"><span class="lineno"> 2197</span>    <span class="keywordflow">return</span> sample</div>
<div class="line"><span class="lineno"> 2198</span> </div>
<div class="line"><span class="lineno"> 2199</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5c28a8dac5cfeaeacca8c1cf345f9b05" name="a5c28a8dac5cfeaeacca8c1cf345f9b05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c28a8dac5cfeaeacca8c1cf345f9b05">&#9670;&#160;</a></span>_perturb_discrepancy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._qmc._perturb_discrepancy </td>
          <td>(</td>
          <td class="paramtype">np.ndarray&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>disc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Centered discrepancy after an elementary perturbation of a LHS.

An elementary perturbation consists of an exchange of coordinates between
two points: ``sample[i1, k] &lt;-&gt; sample[i2, k]``. By construction,
this operation conserves the LHS properties.

Parameters
----------
sample : array_like (n, d)
    The sample (before permutation) to compute the discrepancy from.
i1 : int
    The first line of the elementary permutation.
i2 : int
    The second line of the elementary permutation.
k : int
    The column of the elementary permutation.
disc : float
    Centered discrepancy of the design before permutation.

Returns
-------
discrepancy : float
    Centered discrepancy of the design after permutation.

References
----------
.. [1] Jin et al. "An efficient algorithm for constructing optimal design
   of computer experiments", Journal of Statistical Planning and
   Inference, 2005.</pre> <div class="fragment"><div class="line"><span class="lineno">  374</span>                         disc: float):</div>
<div class="line"><span class="lineno">  375</span>    <span class="stringliteral">&quot;&quot;&quot;Centered discrepancy after an elementary perturbation of a LHS.</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">    An elementary perturbation consists of an exchange of coordinates between</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">    two points: ``sample[i1, k] &lt;-&gt; sample[i2, k]``. By construction,</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">    this operation conserves the LHS properties.</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">        The sample (before permutation) to compute the discrepancy from.</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">    i1 : int</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">        The first line of the elementary permutation.</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">    i2 : int</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">        The second line of the elementary permutation.</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">    k : int</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">        The column of the elementary permutation.</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    disc : float</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">        Centered discrepancy of the design before permutation.</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    discrepancy : float</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">        Centered discrepancy of the design after permutation.</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    .. [1] Jin et al. &quot;An efficient algorithm for constructing optimal design</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">       of computer experiments&quot;, Journal of Statistical Planning and</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">       Inference, 2005.</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  406</span>    n = sample.shape[0]</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>    z_ij = sample - 0.5</div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span>    <span class="comment"># Eq (19)</span></div>
<div class="line"><span class="lineno">  411</span>    c_i1j = (1. / n ** 2.</div>
<div class="line"><span class="lineno">  412</span>             * np.prod(0.5 * (2. + abs(z_ij[i1, :])</div>
<div class="line"><span class="lineno">  413</span>                              + abs(z_ij) - abs(z_ij[i1, :] - z_ij)), axis=1))</div>
<div class="line"><span class="lineno">  414</span>    c_i2j = (1. / n ** 2.</div>
<div class="line"><span class="lineno">  415</span>             * np.prod(0.5 * (2. + abs(z_ij[i2, :])</div>
<div class="line"><span class="lineno">  416</span>                              + abs(z_ij) - abs(z_ij[i2, :] - z_ij)), axis=1))</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>    <span class="comment"># Eq (20)</span></div>
<div class="line"><span class="lineno">  419</span>    c_i1i1 = (1. / n ** 2 * np.prod(1 + abs(z_ij[i1, :]))</div>
<div class="line"><span class="lineno">  420</span>              - 2. / n * np.prod(1. + 0.5 * abs(z_ij[i1, :])</div>
<div class="line"><span class="lineno">  421</span>                                 - 0.5 * z_ij[i1, :] ** 2))</div>
<div class="line"><span class="lineno">  422</span>    c_i2i2 = (1. / n ** 2 * np.prod(1 + abs(z_ij[i2, :]))</div>
<div class="line"><span class="lineno">  423</span>              - 2. / n * np.prod(1. + 0.5 * abs(z_ij[i2, :])</div>
<div class="line"><span class="lineno">  424</span>                                 - 0.5 * z_ij[i2, :] ** 2))</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <span class="comment"># Eq (22), typo in the article in the denominator i2 -&gt; i1</span></div>
<div class="line"><span class="lineno">  427</span>    num = (2 + abs(z_ij[i2, k]) + abs(z_ij[:, k])</div>
<div class="line"><span class="lineno">  428</span>           - abs(z_ij[i2, k] - z_ij[:, k]))</div>
<div class="line"><span class="lineno">  429</span>    denum = (2 + abs(z_ij[i1, k]) + abs(z_ij[:, k])</div>
<div class="line"><span class="lineno">  430</span>             - abs(z_ij[i1, k] - z_ij[:, k]))</div>
<div class="line"><span class="lineno">  431</span>    gamma = num / denum</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <span class="comment"># Eq (23)</span></div>
<div class="line"><span class="lineno">  434</span>    c_p_i1j = gamma * c_i1j</div>
<div class="line"><span class="lineno">  435</span>    <span class="comment"># Eq (24)</span></div>
<div class="line"><span class="lineno">  436</span>    c_p_i2j = c_i2j / gamma</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>    alpha = (1 + abs(z_ij[i2, k])) / (1 + abs(z_ij[i1, k]))</div>
<div class="line"><span class="lineno">  439</span>    beta = (2 - abs(z_ij[i2, k])) / (2 - abs(z_ij[i1, k]))</div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    g_i1 = np.prod(1. + abs(z_ij[i1, :]))</div>
<div class="line"><span class="lineno">  442</span>    g_i2 = np.prod(1. + abs(z_ij[i2, :]))</div>
<div class="line"><span class="lineno">  443</span>    h_i1 = np.prod(1. + 0.5 * abs(z_ij[i1, :]) - 0.5 * (z_ij[i1, :] ** 2))</div>
<div class="line"><span class="lineno">  444</span>    h_i2 = np.prod(1. + 0.5 * abs(z_ij[i2, :]) - 0.5 * (z_ij[i2, :] ** 2))</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>    <span class="comment"># Eq (25), typo in the article g is missing</span></div>
<div class="line"><span class="lineno">  447</span>    c_p_i1i1 = ((g_i1 * alpha) / (n ** 2) - 2. * alpha * beta * h_i1 / n)</div>
<div class="line"><span class="lineno">  448</span>    <span class="comment"># Eq (26), typo in the article n ** 2</span></div>
<div class="line"><span class="lineno">  449</span>    c_p_i2i2 = ((g_i2 / ((n ** 2) * alpha)) - (2. * h_i2 / (n * alpha * beta)))</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <span class="comment"># Eq (26)</span></div>
<div class="line"><span class="lineno">  452</span>    sum_ = c_p_i1j - c_i1j + c_p_i2j - c_i2j</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>    mask = np.ones(n, dtype=bool)</div>
<div class="line"><span class="lineno">  455</span>    mask[[i1, i2]] = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  456</span>    sum_ = sum(sum_[mask])</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    disc_ep = (disc + c_p_i1i1 - c_i1i1 + c_p_i2i2 - c_i2i2 + 2 * sum_)</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">return</span> disc_ep</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a16f6d554e8ef8ec252de1f9b039c51a5" name="a16f6d554e8ef8ec252de1f9b039c51a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16f6d554e8ef8ec252de1f9b039c51a5">&#9670;&#160;</a></span>_validate_bounds()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> Tuple[np.ndarray, ...] scipy.stats._qmc._validate_bounds </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>l_bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>u_bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int
&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Bounds input validation.

Parameters
----------
l_bounds, u_bounds : array_like (d,)
    Lower and upper bounds.
d : int
    Dimension to use for broadcasting.

Returns
-------
l_bounds, u_bounds : array_like (d,)
    Lower and upper bounds.</pre> <div class="fragment"><div class="line"><span class="lineno"> 2377</span>) -&gt; Tuple[np.ndarray, ...]:</div>
<div class="line"><span class="lineno"> 2378</span>    <span class="stringliteral">&quot;&quot;&quot;Bounds input validation.</span></div>
<div class="line"><span class="lineno"> 2379</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2380</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2381</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2382</span><span class="stringliteral">    l_bounds, u_bounds : array_like (d,)</span></div>
<div class="line"><span class="lineno"> 2383</span><span class="stringliteral">        Lower and upper bounds.</span></div>
<div class="line"><span class="lineno"> 2384</span><span class="stringliteral">    d : int</span></div>
<div class="line"><span class="lineno"> 2385</span><span class="stringliteral">        Dimension to use for broadcasting.</span></div>
<div class="line"><span class="lineno"> 2386</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2387</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2388</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2389</span><span class="stringliteral">    l_bounds, u_bounds : array_like (d,)</span></div>
<div class="line"><span class="lineno"> 2390</span><span class="stringliteral">        Lower and upper bounds.</span></div>
<div class="line"><span class="lineno"> 2391</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2392</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2393</span>    <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno"> 2394</span>        lower = np.broadcast_to(l_bounds, d)</div>
<div class="line"><span class="lineno"> 2395</span>        upper = np.broadcast_to(u_bounds, d)</div>
<div class="line"><span class="lineno"> 2396</span>    <span class="keywordflow">except</span> ValueError <span class="keyword">as</span> exc:</div>
<div class="line"><span class="lineno"> 2397</span>        msg = (<span class="stringliteral">&quot;&#39;l_bounds&#39; and &#39;u_bounds&#39; must be broadcastable and respect&quot;</span></div>
<div class="line"><span class="lineno"> 2398</span>               <span class="stringliteral">&quot; the sample dimension&quot;</span>)</div>
<div class="line"><span class="lineno"> 2399</span>        <span class="keywordflow">raise</span> ValueError(msg) <span class="keyword">from</span> exc</div>
<div class="line"><span class="lineno"> 2400</span> </div>
<div class="line"><span class="lineno"> 2401</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> np.all(lower &lt; upper):</div>
<div class="line"><span class="lineno"> 2402</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Bounds are not consistent &#39;l_bounds&#39; &lt; &#39;u_bounds&#39;&quot;</span>)</div>
<div class="line"><span class="lineno"> 2403</span> </div>
<div class="line"><span class="lineno"> 2404</span>    <span class="keywordflow">return</span> lower, upper</div>
</div><!-- fragment -->
</div>
</div>
<a id="a50556dec8eaef56be3606788d98bd945" name="a50556dec8eaef56be3606788d98bd945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50556dec8eaef56be3606788d98bd945">&#9670;&#160;</a></span>_validate_workers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> IntNumber scipy.stats._qmc._validate_workers </td>
          <td>(</td>
          <td class="paramtype">IntNumber &#160;</td>
          <td class="paramname"><em>workers</em> = <code>1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Validate `workers` based on platform and value.

Parameters
----------
workers : int, optional
    Number of workers to use for parallel processing. If -1 is
    given all CPU threads are used. Default is 1.

Returns
-------
Workers : int
    Number of CPU used by the algorithm</pre> <div class="fragment"><div class="line"><span class="lineno"> 2345</span><span class="keyword">def </span>_validate_workers(workers: IntNumber = 1) -&gt; IntNumber:</div>
<div class="line"><span class="lineno"> 2346</span>    <span class="stringliteral">&quot;&quot;&quot;Validate `workers` based on platform and value.</span></div>
<div class="line"><span class="lineno"> 2347</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2348</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2349</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2350</span><span class="stringliteral">    workers : int, optional</span></div>
<div class="line"><span class="lineno"> 2351</span><span class="stringliteral">        Number of workers to use for parallel processing. If -1 is</span></div>
<div class="line"><span class="lineno"> 2352</span><span class="stringliteral">        given all CPU threads are used. Default is 1.</span></div>
<div class="line"><span class="lineno"> 2353</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2354</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2355</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2356</span><span class="stringliteral">    Workers : int</span></div>
<div class="line"><span class="lineno"> 2357</span><span class="stringliteral">        Number of CPU used by the algorithm</span></div>
<div class="line"><span class="lineno"> 2358</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2359</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2360</span>    workers = int(workers)</div>
<div class="line"><span class="lineno"> 2361</span>    <span class="keywordflow">if</span> workers == -1:</div>
<div class="line"><span class="lineno"> 2362</span>        workers = os.cpu_count()  <span class="comment"># type: ignore[assignment]</span></div>
<div class="line"><span class="lineno"> 2363</span>        <span class="keywordflow">if</span> workers <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2364</span>            <span class="keywordflow">raise</span> NotImplementedError(</div>
<div class="line"><span class="lineno"> 2365</span>                <span class="stringliteral">&quot;Cannot determine the number of cpus using os.cpu_count(), &quot;</span></div>
<div class="line"><span class="lineno"> 2366</span>                <span class="stringliteral">&quot;cannot use -1 for the number of workers&quot;</span></div>
<div class="line"><span class="lineno"> 2367</span>            )</div>
<div class="line"><span class="lineno"> 2368</span>    <span class="keywordflow">elif</span> workers &lt;= 0:</div>
<div class="line"><span class="lineno"> 2369</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Invalid number of workers: {workers}, must be -1 &quot;</span></div>
<div class="line"><span class="lineno"> 2370</span>                         <span class="stringliteral">&quot;or &gt; 0&quot;</span>)</div>
<div class="line"><span class="lineno"> 2371</span> </div>
<div class="line"><span class="lineno"> 2372</span>    <span class="keywordflow">return</span> workers</div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f2c5dc8605784ba0fdf9936b59df395" name="a2f2c5dc8605784ba0fdf9936b59df395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f2c5dc8605784ba0fdf9936b59df395">&#9670;&#160;</a></span>check_random_state() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> GeneratorType scipy.stats._qmc.check_random_state </td>
          <td>(</td>
          <td class="paramtype">GeneratorType&#160;</td>
          <td class="paramname"><em>seed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   59</span><span class="keyword">def </span>check_random_state(seed: GeneratorType) -&gt; GeneratorType:</div>
<div class="line"><span class="lineno">   60</span>    ...</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span><span class="comment"># Based on scipy._lib._util.check_random_state</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5026854a646a0716daed51af6693c29c" name="a5026854a646a0716daed51af6693c29c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5026854a646a0716daed51af6693c29c">&#9670;&#160;</a></span>check_random_state() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.random.Generator scipy.stats._qmc.check_random_state </td>
          <td>(</td>
          <td class="paramtype">Optional[IntNumber] &#160;</td>
          <td class="paramname"><em>seed</em> = <code>...</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   55</span><span class="keyword">def </span>check_random_state(seed: Optional[IntNumber] = ...) -&gt; np.random.Generator:</div>
<div class="line"><span class="lineno">   56</span>    ...</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span><span class="preprocessor">@overload</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1af3e5c60b0fbc5c4d257feb9e2a9423" name="a1af3e5c60b0fbc5c4d257feb9e2a9423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1af3e5c60b0fbc5c4d257feb9e2a9423">&#9670;&#160;</a></span>check_random_state() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._qmc.check_random_state </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Turn `seed` into a `numpy.random.Generator` instance.

Parameters
----------
seed : {None, int, `numpy.random.Generator`,
        `numpy.random.RandomState`}, optional

    If `seed` is None the `numpy.random.Generator` singleton is used.
    If `seed` is an int, a new ``Generator`` instance is used,
    seeded with `seed`.
    If `seed` is already a ``Generator`` or ``RandomState`` instance then
    that instance is used.

Returns
-------
seed : {`numpy.random.Generator`, `numpy.random.RandomState`}
    Random number generator.</pre> <div class="fragment"><div class="line"><span class="lineno">   64</span><span class="keyword">def </span>check_random_state(seed=None):</div>
<div class="line"><span class="lineno">   65</span>    <span class="stringliteral">&quot;&quot;&quot;Turn `seed` into a `numpy.random.Generator` instance.</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">    seed : {None, int, `numpy.random.Generator`,</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">            `numpy.random.RandomState`}, optional</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">        If `seed` is None the `numpy.random.Generator` singleton is used.</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        If `seed` is an int, a new ``Generator`` instance is used,</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        seeded with `seed`.</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        If `seed` is already a ``Generator`` or ``RandomState`` instance then</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral">        that instance is used.</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    seed : {`numpy.random.Generator`, `numpy.random.RandomState`}</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">        Random number generator.</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   84</span>    <span class="keywordflow">if</span> seed <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">or</span> isinstance(seed, (numbers.Integral, np.integer)):</div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">return</span> np.random.default_rng(seed)</div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">elif</span> isinstance(seed, (np.random.RandomState, np.random.Generator)):</div>
<div class="line"><span class="lineno">   87</span>        <span class="keywordflow">return</span> seed</div>
<div class="line"><span class="lineno">   88</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&#39;{seed!r} cannot be used to seed a&#39;</span></div>
<div class="line"><span class="lineno">   90</span>                         <span class="stringliteral">&#39; numpy.random.Generator instance&#39;</span>)</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a49ddc52a2dce0cb5824f8f925e181206" name="a49ddc52a2dce0cb5824f8f925e181206"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49ddc52a2dce0cb5824f8f925e181206">&#9670;&#160;</a></span>discrepancy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float scipy.stats._qmc.discrepancy </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*bool &#160;</td>
          <td class="paramname"><em>iterative</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Literal[&quot;CD&quot;, &quot;WD&quot;, &quot;MD&quot;, &quot;L2-star&quot;] &#160;</td>
          <td class="paramname"><em>method</em> = <code>&quot;CD&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber &#160;</td>
          <td class="paramname"><em>workers</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Discrepancy of a given sample.

Parameters
----------
sample : array_like (n, d)
    The sample to compute the discrepancy from.
iterative : bool, optional
    Must be False if not using it for updating the discrepancy.
    Default is False. Refer to the notes for more details.
method : str, optional
    Type of discrepancy, can be ``CD``, ``WD``, ``MD`` or ``L2-star``.
    Refer to the notes for more details. Default is ``CD``.
workers : int, optional
    Number of workers to use for parallel processing. If -1 is given all
    CPU threads are used. Default is 1.

Returns
-------
discrepancy : float
    Discrepancy.

Notes
-----
The discrepancy is a uniformity criterion used to assess the space filling
of a number of samples in a hypercube. A discrepancy quantifies the
distance between the continuous uniform distribution on a hypercube and the
discrete uniform distribution on :math:`n` distinct sample points.

The lower the value is, the better the coverage of the parameter space is.

For a collection of subsets of the hypercube, the discrepancy is the
difference between the fraction of sample points in one of those
subsets and the volume of that subset. There are different definitions of
discrepancy corresponding to different collections of subsets. Some
versions take a root mean square difference over subsets instead of
a maximum.

A measure of uniformity is reasonable if it satisfies the following
criteria [1]_:

1. It is invariant under permuting factors and/or runs.
2. It is invariant under rotation of the coordinates.
3. It can measure not only uniformity of the sample over the hypercube,
   but also the projection uniformity of the sample over non-empty
   subset of lower dimension hypercubes.
4. There is some reasonable geometric meaning.
5. It is easy to compute.
6. It satisfies the Koksma-Hlawka-like inequality.
7. It is consistent with other criteria in experimental design.

Four methods are available:

* ``CD``: Centered Discrepancy - subspace involves a corner of the
  hypercube
* ``WD``: Wrap-around Discrepancy - subspace can wrap around bounds
* ``MD``: Mixture Discrepancy - mix between CD/WD covering more criteria
* ``L2-star``: L2-star discrepancy - like CD BUT variant to rotation

See [2]_ for precise definitions of each method.

Lastly, using ``iterative=True``, it is possible to compute the
discrepancy as if we had :math:`n+1` samples. This is useful if we want
to add a point to a sampling and check the candidate which would give the
lowest discrepancy. Then you could just update the discrepancy with
each candidate using `update_discrepancy`. This method is faster than
computing the discrepancy for a large number of candidates.

References
----------
.. [1] Fang et al. "Design and modeling for computer experiments".
   Computer Science and Data Analysis Series, 2006.
.. [2] Zhou Y.-D. et al. "Mixture discrepancy for quasi-random point sets."
   Journal of Complexity, 29 (3-4) , pp. 283-301, 2013.
.. [3] T. T. Warnock. "Computational investigations of low discrepancy
   point sets." Applications of Number Theory to Numerical
   Analysis, Academic Press, pp. 319-343, 1972.

Examples
--------
Calculate the quality of the sample using the discrepancy:

&gt;&gt;&gt; from scipy.stats import qmc
&gt;&gt;&gt; space = np.array([[1, 3], [2, 6], [3, 2], [4, 5], [5, 1], [6, 4]])
&gt;&gt;&gt; l_bounds = [0.5, 0.5]
&gt;&gt;&gt; u_bounds = [6.5, 6.5]
&gt;&gt;&gt; space = qmc.scale(space, l_bounds, u_bounds, reverse=True)
&gt;&gt;&gt; space
array([[0.08333333, 0.41666667],
       [0.25      , 0.91666667],
       [0.41666667, 0.25      ],
       [0.58333333, 0.75      ],
       [0.75      , 0.08333333],
       [0.91666667, 0.58333333]])
&gt;&gt;&gt; qmc.discrepancy(space)
0.008142039609053464

We can also compute iteratively the ``CD`` discrepancy by using
``iterative=True``.

&gt;&gt;&gt; disc_init = qmc.discrepancy(space[:-1], iterative=True)
&gt;&gt;&gt; disc_init
0.04769081147119336
&gt;&gt;&gt; qmc.update_discrepancy(space[-1], space[:-1], disc_init)
0.008142039609053513</pre> <div class="fragment"><div class="line"><span class="lineno">  181</span>        workers: IntNumber = 1) -&gt; float:</div>
<div class="line"><span class="lineno">  182</span>    <span class="stringliteral">&quot;&quot;&quot;Discrepancy of a given sample.</span></div>
<div class="line"><span class="lineno">  183</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  184</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  185</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">        The sample to compute the discrepancy from.</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    iterative : bool, optional</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">        Must be False if not using it for updating the discrepancy.</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">        Default is False. Refer to the notes for more details.</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    method : str, optional</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">        Type of discrepancy, can be ``CD``, ``WD``, ``MD`` or ``L2-star``.</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">        Refer to the notes for more details. Default is ``CD``.</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral">    workers : int, optional</span></div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">        Number of workers to use for parallel processing. If -1 is given all</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">        CPU threads are used. Default is 1.</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    discrepancy : float</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">        Discrepancy.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    The discrepancy is a uniformity criterion used to assess the space filling</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    of a number of samples in a hypercube. A discrepancy quantifies the</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    distance between the continuous uniform distribution on a hypercube and the</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">    discrete uniform distribution on :math:`n` distinct sample points.</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral">    The lower the value is, the better the coverage of the parameter space is.</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">    For a collection of subsets of the hypercube, the discrepancy is the</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">    difference between the fraction of sample points in one of those</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">    subsets and the volume of that subset. There are different definitions of</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral">    discrepancy corresponding to different collections of subsets. Some</span></div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">    versions take a root mean square difference over subsets instead of</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">    a maximum.</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">    A measure of uniformity is reasonable if it satisfies the following</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">    criteria [1]_:</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    1. It is invariant under permuting factors and/or runs.</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">    2. It is invariant under rotation of the coordinates.</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">    3. It can measure not only uniformity of the sample over the hypercube,</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">       but also the projection uniformity of the sample over non-empty</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">       subset of lower dimension hypercubes.</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    4. There is some reasonable geometric meaning.</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">    5. It is easy to compute.</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">    6. It satisfies the Koksma-Hlawka-like inequality.</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    7. It is consistent with other criteria in experimental design.</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    Four methods are available:</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">    * ``CD``: Centered Discrepancy - subspace involves a corner of the</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">      hypercube</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral">    * ``WD``: Wrap-around Discrepancy - subspace can wrap around bounds</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">    * ``MD``: Mixture Discrepancy - mix between CD/WD covering more criteria</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">    * ``L2-star``: L2-star discrepancy - like CD BUT variant to rotation</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral">    See [2]_ for precise definitions of each method.</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">    Lastly, using ``iterative=True``, it is possible to compute the</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    discrepancy as if we had :math:`n+1` samples. This is useful if we want</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    to add a point to a sampling and check the candidate which would give the</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">    lowest discrepancy. Then you could just update the discrepancy with</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">    each candidate using `update_discrepancy`. This method is faster than</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    computing the discrepancy for a large number of candidates.</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    .. [1] Fang et al. &quot;Design and modeling for computer experiments&quot;.</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">       Computer Science and Data Analysis Series, 2006.</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">    .. [2] Zhou Y.-D. et al. &quot;Mixture discrepancy for quasi-random point sets.&quot;</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">       Journal of Complexity, 29 (3-4) , pp. 283-301, 2013.</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">    .. [3] T. T. Warnock. &quot;Computational investigations of low discrepancy</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">       point sets.&quot; Applications of Number Theory to Numerical</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">       Analysis, Academic Press, pp. 319-343, 1972.</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    Calculate the quality of the sample using the discrepancy:</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import qmc</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    &gt;&gt;&gt; space = np.array([[1, 3], [2, 6], [3, 2], [4, 5], [5, 1], [6, 4]])</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">    &gt;&gt;&gt; l_bounds = [0.5, 0.5]</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    &gt;&gt;&gt; u_bounds = [6.5, 6.5]</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    &gt;&gt;&gt; space = qmc.scale(space, l_bounds, u_bounds, reverse=True)</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    &gt;&gt;&gt; space</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">    array([[0.08333333, 0.41666667],</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">           [0.25      , 0.91666667],</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">           [0.41666667, 0.25      ],</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">           [0.58333333, 0.75      ],</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">           [0.75      , 0.08333333],</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">           [0.91666667, 0.58333333]])</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">    &gt;&gt;&gt; qmc.discrepancy(space)</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    0.008142039609053464</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    We can also compute iteratively the ``CD`` discrepancy by using</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">    ``iterative=True``.</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">    &gt;&gt;&gt; disc_init = qmc.discrepancy(space[:-1], iterative=True)</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    &gt;&gt;&gt; disc_init</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">    0.04769081147119336</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">    &gt;&gt;&gt; qmc.update_discrepancy(space[-1], space[:-1], disc_init)</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">    0.008142039609053513</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  288</span>    sample = np.asarray(sample, dtype=np.float64, order=<span class="stringliteral">&quot;C&quot;</span>)</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    <span class="comment"># Checking that sample is within the hypercube and 2D</span></div>
<div class="line"><span class="lineno">  291</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> sample.ndim == 2:</div>
<div class="line"><span class="lineno">  292</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Sample is not a 2D array&quot;</span>)</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">if</span> (sample.max() &gt; 1.) <span class="keywordflow">or</span> (sample.min() &lt; 0.):</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Sample is not in unit hypercube&quot;</span>)</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    workers = _validate_workers(workers)</div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>    methods = {</div>
<div class="line"><span class="lineno">  300</span>        <span class="stringliteral">&quot;CD&quot;</span>: _cy_wrapper_centered_discrepancy,</div>
<div class="line"><span class="lineno">  301</span>        <span class="stringliteral">&quot;WD&quot;</span>: _cy_wrapper_wrap_around_discrepancy,</div>
<div class="line"><span class="lineno">  302</span>        <span class="stringliteral">&quot;MD&quot;</span>: _cy_wrapper_mixture_discrepancy,</div>
<div class="line"><span class="lineno">  303</span>        <span class="stringliteral">&quot;L2-star&quot;</span>: _cy_wrapper_l2_star_discrepancy,</div>
<div class="line"><span class="lineno">  304</span>    }</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    <span class="keywordflow">if</span> method <span class="keywordflow">in</span> methods:</div>
<div class="line"><span class="lineno">  307</span>        <span class="keywordflow">return</span> methods[method](sample, iterative, workers=workers)</div>
<div class="line"><span class="lineno">  308</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;{method!r} is not a valid method. It must be one of&quot;</span></div>
<div class="line"><span class="lineno">  310</span>                         f<span class="stringliteral">&quot; {set(methods)!r}&quot;</span>)</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aab4a2dedc07c083865e9f31dc94f402f" name="aab4a2dedc07c083865e9f31dc94f402f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab4a2dedc07c083865e9f31dc94f402f">&#9670;&#160;</a></span>lloyd_centroidal_voronoi_tessellation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc.lloyd_centroidal_voronoi_tessellation </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*DecimalNumber &#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber &#160;</td>
          <td class="paramname"><em>maxiter</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[str] &#160;</td>
          <td class="paramname"><em>qhull_options</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Approximate Centroidal Voronoi Tessellation.

Perturb samples in N-dimensions using Lloyd-Max algorithm.

Parameters
----------
sample : array_like (n, d)
    The sample to iterate on. With ``n`` the number of samples and ``d``
    the dimension. Samples must be in :math:`[0, 1]^d`, with ``d&gt;=2``.
tol : float, optional
    Tolerance for termination. If the min of the L1-norm over the samples
    changes less than `tol`, it stops the algorithm. Default is 1e-5.
maxiter : int, optional
    Maximum number of iterations. It will stop the algorithm even if
    `tol` is above the threshold.
    Too many iterations tend to cluster the samples as a hypersphere.
    Default is 10.
qhull_options : str, optional
    Additional options to pass to Qhull. See Qhull manual
    for details. (Default: "Qbb Qc Qz Qj Qx" for ndim &gt; 4 and
    "Qbb Qc Qz Qj" otherwise.)

Returns
-------
sample : array_like (n, d)
    The sample after being processed by Lloyd-Max algorithm.

Notes
-----
Lloyd-Max algorithm is an iterative process with the purpose of improving
the dispersion of samples. For given sample: (i) compute a Voronoi
Tessellation; (ii) find the centroid of each Voronoi cell; (iii) move the
samples toward the centroid of their respective cell. See [1]_, [2]_.

A relaxation factor is used to control how fast samples can move at each
iteration. This factor is starting at 2 and ending at 1 after `maxiter`
following an exponential decay.

The process converges to equally spaced samples. It implies that measures
like the discrepancy could suffer from too many iterations. On the other
hand, L1 and L2 distances should improve. This is especially true with
QMC methods which tend to favor the discrepancy over other criteria.

.. note::

    The current implementation does not intersect the Voronoi Tessellation
    with the boundaries. This implies that for a low number of samples,
    empirically below 20, no Voronoi cell is touching the boundaries.
    Hence, samples cannot be moved close to the boundaries.

    Further improvements could consider the samples at infinity so that
    all boundaries are segments of some Voronoi cells. This would fix
    the computation of the centroid position.

.. warning::

   The Voronoi Tessellation step is expensive and quickly becomes
   intractable with dimensions as low as 10 even for a sample
   of size as low as 1000.

.. versionadded:: 1.9.0

References
----------
.. [1] Lloyd. "Least Squares Quantization in PCM".
   IEEE Transactions on Information Theory, 1982.
.. [2] Max J. "Quantizing for minimum distortion".
   IEEE Transactions on Information Theory, 1960.

Examples
--------
&gt;&gt;&gt; from scipy.spatial import distance
&gt;&gt;&gt; rng = np.random.default_rng()
&gt;&gt;&gt; sample = rng.random((128, 2))

.. note::

    The samples need to be in :math:`[0, 1]^d`. `scipy.stats.qmc.scale`
    can be used to scale the samples from their
    original bounds to :math:`[0, 1]^d`. And back to their original bounds.

Compute the quality of the sample using the L1 criterion.

&gt;&gt;&gt; def l1_norm(sample):
...    return distance.pdist(sample, 'cityblock').min()

&gt;&gt;&gt; l1_norm(sample)
0.00161...  # random

Now process the sample using Lloyd's algorithm and check the improvement
on the L1. The value should increase.

&gt;&gt;&gt; sample = lloyd_centroidal_voronoi_tessellation(sample)
&gt;&gt;&gt; l1_norm(sample)
0.0278...  # random</pre> <div class="fragment"><div class="line"><span class="lineno"> 2206</span>) -&gt; np.ndarray:</div>
<div class="line"><span class="lineno"> 2207</span>    <span class="stringliteral">&quot;&quot;&quot;Approximate Centroidal Voronoi Tessellation.</span></div>
<div class="line"><span class="lineno"> 2208</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2209</span><span class="stringliteral">    Perturb samples in N-dimensions using Lloyd-Max algorithm.</span></div>
<div class="line"><span class="lineno"> 2210</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2211</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno"> 2212</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2213</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno"> 2214</span><span class="stringliteral">        The sample to iterate on. With ``n`` the number of samples and ``d``</span></div>
<div class="line"><span class="lineno"> 2215</span><span class="stringliteral">        the dimension. Samples must be in :math:`[0, 1]^d`, with ``d&gt;=2``.</span></div>
<div class="line"><span class="lineno"> 2216</span><span class="stringliteral">    tol : float, optional</span></div>
<div class="line"><span class="lineno"> 2217</span><span class="stringliteral">        Tolerance for termination. If the min of the L1-norm over the samples</span></div>
<div class="line"><span class="lineno"> 2218</span><span class="stringliteral">        changes less than `tol`, it stops the algorithm. Default is 1e-5.</span></div>
<div class="line"><span class="lineno"> 2219</span><span class="stringliteral">    maxiter : int, optional</span></div>
<div class="line"><span class="lineno"> 2220</span><span class="stringliteral">        Maximum number of iterations. It will stop the algorithm even if</span></div>
<div class="line"><span class="lineno"> 2221</span><span class="stringliteral">        `tol` is above the threshold.</span></div>
<div class="line"><span class="lineno"> 2222</span><span class="stringliteral">        Too many iterations tend to cluster the samples as a hypersphere.</span></div>
<div class="line"><span class="lineno"> 2223</span><span class="stringliteral">        Default is 10.</span></div>
<div class="line"><span class="lineno"> 2224</span><span class="stringliteral">    qhull_options : str, optional</span></div>
<div class="line"><span class="lineno"> 2225</span><span class="stringliteral">        Additional options to pass to Qhull. See Qhull manual</span></div>
<div class="line"><span class="lineno"> 2226</span><span class="stringliteral">        for details. (Default: &quot;Qbb Qc Qz Qj Qx&quot; for ndim &gt; 4 and</span></div>
<div class="line"><span class="lineno"> 2227</span><span class="stringliteral">        &quot;Qbb Qc Qz Qj&quot; otherwise.)</span></div>
<div class="line"><span class="lineno"> 2228</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2229</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno"> 2230</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno"> 2231</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno"> 2232</span><span class="stringliteral">        The sample after being processed by Lloyd-Max algorithm.</span></div>
<div class="line"><span class="lineno"> 2233</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2234</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno"> 2235</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno"> 2236</span><span class="stringliteral">    Lloyd-Max algorithm is an iterative process with the purpose of improving</span></div>
<div class="line"><span class="lineno"> 2237</span><span class="stringliteral">    the dispersion of samples. For given sample: (i) compute a Voronoi</span></div>
<div class="line"><span class="lineno"> 2238</span><span class="stringliteral">    Tessellation; (ii) find the centroid of each Voronoi cell; (iii) move the</span></div>
<div class="line"><span class="lineno"> 2239</span><span class="stringliteral">    samples toward the centroid of their respective cell. See [1]_, [2]_.</span></div>
<div class="line"><span class="lineno"> 2240</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2241</span><span class="stringliteral">    A relaxation factor is used to control how fast samples can move at each</span></div>
<div class="line"><span class="lineno"> 2242</span><span class="stringliteral">    iteration. This factor is starting at 2 and ending at 1 after `maxiter`</span></div>
<div class="line"><span class="lineno"> 2243</span><span class="stringliteral">    following an exponential decay.</span></div>
<div class="line"><span class="lineno"> 2244</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2245</span><span class="stringliteral">    The process converges to equally spaced samples. It implies that measures</span></div>
<div class="line"><span class="lineno"> 2246</span><span class="stringliteral">    like the discrepancy could suffer from too many iterations. On the other</span></div>
<div class="line"><span class="lineno"> 2247</span><span class="stringliteral">    hand, L1 and L2 distances should improve. This is especially true with</span></div>
<div class="line"><span class="lineno"> 2248</span><span class="stringliteral">    QMC methods which tend to favor the discrepancy over other criteria.</span></div>
<div class="line"><span class="lineno"> 2249</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2250</span><span class="stringliteral">    .. note::</span></div>
<div class="line"><span class="lineno"> 2251</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2252</span><span class="stringliteral">        The current implementation does not intersect the Voronoi Tessellation</span></div>
<div class="line"><span class="lineno"> 2253</span><span class="stringliteral">        with the boundaries. This implies that for a low number of samples,</span></div>
<div class="line"><span class="lineno"> 2254</span><span class="stringliteral">        empirically below 20, no Voronoi cell is touching the boundaries.</span></div>
<div class="line"><span class="lineno"> 2255</span><span class="stringliteral">        Hence, samples cannot be moved close to the boundaries.</span></div>
<div class="line"><span class="lineno"> 2256</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2257</span><span class="stringliteral">        Further improvements could consider the samples at infinity so that</span></div>
<div class="line"><span class="lineno"> 2258</span><span class="stringliteral">        all boundaries are segments of some Voronoi cells. This would fix</span></div>
<div class="line"><span class="lineno"> 2259</span><span class="stringliteral">        the computation of the centroid position.</span></div>
<div class="line"><span class="lineno"> 2260</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2261</span><span class="stringliteral">    .. warning::</span></div>
<div class="line"><span class="lineno"> 2262</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2263</span><span class="stringliteral">       The Voronoi Tessellation step is expensive and quickly becomes</span></div>
<div class="line"><span class="lineno"> 2264</span><span class="stringliteral">       intractable with dimensions as low as 10 even for a sample</span></div>
<div class="line"><span class="lineno"> 2265</span><span class="stringliteral">       of size as low as 1000.</span></div>
<div class="line"><span class="lineno"> 2266</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2267</span><span class="stringliteral">    .. versionadded:: 1.9.0</span></div>
<div class="line"><span class="lineno"> 2268</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2269</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno"> 2270</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno"> 2271</span><span class="stringliteral">    .. [1] Lloyd. &quot;Least Squares Quantization in PCM&quot;.</span></div>
<div class="line"><span class="lineno"> 2272</span><span class="stringliteral">       IEEE Transactions on Information Theory, 1982.</span></div>
<div class="line"><span class="lineno"> 2273</span><span class="stringliteral">    .. [2] Max J. &quot;Quantizing for minimum distortion&quot;.</span></div>
<div class="line"><span class="lineno"> 2274</span><span class="stringliteral">       IEEE Transactions on Information Theory, 1960.</span></div>
<div class="line"><span class="lineno"> 2275</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2276</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno"> 2277</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno"> 2278</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.spatial import distance</span></div>
<div class="line"><span class="lineno"> 2279</span><span class="stringliteral">    &gt;&gt;&gt; rng = np.random.default_rng()</span></div>
<div class="line"><span class="lineno"> 2280</span><span class="stringliteral">    &gt;&gt;&gt; sample = rng.random((128, 2))</span></div>
<div class="line"><span class="lineno"> 2281</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2282</span><span class="stringliteral">    .. note::</span></div>
<div class="line"><span class="lineno"> 2283</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2284</span><span class="stringliteral">        The samples need to be in :math:`[0, 1]^d`. `scipy.stats.qmc.scale`</span></div>
<div class="line"><span class="lineno"> 2285</span><span class="stringliteral">        can be used to scale the samples from their</span></div>
<div class="line"><span class="lineno"> 2286</span><span class="stringliteral">        original bounds to :math:`[0, 1]^d`. And back to their original bounds.</span></div>
<div class="line"><span class="lineno"> 2287</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2288</span><span class="stringliteral">    Compute the quality of the sample using the L1 criterion.</span></div>
<div class="line"><span class="lineno"> 2289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2290</span><span class="stringliteral">    &gt;&gt;&gt; def l1_norm(sample):</span></div>
<div class="line"><span class="lineno"> 2291</span><span class="stringliteral">    ...    return distance.pdist(sample, &#39;cityblock&#39;).min()</span></div>
<div class="line"><span class="lineno"> 2292</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2293</span><span class="stringliteral">    &gt;&gt;&gt; l1_norm(sample)</span></div>
<div class="line"><span class="lineno"> 2294</span><span class="stringliteral">    0.00161...  # random</span></div>
<div class="line"><span class="lineno"> 2295</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2296</span><span class="stringliteral">    Now process the sample using Lloyd&#39;s algorithm and check the improvement</span></div>
<div class="line"><span class="lineno"> 2297</span><span class="stringliteral">    on the L1. The value should increase.</span></div>
<div class="line"><span class="lineno"> 2298</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2299</span><span class="stringliteral">    &gt;&gt;&gt; sample = lloyd_centroidal_voronoi_tessellation(sample)</span></div>
<div class="line"><span class="lineno"> 2300</span><span class="stringliteral">    &gt;&gt;&gt; l1_norm(sample)</span></div>
<div class="line"><span class="lineno"> 2301</span><span class="stringliteral">    0.0278...  # random</span></div>
<div class="line"><span class="lineno"> 2302</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2303</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2304</span>    sample = np.asarray(sample).copy()</div>
<div class="line"><span class="lineno"> 2305</span> </div>
<div class="line"><span class="lineno"> 2306</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> sample.ndim == 2:</div>
<div class="line"><span class="lineno"> 2307</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;`sample` is not a 2D array&#39;</span>)</div>
<div class="line"><span class="lineno"> 2308</span> </div>
<div class="line"><span class="lineno"> 2309</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> sample.shape[1] &gt;= 2:</div>
<div class="line"><span class="lineno"> 2310</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;`sample` dimension is not &gt;= 2&#39;</span>)</div>
<div class="line"><span class="lineno"> 2311</span> </div>
<div class="line"><span class="lineno"> 2312</span>    <span class="comment"># Checking that sample is within the hypercube</span></div>
<div class="line"><span class="lineno"> 2313</span>    <span class="keywordflow">if</span> (sample.max() &gt; 1.) <span class="keywordflow">or</span> (sample.min() &lt; 0.):</div>
<div class="line"><span class="lineno"> 2314</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;`sample` is not in unit hypercube&#39;</span>)</div>
<div class="line"><span class="lineno"> 2315</span> </div>
<div class="line"><span class="lineno"> 2316</span>    <span class="keywordflow">if</span> qhull_options <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2317</span>        qhull_options = <span class="stringliteral">&#39;Qbb Qc Qz QJ&#39;</span></div>
<div class="line"><span class="lineno"> 2318</span> </div>
<div class="line"><span class="lineno"> 2319</span>        <span class="keywordflow">if</span> sample.shape[1] &gt;= 5:</div>
<div class="line"><span class="lineno"> 2320</span>            qhull_options += <span class="stringliteral">&#39; Qx&#39;</span></div>
<div class="line"><span class="lineno"> 2321</span> </div>
<div class="line"><span class="lineno"> 2322</span>    <span class="comment"># Fit an exponential to be 2 at 0 and 1 at `maxiter`.</span></div>
<div class="line"><span class="lineno"> 2323</span>    <span class="comment"># The decay is used for relaxation.</span></div>
<div class="line"><span class="lineno"> 2324</span>    <span class="comment"># analytical solution for y=exp(-maxiter/x) - 0.1</span></div>
<div class="line"><span class="lineno"> 2325</span>    root = -maxiter / np.log(0.1)</div>
<div class="line"><span class="lineno"> 2326</span>    decay = [np.exp(-x / root)+0.9 <span class="keywordflow">for</span> x <span class="keywordflow">in</span> range(maxiter)]</div>
<div class="line"><span class="lineno"> 2327</span> </div>
<div class="line"><span class="lineno"> 2328</span>    l1_old = _l1_norm(sample=sample)</div>
<div class="line"><span class="lineno"> 2329</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(maxiter):</div>
<div class="line"><span class="lineno"> 2330</span>        sample = _lloyd_centroidal_voronoi_tessellation(</div>
<div class="line"><span class="lineno"> 2331</span>                sample=sample, decay=decay[i],</div>
<div class="line"><span class="lineno"> 2332</span>                qhull_options=qhull_options,</div>
<div class="line"><span class="lineno"> 2333</span>        )</div>
<div class="line"><span class="lineno"> 2334</span> </div>
<div class="line"><span class="lineno"> 2335</span>        l1_new = _l1_norm(sample=sample)</div>
<div class="line"><span class="lineno"> 2336</span> </div>
<div class="line"><span class="lineno"> 2337</span>        <span class="keywordflow">if</span> abs(l1_new - l1_old) &lt; tol:</div>
<div class="line"><span class="lineno"> 2338</span>            <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno"> 2339</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2340</span>            l1_old = l1_new</div>
<div class="line"><span class="lineno"> 2341</span> </div>
<div class="line"><span class="lineno"> 2342</span>    <span class="keywordflow">return</span> sample</div>
<div class="line"><span class="lineno"> 2343</span> </div>
<div class="line"><span class="lineno"> 2344</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a056dd358acc3cd2c82d696183d5d878f" name="a056dd358acc3cd2c82d696183d5d878f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a056dd358acc3cd2c82d696183d5d878f">&#9670;&#160;</a></span>n_primes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> List[int] scipy.stats._qmc.n_primes </td>
          <td>(</td>
          <td class="paramtype">IntNumber&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">List of the n-first prime numbers.

Parameters
----------
n : int
    Number of prime numbers wanted.

Returns
-------
primes : list(int)
    List of primes.</pre> <div class="fragment"><div class="line"><span class="lineno">  495</span><span class="keyword">def </span>n_primes(n: IntNumber) -&gt; List[int]:</div>
<div class="line"><span class="lineno">  496</span>    <span class="stringliteral">&quot;&quot;&quot;List of the n-first prime numbers.</span></div>
<div class="line"><span class="lineno">  497</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  498</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  499</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  500</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral">        Number of prime numbers wanted.</span></div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  505</span><span class="stringliteral">    primes : list(int)</span></div>
<div class="line"><span class="lineno">  506</span><span class="stringliteral">        List of primes.</span></div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  509</span>    primes = [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59,</div>
<div class="line"><span class="lineno">  510</span>              61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127,</div>
<div class="line"><span class="lineno">  511</span>              131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193,</div>
<div class="line"><span class="lineno">  512</span>              197, 199, 211, 223, 227, 229, 233, 239, 241, 251, 257, 263, 269,</div>
<div class="line"><span class="lineno">  513</span>              271, 277, 281, 283, 293, 307, 311, 313, 317, 331, 337, 347, 349,</div>
<div class="line"><span class="lineno">  514</span>              353, 359, 367, 373, 379, 383, 389, 397, 401, 409, 419, 421, 431,</div>
<div class="line"><span class="lineno">  515</span>              433, 439, 443, 449, 457, 461, 463, 467, 479, 487, 491, 499, 503,</div>
<div class="line"><span class="lineno">  516</span>              509, 521, 523, 541, 547, 557, 563, 569, 571, 577, 587, 593, 599,</div>
<div class="line"><span class="lineno">  517</span>              601, 607, 613, 617, 619, 631, 641, 643, 647, 653, 659, 661, 673,</div>
<div class="line"><span class="lineno">  518</span>              677, 683, 691, 701, 709, 719, 727, 733, 739, 743, 751, 757, 761,</div>
<div class="line"><span class="lineno">  519</span>              769, 773, 787, 797, 809, 811, 821, 823, 827, 829, 839, 853, 857,</div>
<div class="line"><span class="lineno">  520</span>              859, 863, 877, 881, 883, 887, 907, 911, 919, 929, 937, 941, 947,</div>
<div class="line"><span class="lineno">  521</span>              953, 967, 971, 977, 983, 991, 997][:n]  <span class="comment"># type: ignore[misc]</span></div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">if</span> len(primes) &lt; n:</div>
<div class="line"><span class="lineno">  524</span>        big_number = 2000</div>
<div class="line"><span class="lineno">  525</span>        <span class="keywordflow">while</span> <span class="stringliteral">&#39;Not enough primes&#39;</span>:</div>
<div class="line"><span class="lineno">  526</span>            primes = primes_from_2_to(big_number)[:n]  <span class="comment"># type: ignore</span></div>
<div class="line"><span class="lineno">  527</span>            <span class="keywordflow">if</span> len(primes) == n:</div>
<div class="line"><span class="lineno">  528</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  529</span>            big_number += 1000</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>    <span class="keywordflow">return</span> primes</div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a73db6f8ac0e878841d09657004b0649c" name="a73db6f8ac0e878841d09657004b0649c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73db6f8ac0e878841d09657004b0649c">&#9670;&#160;</a></span>primes_from_2_to()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc.primes_from_2_to </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Prime numbers from 2 to *n*.

Parameters
----------
n : int
    Sup bound with ``n &gt;= 6``.

Returns
-------
primes : list(int)
    Primes in ``2 &lt;= p &lt; n``.

Notes
-----
Taken from [1]_ by P.T. Roy, written consent given on 23.04.2021
by the original author, Bruno Astrolino, for free use in SciPy under
the 3-clause BSD.

References
----------
.. [1] `StackOverflow &lt;https://stackoverflow.com/questions/2068372&gt;`_.</pre> <div class="fragment"><div class="line"><span class="lineno">  463</span><span class="keyword">def </span>primes_from_2_to(n: int) -&gt; np.ndarray:</div>
<div class="line"><span class="lineno">  464</span>    <span class="stringliteral">&quot;&quot;&quot;Prime numbers from 2 to *n*.</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  467</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  468</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  469</span><span class="stringliteral">        Sup bound with ``n &gt;= 6``.</span></div>
<div class="line"><span class="lineno">  470</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  471</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  472</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">    primes : list(int)</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">        Primes in ``2 &lt;= p &lt; n``.</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  478</span><span class="stringliteral">    Taken from [1]_ by P.T. Roy, written consent given on 23.04.2021</span></div>
<div class="line"><span class="lineno">  479</span><span class="stringliteral">    by the original author, Bruno Astrolino, for free use in SciPy under</span></div>
<div class="line"><span class="lineno">  480</span><span class="stringliteral">    the 3-clause BSD.</span></div>
<div class="line"><span class="lineno">  481</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">    .. [1] `StackOverflow &lt;https://stackoverflow.com/questions/2068372&gt;`_.</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  487</span>    sieve = np.ones(n // 3 + (n % 6 == 2), dtype=bool)</div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(1, int(n ** 0.5) // 3 + 1):</div>
<div class="line"><span class="lineno">  489</span>        k = 3 * i + 1 | 1</div>
<div class="line"><span class="lineno">  490</span>        sieve[k * k // 3::2 * k] = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  491</span>        sieve[k * (k - 2 * (i &amp; 1) + 4) // 3::2 * k] = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  492</span>    <span class="keywordflow">return</span> np.r_[2, 3, ((3 * np.nonzero(sieve)[0][1:] + 1) | 1)]</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9f6010e0d6b7b2c3128b2f7cbadfff1a" name="a9f6010e0d6b7b2c3128b2f7cbadfff1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f6010e0d6b7b2c3128b2f7cbadfff1a">&#9670;&#160;</a></span>scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc.scale </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>l_bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>u_bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*bool &#160;</td>
          <td class="paramname"><em>reverse</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Sample scaling from unit hypercube to different bounds.

To convert a sample from :math:`[0, 1)` to :math:`[a, b), b&gt;a`,
with :math:`a` the lower bounds and :math:`b` the upper bounds.
The following transformation is used:

.. math::

(b - a) \cdot \text{sample} + a

Parameters
----------
sample : array_like (n, d)
Sample to scale.
l_bounds, u_bounds : array_like (d,)
Lower and upper bounds (resp. :math:`a`, :math:`b`) of transformed
data. If `reverse` is True, range of the original data to transform
to the unit hypercube.
reverse : bool, optional
Reverse the transformation from different bounds to the unit hypercube.
Default is False.

Returns
-------
sample : array_like (n, d)
Scaled sample.

Examples
--------
Transform 3 samples in the unit hypercube to bounds:

&gt;&gt;&gt; from scipy.stats import qmc
&gt;&gt;&gt; l_bounds = [-2, 0]
&gt;&gt;&gt; u_bounds = [6, 5]
&gt;&gt;&gt; sample = [[0.5 , 0.75],
...           [0.5 , 0.5],
...           [0.75, 0.25]]
&gt;&gt;&gt; sample_scaled = qmc.scale(sample, l_bounds, u_bounds)
&gt;&gt;&gt; sample_scaled
array([[2.  , 3.75],
[2.  , 2.5 ],
[4.  , 1.25]])

And convert back to the unit hypercube:

&gt;&gt;&gt; sample_ = qmc.scale(sample_scaled, l_bounds, u_bounds, reverse=True)
&gt;&gt;&gt; sample_
array([[0.5 , 0.75],
[0.5 , 0.5 ],
[0.75, 0.25]])</pre> <div class="fragment"><div class="line"><span class="lineno">   99</span>) -&gt; np.ndarray:</div>
<div class="line"><span class="lineno">  100</span>    <span class="stringliteral">r&quot;&quot;&quot;Sample scaling from unit hypercube to different bounds.</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    To convert a sample from :math:`[0, 1)` to :math:`[a, b), b&gt;a`,</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">    with :math:`a` the lower bounds and :math:`b` the upper bounds.</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    The following transformation is used:</span></div>
<div class="line"><span class="lineno">  105</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  106</span><span class="stringliteral">    .. math::</span></div>
<div class="line"><span class="lineno">  107</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  108</span><span class="stringliteral">        (b - a) \cdot \text{sample} + a</span></div>
<div class="line"><span class="lineno">  109</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  110</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  111</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  112</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">        Sample to scale.</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">    l_bounds, u_bounds : array_like (d,)</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">        Lower and upper bounds (resp. :math:`a`, :math:`b`) of transformed</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">        data. If `reverse` is True, range of the original data to transform</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">        to the unit hypercube.</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral">    reverse : bool, optional</span></div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">        Reverse the transformation from different bounds to the unit hypercube.</span></div>
<div class="line"><span class="lineno">  120</span><span class="stringliteral">        Default is False.</span></div>
<div class="line"><span class="lineno">  121</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  122</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  123</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  124</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno">  125</span><span class="stringliteral">        Scaled sample.</span></div>
<div class="line"><span class="lineno">  126</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral">    Transform 3 samples in the unit hypercube to bounds:</span></div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import qmc</span></div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">    &gt;&gt;&gt; l_bounds = [-2, 0]</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">    &gt;&gt;&gt; u_bounds = [6, 5]</span></div>
<div class="line"><span class="lineno">  134</span><span class="stringliteral">    &gt;&gt;&gt; sample = [[0.5 , 0.75],</span></div>
<div class="line"><span class="lineno">  135</span><span class="stringliteral">    ...           [0.5 , 0.5],</span></div>
<div class="line"><span class="lineno">  136</span><span class="stringliteral">    ...           [0.75, 0.25]]</span></div>
<div class="line"><span class="lineno">  137</span><span class="stringliteral">    &gt;&gt;&gt; sample_scaled = qmc.scale(sample, l_bounds, u_bounds)</span></div>
<div class="line"><span class="lineno">  138</span><span class="stringliteral">    &gt;&gt;&gt; sample_scaled</span></div>
<div class="line"><span class="lineno">  139</span><span class="stringliteral">    array([[2.  , 3.75],</span></div>
<div class="line"><span class="lineno">  140</span><span class="stringliteral">           [2.  , 2.5 ],</span></div>
<div class="line"><span class="lineno">  141</span><span class="stringliteral">           [4.  , 1.25]])</span></div>
<div class="line"><span class="lineno">  142</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">    And convert back to the unit hypercube:</span></div>
<div class="line"><span class="lineno">  144</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  145</span><span class="stringliteral">    &gt;&gt;&gt; sample_ = qmc.scale(sample_scaled, l_bounds, u_bounds, reverse=True)</span></div>
<div class="line"><span class="lineno">  146</span><span class="stringliteral">    &gt;&gt;&gt; sample_</span></div>
<div class="line"><span class="lineno">  147</span><span class="stringliteral">    array([[0.5 , 0.75],</span></div>
<div class="line"><span class="lineno">  148</span><span class="stringliteral">           [0.5 , 0.5 ],</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">           [0.75, 0.25]])</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  152</span>    sample = np.asarray(sample)</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>    <span class="comment"># Checking bounds and sample</span></div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> sample.ndim == 2:</div>
<div class="line"><span class="lineno">  156</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Sample is not a 2D array&#39;</span>)</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>    lower, upper = _validate_bounds(</div>
<div class="line"><span class="lineno">  159</span>        l_bounds=l_bounds, u_bounds=u_bounds, d=sample.shape[1]</div>
<div class="line"><span class="lineno">  160</span>    )</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> reverse:</div>
<div class="line"><span class="lineno">  163</span>        <span class="comment"># Checking that sample is within the hypercube</span></div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">if</span> (sample.max() &gt; 1.) <span class="keywordflow">or</span> (sample.min() &lt; 0.):</div>
<div class="line"><span class="lineno">  165</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Sample is not in unit hypercube&#39;</span>)</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>        <span class="keywordflow">return</span> sample * (upper - lower) + lower</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  169</span>        <span class="comment"># Checking that sample is within the bounds</span></div>
<div class="line"><span class="lineno">  170</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> (np.all(sample &gt;= lower) <span class="keywordflow">and</span> np.all(sample &lt;= upper)):</div>
<div class="line"><span class="lineno">  171</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Sample is out of bounds&#39;</span>)</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>        <span class="keywordflow">return</span> (sample - lower) / (upper - lower)</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a33205602634d9d5ce04705a48d798551" name="a33205602634d9d5ce04705a48d798551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33205602634d9d5ce04705a48d798551">&#9670;&#160;</a></span>update_discrepancy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> float scipy.stats._qmc.update_discrepancy </td>
          <td>(</td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>x_new</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">npt.ArrayLike&#160;</td>
          <td class="paramname"><em>sample</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DecimalNumber&#160;</td>
          <td class="paramname"><em>initial_disc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Update the centered discrepancy with a new sample.

Parameters
----------
x_new : array_like (1, d)
    The new sample to add in `sample`.
sample : array_like (n, d)
    The initial sample.
initial_disc : float
    Centered discrepancy of the `sample`.

Returns
-------
discrepancy : float
    Centered discrepancy of the sample composed of `x_new` and `sample`.

Examples
--------
We can also compute iteratively the discrepancy by using
``iterative=True``.

&gt;&gt;&gt; from scipy.stats import qmc
&gt;&gt;&gt; space = np.array([[1, 3], [2, 6], [3, 2], [4, 5], [5, 1], [6, 4]])
&gt;&gt;&gt; l_bounds = [0.5, 0.5]
&gt;&gt;&gt; u_bounds = [6.5, 6.5]
&gt;&gt;&gt; space = qmc.scale(space, l_bounds, u_bounds, reverse=True)
&gt;&gt;&gt; disc_init = qmc.discrepancy(space[:-1], iterative=True)
&gt;&gt;&gt; disc_init
0.04769081147119336
&gt;&gt;&gt; qmc.update_discrepancy(space[-1], space[:-1], disc_init)
0.008142039609053513</pre> <div class="fragment"><div class="line"><span class="lineno">  316</span>        initial_disc: DecimalNumber) -&gt; float:</div>
<div class="line"><span class="lineno">  317</span>    <span class="stringliteral">&quot;&quot;&quot;Update the centered discrepancy with a new sample.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    x_new : array_like (1, d)</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">        The new sample to add in `sample`.</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    sample : array_like (n, d)</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        The initial sample.</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">    initial_disc : float</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">        Centered discrepancy of the `sample`.</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    discrepancy : float</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">        Centered discrepancy of the sample composed of `x_new` and `sample`.</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    We can also compute iteratively the discrepancy by using</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    ``iterative=True``.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import qmc</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">    &gt;&gt;&gt; space = np.array([[1, 3], [2, 6], [3, 2], [4, 5], [5, 1], [6, 4]])</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    &gt;&gt;&gt; l_bounds = [0.5, 0.5]</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    &gt;&gt;&gt; u_bounds = [6.5, 6.5]</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">    &gt;&gt;&gt; space = qmc.scale(space, l_bounds, u_bounds, reverse=True)</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">    &gt;&gt;&gt; disc_init = qmc.discrepancy(space[:-1], iterative=True)</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    &gt;&gt;&gt; disc_init</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">    0.04769081147119336</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    &gt;&gt;&gt; qmc.update_discrepancy(space[-1], space[:-1], disc_init)</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">    0.008142039609053513</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  350</span>    sample = np.asarray(sample, dtype=np.float64, order=<span class="stringliteral">&quot;C&quot;</span>)</div>
<div class="line"><span class="lineno">  351</span>    x_new = np.asarray(x_new, dtype=np.float64, order=<span class="stringliteral">&quot;C&quot;</span>)</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    <span class="comment"># Checking that sample is within the hypercube and 2D</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> sample.ndim == 2:</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Sample is not a 2D array&#39;</span>)</div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    <span class="keywordflow">if</span> (sample.max() &gt; 1.) <span class="keywordflow">or</span> (sample.min() &lt; 0.):</div>
<div class="line"><span class="lineno">  358</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Sample is not in unit hypercube&#39;</span>)</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>    <span class="comment"># Checking that x_new is within the hypercube and 1D</span></div>
<div class="line"><span class="lineno">  361</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> x_new.ndim == 1:</div>
<div class="line"><span class="lineno">  362</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;x_new is not a 1D array&#39;</span>)</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> (np.all(x_new &gt;= 0) <span class="keywordflow">and</span> np.all(x_new &lt;= 1)):</div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;x_new is not in unit hypercube&#39;</span>)</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">if</span> x_new.shape[0] != sample.shape[1]:</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;x_new and sample must be broadcastable&quot;</span>)</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordflow">return</span> _cy_wrapper_update_discrepancy(x_new, sample, initial_disc)</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7024f63085bf763b5b4a2db05e4f8b6d" name="a7024f63085bf763b5b4a2db05e4f8b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7024f63085bf763b5b4a2db05e4f8b6d">&#9670;&#160;</a></span>van_der_corput()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray scipy.stats._qmc.van_der_corput </td>
          <td>(</td>
          <td class="paramtype">IntNumber&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber &#160;</td>
          <td class="paramname"><em>base</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*IntNumber &#160;</td>
          <td class="paramname"><em>start_index</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>scramble</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SeedType &#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IntNumber &#160;</td>
          <td class="paramname"><em>workers</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Van der Corput sequence.

Pseudo-random number generator based on a b-adic expansion.

Scrambling uses permutations of the remainders (see [1]_). Multiple
permutations are applied to construct a point. The sequence of
permutations has to be the same for all points of the sequence.

Parameters
----------
n : int
    Number of element of the sequence.
base : int, optional
    Base of the sequence. Default is 2.
start_index : int, optional
    Index to start the sequence from. Default is 0.
scramble : bool, optional
    If True, use Owen scrambling. Otherwise no scrambling is done.
    Default is True.
seed : {None, int, `numpy.random.Generator`}, optional
    If `seed` is None the `numpy.random.Generator` singleton is used.
    If `seed` is an int, a new ``Generator`` instance is used,
    seeded with `seed`.
    If `seed` is already a ``Generator`` instance then that instance is
    used.
workers : int, optional
    Number of workers to use for parallel processing. If -1 is
    given all CPU threads are used. Default is 1.

Returns
-------
sequence : list (n,)
    Sequence of Van der Corput.

References
----------
.. [1] A. B. Owen. "A randomized Halton algorithm in R",
   :arxiv:`1706.02808`, 2017.</pre> <div class="fragment"><div class="line"><span class="lineno">  541</span>        workers: IntNumber = 1) -&gt; np.ndarray:</div>
<div class="line"><span class="lineno">  542</span>    <span class="stringliteral">&quot;&quot;&quot;Van der Corput sequence.</span></div>
<div class="line"><span class="lineno">  543</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  544</span><span class="stringliteral">    Pseudo-random number generator based on a b-adic expansion.</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">    Scrambling uses permutations of the remainders (see [1]_). Multiple</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">    permutations are applied to construct a point. The sequence of</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">    permutations has to be the same for all points of the sequence.</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">    n : int</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral">        Number of element of the sequence.</span></div>
<div class="line"><span class="lineno">  554</span><span class="stringliteral">    base : int, optional</span></div>
<div class="line"><span class="lineno">  555</span><span class="stringliteral">        Base of the sequence. Default is 2.</span></div>
<div class="line"><span class="lineno">  556</span><span class="stringliteral">    start_index : int, optional</span></div>
<div class="line"><span class="lineno">  557</span><span class="stringliteral">        Index to start the sequence from. Default is 0.</span></div>
<div class="line"><span class="lineno">  558</span><span class="stringliteral">    scramble : bool, optional</span></div>
<div class="line"><span class="lineno">  559</span><span class="stringliteral">        If True, use Owen scrambling. Otherwise no scrambling is done.</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">        Default is True.</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">    seed : {None, int, `numpy.random.Generator`}, optional</span></div>
<div class="line"><span class="lineno">  562</span><span class="stringliteral">        If `seed` is None the `numpy.random.Generator` singleton is used.</span></div>
<div class="line"><span class="lineno">  563</span><span class="stringliteral">        If `seed` is an int, a new ``Generator`` instance is used,</span></div>
<div class="line"><span class="lineno">  564</span><span class="stringliteral">        seeded with `seed`.</span></div>
<div class="line"><span class="lineno">  565</span><span class="stringliteral">        If `seed` is already a ``Generator`` instance then that instance is</span></div>
<div class="line"><span class="lineno">  566</span><span class="stringliteral">        used.</span></div>
<div class="line"><span class="lineno">  567</span><span class="stringliteral">    workers : int, optional</span></div>
<div class="line"><span class="lineno">  568</span><span class="stringliteral">        Number of workers to use for parallel processing. If -1 is</span></div>
<div class="line"><span class="lineno">  569</span><span class="stringliteral">        given all CPU threads are used. Default is 1.</span></div>
<div class="line"><span class="lineno">  570</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  571</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">    sequence : list (n,)</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">        Sequence of Van der Corput.</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">    .. [1] A. B. Owen. &quot;A randomized Halton algorithm in R&quot;,</span></div>
<div class="line"><span class="lineno">  579</span><span class="stringliteral">       :arxiv:`1706.02808`, 2017.</span></div>
<div class="line"><span class="lineno">  580</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  581</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  582</span>    <span class="keywordflow">if</span> base &lt; 2:</div>
<div class="line"><span class="lineno">  583</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;&#39;base&#39; must be at least 2&quot;</span>)</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordflow">if</span> scramble:</div>
<div class="line"><span class="lineno">  586</span>        rng = check_random_state(seed)</div>
<div class="line"><span class="lineno">  587</span>        <span class="comment"># In Algorithm 1 of Owen 2017, a permutation of `np.arange(base)` is</span></div>
<div class="line"><span class="lineno">  588</span>        <span class="comment"># created for each positive integer `k` such that `1 - base**-k &lt; 1`</span></div>
<div class="line"><span class="lineno">  589</span>        <span class="comment"># using floating-point arithmetic. For double precision floats, the</span></div>
<div class="line"><span class="lineno">  590</span>        <span class="comment"># condition `1 - base**-k &lt; 1` can also be written as `base**-k &gt;</span></div>
<div class="line"><span class="lineno">  591</span>        <span class="comment"># 2**-54`, which makes it more apparent how many permutations we need</span></div>
<div class="line"><span class="lineno">  592</span>        <span class="comment"># to create.</span></div>
<div class="line"><span class="lineno">  593</span>        count = math.ceil(54 / math.log2(base)) - 1</div>
<div class="line"><span class="lineno">  594</span>        permutations = np.repeat(np.arange(base)[<span class="keywordtype">None</span>], count, axis=0)</div>
<div class="line"><span class="lineno">  595</span>        <span class="keywordflow">for</span> perm <span class="keywordflow">in</span> permutations:</div>
<div class="line"><span class="lineno">  596</span>            rng.shuffle(perm)</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>        <span class="keywordflow">return</span> _cy_van_der_corput_scrambled(n, base, start_index,</div>
<div class="line"><span class="lineno">  599</span>                                            permutations, workers)</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">return</span> _cy_van_der_corput(n, base, start_index, workers)</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
