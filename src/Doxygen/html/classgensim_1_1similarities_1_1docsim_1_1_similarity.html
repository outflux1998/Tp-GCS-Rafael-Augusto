<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: gensim.similarities.docsim.Similarity Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacegensim.html">gensim</a></li><li class="navelem"><a class="el" href="namespacegensim_1_1similarities.html">similarities</a></li><li class="navelem"><a class="el" href="namespacegensim_1_1similarities_1_1docsim.html">docsim</a></li><li class="navelem"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html">Similarity</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classgensim_1_1similarities_1_1docsim_1_1_similarity-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">gensim.similarities.docsim.Similarity Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for gensim.similarities.docsim.Similarity:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classgensim_1_1similarities_1_1docsim_1_1_similarity.png" usemap="#gensim.similarities.docsim.Similarity_map" alt=""/>
  <map id="gensim.similarities.docsim.Similarity_map" name="gensim.similarities.docsim.Similarity_map">
<area href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html" alt="gensim.interfaces.SimilarityABC" shape="rect" coords="0,112,211,136"/>
<area href="classgensim_1_1utils_1_1_save_load.html" alt="gensim.utils.SaveLoad" shape="rect" coords="0,56,211,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:affcdac572f9241335acf9e371775d495" id="r_affcdac572f9241335acf9e371775d495"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#affcdac572f9241335acf9e371775d495">__init__</a> (self, <a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a34a3e363891c678bbd62b372d65d5a99">output_prefix</a>, corpus, <a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#ae3b406e0a6f00eeac9604bc7625ddd06">num_features</a>, <a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#afe5a060fd52f13234e47f91ccb22fc05">num_best</a>=None, <a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#aa1d464418f829b6db37dd2bec35e0ef2">chunksize</a>=256, <a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a3f54812f94d3cbe693fbbdbb3b01d0c6">shardsize</a>=32768, <a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a851e32d93fcc6f4076456066b612474d">norm</a>='l2')</td></tr>
<tr class="separator:affcdac572f9241335acf9e371775d495"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f8ab1dc5e446266f565367891b6a9f" id="r_a27f8ab1dc5e446266f565367891b6a9f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a27f8ab1dc5e446266f565367891b6a9f">__len__</a> (self)</td></tr>
<tr class="separator:a27f8ab1dc5e446266f565367891b6a9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d23dd56c36a38ba30bb732900df1a3f" id="r_a0d23dd56c36a38ba30bb732900df1a3f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a0d23dd56c36a38ba30bb732900df1a3f">__str__</a> (self)</td></tr>
<tr class="separator:a0d23dd56c36a38ba30bb732900df1a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a722370c1e0cb8cc04f52985686de4d76" id="r_a722370c1e0cb8cc04f52985686de4d76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a722370c1e0cb8cc04f52985686de4d76">add_documents</a> (self, corpus)</td></tr>
<tr class="separator:a722370c1e0cb8cc04f52985686de4d76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ade55729b15d77f3523f67e6f5ec8aa" id="r_a3ade55729b15d77f3523f67e6f5ec8aa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a3ade55729b15d77f3523f67e6f5ec8aa">shardid2filename</a> (self, shardid)</td></tr>
<tr class="separator:a3ade55729b15d77f3523f67e6f5ec8aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16091f95c9bd4b04f68c06d97b57c688" id="r_a16091f95c9bd4b04f68c06d97b57c688"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a16091f95c9bd4b04f68c06d97b57c688">close_shard</a> (self)</td></tr>
<tr class="separator:a16091f95c9bd4b04f68c06d97b57c688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeed1ed8ef6c92a3ce8571d63c6d1323d" id="r_aeed1ed8ef6c92a3ce8571d63c6d1323d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#aeed1ed8ef6c92a3ce8571d63c6d1323d">reopen_shard</a> (self)</td></tr>
<tr class="separator:aeed1ed8ef6c92a3ce8571d63c6d1323d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c292ed6ccdcb6b964b49cc0bf9b11f4" id="r_a2c292ed6ccdcb6b964b49cc0bf9b11f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a2c292ed6ccdcb6b964b49cc0bf9b11f4">query_shards</a> (self, query)</td></tr>
<tr class="separator:a2c292ed6ccdcb6b964b49cc0bf9b11f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abda2062e899cd23e5060ff7f498578a5" id="r_abda2062e899cd23e5060ff7f498578a5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#abda2062e899cd23e5060ff7f498578a5">__getitem__</a> (self, query)</td></tr>
<tr class="separator:abda2062e899cd23e5060ff7f498578a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a597d737f57179043d720a81d6d3c329f" id="r_a597d737f57179043d720a81d6d3c329f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a597d737f57179043d720a81d6d3c329f">vector_by_id</a> (self, docpos)</td></tr>
<tr class="separator:a597d737f57179043d720a81d6d3c329f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae424db33c2b8b5f5ba2b2794c87d63a6" id="r_ae424db33c2b8b5f5ba2b2794c87d63a6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#ae424db33c2b8b5f5ba2b2794c87d63a6">similarity_by_id</a> (self, docpos)</td></tr>
<tr class="separator:ae424db33c2b8b5f5ba2b2794c87d63a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeddb4e19da25d376f3cf58583de006f4" id="r_aeddb4e19da25d376f3cf58583de006f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#aeddb4e19da25d376f3cf58583de006f4">__iter__</a> (self)</td></tr>
<tr class="separator:aeddb4e19da25d376f3cf58583de006f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a773a8c48d3776c034f37ffe137a0c4bc" id="r_a773a8c48d3776c034f37ffe137a0c4bc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a773a8c48d3776c034f37ffe137a0c4bc">iter_chunks</a> (self, <a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#aa1d464418f829b6db37dd2bec35e0ef2">chunksize</a>=None)</td></tr>
<tr class="separator:a773a8c48d3776c034f37ffe137a0c4bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8189904e65dedb007190ed30969a6ff0" id="r_a8189904e65dedb007190ed30969a6ff0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a8189904e65dedb007190ed30969a6ff0">check_moved</a> (self)</td></tr>
<tr class="separator:a8189904e65dedb007190ed30969a6ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcabaad6bb1d16a01d79cdc86f653a3d" id="r_abcabaad6bb1d16a01d79cdc86f653a3d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#abcabaad6bb1d16a01d79cdc86f653a3d">save</a> (self, fname=None, *args, **kwargs)</td></tr>
<tr class="separator:abcabaad6bb1d16a01d79cdc86f653a3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a633b353fcdf7fff867b06d2bf6340d90" id="r_a633b353fcdf7fff867b06d2bf6340d90"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a633b353fcdf7fff867b06d2bf6340d90">destroy</a> (self)</td></tr>
<tr class="separator:a633b353fcdf7fff867b06d2bf6340d90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classgensim_1_1interfaces_1_1_similarity_a_b_c"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classgensim_1_1interfaces_1_1_similarity_a_b_c')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html">gensim.interfaces.SimilarityABC</a></td></tr>
<tr class="memitem:a3ee0f4eae0a715a96858f1e605d1d904 inherit pub_methods_classgensim_1_1interfaces_1_1_similarity_a_b_c" id="r_a3ee0f4eae0a715a96858f1e605d1d904"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html#a3ee0f4eae0a715a96858f1e605d1d904">get_similarities</a> (self, doc)</td></tr>
<tr class="separator:a3ee0f4eae0a715a96858f1e605d1d904 inherit pub_methods_classgensim_1_1interfaces_1_1_similarity_a_b_c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classgensim_1_1utils_1_1_save_load"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classgensim_1_1utils_1_1_save_load')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classgensim_1_1utils_1_1_save_load.html">gensim.utils.SaveLoad</a></td></tr>
<tr class="memitem:a70d054bfd9dfd1373fef9e0e691a24b5 inherit pub_methods_classgensim_1_1utils_1_1_save_load" id="r_a70d054bfd9dfd1373fef9e0e691a24b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#a70d054bfd9dfd1373fef9e0e691a24b5">load</a> (cls, fname, mmap=None)</td></tr>
<tr class="separator:a70d054bfd9dfd1373fef9e0e691a24b5 inherit pub_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a34a3e363891c678bbd62b372d65d5a99" id="r_a34a3e363891c678bbd62b372d65d5a99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a34a3e363891c678bbd62b372d65d5a99">output_prefix</a></td></tr>
<tr class="separator:a34a3e363891c678bbd62b372d65d5a99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b406e0a6f00eeac9604bc7625ddd06" id="r_ae3b406e0a6f00eeac9604bc7625ddd06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#ae3b406e0a6f00eeac9604bc7625ddd06">num_features</a></td></tr>
<tr class="separator:ae3b406e0a6f00eeac9604bc7625ddd06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe5a060fd52f13234e47f91ccb22fc05" id="r_afe5a060fd52f13234e47f91ccb22fc05"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#afe5a060fd52f13234e47f91ccb22fc05">num_best</a></td></tr>
<tr class="separator:afe5a060fd52f13234e47f91ccb22fc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a851e32d93fcc6f4076456066b612474d" id="r_a851e32d93fcc6f4076456066b612474d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a851e32d93fcc6f4076456066b612474d">norm</a></td></tr>
<tr class="separator:a851e32d93fcc6f4076456066b612474d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1d464418f829b6db37dd2bec35e0ef2" id="r_aa1d464418f829b6db37dd2bec35e0ef2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#aa1d464418f829b6db37dd2bec35e0ef2">chunksize</a></td></tr>
<tr class="separator:aa1d464418f829b6db37dd2bec35e0ef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f54812f94d3cbe693fbbdbb3b01d0c6" id="r_a3f54812f94d3cbe693fbbdbb3b01d0c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a3f54812f94d3cbe693fbbdbb3b01d0c6">shardsize</a></td></tr>
<tr class="separator:a3f54812f94d3cbe693fbbdbb3b01d0c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53fbf340d6a0daaad50b1bf48473aea1" id="r_a53fbf340d6a0daaad50b1bf48473aea1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a53fbf340d6a0daaad50b1bf48473aea1">shards</a></td></tr>
<tr class="separator:a53fbf340d6a0daaad50b1bf48473aea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa274e207c541a5252bc7c5ae89557375" id="r_aa274e207c541a5252bc7c5ae89557375"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#aa274e207c541a5252bc7c5ae89557375">fresh_docs</a></td></tr>
<tr class="separator:aa274e207c541a5252bc7c5ae89557375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b77b18bda77174ee3bf00384afc583a" id="r_a3b77b18bda77174ee3bf00384afc583a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1similarities_1_1docsim_1_1_similarity.html#a3b77b18bda77174ee3bf00384afc583a">fresh_nnz</a></td></tr>
<tr class="separator:a3b77b18bda77174ee3bf00384afc583a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classgensim_1_1interfaces_1_1_similarity_a_b_c"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classgensim_1_1interfaces_1_1_similarity_a_b_c')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html">gensim.interfaces.SimilarityABC</a></td></tr>
<tr class="memitem:a2c6b219fab14d782e71d1426a6c04fa8 inherit pub_attribs_classgensim_1_1interfaces_1_1_similarity_a_b_c" id="r_a2c6b219fab14d782e71d1426a6c04fa8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html#a2c6b219fab14d782e71d1426a6c04fa8">num_best</a></td></tr>
<tr class="separator:a2c6b219fab14d782e71d1426a6c04fa8 inherit pub_attribs_classgensim_1_1interfaces_1_1_similarity_a_b_c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f43f5a733bfacbe8529c32ba32747d8 inherit pub_attribs_classgensim_1_1interfaces_1_1_similarity_a_b_c" id="r_a9f43f5a733bfacbe8529c32ba32747d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html#a9f43f5a733bfacbe8529c32ba32747d8">normalize</a></td></tr>
<tr class="separator:a9f43f5a733bfacbe8529c32ba32747d8 inherit pub_attribs_classgensim_1_1interfaces_1_1_similarity_a_b_c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bac7ffdebe9211b0f540b7a52391402 inherit pub_attribs_classgensim_1_1interfaces_1_1_similarity_a_b_c" id="r_a0bac7ffdebe9211b0f540b7a52391402"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html#a0bac7ffdebe9211b0f540b7a52391402">chunksize</a></td></tr>
<tr class="separator:a0bac7ffdebe9211b0f540b7a52391402 inherit pub_attribs_classgensim_1_1interfaces_1_1_similarity_a_b_c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classgensim_1_1utils_1_1_save_load"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classgensim_1_1utils_1_1_save_load')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classgensim_1_1utils_1_1_save_load.html">gensim.utils.SaveLoad</a></td></tr>
<tr class="memitem:ace7b79d8870c44c2bab0d590a5aca91e inherit pro_methods_classgensim_1_1utils_1_1_save_load" id="r_ace7b79d8870c44c2bab0d590a5aca91e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#ace7b79d8870c44c2bab0d590a5aca91e">_load_specials</a> (self, fname, mmap, compress, subname)</td></tr>
<tr class="separator:ace7b79d8870c44c2bab0d590a5aca91e inherit pro_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd9faa42ba3aae8f0a175418889d425c inherit pro_methods_classgensim_1_1utils_1_1_save_load" id="r_acd9faa42ba3aae8f0a175418889d425c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#acd9faa42ba3aae8f0a175418889d425c">_smart_save</a> (self, fname, separately=None, sep_limit=10 *1024 **2, ignore=frozenset(), pickle_protocol=2)</td></tr>
<tr class="separator:acd9faa42ba3aae8f0a175418889d425c inherit pro_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bae38a76fa8264d2c8759b9d40a6f5c inherit pro_methods_classgensim_1_1utils_1_1_save_load" id="r_a4bae38a76fa8264d2c8759b9d40a6f5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#a4bae38a76fa8264d2c8759b9d40a6f5c">_save_specials</a> (self, fname, separately, sep_limit, ignore, pickle_protocol, compress, subname)</td></tr>
<tr class="separator:a4bae38a76fa8264d2c8759b9d40a6f5c inherit pro_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_static_methods_classgensim_1_1utils_1_1_save_load"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classgensim_1_1utils_1_1_save_load')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classgensim_1_1utils_1_1_save_load.html">gensim.utils.SaveLoad</a></td></tr>
<tr class="memitem:a6cf051b348407267110444260535d143 inherit pro_static_methods_classgensim_1_1utils_1_1_save_load" id="r_a6cf051b348407267110444260535d143"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgensim_1_1utils_1_1_save_load.html#a6cf051b348407267110444260535d143">_adapt_by_suffix</a> (fname)</td></tr>
<tr class="separator:a6cf051b348407267110444260535d143 inherit pro_static_methods_classgensim_1_1utils_1_1_save_load"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Compute cosine similarity of a dynamic query against a corpus of documents ('the index').

The index supports adding new documents dynamically.

Notes
-----
Scalability is achieved by sharding the index into smaller pieces, each of which fits into core memory
The shards themselves are simply stored as files to disk and mmap'ed back as needed.

Examples
--------
.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus
    &gt;&gt;&gt; from gensim.test.utils import datapath, get_tmpfile
    &gt;&gt;&gt; from gensim.similarities import Similarity
    &gt;&gt;&gt;
    &gt;&gt;&gt; corpus = TextCorpus(datapath('testcorpus.mm'))
    &gt;&gt;&gt; index_temp = get_tmpfile("index")
    &gt;&gt;&gt; index = Similarity(index_temp, corpus, num_features=400)  # create index
    &gt;&gt;&gt;
    &gt;&gt;&gt; query = next(iter(corpus))
    &gt;&gt;&gt; result = index[query]  # search similar to `query` in index
    &gt;&gt;&gt;
    &gt;&gt;&gt; for sims in index[corpus]:  # if you have more query documents, you can submit them all at once, in a batch
    ...     pass
    &gt;&gt;&gt;
    &gt;&gt;&gt; # There is also a special syntax for when you need similarity of documents in the index
    &gt;&gt;&gt; # to the index itself (i.e. queries=indexed documents themselves). This special syntax
    &gt;&gt;&gt; # uses the faster, batch queries internally and **is ideal for all-vs-all pairwise similarities**:
    &gt;&gt;&gt; for similarities in index:  # yield similarities of the 1st indexed document, then 2nd...
    ...     pass

See Also
--------
:class:`~gensim.similarities.docsim.MatrixSimilarity`
    Index similarity (dense with cosine distance).
:class:`~gensim.similarities.docsim.SparseMatrixSimilarity`
    Index similarity (sparse with cosine distance).
:class:`~gensim.similarities.docsim.WmdSimilarity`
    Index similarity (with word-mover distance).</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="affcdac572f9241335acf9e371775d495" name="affcdac572f9241335acf9e371775d495"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affcdac572f9241335acf9e371775d495">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output_prefix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_features</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_best</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chunksize</em> = <code>256</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shardsize</em> = <code>32768</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>norm</em> = <code>'l2'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parameters
----------
output_prefix : str
    Prefix for shard filename. If None, a random filename in temp will be used.
corpus : iterable of list of (int, number)
    Corpus in streamed Gensim bag-of-words format.
num_features : int
    Size of the dictionary (number of features).
num_best : int, optional
    If set, return only the `num_best` most similar documents, always leaving out documents with similarity = 0.
    Otherwise, return a full vector with one float for every document in the index.
chunksize : int, optional
    Size of query chunks. Used internally when the query is an entire corpus.
shardsize : int, optional
    Maximum shard size, in documents. Choose a value so that a `shardsize x chunksize` matrix of floats fits
    comfortably into your RAM.
norm : {'l1', 'l2'}, optional
    Normalization to use.

Notes
-----
Documents are split (internally, transparently) into shards of `shardsize` documents each, and each shard
converted to a matrix, for faster BLAS calls. Each shard is stored to disk under `output_prefix.shard_number`.

If you don't specify an output prefix, a random filename in temp will be used.

If your entire index fits in memory (~1 million documents per 1GB of RAM), you can also use the
:class:`~gensim.similarities.docsim.MatrixSimilarity` or
:class:`~gensim.similarities.docsim.SparseMatrixSimilarity` classes directly.
These are more simple but do not scale as well (they keep the entire index in RAM, no sharding).
They also do not support adding new document dynamically.</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html#a4ab14e3c5a6737522e09dd34258fd2b2">gensim.interfaces.SimilarityABC</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  305</span>    <span class="keyword">def </span>__init__(self, output_prefix, corpus, num_features, num_best=None, chunksize=256, shardsize=32768, norm=&#39;l2&#39;):</div>
<div class="line"><span class="lineno">  306</span>        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">        output_prefix : str</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">            Prefix for shard filename. If None, a random filename in temp will be used.</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">        corpus : iterable of list of (int, number)</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">            Corpus in streamed Gensim bag-of-words format.</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">        num_features : int</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral">            Size of the dictionary (number of features).</span></div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">        num_best : int, optional</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">            If set, return only the `num_best` most similar documents, always leaving out documents with similarity = 0.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral">            Otherwise, return a full vector with one float for every document in the index.</span></div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">        chunksize : int, optional</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">            Size of query chunks. Used internally when the query is an entire corpus.</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">        shardsize : int, optional</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">            Maximum shard size, in documents. Choose a value so that a `shardsize x chunksize` matrix of floats fits</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">            comfortably into your RAM.</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">        norm : {&#39;l1&#39;, &#39;l2&#39;}, optional</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral">            Normalization to use.</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral">        Documents are split (internally, transparently) into shards of `shardsize` documents each, and each shard</span></div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">        converted to a matrix, for faster BLAS calls. Each shard is stored to disk under `output_prefix.shard_number`.</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">        If you don&#39;t specify an output prefix, a random filename in temp will be used.</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">        If your entire index fits in memory (~1 million documents per 1GB of RAM), you can also use the</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">        :class:`~gensim.similarities.docsim.MatrixSimilarity` or</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">        :class:`~gensim.similarities.docsim.SparseMatrixSimilarity` classes directly.</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">        These are more simple but do not scale as well (they keep the entire index in RAM, no sharding).</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">        They also do not support adding new document dynamically.</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">if</span> output_prefix <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  342</span>            <span class="comment"># undocumented feature: set output_prefix=None to create the server in temp</span></div>
<div class="line"><span class="lineno">  343</span>            self.output_prefix = utils.randfname(prefix=<span class="stringliteral">&#39;simserver&#39;</span>)</div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  345</span>            self.output_prefix = output_prefix</div>
<div class="line"><span class="lineno">  346</span>        logger.info(<span class="stringliteral">&quot;starting similarity index under %s&quot;</span>, self.output_prefix)</div>
<div class="line"><span class="lineno">  347</span>        self.num_features = num_features</div>
<div class="line"><span class="lineno">  348</span>        self.num_best = num_best</div>
<div class="line"><span class="lineno">  349</span>        self.norm = norm</div>
<div class="line"><span class="lineno">  350</span>        self.chunksize = int(chunksize)</div>
<div class="line"><span class="lineno">  351</span>        self.shardsize = shardsize</div>
<div class="line"><span class="lineno">  352</span>        self.shards = []</div>
<div class="line"><span class="lineno">  353</span>        self.fresh_docs, self.fresh_nnz = [], 0</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordflow">if</span> corpus <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  356</span>            self.add_documents(corpus)</div>
<div class="line"><span class="lineno">  357</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abda2062e899cd23e5060ff7f498578a5" name="abda2062e899cd23e5060ff7f498578a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abda2062e899cd23e5060ff7f498578a5">&#9670;&#160;</a></span>__getitem__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.__getitem__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>query</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get similarities of the document (or corpus) `query` to all documents in the corpus.

Parameters
----------
query : {iterable of list of (int, number) , list of (int, number))}
    A single document in bag-of-words format, or a corpus (iterable) of such documents.

Return
------
:class:`numpy.ndarray` or :class:`scipy.sparse.csr_matrix`
    Similarities of the query against this index.

Notes
-----
If `query` is a corpus (iterable of documents), return a matrix of similarities of
all query documents vs. all corpus document. This batch query is more efficient than computing the similarities
one document after another.

Examples
--------
.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus
    &gt;&gt;&gt; from gensim.test.utils import datapath
    &gt;&gt;&gt; from gensim.similarities import Similarity
    &gt;&gt;&gt;
    &gt;&gt;&gt; corpus = TextCorpus(datapath('testcorpus.txt'))
    &gt;&gt;&gt; index = Similarity('temp', corpus, num_features=400)
    &gt;&gt;&gt; result = index[corpus]  # pairwise similarities of each document against each document</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html#a9de8979a1472e0c0146ce1c7403d9205">gensim.interfaces.SimilarityABC</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  505</span>    <span class="keyword">def </span>__getitem__(self, query):</div>
<div class="line"><span class="lineno">  506</span>        <span class="stringliteral">&quot;&quot;&quot;Get similarities of the document (or corpus) `query` to all documents in the corpus.</span></div>
<div class="line"><span class="lineno">  507</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  508</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  509</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  510</span><span class="stringliteral">        query : {iterable of list of (int, number) , list of (int, number))}</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">            A single document in bag-of-words format, or a corpus (iterable) of such documents.</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">        Return</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">        ------</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">        :class:`numpy.ndarray` or :class:`scipy.sparse.csr_matrix`</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">            Similarities of the query against this index.</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  519</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  520</span><span class="stringliteral">        If `query` is a corpus (iterable of documents), return a matrix of similarities of</span></div>
<div class="line"><span class="lineno">  521</span><span class="stringliteral">        all query documents vs. all corpus document. This batch query is more efficient than computing the similarities</span></div>
<div class="line"><span class="lineno">  522</span><span class="stringliteral">        one document after another.</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">        Examples</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  526</span><span class="stringliteral">        .. sourcecode:: pycon</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.test.utils import datapath</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.similarities import Similarity</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">            &gt;&gt;&gt;</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">            &gt;&gt;&gt; corpus = TextCorpus(datapath(&#39;testcorpus.txt&#39;))</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">            &gt;&gt;&gt; index = Similarity(&#39;temp&#39;, corpus, num_features=400)</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">            &gt;&gt;&gt; result = index[corpus]  # pairwise similarities of each document against each document</span></div>
<div class="line"><span class="lineno">  535</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  536</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  537</span>        self.close_shard()  <span class="comment"># no-op if no documents added to index since last query</span></div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>        <span class="comment"># reset num_best and normalize parameters, in case they were changed dynamically</span></div>
<div class="line"><span class="lineno">  540</span>        <span class="keywordflow">for</span> shard <span class="keywordflow">in</span> self.shards:</div>
<div class="line"><span class="lineno">  541</span>            shard.num_best = self.num_best</div>
<div class="line"><span class="lineno">  542</span>            shard.normalize = self.norm</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>        <span class="comment"># there are 4 distinct code paths, depending on whether input `query` is</span></div>
<div class="line"><span class="lineno">  545</span>        <span class="comment"># a corpus (or numpy/scipy matrix) or a single document, and whether the</span></div>
<div class="line"><span class="lineno">  546</span>        <span class="comment"># similarity result should be a full array or only num_best most similar</span></div>
<div class="line"><span class="lineno">  547</span>        <span class="comment"># documents.</span></div>
<div class="line"><span class="lineno">  548</span>        pool, shard_results = self.query_shards(query)</div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">if</span> self.num_best <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  550</span>            <span class="comment"># user asked for all documents =&gt; just stack the sub-results into a single matrix</span></div>
<div class="line"><span class="lineno">  551</span>            <span class="comment"># (works for both corpus / single doc query)</span></div>
<div class="line"><span class="lineno">  552</span>            result = numpy.hstack(list(shard_results))</div>
<div class="line"><span class="lineno">  553</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  554</span>            <span class="comment"># the following uses a lot of lazy evaluation and (optionally) parallel</span></div>
<div class="line"><span class="lineno">  555</span>            <span class="comment"># processing, to improve query latency and minimize memory footprint.</span></div>
<div class="line"><span class="lineno">  556</span>            offsets = numpy.cumsum([0] + [len(shard) <span class="keywordflow">for</span> shard <span class="keywordflow">in</span> self.shards])</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>            <span class="keyword">def </span>convert(shard_no, doc):</div>
<div class="line"><span class="lineno">  559</span>                <span class="keywordflow">return</span> [(doc_index + offsets[shard_no], sim) <span class="keywordflow">for</span> doc_index, sim <span class="keywordflow">in</span> doc]</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>            is_corpus, query = utils.is_corpus(query)</div>
<div class="line"><span class="lineno">  562</span>            is_corpus = is_corpus <span class="keywordflow">or</span> hasattr(query, <span class="stringliteral">&#39;ndim&#39;</span>) <span class="keywordflow">and</span> query.ndim &gt; 1 <span class="keywordflow">and</span> query.shape[0] &gt; 1</div>
<div class="line"><span class="lineno">  563</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_corpus:</div>
<div class="line"><span class="lineno">  564</span>                <span class="comment"># user asked for num_best most similar and query is a single doc</span></div>
<div class="line"><span class="lineno">  565</span>                results = (convert(shard_no, result) <span class="keywordflow">for</span> shard_no, result <span class="keywordflow">in</span> enumerate(shard_results))</div>
<div class="line"><span class="lineno">  566</span>                result = _nlargest(self.num_best, results)</div>
<div class="line"><span class="lineno">  567</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  568</span>                <span class="comment"># the trickiest combination: returning num_best results when query was a corpus</span></div>
<div class="line"><span class="lineno">  569</span>                results = []</div>
<div class="line"><span class="lineno">  570</span>                <span class="keywordflow">for</span> shard_no, result <span class="keywordflow">in</span> enumerate(shard_results):</div>
<div class="line"><span class="lineno">  571</span>                    shard_result = [convert(shard_no, doc) <span class="keywordflow">for</span> doc <span class="keywordflow">in</span> result]</div>
<div class="line"><span class="lineno">  572</span>                    results.append(shard_result)</div>
<div class="line"><span class="lineno">  573</span>                result = []</div>
<div class="line"><span class="lineno">  574</span>                <span class="keywordflow">for</span> parts <span class="keywordflow">in</span> zip(*results):</div>
<div class="line"><span class="lineno">  575</span>                    merged = _nlargest(self.num_best, parts)</div>
<div class="line"><span class="lineno">  576</span>                    result.append(merged)</div>
<div class="line"><span class="lineno">  577</span>        <span class="keywordflow">if</span> pool:</div>
<div class="line"><span class="lineno">  578</span>            <span class="comment"># gc doesn&#39;t seem to collect the Pools, eventually leading to</span></div>
<div class="line"><span class="lineno">  579</span>            <span class="comment"># &quot;IOError 24: too many open files&quot;. so let&#39;s terminate it manually.</span></div>
<div class="line"><span class="lineno">  580</span>            pool.terminate()</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>        <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  583</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aeddb4e19da25d376f3cf58583de006f4" name="aeddb4e19da25d376f3cf58583de006f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeddb4e19da25d376f3cf58583de006f4">&#9670;&#160;</a></span>__iter__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.__iter__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">For each index document in index, compute cosine similarity against all other documents in the index.
Uses :meth:`~gensim.similarities.docsim.Similarity.iter_chunks` internally.

Yields
------
:class:`numpy.ndarray` or :class:`scipy.sparse.csr_matrix`
    Similarities of each document in turn against the index.</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1interfaces_1_1_similarity_a_b_c.html#a60ef0ed1a36d3dd5ec8a30b277918895">gensim.interfaces.SimilarityABC</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  654</span>    <span class="keyword">def </span>__iter__(self):</div>
<div class="line"><span class="lineno">  655</span>        <span class="stringliteral">&quot;&quot;&quot;For each index document in index, compute cosine similarity against all other documents in the index.</span></div>
<div class="line"><span class="lineno">  656</span><span class="stringliteral">        Uses :meth:`~gensim.similarities.docsim.Similarity.iter_chunks` internally.</span></div>
<div class="line"><span class="lineno">  657</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  658</span><span class="stringliteral">        Yields</span></div>
<div class="line"><span class="lineno">  659</span><span class="stringliteral">        ------</span></div>
<div class="line"><span class="lineno">  660</span><span class="stringliteral">        :class:`numpy.ndarray` or :class:`scipy.sparse.csr_matrix`</span></div>
<div class="line"><span class="lineno">  661</span><span class="stringliteral">            Similarities of each document in turn against the index.</span></div>
<div class="line"><span class="lineno">  662</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  663</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  664</span>        <span class="comment"># turn off query normalization (vectors in the index are already normalized, save some CPU)</span></div>
<div class="line"><span class="lineno">  665</span>        norm, self.norm = self.norm, <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>        <span class="keywordflow">for</span> chunk <span class="keywordflow">in</span> self.iter_chunks():</div>
<div class="line"><span class="lineno">  668</span>            <span class="keywordflow">if</span> chunk.shape[0] &gt; 1:</div>
<div class="line"><span class="lineno">  669</span>                <span class="keywordflow">for</span> sim <span class="keywordflow">in</span> self[chunk]:</div>
<div class="line"><span class="lineno">  670</span>                    <span class="keywordflow">yield</span> sim</div>
<div class="line"><span class="lineno">  671</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  672</span>                <span class="keywordflow">yield</span> self[chunk]</div>
<div class="line"><span class="lineno">  673</span> </div>
<div class="line"><span class="lineno">  674</span>        self.norm = norm  <span class="comment"># restore normalization</span></div>
<div class="line"><span class="lineno">  675</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a27f8ab1dc5e446266f565367891b6a9f" name="a27f8ab1dc5e446266f565367891b6a9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27f8ab1dc5e446266f565367891b6a9f">&#9670;&#160;</a></span>__len__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.__len__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get length of index.</pre> <div class="fragment"><div class="line"><span class="lineno">  358</span>    <span class="keyword">def </span>__len__(self):</div>
<div class="line"><span class="lineno">  359</span>        <span class="stringliteral">&quot;&quot;&quot;Get length of index.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  360</span>        <span class="keywordflow">return</span> len(self.fresh_docs) + sum(len(shard) <span class="keywordflow">for</span> shard <span class="keywordflow">in</span> self.shards)</div>
<div class="line"><span class="lineno">  361</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0d23dd56c36a38ba30bb732900df1a3f" name="a0d23dd56c36a38ba30bb732900df1a3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d23dd56c36a38ba30bb732900df1a3f">&#9670;&#160;</a></span>__str__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.__str__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  362</span>    <span class="keyword">def </span>__str__(self):</div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Similarity index with %i documents in %i shards (stored under %s)&quot;</span> % (</div>
<div class="line"><span class="lineno">  364</span>            len(self), len(self.shards), self.output_prefix</div>
<div class="line"><span class="lineno">  365</span>        )</div>
<div class="line"><span class="lineno">  366</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a722370c1e0cb8cc04f52985686de4d76" name="a722370c1e0cb8cc04f52985686de4d76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a722370c1e0cb8cc04f52985686de4d76">&#9670;&#160;</a></span>add_documents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.add_documents </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>corpus</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Extend the index with new documents.

Parameters
----------
corpus : iterable of list of (int, number)
    Corpus in BoW format.

Notes
-----
Internally, documents are buffered and then spilled to disk when there's `self.shardsize` of them
(or when a query is issued).

Examples
--------
.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus
    &gt;&gt;&gt; from gensim.test.utils import datapath, get_tmpfile
    &gt;&gt;&gt; from gensim.similarities import Similarity
    &gt;&gt;&gt;
    &gt;&gt;&gt; corpus = TextCorpus(datapath('testcorpus.mm'))
    &gt;&gt;&gt; index_temp = get_tmpfile("index")
    &gt;&gt;&gt; index = Similarity(index_temp, corpus, num_features=400)  # create index
    &gt;&gt;&gt;
    &gt;&gt;&gt; one_more_corpus = TextCorpus(datapath('testcorpus.txt'))
    &gt;&gt;&gt; index.add_documents(one_more_corpus)  # add more documents in corpus</pre> <div class="fragment"><div class="line"><span class="lineno">  367</span>    <span class="keyword">def </span>add_documents(self, corpus):</div>
<div class="line"><span class="lineno">  368</span>        <span class="stringliteral">&quot;&quot;&quot;Extend the index with new documents.</span></div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">        corpus : iterable of list of (int, number)</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral">            Corpus in BoW format.</span></div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">        Internally, documents are buffered and then spilled to disk when there&#39;s `self.shardsize` of them</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral">        (or when a query is issued).</span></div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">        Examples</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">        .. sourcecode:: pycon</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.test.utils import datapath, get_tmpfile</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.similarities import Similarity</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral">            &gt;&gt;&gt;</span></div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">            &gt;&gt;&gt; corpus = TextCorpus(datapath(&#39;testcorpus.mm&#39;))</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">            &gt;&gt;&gt; index_temp = get_tmpfile(&quot;index&quot;)</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral">            &gt;&gt;&gt; index = Similarity(index_temp, corpus, num_features=400)  # create index</span></div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">            &gt;&gt;&gt;</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">            &gt;&gt;&gt; one_more_corpus = TextCorpus(datapath(&#39;testcorpus.txt&#39;))</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">            &gt;&gt;&gt; index.add_documents(one_more_corpus)  # add more documents in corpus</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  396</span>        min_ratio = 1.0  <span class="comment"># 0.5 to only reopen shards that are &lt;50% complete</span></div>
<div class="line"><span class="lineno">  397</span>        <span class="keywordflow">if</span> self.shards <span class="keywordflow">and</span> len(self.shards[-1]) &lt; min_ratio * self.shardsize:</div>
<div class="line"><span class="lineno">  398</span>            <span class="comment"># The last shard was incomplete (&lt;; load it back and add the documents there, don&#39;t start a new shard</span></div>
<div class="line"><span class="lineno">  399</span>            self.reopen_shard()</div>
<div class="line"><span class="lineno">  400</span>        <span class="keywordflow">for</span> doc <span class="keywordflow">in</span> corpus:</div>
<div class="line"><span class="lineno">  401</span>            <span class="keywordflow">if</span> isinstance(doc, numpy.ndarray):</div>
<div class="line"><span class="lineno">  402</span>                doclen = len(doc)</div>
<div class="line"><span class="lineno">  403</span>            <span class="keywordflow">elif</span> scipy.sparse.issparse(doc):</div>
<div class="line"><span class="lineno">  404</span>                doclen = doc.nnz</div>
<div class="line"><span class="lineno">  405</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  406</span>                doclen = len(doc)</div>
<div class="line"><span class="lineno">  407</span>                <span class="keywordflow">if</span> doclen &lt; 0.3 * self.num_features:</div>
<div class="line"><span class="lineno">  408</span>                    doc = matutils.unitvec(matutils.corpus2csc([doc], self.num_features).T, self.norm)</div>
<div class="line"><span class="lineno">  409</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  410</span>                    doc = matutils.unitvec(matutils.sparse2full(doc, self.num_features), self.norm)</div>
<div class="line"><span class="lineno">  411</span>            self.fresh_docs.append(doc)</div>
<div class="line"><span class="lineno">  412</span>            self.fresh_nnz += doclen</div>
<div class="line"><span class="lineno">  413</span>            <span class="keywordflow">if</span> len(self.fresh_docs) &gt;= self.shardsize:</div>
<div class="line"><span class="lineno">  414</span>                self.close_shard()</div>
<div class="line"><span class="lineno">  415</span>            <span class="keywordflow">if</span> len(self.fresh_docs) % 10000 == 0:</div>
<div class="line"><span class="lineno">  416</span>                logger.info(<span class="stringliteral">&quot;PROGRESS: fresh_shard size=%i&quot;</span>, len(self.fresh_docs))</div>
<div class="line"><span class="lineno">  417</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8189904e65dedb007190ed30969a6ff0" name="a8189904e65dedb007190ed30969a6ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8189904e65dedb007190ed30969a6ff0">&#9670;&#160;</a></span>check_moved()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.check_moved </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Update shard locations, for case where the server prefix location changed on the filesystem.</pre> <div class="fragment"><div class="line"><span class="lineno">  707</span>    <span class="keyword">def </span>check_moved(self):</div>
<div class="line"><span class="lineno">  708</span>        <span class="stringliteral">&quot;&quot;&quot;Update shard locations, for case where the server prefix location changed on the filesystem.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  709</span>        dirname = os.path.dirname(self.output_prefix)</div>
<div class="line"><span class="lineno">  710</span>        <span class="keywordflow">for</span> shard <span class="keywordflow">in</span> self.shards:</div>
<div class="line"><span class="lineno">  711</span>            shard.dirname = dirname</div>
<div class="line"><span class="lineno">  712</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a16091f95c9bd4b04f68c06d97b57c688" name="a16091f95c9bd4b04f68c06d97b57c688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16091f95c9bd4b04f68c06d97b57c688">&#9670;&#160;</a></span>close_shard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.close_shard </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Force the latest shard to close (be converted to a matrix and stored to disk).
 Do nothing if no new documents added since last call.

Notes
-----
The shard is closed even if it is not full yet (its size is smaller than `self.shardsize`).
If documents are added later via :meth:`~gensim.similarities.docsim.MatrixSimilarity.add_documents`
this incomplete shard will be loaded again and completed.</pre> <div class="fragment"><div class="line"><span class="lineno">  437</span>    <span class="keyword">def </span>close_shard(self):</div>
<div class="line"><span class="lineno">  438</span>        <span class="stringliteral">&quot;&quot;&quot;Force the latest shard to close (be converted to a matrix and stored to disk).</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">         Do nothing if no new documents added since last call.</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">        The shard is closed even if it is not full yet (its size is smaller than `self.shardsize`).</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral">        If documents are added later via :meth:`~gensim.similarities.docsim.MatrixSimilarity.add_documents`</span></div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">        this incomplete shard will be loaded again and completed.</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  448</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.fresh_docs:</div>
<div class="line"><span class="lineno">  449</span>            <span class="keywordflow">return</span></div>
<div class="line"><span class="lineno">  450</span>        shardid = len(self.shards)</div>
<div class="line"><span class="lineno">  451</span>        <span class="comment"># consider the shard sparse if its density is &lt; 30%</span></div>
<div class="line"><span class="lineno">  452</span>        issparse = 0.3 &gt; 1.0 * self.fresh_nnz / (len(self.fresh_docs) * self.num_features)</div>
<div class="line"><span class="lineno">  453</span>        <span class="keywordflow">if</span> issparse:</div>
<div class="line"><span class="lineno">  454</span>            index = SparseMatrixSimilarity(</div>
<div class="line"><span class="lineno">  455</span>                self.fresh_docs, num_terms=self.num_features, num_docs=len(self.fresh_docs), num_nnz=self.fresh_nnz</div>
<div class="line"><span class="lineno">  456</span>            )</div>
<div class="line"><span class="lineno">  457</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  458</span>            index = MatrixSimilarity(self.fresh_docs, num_features=self.num_features)</div>
<div class="line"><span class="lineno">  459</span>        logger.info(<span class="stringliteral">&quot;creating %s shard #%s&quot;</span>, <span class="stringliteral">&#39;sparse&#39;</span> <span class="keywordflow">if</span> issparse <span class="keywordflow">else</span> <span class="stringliteral">&#39;dense&#39;</span>, shardid)</div>
<div class="line"><span class="lineno">  460</span>        shard = Shard(self.shardid2filename(shardid), index)</div>
<div class="line"><span class="lineno">  461</span>        shard.num_best = self.num_best</div>
<div class="line"><span class="lineno">  462</span>        shard.num_nnz = self.fresh_nnz</div>
<div class="line"><span class="lineno">  463</span>        self.shards.append(shard)</div>
<div class="line"><span class="lineno">  464</span>        self.fresh_docs, self.fresh_nnz = [], 0</div>
<div class="line"><span class="lineno">  465</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a633b353fcdf7fff867b06d2bf6340d90" name="a633b353fcdf7fff867b06d2bf6340d90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a633b353fcdf7fff867b06d2bf6340d90">&#9670;&#160;</a></span>destroy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.destroy </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Delete all files under self.output_prefix Index is not usable anymore after calling this method.</pre> <div class="fragment"><div class="line"><span class="lineno">  753</span>    <span class="keyword">def </span>destroy(self):</div>
<div class="line"><span class="lineno">  754</span>        <span class="stringliteral">&quot;&quot;&quot;Delete all files under self.output_prefix Index is not usable anymore after calling this method.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  755</span>        <span class="keyword">import</span> glob</div>
<div class="line"><span class="lineno">  756</span>        <span class="keywordflow">for</span> fname <span class="keywordflow">in</span> glob.glob(self.output_prefix + <span class="stringliteral">&#39;*&#39;</span>):</div>
<div class="line"><span class="lineno">  757</span>            logger.info(<span class="stringliteral">&quot;deleting %s&quot;</span>, fname)</div>
<div class="line"><span class="lineno">  758</span>            os.remove(fname)</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a773a8c48d3776c034f37ffe137a0c4bc" name="a773a8c48d3776c034f37ffe137a0c4bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a773a8c48d3776c034f37ffe137a0c4bc">&#9670;&#160;</a></span>iter_chunks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.iter_chunks </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>chunksize</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Iteratively yield the index as chunks of document vectors, each of size &lt;= chunksize.

Parameters
----------
chunksize : int, optional
    Size of chunk,, if None - `self.chunksize` will be used.

Yields
------
:class:`numpy.ndarray` or :class:`scipy.sparse.csr_matrix`
    Chunks of the index as 2D arrays. The arrays are either dense or sparse, depending on
    whether the shard was storing dense or sparse vectors.</pre> <div class="fragment"><div class="line"><span class="lineno">  676</span>    <span class="keyword">def </span>iter_chunks(self, chunksize=None):</div>
<div class="line"><span class="lineno">  677</span>        <span class="stringliteral">&quot;&quot;&quot;Iteratively yield the index as chunks of document vectors, each of size &lt;= chunksize.</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">        chunksize : int, optional</span></div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">            Size of chunk,, if None - `self.chunksize` will be used.</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  684</span><span class="stringliteral">        Yields</span></div>
<div class="line"><span class="lineno">  685</span><span class="stringliteral">        ------</span></div>
<div class="line"><span class="lineno">  686</span><span class="stringliteral">        :class:`numpy.ndarray` or :class:`scipy.sparse.csr_matrix`</span></div>
<div class="line"><span class="lineno">  687</span><span class="stringliteral">            Chunks of the index as 2D arrays. The arrays are either dense or sparse, depending on</span></div>
<div class="line"><span class="lineno">  688</span><span class="stringliteral">            whether the shard was storing dense or sparse vectors.</span></div>
<div class="line"><span class="lineno">  689</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  690</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  691</span>        self.close_shard()</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>        <span class="keywordflow">if</span> chunksize <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  694</span>            <span class="comment"># if not explicitly specified, use the chunksize from the constructor</span></div>
<div class="line"><span class="lineno">  695</span>            chunksize = self.chunksize</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>        <span class="keywordflow">for</span> shard <span class="keywordflow">in</span> self.shards:</div>
<div class="line"><span class="lineno">  698</span>            query = shard.get_index().index</div>
<div class="line"><span class="lineno">  699</span>            <span class="keywordflow">for</span> chunk_start <span class="keywordflow">in</span> range(0, query.shape[0], chunksize):</div>
<div class="line"><span class="lineno">  700</span>                <span class="comment"># scipy.sparse doesn&#39;t allow slicing beyond real size of the matrix</span></div>
<div class="line"><span class="lineno">  701</span>                <span class="comment"># (unlike numpy). so, clip the end of the chunk explicitly to make</span></div>
<div class="line"><span class="lineno">  702</span>                <span class="comment"># scipy.sparse happy</span></div>
<div class="line"><span class="lineno">  703</span>                chunk_end = min(query.shape[0], chunk_start + chunksize)</div>
<div class="line"><span class="lineno">  704</span>                chunk = query[chunk_start: chunk_end]  <span class="comment"># create a view</span></div>
<div class="line"><span class="lineno">  705</span>                <span class="keywordflow">yield</span> chunk</div>
<div class="line"><span class="lineno">  706</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c292ed6ccdcb6b964b49cc0bf9b11f4" name="a2c292ed6ccdcb6b964b49cc0bf9b11f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c292ed6ccdcb6b964b49cc0bf9b11f4">&#9670;&#160;</a></span>query_shards()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.query_shards </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>query</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Apply shard[query] to each shard in `self.shards`. Used internally.

Parameters
----------
query : {iterable of list of (int, number) , list of (int, number))}
    Document in BoW format or corpus of documents.

Returns
-------
(None, list of individual shard query results)
    Query results.</pre> <div class="fragment"><div class="line"><span class="lineno">  480</span>    <span class="keyword">def </span>query_shards(self, query):</div>
<div class="line"><span class="lineno">  481</span>        <span class="stringliteral">&quot;&quot;&quot;Apply shard[query] to each shard in `self.shards`. Used internally.</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">        query : {iterable of list of (int, number) , list of (int, number))}</span></div>
<div class="line"><span class="lineno">  486</span><span class="stringliteral">            Document in BoW format or corpus of documents.</span></div>
<div class="line"><span class="lineno">  487</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  488</span><span class="stringliteral">        Returns</span></div>
<div class="line"><span class="lineno">  489</span><span class="stringliteral">        -------</span></div>
<div class="line"><span class="lineno">  490</span><span class="stringliteral">        (None, list of individual shard query results)</span></div>
<div class="line"><span class="lineno">  491</span><span class="stringliteral">            Query results.</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  494</span>        args = zip([query] * len(self.shards), self.shards)</div>
<div class="line"><span class="lineno">  495</span>        <span class="keywordflow">if</span> PARALLEL_SHARDS <span class="keywordflow">and</span> PARALLEL_SHARDS &gt; 1:</div>
<div class="line"><span class="lineno">  496</span>            logger.debug(<span class="stringliteral">&quot;spawning %i query processes&quot;</span>, PARALLEL_SHARDS)</div>
<div class="line"><span class="lineno">  497</span>            pool = multiprocessing.Pool(PARALLEL_SHARDS)</div>
<div class="line"><span class="lineno">  498</span>            result = pool.imap(query_shard, args, chunksize=1 + len(self.shards) / PARALLEL_SHARDS)</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  500</span>            <span class="comment"># serial processing, one shard after another</span></div>
<div class="line"><span class="lineno">  501</span>            pool = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  502</span>            result = map(query_shard, args)</div>
<div class="line"><span class="lineno">  503</span>        <span class="keywordflow">return</span> pool, result</div>
<div class="line"><span class="lineno">  504</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aeed1ed8ef6c92a3ce8571d63c6d1323d" name="aeed1ed8ef6c92a3ce8571d63c6d1323d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeed1ed8ef6c92a3ce8571d63c6d1323d">&#9670;&#160;</a></span>reopen_shard()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.reopen_shard </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reopen an incomplete shard.</pre> <div class="fragment"><div class="line"><span class="lineno">  466</span>    <span class="keyword">def </span>reopen_shard(self):</div>
<div class="line"><span class="lineno">  467</span>        <span class="stringliteral">&quot;&quot;&quot;Reopen an incomplete shard.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  468</span>        <span class="keyword">assert</span> self.shards</div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">if</span> self.fresh_docs:</div>
<div class="line"><span class="lineno">  470</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;cannot reopen a shard with fresh documents in index&quot;</span>)</div>
<div class="line"><span class="lineno">  471</span>        last_shard = self.shards[-1]</div>
<div class="line"><span class="lineno">  472</span>        last_index = last_shard.get_index()</div>
<div class="line"><span class="lineno">  473</span>        logger.info(<span class="stringliteral">&quot;reopening an incomplete shard of %i documents&quot;</span>, len(last_shard))</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>        self.fresh_docs = list(last_index.index)</div>
<div class="line"><span class="lineno">  476</span>        self.fresh_nnz = last_shard.num_nnz</div>
<div class="line"><span class="lineno">  477</span>        del self.shards[-1]  <span class="comment"># remove the shard from index, *but its file on disk is not deleted*</span></div>
<div class="line"><span class="lineno">  478</span>        logger.debug(<span class="stringliteral">&quot;reopen complete&quot;</span>)</div>
<div class="line"><span class="lineno">  479</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abcabaad6bb1d16a01d79cdc86f653a3d" name="abcabaad6bb1d16a01d79cdc86f653a3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abcabaad6bb1d16a01d79cdc86f653a3d">&#9670;&#160;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.save </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fname</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">**&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Save the index object via pickling under `fname`. See also :meth:`~gensim.docsim.Similarity.load()`.

Parameters
----------
fname : str, optional
    Path for save index, if not provided - will be saved to `self.output_prefix`.
*args : object
    Arguments, see :meth:`gensim.utils.SaveLoad.save`.
**kwargs : object
    Keyword arguments, see :meth:`gensim.utils.SaveLoad.save`.

Notes
-----
Will call :meth:`~gensim.similarities.Similarity.close_shard` internally to spill
any unfinished shards to disk first.

Examples
--------
.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus
    &gt;&gt;&gt; from gensim.test.utils import datapath, get_tmpfile
    &gt;&gt;&gt; from gensim.similarities import Similarity
    &gt;&gt;&gt;
    &gt;&gt;&gt; temp_fname = get_tmpfile("index")
    &gt;&gt;&gt; output_fname = get_tmpfile("saved_index")
    &gt;&gt;&gt;
    &gt;&gt;&gt; corpus = TextCorpus(datapath('testcorpus.txt'))
    &gt;&gt;&gt; index = Similarity(output_fname, corpus, num_features=400)
    &gt;&gt;&gt;
    &gt;&gt;&gt; index.save(output_fname)
    &gt;&gt;&gt; loaded_index = index.load(output_fname)</pre> 
<p>Reimplemented from <a class="el" href="classgensim_1_1utils_1_1_save_load.html#a0767537a6eb767dfe4fb8cf6d5fc221c">gensim.utils.SaveLoad</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  713</span>    <span class="keyword">def </span>save(self, fname=None, *args, **kwargs):</div>
<div class="line"><span class="lineno">  714</span>        <span class="stringliteral">&quot;&quot;&quot;Save the index object via pickling under `fname`. See also :meth:`~gensim.docsim.Similarity.load()`.</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral">        fname : str, optional</span></div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral">            Path for save index, if not provided - will be saved to `self.output_prefix`.</span></div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral">        *args : object</span></div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral">            Arguments, see :meth:`gensim.utils.SaveLoad.save`.</span></div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">        **kwargs : object</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">            Keyword arguments, see :meth:`gensim.utils.SaveLoad.save`.</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">        Notes</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">        -----</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral">        Will call :meth:`~gensim.similarities.Similarity.close_shard` internally to spill</span></div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral">        any unfinished shards to disk first.</span></div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral">        Examples</span></div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">        .. sourcecode:: pycon</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus</span></div>
<div class="line"><span class="lineno">  735</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.test.utils import datapath, get_tmpfile</span></div>
<div class="line"><span class="lineno">  736</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.similarities import Similarity</span></div>
<div class="line"><span class="lineno">  737</span><span class="stringliteral">            &gt;&gt;&gt;</span></div>
<div class="line"><span class="lineno">  738</span><span class="stringliteral">            &gt;&gt;&gt; temp_fname = get_tmpfile(&quot;index&quot;)</span></div>
<div class="line"><span class="lineno">  739</span><span class="stringliteral">            &gt;&gt;&gt; output_fname = get_tmpfile(&quot;saved_index&quot;)</span></div>
<div class="line"><span class="lineno">  740</span><span class="stringliteral">            &gt;&gt;&gt;</span></div>
<div class="line"><span class="lineno">  741</span><span class="stringliteral">            &gt;&gt;&gt; corpus = TextCorpus(datapath(&#39;testcorpus.txt&#39;))</span></div>
<div class="line"><span class="lineno">  742</span><span class="stringliteral">            &gt;&gt;&gt; index = Similarity(output_fname, corpus, num_features=400)</span></div>
<div class="line"><span class="lineno">  743</span><span class="stringliteral">            &gt;&gt;&gt;</span></div>
<div class="line"><span class="lineno">  744</span><span class="stringliteral">            &gt;&gt;&gt; index.save(output_fname)</span></div>
<div class="line"><span class="lineno">  745</span><span class="stringliteral">            &gt;&gt;&gt; loaded_index = index.load(output_fname)</span></div>
<div class="line"><span class="lineno">  746</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  747</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  748</span>        self.close_shard()</div>
<div class="line"><span class="lineno">  749</span>        <span class="keywordflow">if</span> fname <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  750</span>            fname = self.output_prefix</div>
<div class="line"><span class="lineno">  751</span>        super(Similarity, self).save(fname, *args, **kwargs)</div>
<div class="line"><span class="lineno">  752</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ade55729b15d77f3523f67e6f5ec8aa" name="a3ade55729b15d77f3523f67e6f5ec8aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ade55729b15d77f3523f67e6f5ec8aa">&#9670;&#160;</a></span>shardid2filename()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.shardid2filename </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shardid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get shard file by `shardid`.

Parameters
----------
shardid : int
    Shard index.

Return
------
str
    Path to shard file.</pre> <div class="fragment"><div class="line"><span class="lineno">  418</span>    <span class="keyword">def </span>shardid2filename(self, shardid):</div>
<div class="line"><span class="lineno">  419</span>        <span class="stringliteral">&quot;&quot;&quot;Get shard file by `shardid`.</span></div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">        shardid : int</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral">            Shard index.</span></div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">        Return</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">        ------</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">        str</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral">            Path to shard file.</span></div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  432</span>        <span class="keywordflow">if</span> self.output_prefix.endswith(<span class="stringliteral">&#39;.&#39;</span>):</div>
<div class="line"><span class="lineno">  433</span>            <span class="keywordflow">return</span> <span class="stringliteral">&quot;%s%s&quot;</span> % (self.output_prefix, shardid)</div>
<div class="line"><span class="lineno">  434</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  435</span>            <span class="keywordflow">return</span> <span class="stringliteral">&quot;%s.%s&quot;</span> % (self.output_prefix, shardid)</div>
<div class="line"><span class="lineno">  436</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae424db33c2b8b5f5ba2b2794c87d63a6" name="ae424db33c2b8b5f5ba2b2794c87d63a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae424db33c2b8b5f5ba2b2794c87d63a6">&#9670;&#160;</a></span>similarity_by_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.similarity_by_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>docpos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get similarity of a document specified by its index position `docpos`.

Parameters
----------
docpos : int
    Document position in the index.

Return
------
:class:`numpy.ndarray` or :class:`scipy.sparse.csr_matrix`
    Similarities of the given document against this index.

Examples
--------
.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus
    &gt;&gt;&gt; from gensim.test.utils import datapath
    &gt;&gt;&gt; from gensim.similarities import Similarity
    &gt;&gt;&gt;
    &gt;&gt;&gt; corpus = TextCorpus(datapath('testcorpus.txt'))
    &gt;&gt;&gt; index = Similarity('temp', corpus, num_features=400)
    &gt;&gt;&gt; similarities = index.similarity_by_id(1)</pre> <div class="fragment"><div class="line"><span class="lineno">  622</span>    <span class="keyword">def </span>similarity_by_id(self, docpos):</div>
<div class="line"><span class="lineno">  623</span>        <span class="stringliteral">&quot;&quot;&quot;Get similarity of a document specified by its index position `docpos`.</span></div>
<div class="line"><span class="lineno">  624</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  625</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  626</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  627</span><span class="stringliteral">        docpos : int</span></div>
<div class="line"><span class="lineno">  628</span><span class="stringliteral">            Document position in the index.</span></div>
<div class="line"><span class="lineno">  629</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  630</span><span class="stringliteral">        Return</span></div>
<div class="line"><span class="lineno">  631</span><span class="stringliteral">        ------</span></div>
<div class="line"><span class="lineno">  632</span><span class="stringliteral">        :class:`numpy.ndarray` or :class:`scipy.sparse.csr_matrix`</span></div>
<div class="line"><span class="lineno">  633</span><span class="stringliteral">            Similarities of the given document against this index.</span></div>
<div class="line"><span class="lineno">  634</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  635</span><span class="stringliteral">        Examples</span></div>
<div class="line"><span class="lineno">  636</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  637</span><span class="stringliteral">        .. sourcecode:: pycon</span></div>
<div class="line"><span class="lineno">  638</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus</span></div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.test.utils import datapath</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.similarities import Similarity</span></div>
<div class="line"><span class="lineno">  642</span><span class="stringliteral">            &gt;&gt;&gt;</span></div>
<div class="line"><span class="lineno">  643</span><span class="stringliteral">            &gt;&gt;&gt; corpus = TextCorpus(datapath(&#39;testcorpus.txt&#39;))</span></div>
<div class="line"><span class="lineno">  644</span><span class="stringliteral">            &gt;&gt;&gt; index = Similarity(&#39;temp&#39;, corpus, num_features=400)</span></div>
<div class="line"><span class="lineno">  645</span><span class="stringliteral">            &gt;&gt;&gt; similarities = index.similarity_by_id(1)</span></div>
<div class="line"><span class="lineno">  646</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  647</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  648</span>        query = self.vector_by_id(docpos)</div>
<div class="line"><span class="lineno">  649</span>        norm, self.norm = self.norm, <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  650</span>        result = self[query]</div>
<div class="line"><span class="lineno">  651</span>        self.norm = norm</div>
<div class="line"><span class="lineno">  652</span>        <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  653</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a597d737f57179043d720a81d6d3c329f" name="a597d737f57179043d720a81d6d3c329f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a597d737f57179043d720a81d6d3c329f">&#9670;&#160;</a></span>vector_by_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.vector_by_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>docpos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get the indexed vector corresponding to the document at position `docpos`.

Parameters
----------
docpos : int
    Document position

Return
------
:class:`scipy.sparse.csr_matrix`
    Indexed vector.

Examples
--------
.. sourcecode:: pycon

    &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus
    &gt;&gt;&gt; from gensim.test.utils import datapath
    &gt;&gt;&gt; from gensim.similarities import Similarity
    &gt;&gt;&gt;
    &gt;&gt;&gt; # Create index:
    &gt;&gt;&gt; corpus = TextCorpus(datapath('testcorpus.txt'))
    &gt;&gt;&gt; index = Similarity('temp', corpus, num_features=400)
    &gt;&gt;&gt; vector = index.vector_by_id(1)</pre> <div class="fragment"><div class="line"><span class="lineno">  584</span>    <span class="keyword">def </span>vector_by_id(self, docpos):</div>
<div class="line"><span class="lineno">  585</span>        <span class="stringliteral">&quot;&quot;&quot;Get the indexed vector corresponding to the document at position `docpos`.</span></div>
<div class="line"><span class="lineno">  586</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  587</span><span class="stringliteral">        Parameters</span></div>
<div class="line"><span class="lineno">  588</span><span class="stringliteral">        ----------</span></div>
<div class="line"><span class="lineno">  589</span><span class="stringliteral">        docpos : int</span></div>
<div class="line"><span class="lineno">  590</span><span class="stringliteral">            Document position</span></div>
<div class="line"><span class="lineno">  591</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  592</span><span class="stringliteral">        Return</span></div>
<div class="line"><span class="lineno">  593</span><span class="stringliteral">        ------</span></div>
<div class="line"><span class="lineno">  594</span><span class="stringliteral">        :class:`scipy.sparse.csr_matrix`</span></div>
<div class="line"><span class="lineno">  595</span><span class="stringliteral">            Indexed vector.</span></div>
<div class="line"><span class="lineno">  596</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  597</span><span class="stringliteral">        Examples</span></div>
<div class="line"><span class="lineno">  598</span><span class="stringliteral">        --------</span></div>
<div class="line"><span class="lineno">  599</span><span class="stringliteral">        .. sourcecode:: pycon</span></div>
<div class="line"><span class="lineno">  600</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  601</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.corpora.textcorpus import TextCorpus</span></div>
<div class="line"><span class="lineno">  602</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.test.utils import datapath</span></div>
<div class="line"><span class="lineno">  603</span><span class="stringliteral">            &gt;&gt;&gt; from gensim.similarities import Similarity</span></div>
<div class="line"><span class="lineno">  604</span><span class="stringliteral">            &gt;&gt;&gt;</span></div>
<div class="line"><span class="lineno">  605</span><span class="stringliteral">            &gt;&gt;&gt; # Create index:</span></div>
<div class="line"><span class="lineno">  606</span><span class="stringliteral">            &gt;&gt;&gt; corpus = TextCorpus(datapath(&#39;testcorpus.txt&#39;))</span></div>
<div class="line"><span class="lineno">  607</span><span class="stringliteral">            &gt;&gt;&gt; index = Similarity(&#39;temp&#39;, corpus, num_features=400)</span></div>
<div class="line"><span class="lineno">  608</span><span class="stringliteral">            &gt;&gt;&gt; vector = index.vector_by_id(1)</span></div>
<div class="line"><span class="lineno">  609</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  610</span><span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  611</span>        self.close_shard()  <span class="comment"># no-op if no documents added to index since last query</span></div>
<div class="line"><span class="lineno">  612</span>        pos = 0</div>
<div class="line"><span class="lineno">  613</span>        <span class="keywordflow">for</span> shard <span class="keywordflow">in</span> self.shards:</div>
<div class="line"><span class="lineno">  614</span>            pos += len(shard)</div>
<div class="line"><span class="lineno">  615</span>            <span class="keywordflow">if</span> docpos &lt; pos:</div>
<div class="line"><span class="lineno">  616</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  617</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.shards <span class="keywordflow">or</span> docpos &lt; 0 <span class="keywordflow">or</span> docpos &gt;= pos:</div>
<div class="line"><span class="lineno">  618</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;invalid document position: %s (must be 0 &lt;= x &lt; %s)&quot;</span> % (docpos, len(self)))</div>
<div class="line"><span class="lineno">  619</span>        result = shard.get_document_id(docpos - pos + len(shard))</div>
<div class="line"><span class="lineno">  620</span>        <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  621</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aa1d464418f829b6db37dd2bec35e0ef2" name="aa1d464418f829b6db37dd2bec35e0ef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1d464418f829b6db37dd2bec35e0ef2">&#9670;&#160;</a></span>chunksize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.chunksize</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa274e207c541a5252bc7c5ae89557375" name="aa274e207c541a5252bc7c5ae89557375"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa274e207c541a5252bc7c5ae89557375">&#9670;&#160;</a></span>fresh_docs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.fresh_docs</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3b77b18bda77174ee3bf00384afc583a" name="a3b77b18bda77174ee3bf00384afc583a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b77b18bda77174ee3bf00384afc583a">&#9670;&#160;</a></span>fresh_nnz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.fresh_nnz</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a851e32d93fcc6f4076456066b612474d" name="a851e32d93fcc6f4076456066b612474d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a851e32d93fcc6f4076456066b612474d">&#9670;&#160;</a></span>norm</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.norm</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afe5a060fd52f13234e47f91ccb22fc05" name="afe5a060fd52f13234e47f91ccb22fc05"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe5a060fd52f13234e47f91ccb22fc05">&#9670;&#160;</a></span>num_best</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.num_best</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae3b406e0a6f00eeac9604bc7625ddd06" name="ae3b406e0a6f00eeac9604bc7625ddd06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b406e0a6f00eeac9604bc7625ddd06">&#9670;&#160;</a></span>num_features</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.num_features</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a34a3e363891c678bbd62b372d65d5a99" name="a34a3e363891c678bbd62b372d65d5a99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34a3e363891c678bbd62b372d65d5a99">&#9670;&#160;</a></span>output_prefix</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.output_prefix</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a53fbf340d6a0daaad50b1bf48473aea1" name="a53fbf340d6a0daaad50b1bf48473aea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53fbf340d6a0daaad50b1bf48473aea1">&#9670;&#160;</a></span>shards</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.shards</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3f54812f94d3cbe693fbbdbb3b01d0c6" name="a3f54812f94d3cbe693fbbdbb3b01d0c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f54812f94d3cbe693fbbdbb3b01d0c6">&#9670;&#160;</a></span>shardsize</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gensim.similarities.docsim.Similarity.shardsize</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/gensim/similarities/<a class="el" href="docsim_8py.html">docsim.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
