<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.tests.reshape.merge.test_merge.TestMergeDtypes Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests.html">tests</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape.html">reshape</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge.html">merge</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1tests_1_1reshape_1_1merge_1_1test__merge.html">test_merge</a></li><li class="navelem"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html">TestMergeDtypes</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">pandas.tests.reshape.merge.test_merge.TestMergeDtypes Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa3cd0e8a4c0cb5111276f73168dbc5d7" id="r_aa3cd0e8a4c0cb5111276f73168dbc5d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#aa3cd0e8a4c0cb5111276f73168dbc5d7">test_different</a> (self, right_vals)</td></tr>
<tr class="separator:aa3cd0e8a4c0cb5111276f73168dbc5d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeb332698ea2e57418af03e1198e44c5" id="r_adeb332698ea2e57418af03e1198e44c5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#adeb332698ea2e57418af03e1198e44c5">test_join_multi_dtypes</a> (self, <a class="el" href="__lapack__subroutines_8h.html#a2b925362405fa9a6d18ed6ee40fca5e6">d1</a>, <a class="el" href="__lapack__subroutines_8h.html#aa0eb6a5759e915fb14ebf87116ebfaf8">d2</a>)</td></tr>
<tr class="separator:adeb332698ea2e57418af03e1198e44c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdc2f133d599d5122a163d2e2c66e54b" id="r_afdc2f133d599d5122a163d2e2c66e54b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#afdc2f133d599d5122a163d2e2c66e54b">test_merge_on_ints_floats</a> (self, int_vals, float_vals, exp_vals)</td></tr>
<tr class="separator:afdc2f133d599d5122a163d2e2c66e54b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23b5b587b2e65a04f0c962847dc1028" id="r_ac23b5b587b2e65a04f0c962847dc1028"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#ac23b5b587b2e65a04f0c962847dc1028">test_merge_key_dtype_cast</a> (self)</td></tr>
<tr class="separator:ac23b5b587b2e65a04f0c962847dc1028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae576896888369029047c1afb3e0f158d" id="r_ae576896888369029047c1afb3e0f158d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#ae576896888369029047c1afb3e0f158d">test_merge_on_ints_floats_warning</a> (self)</td></tr>
<tr class="separator:ae576896888369029047c1afb3e0f158d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c890e05de633fe0b8be112eab5738ec" id="r_a8c890e05de633fe0b8be112eab5738ec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#a8c890e05de633fe0b8be112eab5738ec">test_merge_incompat_infer_boolean_object</a> (self)</td></tr>
<tr class="separator:a8c890e05de633fe0b8be112eab5738ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c8f48e01d8f4a5adafe1b4ed40b5aa5" id="r_a8c8f48e01d8f4a5adafe1b4ed40b5aa5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#a8c8f48e01d8f4a5adafe1b4ed40b5aa5">test_merge_incompat_infer_boolean_object_with_missing</a> (self)</td></tr>
<tr class="separator:a8c8f48e01d8f4a5adafe1b4ed40b5aa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78488159d2278380206d3f6363e1d801" id="r_a78488159d2278380206d3f6363e1d801"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#a78488159d2278380206d3f6363e1d801">test_merge_incompat_dtypes_are_ok</a> (self, df1_vals, df2_vals)</td></tr>
<tr class="separator:a78488159d2278380206d3f6363e1d801"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f3a85017414bfcf5fa21a78e39363e4" id="r_a5f3a85017414bfcf5fa21a78e39363e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#a5f3a85017414bfcf5fa21a78e39363e4">test_merge_incompat_dtypes_error</a> (self, df1_vals, df2_vals)</td></tr>
<tr class="separator:a5f3a85017414bfcf5fa21a78e39363e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a204e5baac436f53e934e02dd44d88f79" id="r_a204e5baac436f53e934e02dd44d88f79"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#a204e5baac436f53e934e02dd44d88f79">test_merge_EA_dtype</a> (self, any_numeric_ea_dtype, how, expected_data)</td></tr>
<tr class="separator:a204e5baac436f53e934e02dd44d88f79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab16e86af1a74a08aa4e09fe295c38eb7" id="r_ab16e86af1a74a08aa4e09fe295c38eb7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#ab16e86af1a74a08aa4e09fe295c38eb7">test_merge_string_dtype</a> (self, how, expected_data, any_string_dtype)</td></tr>
<tr class="separator:ab16e86af1a74a08aa4e09fe295c38eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09c775e267734111cb32a7e781c494d" id="r_ad09c775e267734111cb32a7e781c494d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#ad09c775e267734111cb32a7e781c494d">test_merge_bool_dtype</a> (self, how, expected_data)</td></tr>
<tr class="separator:ad09c775e267734111cb32a7e781c494d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac974439d3709f04b9e878386c5fdc461" id="r_ac974439d3709f04b9e878386c5fdc461"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#ac974439d3709f04b9e878386c5fdc461">test_merge_ea_with_string</a> (self, join_type, string_dtype)</td></tr>
<tr class="separator:ac974439d3709f04b9e878386c5fdc461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60d58fed505029348de11ce74b4e1104" id="r_a60d58fed505029348de11ce74b4e1104"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1tests_1_1reshape_1_1merge_1_1test__merge_1_1_test_merge_dtypes.html#a60d58fed505029348de11ce74b4e1104">test_merge_empty</a> (self, left_empty, how, exp)</td></tr>
<tr class="separator:a60d58fed505029348de11ce74b4e1104"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa3cd0e8a4c0cb5111276f73168dbc5d7" name="aa3cd0e8a4c0cb5111276f73168dbc5d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3cd0e8a4c0cb5111276f73168dbc5d7">&#9670;&#160;</a></span>test_different()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_different </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>right_vals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1432</span>    <span class="keyword">def </span>test_different(self, right_vals):</div>
<div class="line"><span class="lineno"> 1433</span> </div>
<div class="line"><span class="lineno"> 1434</span>        left = DataFrame(</div>
<div class="line"><span class="lineno"> 1435</span>            {</div>
<div class="line"><span class="lineno"> 1436</span>                <span class="stringliteral">&quot;A&quot;</span>: [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>],</div>
<div class="line"><span class="lineno"> 1437</span>                <span class="stringliteral">&quot;B&quot;</span>: Series([<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>]).astype(<span class="stringliteral">&quot;category&quot;</span>),</div>
<div class="line"><span class="lineno"> 1438</span>                <span class="stringliteral">&quot;C&quot;</span>: [1, 2],</div>
<div class="line"><span class="lineno"> 1439</span>                <span class="stringliteral">&quot;D&quot;</span>: [1.0, 2.0],</div>
<div class="line"><span class="lineno"> 1440</span>                <span class="stringliteral">&quot;E&quot;</span>: Series([1, 2], dtype=<span class="stringliteral">&quot;uint64&quot;</span>),</div>
<div class="line"><span class="lineno"> 1441</span>                <span class="stringliteral">&quot;F&quot;</span>: Series([1, 2], dtype=<span class="stringliteral">&quot;int32&quot;</span>),</div>
<div class="line"><span class="lineno"> 1442</span>            }</div>
<div class="line"><span class="lineno"> 1443</span>        )</div>
<div class="line"><span class="lineno"> 1444</span>        right = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: right_vals})</div>
<div class="line"><span class="lineno"> 1445</span> </div>
<div class="line"><span class="lineno"> 1446</span>        <span class="comment"># GH 9780</span></div>
<div class="line"><span class="lineno"> 1447</span>        <span class="comment"># We allow merging on object and categorical cols and cast</span></div>
<div class="line"><span class="lineno"> 1448</span>        <span class="comment"># categorical cols to object</span></div>
<div class="line"><span class="lineno"> 1449</span>        result = merge(left, right, on=<span class="stringliteral">&quot;A&quot;</span>)</div>
<div class="line"><span class="lineno"> 1450</span>        <span class="keyword">assert</span> is_object_dtype(result.A.dtype)</div>
<div class="line"><span class="lineno"> 1451</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="adeb332698ea2e57418af03e1198e44c5" name="adeb332698ea2e57418af03e1198e44c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeb332698ea2e57418af03e1198e44c5">&#9670;&#160;</a></span>test_join_multi_dtypes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_join_multi_dtypes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>d2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1454</span>    <span class="keyword">def </span>test_join_multi_dtypes(self, d1, d2):</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span>        dtype1 = np.dtype(d1)</div>
<div class="line"><span class="lineno"> 1457</span>        dtype2 = np.dtype(d2)</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>        left = DataFrame(</div>
<div class="line"><span class="lineno"> 1460</span>            {</div>
<div class="line"><span class="lineno"> 1461</span>                <span class="stringliteral">&quot;k1&quot;</span>: np.array([0, 1, 2] * 8, dtype=dtype1),</div>
<div class="line"><span class="lineno"> 1462</span>                <span class="stringliteral">&quot;k2&quot;</span>: [<span class="stringliteral">&quot;foo&quot;</span>, <span class="stringliteral">&quot;bar&quot;</span>] * 12,</div>
<div class="line"><span class="lineno"> 1463</span>                <span class="stringliteral">&quot;v&quot;</span>: np.array(np.arange(24), dtype=np.int64),</div>
<div class="line"><span class="lineno"> 1464</span>            }</div>
<div class="line"><span class="lineno"> 1465</span>        )</div>
<div class="line"><span class="lineno"> 1466</span> </div>
<div class="line"><span class="lineno"> 1467</span>        index = MultiIndex.from_tuples([(2, <span class="stringliteral">&quot;bar&quot;</span>), (1, <span class="stringliteral">&quot;foo&quot;</span>)])</div>
<div class="line"><span class="lineno"> 1468</span>        right = DataFrame({<span class="stringliteral">&quot;v2&quot;</span>: np.array([5, 7], dtype=dtype2)}, index=index)</div>
<div class="line"><span class="lineno"> 1469</span> </div>
<div class="line"><span class="lineno"> 1470</span>        result = left.join(right, on=[<span class="stringliteral">&quot;k1&quot;</span>, <span class="stringliteral">&quot;k2&quot;</span>])</div>
<div class="line"><span class="lineno"> 1471</span> </div>
<div class="line"><span class="lineno"> 1472</span>        expected = left.copy()</div>
<div class="line"><span class="lineno"> 1473</span> </div>
<div class="line"><span class="lineno"> 1474</span>        <span class="keywordflow">if</span> dtype2.kind == <span class="stringliteral">&quot;i&quot;</span>:</div>
<div class="line"><span class="lineno"> 1475</span>            dtype2 = np.dtype(<span class="stringliteral">&quot;float64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1476</span>        expected[<span class="stringliteral">&quot;v2&quot;</span>] = np.array(np.nan, dtype=dtype2)</div>
<div class="line"><span class="lineno"> 1477</span>        expected.loc[(expected.k1 == 2) &amp; (expected.k2 == <span class="stringliteral">&quot;bar&quot;</span>), <span class="stringliteral">&quot;v2&quot;</span>] = 5</div>
<div class="line"><span class="lineno"> 1478</span>        expected.loc[(expected.k1 == 1) &amp; (expected.k2 == <span class="stringliteral">&quot;foo&quot;</span>), <span class="stringliteral">&quot;v2&quot;</span>] = 7</div>
<div class="line"><span class="lineno"> 1479</span> </div>
<div class="line"><span class="lineno"> 1480</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1481</span> </div>
<div class="line"><span class="lineno"> 1482</span>        result = left.join(right, on=[<span class="stringliteral">&quot;k1&quot;</span>, <span class="stringliteral">&quot;k2&quot;</span>], sort=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1483</span>        expected.sort_values([<span class="stringliteral">&quot;k1&quot;</span>, <span class="stringliteral">&quot;k2&quot;</span>], kind=<span class="stringliteral">&quot;mergesort&quot;</span>, inplace=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1484</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1485</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09c775e267734111cb32a7e781c494d" name="ad09c775e267734111cb32a7e781c494d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09c775e267734111cb32a7e781c494d">&#9670;&#160;</a></span>test_merge_bool_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_bool_dtype </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>how</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1681</span>    <span class="keyword">def </span>test_merge_bool_dtype(self, how, expected_data):</div>
<div class="line"><span class="lineno"> 1682</span>        <span class="comment"># GH#40073</span></div>
<div class="line"><span class="lineno"> 1683</span>        df1 = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [<span class="keyword">True</span>, <span class="keyword">False</span>], <span class="stringliteral">&quot;B&quot;</span>: [1, 5]})</div>
<div class="line"><span class="lineno"> 1684</span>        df2 = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [<span class="keyword">False</span>, <span class="keyword">True</span>], <span class="stringliteral">&quot;C&quot;</span>: [3, 4]})</div>
<div class="line"><span class="lineno"> 1685</span>        result = merge(df1, df2, how=how)</div>
<div class="line"><span class="lineno"> 1686</span>        expected = DataFrame(expected_data, columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>])</div>
<div class="line"><span class="lineno"> 1687</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1688</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a204e5baac436f53e934e02dd44d88f79" name="a204e5baac436f53e934e02dd44d88f79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a204e5baac436f53e934e02dd44d88f79">&#9670;&#160;</a></span>test_merge_EA_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_EA_dtype </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>any_numeric_ea_dtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>how</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1647</span>    <span class="keyword">def </span>test_merge_EA_dtype(self, any_numeric_ea_dtype, how, expected_data):</div>
<div class="line"><span class="lineno"> 1648</span>        <span class="comment"># GH#40073</span></div>
<div class="line"><span class="lineno"> 1649</span>        d1 = DataFrame([(1,)], columns=[<span class="stringliteral">&quot;id&quot;</span>], dtype=any_numeric_ea_dtype)</div>
<div class="line"><span class="lineno"> 1650</span>        d2 = DataFrame([(2,)], columns=[<span class="stringliteral">&quot;id&quot;</span>], dtype=any_numeric_ea_dtype)</div>
<div class="line"><span class="lineno"> 1651</span>        result = merge(d1, d2, how=how)</div>
<div class="line"><span class="lineno"> 1652</span>        expected = DataFrame(expected_data, columns=[<span class="stringliteral">&quot;id&quot;</span>], dtype=any_numeric_ea_dtype)</div>
<div class="line"><span class="lineno"> 1653</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1654</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac974439d3709f04b9e878386c5fdc461" name="ac974439d3709f04b9e878386c5fdc461"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac974439d3709f04b9e878386c5fdc461">&#9670;&#160;</a></span>test_merge_ea_with_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_ea_with_string </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>join_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>string_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1689</span>    <span class="keyword">def </span>test_merge_ea_with_string(self, join_type, string_dtype):</div>
<div class="line"><span class="lineno"> 1690</span>        <span class="comment"># GH 43734 Avoid the use of `assign` with multi-index</span></div>
<div class="line"><span class="lineno"> 1691</span>        df1 = DataFrame(</div>
<div class="line"><span class="lineno"> 1692</span>            data={</div>
<div class="line"><span class="lineno"> 1693</span>                (<span class="stringliteral">&quot;lvl0&quot;</span>, <span class="stringliteral">&quot;lvl1-a&quot;</span>): [<span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <span class="keywordtype">None</span>],</div>
<div class="line"><span class="lineno"> 1694</span>                (<span class="stringliteral">&quot;lvl0&quot;</span>, <span class="stringliteral">&quot;lvl1-b&quot;</span>): [<span class="stringliteral">&quot;4&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <span class="stringliteral">&quot;6&quot;</span>, <span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>],</div>
<div class="line"><span class="lineno"> 1695</span>            },</div>
<div class="line"><span class="lineno"> 1696</span>            dtype=pd.StringDtype(),</div>
<div class="line"><span class="lineno"> 1697</span>        )</div>
<div class="line"><span class="lineno"> 1698</span>        df1_copy = df1.copy()</div>
<div class="line"><span class="lineno"> 1699</span>        df2 = DataFrame(</div>
<div class="line"><span class="lineno"> 1700</span>            data={</div>
<div class="line"><span class="lineno"> 1701</span>                (<span class="stringliteral">&quot;lvl0&quot;</span>, <span class="stringliteral">&quot;lvl1-a&quot;</span>): [<span class="stringliteral">&quot;1&quot;</span>, <span class="stringliteral">&quot;2&quot;</span>, <span class="stringliteral">&quot;3&quot;</span>, pd.NA, <span class="stringliteral">&quot;5&quot;</span>],</div>
<div class="line"><span class="lineno"> 1702</span>                (<span class="stringliteral">&quot;lvl0&quot;</span>, <span class="stringliteral">&quot;lvl1-c&quot;</span>): [<span class="stringliteral">&quot;7&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>, <span class="stringliteral">&quot;9&quot;</span>, pd.NA, <span class="stringliteral">&quot;11&quot;</span>],</div>
<div class="line"><span class="lineno"> 1703</span>            },</div>
<div class="line"><span class="lineno"> 1704</span>            dtype=string_dtype,</div>
<div class="line"><span class="lineno"> 1705</span>        )</div>
<div class="line"><span class="lineno"> 1706</span>        df2_copy = df2.copy()</div>
<div class="line"><span class="lineno"> 1707</span>        merged = merge(left=df1, right=df2, on=[(<span class="stringliteral">&quot;lvl0&quot;</span>, <span class="stringliteral">&quot;lvl1-a&quot;</span>)], how=join_type)</div>
<div class="line"><span class="lineno"> 1708</span> </div>
<div class="line"><span class="lineno"> 1709</span>        <span class="comment"># No change in df1 and df2</span></div>
<div class="line"><span class="lineno"> 1710</span>        tm.assert_frame_equal(df1, df1_copy)</div>
<div class="line"><span class="lineno"> 1711</span>        tm.assert_frame_equal(df2, df2_copy)</div>
<div class="line"><span class="lineno"> 1712</span> </div>
<div class="line"><span class="lineno"> 1713</span>        <span class="comment"># Check the expected types for the merged data frame</span></div>
<div class="line"><span class="lineno"> 1714</span>        expected = Series(</div>
<div class="line"><span class="lineno"> 1715</span>            [np.dtype(<span class="stringliteral">&quot;O&quot;</span>), pd.StringDtype(), np.dtype(<span class="stringliteral">&quot;O&quot;</span>)],</div>
<div class="line"><span class="lineno"> 1716</span>            index=MultiIndex.from_tuples(</div>
<div class="line"><span class="lineno"> 1717</span>                [(<span class="stringliteral">&quot;lvl0&quot;</span>, <span class="stringliteral">&quot;lvl1-a&quot;</span>), (<span class="stringliteral">&quot;lvl0&quot;</span>, <span class="stringliteral">&quot;lvl1-b&quot;</span>), (<span class="stringliteral">&quot;lvl0&quot;</span>, <span class="stringliteral">&quot;lvl1-c&quot;</span>)]</div>
<div class="line"><span class="lineno"> 1718</span>            ),</div>
<div class="line"><span class="lineno"> 1719</span>        )</div>
<div class="line"><span class="lineno"> 1720</span>        tm.assert_series_equal(merged.dtypes, expected)</div>
<div class="line"><span class="lineno"> 1721</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a60d58fed505029348de11ce74b4e1104" name="a60d58fed505029348de11ce74b4e1104"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60d58fed505029348de11ce74b4e1104">&#9670;&#160;</a></span>test_merge_empty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_empty </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>left_empty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>how</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1737</span>    <span class="keyword">def </span>test_merge_empty(self, left_empty, how, exp):</div>
<div class="line"><span class="lineno"> 1738</span> </div>
<div class="line"><span class="lineno"> 1739</span>        left = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [2, 1], <span class="stringliteral">&quot;B&quot;</span>: [3, 4]})</div>
<div class="line"><span class="lineno"> 1740</span>        right = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [1], <span class="stringliteral">&quot;C&quot;</span>: [5]}, dtype=<span class="stringliteral">&quot;int64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span>        <span class="keywordflow">if</span> left_empty:</div>
<div class="line"><span class="lineno"> 1743</span>            left = left.head(0)</div>
<div class="line"><span class="lineno"> 1744</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1745</span>            right = right.head(0)</div>
<div class="line"><span class="lineno"> 1746</span> </div>
<div class="line"><span class="lineno"> 1747</span>        result = left.merge(right, how=how)</div>
<div class="line"><span class="lineno"> 1748</span> </div>
<div class="line"><span class="lineno"> 1749</span>        <span class="keywordflow">if</span> exp == <span class="stringliteral">&quot;left&quot;</span>:</div>
<div class="line"><span class="lineno"> 1750</span>            expected = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: [2, 1], <span class="stringliteral">&quot;B&quot;</span>: [3, 4], <span class="stringliteral">&quot;C&quot;</span>: [np.nan, np.nan]})</div>
<div class="line"><span class="lineno"> 1751</span>        <span class="keywordflow">elif</span> exp == <span class="stringliteral">&quot;right&quot;</span>:</div>
<div class="line"><span class="lineno"> 1752</span>            expected = DataFrame({<span class="stringliteral">&quot;B&quot;</span>: [np.nan], <span class="stringliteral">&quot;A&quot;</span>: [1], <span class="stringliteral">&quot;C&quot;</span>: [5]})</div>
<div class="line"><span class="lineno"> 1753</span>        <span class="keywordflow">elif</span> exp == <span class="stringliteral">&quot;empty&quot;</span>:</div>
<div class="line"><span class="lineno"> 1754</span>            expected = DataFrame(columns=[<span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>], dtype=<span class="stringliteral">&quot;int64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1755</span>            <span class="keywordflow">if</span> left_empty:</div>
<div class="line"><span class="lineno"> 1756</span>                expected = expected[[<span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;A&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>]]</div>
<div class="line"><span class="lineno"> 1757</span>        <span class="keywordflow">elif</span> exp == <span class="stringliteral">&quot;empty_cross&quot;</span>:</div>
<div class="line"><span class="lineno"> 1758</span>            expected = DataFrame(columns=[<span class="stringliteral">&quot;A_x&quot;</span>, <span class="stringliteral">&quot;B&quot;</span>, <span class="stringliteral">&quot;A_y&quot;</span>, <span class="stringliteral">&quot;C&quot;</span>], dtype=<span class="stringliteral">&quot;int64&quot;</span>)</div>
<div class="line"><span class="lineno"> 1759</span> </div>
<div class="line"><span class="lineno"> 1760</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1761</span> </div>
<div class="line"><span class="lineno"> 1762</span> </div>
<div class="line"><span class="lineno"> 1763</span><span class="preprocessor">@pytest.fixture</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a78488159d2278380206d3f6363e1d801" name="a78488159d2278380206d3f6363e1d801"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78488159d2278380206d3f6363e1d801">&#9670;&#160;</a></span>test_merge_incompat_dtypes_are_ok()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_incompat_dtypes_are_ok </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df1_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df2_vals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1577</span>    <span class="keyword">def </span>test_merge_incompat_dtypes_are_ok(self, df1_vals, df2_vals):</div>
<div class="line"><span class="lineno"> 1578</span>        <span class="comment"># these are explicitly allowed incompat merges, that pass thru</span></div>
<div class="line"><span class="lineno"> 1579</span>        <span class="comment"># the result type is dependent on if the values on the rhs are</span></div>
<div class="line"><span class="lineno"> 1580</span>        <span class="comment"># inferred, otherwise these will be coerced to object</span></div>
<div class="line"><span class="lineno"> 1581</span> </div>
<div class="line"><span class="lineno"> 1582</span>        df1 = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: df1_vals})</div>
<div class="line"><span class="lineno"> 1583</span>        df2 = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: df2_vals})</div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span>        result = merge(df1, df2, on=[<span class="stringliteral">&quot;A&quot;</span>])</div>
<div class="line"><span class="lineno"> 1586</span>        <span class="keyword">assert</span> is_object_dtype(result.A.dtype)</div>
<div class="line"><span class="lineno"> 1587</span>        result = merge(df2, df1, on=[<span class="stringliteral">&quot;A&quot;</span>])</div>
<div class="line"><span class="lineno"> 1588</span>        <span class="keyword">assert</span> is_object_dtype(result.A.dtype)</div>
<div class="line"><span class="lineno"> 1589</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f3a85017414bfcf5fa21a78e39363e4" name="a5f3a85017414bfcf5fa21a78e39363e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f3a85017414bfcf5fa21a78e39363e4">&#9670;&#160;</a></span>test_merge_incompat_dtypes_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_incompat_dtypes_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df1_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>df2_vals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1611</span>    <span class="keyword">def </span>test_merge_incompat_dtypes_error(self, df1_vals, df2_vals):</div>
<div class="line"><span class="lineno"> 1612</span>        <span class="comment"># GH 9780, GH 15800</span></div>
<div class="line"><span class="lineno"> 1613</span>        <span class="comment"># Raise a ValueError when a user tries to merge on</span></div>
<div class="line"><span class="lineno"> 1614</span>        <span class="comment"># dtypes that are incompatible (e.g., obj and int/float)</span></div>
<div class="line"><span class="lineno"> 1615</span> </div>
<div class="line"><span class="lineno"> 1616</span>        df1 = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: df1_vals})</div>
<div class="line"><span class="lineno"> 1617</span>        df2 = DataFrame({<span class="stringliteral">&quot;A&quot;</span>: df2_vals})</div>
<div class="line"><span class="lineno"> 1618</span> </div>
<div class="line"><span class="lineno"> 1619</span>        msg = (</div>
<div class="line"><span class="lineno"> 1620</span>            f<span class="stringliteral">&quot;You are trying to merge on {df1[&#39;A&#39;].dtype} and &quot;</span></div>
<div class="line"><span class="lineno"> 1621</span>            f<span class="stringliteral">&quot;{df2[&#39;A&#39;].dtype} columns. If you wish to proceed &quot;</span></div>
<div class="line"><span class="lineno"> 1622</span>            <span class="stringliteral">&quot;you should use pd.concat&quot;</span></div>
<div class="line"><span class="lineno"> 1623</span>        )</div>
<div class="line"><span class="lineno"> 1624</span>        msg = re.escape(msg)</div>
<div class="line"><span class="lineno"> 1625</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno"> 1626</span>            merge(df1, df2, on=[<span class="stringliteral">&quot;A&quot;</span>])</div>
<div class="line"><span class="lineno"> 1627</span> </div>
<div class="line"><span class="lineno"> 1628</span>        <span class="comment"># Check that error still raised when swapping order of dataframes</span></div>
<div class="line"><span class="lineno"> 1629</span>        msg = (</div>
<div class="line"><span class="lineno"> 1630</span>            f<span class="stringliteral">&quot;You are trying to merge on {df2[&#39;A&#39;].dtype} and &quot;</span></div>
<div class="line"><span class="lineno"> 1631</span>            f<span class="stringliteral">&quot;{df1[&#39;A&#39;].dtype} columns. If you wish to proceed &quot;</span></div>
<div class="line"><span class="lineno"> 1632</span>            <span class="stringliteral">&quot;you should use pd.concat&quot;</span></div>
<div class="line"><span class="lineno"> 1633</span>        )</div>
<div class="line"><span class="lineno"> 1634</span>        msg = re.escape(msg)</div>
<div class="line"><span class="lineno"> 1635</span>        <span class="keyword">with</span> pytest.raises(ValueError, match=msg):</div>
<div class="line"><span class="lineno"> 1636</span>            merge(df2, df1, on=[<span class="stringliteral">&quot;A&quot;</span>])</div>
<div class="line"><span class="lineno"> 1637</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c890e05de633fe0b8be112eab5738ec" name="a8c890e05de633fe0b8be112eab5738ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c890e05de633fe0b8be112eab5738ec">&#9670;&#160;</a></span>test_merge_incompat_infer_boolean_object()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_incompat_infer_boolean_object </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1543</span>    <span class="keyword">def </span>test_merge_incompat_infer_boolean_object(self):</div>
<div class="line"><span class="lineno"> 1544</span>        <span class="comment"># GH21119: bool + object bool merge OK</span></div>
<div class="line"><span class="lineno"> 1545</span>        df1 = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: Series([<span class="keyword">True</span>, <span class="keyword">False</span>], dtype=object)})</div>
<div class="line"><span class="lineno"> 1546</span>        df2 = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [<span class="keyword">True</span>, <span class="keyword">False</span>]})</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>        expected = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [<span class="keyword">True</span>, <span class="keyword">False</span>]}, dtype=object)</div>
<div class="line"><span class="lineno"> 1549</span>        result = merge(df1, df2, on=<span class="stringliteral">&quot;key&quot;</span>)</div>
<div class="line"><span class="lineno"> 1550</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1551</span>        result = merge(df2, df1, on=<span class="stringliteral">&quot;key&quot;</span>)</div>
<div class="line"><span class="lineno"> 1552</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1553</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8c8f48e01d8f4a5adafe1b4ed40b5aa5" name="a8c8f48e01d8f4a5adafe1b4ed40b5aa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c8f48e01d8f4a5adafe1b4ed40b5aa5">&#9670;&#160;</a></span>test_merge_incompat_infer_boolean_object_with_missing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_incompat_infer_boolean_object_with_missing </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1554</span>    <span class="keyword">def </span>test_merge_incompat_infer_boolean_object_with_missing(self):</div>
<div class="line"><span class="lineno"> 1555</span>        <span class="comment"># GH21119: bool + object bool merge OK</span></div>
<div class="line"><span class="lineno"> 1556</span>        <span class="comment"># with missing value</span></div>
<div class="line"><span class="lineno"> 1557</span>        df1 = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: Series([<span class="keyword">True</span>, <span class="keyword">False</span>, np.nan], dtype=object)})</div>
<div class="line"><span class="lineno"> 1558</span>        df2 = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [<span class="keyword">True</span>, <span class="keyword">False</span>]})</div>
<div class="line"><span class="lineno"> 1559</span> </div>
<div class="line"><span class="lineno"> 1560</span>        expected = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [<span class="keyword">True</span>, <span class="keyword">False</span>]}, dtype=object)</div>
<div class="line"><span class="lineno"> 1561</span>        result = merge(df1, df2, on=<span class="stringliteral">&quot;key&quot;</span>)</div>
<div class="line"><span class="lineno"> 1562</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1563</span>        result = merge(df2, df1, on=<span class="stringliteral">&quot;key&quot;</span>)</div>
<div class="line"><span class="lineno"> 1564</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1565</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac23b5b587b2e65a04f0c962847dc1028" name="ac23b5b587b2e65a04f0c962847dc1028"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac23b5b587b2e65a04f0c962847dc1028">&#9670;&#160;</a></span>test_merge_key_dtype_cast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_key_dtype_cast </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1508</span>    <span class="keyword">def </span>test_merge_key_dtype_cast(self):</div>
<div class="line"><span class="lineno"> 1509</span>        <span class="comment"># GH 17044</span></div>
<div class="line"><span class="lineno"> 1510</span>        df1 = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [1.0, 2.0], <span class="stringliteral">&quot;v1&quot;</span>: [10, 20]}, columns=[<span class="stringliteral">&quot;key&quot;</span>, <span class="stringliteral">&quot;v1&quot;</span>])</div>
<div class="line"><span class="lineno"> 1511</span>        df2 = DataFrame({<span class="stringliteral">&quot;key&quot;</span>: [2], <span class="stringliteral">&quot;v2&quot;</span>: [200]}, columns=[<span class="stringliteral">&quot;key&quot;</span>, <span class="stringliteral">&quot;v2&quot;</span>])</div>
<div class="line"><span class="lineno"> 1512</span>        result = df1.merge(df2, on=<span class="stringliteral">&quot;key&quot;</span>, how=<span class="stringliteral">&quot;left&quot;</span>)</div>
<div class="line"><span class="lineno"> 1513</span>        expected = DataFrame(</div>
<div class="line"><span class="lineno"> 1514</span>            {<span class="stringliteral">&quot;key&quot;</span>: [1.0, 2.0], <span class="stringliteral">&quot;v1&quot;</span>: [10, 20], <span class="stringliteral">&quot;v2&quot;</span>: [np.nan, 200.0]},</div>
<div class="line"><span class="lineno"> 1515</span>            columns=[<span class="stringliteral">&quot;key&quot;</span>, <span class="stringliteral">&quot;v1&quot;</span>, <span class="stringliteral">&quot;v2&quot;</span>],</div>
<div class="line"><span class="lineno"> 1516</span>        )</div>
<div class="line"><span class="lineno"> 1517</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1518</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afdc2f133d599d5122a163d2e2c66e54b" name="afdc2f133d599d5122a163d2e2c66e54b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdc2f133d599d5122a163d2e2c66e54b">&#9670;&#160;</a></span>test_merge_on_ints_floats()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_on_ints_floats </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>int_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>float_vals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>exp_vals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1494</span>    <span class="keyword">def </span>test_merge_on_ints_floats(self, int_vals, float_vals, exp_vals):</div>
<div class="line"><span class="lineno"> 1495</span>        <span class="comment"># GH 16572</span></div>
<div class="line"><span class="lineno"> 1496</span>        <span class="comment"># Check that float column is not cast to object if</span></div>
<div class="line"><span class="lineno"> 1497</span>        <span class="comment"># merging on float and int columns</span></div>
<div class="line"><span class="lineno"> 1498</span>        A = DataFrame({<span class="stringliteral">&quot;X&quot;</span>: int_vals})</div>
<div class="line"><span class="lineno"> 1499</span>        B = DataFrame({<span class="stringliteral">&quot;Y&quot;</span>: float_vals})</div>
<div class="line"><span class="lineno"> 1500</span>        expected = DataFrame(exp_vals)</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>        result = A.merge(B, left_on=<span class="stringliteral">&quot;X&quot;</span>, right_on=<span class="stringliteral">&quot;Y&quot;</span>)</div>
<div class="line"><span class="lineno"> 1503</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1504</span> </div>
<div class="line"><span class="lineno"> 1505</span>        result = B.merge(A, left_on=<span class="stringliteral">&quot;Y&quot;</span>, right_on=<span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><span class="lineno"> 1506</span>        tm.assert_frame_equal(result, expected[[<span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;X&quot;</span>]])</div>
<div class="line"><span class="lineno"> 1507</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ae576896888369029047c1afb3e0f158d" name="ae576896888369029047c1afb3e0f158d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae576896888369029047c1afb3e0f158d">&#9670;&#160;</a></span>test_merge_on_ints_floats_warning()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_on_ints_floats_warning </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1519</span>    <span class="keyword">def </span>test_merge_on_ints_floats_warning(self):</div>
<div class="line"><span class="lineno"> 1520</span>        <span class="comment"># GH 16572</span></div>
<div class="line"><span class="lineno"> 1521</span>        <span class="comment"># merge will produce a warning when merging on int and</span></div>
<div class="line"><span class="lineno"> 1522</span>        <span class="comment"># float columns where the float values are not exactly</span></div>
<div class="line"><span class="lineno"> 1523</span>        <span class="comment"># equal to their int representation</span></div>
<div class="line"><span class="lineno"> 1524</span>        A = DataFrame({<span class="stringliteral">&quot;X&quot;</span>: [1, 2, 3]})</div>
<div class="line"><span class="lineno"> 1525</span>        B = DataFrame({<span class="stringliteral">&quot;Y&quot;</span>: [1.1, 2.5, 3.0]})</div>
<div class="line"><span class="lineno"> 1526</span>        expected = DataFrame({<span class="stringliteral">&quot;X&quot;</span>: [3], <span class="stringliteral">&quot;Y&quot;</span>: [3.0]})</div>
<div class="line"><span class="lineno"> 1527</span> </div>
<div class="line"><span class="lineno"> 1528</span>        <span class="keyword">with</span> tm.assert_produces_warning(UserWarning):</div>
<div class="line"><span class="lineno"> 1529</span>            result = A.merge(B, left_on=<span class="stringliteral">&quot;X&quot;</span>, right_on=<span class="stringliteral">&quot;Y&quot;</span>)</div>
<div class="line"><span class="lineno"> 1530</span>            tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1531</span> </div>
<div class="line"><span class="lineno"> 1532</span>        <span class="keyword">with</span> tm.assert_produces_warning(UserWarning):</div>
<div class="line"><span class="lineno"> 1533</span>            result = B.merge(A, left_on=<span class="stringliteral">&quot;Y&quot;</span>, right_on=<span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><span class="lineno"> 1534</span>            tm.assert_frame_equal(result, expected[[<span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;X&quot;</span>]])</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>        <span class="comment"># test no warning if float has NaNs</span></div>
<div class="line"><span class="lineno"> 1537</span>        B = DataFrame({<span class="stringliteral">&quot;Y&quot;</span>: [np.nan, np.nan, 3.0]})</div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>        <span class="keyword">with</span> tm.assert_produces_warning(<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1540</span>            result = B.merge(A, left_on=<span class="stringliteral">&quot;Y&quot;</span>, right_on=<span class="stringliteral">&quot;X&quot;</span>)</div>
<div class="line"><span class="lineno"> 1541</span>            tm.assert_frame_equal(result, expected[[<span class="stringliteral">&quot;Y&quot;</span>, <span class="stringliteral">&quot;X&quot;</span>]])</div>
<div class="line"><span class="lineno"> 1542</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab16e86af1a74a08aa4e09fe295c38eb7" name="ab16e86af1a74a08aa4e09fe295c38eb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16e86af1a74a08aa4e09fe295c38eb7">&#9670;&#160;</a></span>test_merge_string_dtype()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.tests.reshape.merge.test_merge.TestMergeDtypes.test_merge_string_dtype </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>how</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>expected_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>any_string_dtype</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 1664</span>    <span class="keyword">def </span>test_merge_string_dtype(self, how, expected_data, any_string_dtype):</div>
<div class="line"><span class="lineno"> 1665</span>        <span class="comment"># GH#40073</span></div>
<div class="line"><span class="lineno"> 1666</span>        d1 = DataFrame([(<span class="stringliteral">&quot;a&quot;</span>,)], columns=[<span class="stringliteral">&quot;id&quot;</span>], dtype=any_string_dtype)</div>
<div class="line"><span class="lineno"> 1667</span>        d2 = DataFrame([(<span class="stringliteral">&quot;b&quot;</span>,)], columns=[<span class="stringliteral">&quot;id&quot;</span>], dtype=any_string_dtype)</div>
<div class="line"><span class="lineno"> 1668</span>        result = merge(d1, d2, how=how)</div>
<div class="line"><span class="lineno"> 1669</span>        expected = DataFrame(expected_data, columns=[<span class="stringliteral">&quot;id&quot;</span>], dtype=any_string_dtype)</div>
<div class="line"><span class="lineno"> 1670</span>        tm.assert_frame_equal(result, expected)</div>
<div class="line"><span class="lineno"> 1671</span> </div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/pandas/tests/reshape/merge/<a class="el" href="test__merge_8py.html">test_merge.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
