<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.core.reshape.reshape._Unstacker Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1core.html">core</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1core_1_1reshape.html">reshape</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1core_1_1reshape_1_1reshape.html">reshape</a></li><li class="navelem"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html">_Unstacker</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">pandas.core.reshape.reshape._Unstacker Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a78c5158e3d0c06e9bd274465d5fbd48c" id="r_a78c5158e3d0c06e9bd274465d5fbd48c"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a78c5158e3d0c06e9bd274465d5fbd48c">__init__</a> (self, <a class="el" href="classpandas_1_1core_1_1indexes_1_1multi_1_1_multi_index.html">MultiIndex</a> <a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a5f7bf40b4eda470f583921bccbe051f3">index</a>, <a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#af97c72c0f147d67582d59fdb95701d10">level</a>=-1, <a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a79d3989edebdee46a519c89ec8f44cb2">constructor</a>=None)</td></tr>
<tr class="separator:a78c5158e3d0c06e9bd274465d5fbd48c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c68832ff7fda6c30feaa334ef449c45" id="r_a2c68832ff7fda6c30feaa334ef449c45"><td class="memItemLeft" align="right" valign="top">list[np.ndarray]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a2c68832ff7fda6c30feaa334ef449c45">sorted_labels</a> (self)</td></tr>
<tr class="separator:a2c68832ff7fda6c30feaa334ef449c45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac879a1829bc7b6d803cb75ad16848429" id="r_ac879a1829bc7b6d803cb75ad16848429"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#ac879a1829bc7b6d803cb75ad16848429">mask_all</a> (self)</td></tr>
<tr class="separator:ac879a1829bc7b6d803cb75ad16848429"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16af2217e9ca36e3cb469a5b331b18d0" id="r_a16af2217e9ca36e3cb469a5b331b18d0"><td class="memItemLeft" align="right" valign="top">tuple[npt.NDArray[np.intp], npt.NDArray[np.bool_]]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a16af2217e9ca36e3cb469a5b331b18d0">arange_result</a> (self)</td></tr>
<tr class="separator:a16af2217e9ca36e3cb469a5b331b18d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3424ca25e6f891d0b9cf4656cbd7435c" id="r_a3424ca25e6f891d0b9cf4656cbd7435c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpandas_1_1core_1_1frame_1_1_data_frame.html">DataFrame</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a3424ca25e6f891d0b9cf4656cbd7435c">get_result</a> (self, values, value_columns, fill_value)</td></tr>
<tr class="separator:a3424ca25e6f891d0b9cf4656cbd7435c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd4d380cc648bfb31c2e839d75b842f7" id="r_afd4d380cc648bfb31c2e839d75b842f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#afd4d380cc648bfb31c2e839d75b842f7">get_new_values</a> (self, values, fill_value=None)</td></tr>
<tr class="separator:afd4d380cc648bfb31c2e839d75b842f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfd107d3d422bb513412d9c103ebd305" id="r_acfd107d3d422bb513412d9c103ebd305"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#acfd107d3d422bb513412d9c103ebd305">get_new_columns</a> (self, <a class="el" href="classpandas_1_1core_1_1indexes_1_1base_1_1_index.html">Index</a>|None value_columns)</td></tr>
<tr class="separator:acfd107d3d422bb513412d9c103ebd305"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68815b36a7564cacecdbfb09d123dac1" id="r_a68815b36a7564cacecdbfb09d123dac1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classpandas_1_1core_1_1indexes_1_1multi_1_1_multi_index.html">MultiIndex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a68815b36a7564cacecdbfb09d123dac1">new_index</a> (self)</td></tr>
<tr class="separator:a68815b36a7564cacecdbfb09d123dac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a79d3989edebdee46a519c89ec8f44cb2" id="r_a79d3989edebdee46a519c89ec8f44cb2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a79d3989edebdee46a519c89ec8f44cb2">constructor</a></td></tr>
<tr class="separator:a79d3989edebdee46a519c89ec8f44cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7bf40b4eda470f583921bccbe051f3" id="r_a5f7bf40b4eda470f583921bccbe051f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a5f7bf40b4eda470f583921bccbe051f3">index</a></td></tr>
<tr class="separator:a5f7bf40b4eda470f583921bccbe051f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97c72c0f147d67582d59fdb95701d10" id="r_af97c72c0f147d67582d59fdb95701d10"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#af97c72c0f147d67582d59fdb95701d10">level</a></td></tr>
<tr class="separator:af97c72c0f147d67582d59fdb95701d10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a932d4c62d069c20aa6190441603d7ead" id="r_a932d4c62d069c20aa6190441603d7ead"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a932d4c62d069c20aa6190441603d7ead">lift</a></td></tr>
<tr class="separator:a932d4c62d069c20aa6190441603d7ead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a238f0075d4b444ab3b67c134d2fed26b" id="r_a238f0075d4b444ab3b67c134d2fed26b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a238f0075d4b444ab3b67c134d2fed26b">new_index_levels</a></td></tr>
<tr class="separator:a238f0075d4b444ab3b67c134d2fed26b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd4f5e19b082d77e1e61a362f87afeaa" id="r_afd4f5e19b082d77e1e61a362f87afeaa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#afd4f5e19b082d77e1e61a362f87afeaa">new_index_names</a></td></tr>
<tr class="separator:afd4f5e19b082d77e1e61a362f87afeaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa10f4718276e78caa8a27cb40768e27" id="r_afa10f4718276e78caa8a27cb40768e27"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#afa10f4718276e78caa8a27cb40768e27">removed_name</a></td></tr>
<tr class="separator:afa10f4718276e78caa8a27cb40768e27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a473a26bfbebb3a5c5fd89c1b97a47001" id="r_a473a26bfbebb3a5c5fd89c1b97a47001"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a473a26bfbebb3a5c5fd89c1b97a47001">removed_level</a></td></tr>
<tr class="separator:a473a26bfbebb3a5c5fd89c1b97a47001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93ae4ebf5ae0391df0b00c496cedea1" id="r_aa93ae4ebf5ae0391df0b00c496cedea1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#aa93ae4ebf5ae0391df0b00c496cedea1">removed_level_full</a></td></tr>
<tr class="separator:aa93ae4ebf5ae0391df0b00c496cedea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2365a0454c469327fd512b5a5436cafc" id="r_a2365a0454c469327fd512b5a5436cafc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a2365a0454c469327fd512b5a5436cafc">full_shape</a></td></tr>
<tr class="separator:a2365a0454c469327fd512b5a5436cafc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e0beee8bf3a19e8c76f35b051a7a179" id="r_a0e0beee8bf3a19e8c76f35b051a7a179"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a0e0beee8bf3a19e8c76f35b051a7a179">group_index</a></td></tr>
<tr class="separator:a0e0beee8bf3a19e8c76f35b051a7a179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40216f8338ddba5bc0ba8fe9ed576877" id="r_a40216f8338ddba5bc0ba8fe9ed576877"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a40216f8338ddba5bc0ba8fe9ed576877">mask</a></td></tr>
<tr class="separator:a40216f8338ddba5bc0ba8fe9ed576877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f1ab98cc3cc2de8dd4c4d67fb282af7" id="r_a1f1ab98cc3cc2de8dd4c4d67fb282af7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a1f1ab98cc3cc2de8dd4c4d67fb282af7">compressor</a></td></tr>
<tr class="separator:a1f1ab98cc3cc2de8dd4c4d67fb282af7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a9945a692a49abbbb53e2d01c065b0ecd" id="r_a9945a692a49abbbb53e2d01c065b0ecd"><td class="memItemLeft" align="right" valign="top">tuple[ npt.NDArray[np.intp], list[np.ndarray], # each has _some_ signed integer dtype]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a9945a692a49abbbb53e2d01c065b0ecd">_indexer_and_to_sort</a> (self)</td></tr>
<tr class="separator:a9945a692a49abbbb53e2d01c065b0ecd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b16210fe81cdab6b60e17c1bf0ceae8" id="r_a9b16210fe81cdab6b60e17c1bf0ceae8"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a9b16210fe81cdab6b60e17c1bf0ceae8">_make_sorted_values</a> (self, np.ndarray values)</td></tr>
<tr class="separator:a9b16210fe81cdab6b60e17c1bf0ceae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66d20067cb44f6e75dd00a56ff7c6383" id="r_a66d20067cb44f6e75dd00a56ff7c6383"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#a66d20067cb44f6e75dd00a56ff7c6383">_make_selectors</a> (self)</td></tr>
<tr class="separator:a66d20067cb44f6e75dd00a56ff7c6383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadd559c24ab28cf5cbc04a85ce1b7da1" id="r_aadd559c24ab28cf5cbc04a85ce1b7da1"><td class="memItemLeft" align="right" valign="top">np.ndarray&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1reshape_1_1reshape_1_1___unstacker.html#aadd559c24ab28cf5cbc04a85ce1b7da1">_repeater</a> (self)</td></tr>
<tr class="separator:aadd559c24ab28cf5cbc04a85ce1b7da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Helper class to unstack data / pivot with multi-level index

Parameters
----------
index : MultiIndex
level : int or str, default last level
    Level to "unstack". Accepts a name for the level.
fill_value : scalar, optional
    Default value to fill in missing values if subgroups do not have the
    same set of labels. By default, missing values will be replaced with
    the default fill value for that data type, NaN for float, NaT for
    datetimelike, etc. For integer types, by default data will converted to
    float and missing values will be set to NaN.
constructor : object
    Pandas ``DataFrame`` or subclass used to create unstacked
    response.  If None, DataFrame will be used.

Examples
--------
&gt;&gt;&gt; index = pd.MultiIndex.from_tuples([('one', 'a'), ('one', 'b'),
...                                    ('two', 'a'), ('two', 'b')])
&gt;&gt;&gt; s = pd.Series(np.arange(1, 5, dtype=np.int64), index=index)
&gt;&gt;&gt; s
one  a    1
     b    2
two  a    3
     b    4
dtype: int64

&gt;&gt;&gt; s.unstack(level=-1)
     a  b
one  1  2
two  3  4

&gt;&gt;&gt; s.unstack(level=0)
   one  two
a    1    3
b    2    4

Returns
-------
unstacked : DataFrame
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a78c5158e3d0c06e9bd274465d5fbd48c" name="a78c5158e3d0c06e9bd274465d5fbd48c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78c5158e3d0c06e9bd274465d5fbd48c">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None pandas.core.reshape.reshape._Unstacker.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpandas_1_1core_1_1indexes_1_1multi_1_1_multi_index.html">MultiIndex</a>&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>level</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>constructor</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   97</span>    <span class="keyword">def </span>__init__(self, index: MultiIndex, level=-1, constructor=<span class="keywordtype">None</span>) -&gt; <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>        <span class="keywordflow">if</span> constructor <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  100</span>            constructor = DataFrame</div>
<div class="line"><span class="lineno">  101</span>        self.constructor = constructor</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>        self.index = index.remove_unused_levels()</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>        self.level = self.index._get_level_number(level)</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>        <span class="comment"># when index includes `nan`, need to lift levels/strides by 1</span></div>
<div class="line"><span class="lineno">  108</span>        self.lift = 1 <span class="keywordflow">if</span> -1 <span class="keywordflow">in</span> self.index.codes[self.level] <span class="keywordflow">else</span> 0</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>        <span class="comment"># Note: the &quot;pop&quot; below alters these in-place.</span></div>
<div class="line"><span class="lineno">  111</span>        self.new_index_levels = list(self.index.levels)</div>
<div class="line"><span class="lineno">  112</span>        self.new_index_names = list(self.index.names)</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>        self.removed_name = self.new_index_names.pop(self.level)</div>
<div class="line"><span class="lineno">  115</span>        self.removed_level = self.new_index_levels.pop(self.level)</div>
<div class="line"><span class="lineno">  116</span>        self.removed_level_full = index.levels[self.level]</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>        <span class="comment"># Bug fix GH 20601</span></div>
<div class="line"><span class="lineno">  119</span>        <span class="comment"># If the data frame is too big, the number of unique index combination</span></div>
<div class="line"><span class="lineno">  120</span>        <span class="comment"># will cause int32 overflow on windows environments.</span></div>
<div class="line"><span class="lineno">  121</span>        <span class="comment"># We want to check and raise an error before this happens</span></div>
<div class="line"><span class="lineno">  122</span>        num_rows = np.max([index_level.size <span class="keywordflow">for</span> index_level <span class="keywordflow">in</span> self.new_index_levels])</div>
<div class="line"><span class="lineno">  123</span>        num_columns = self.removed_level.size</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>        <span class="comment"># GH20601: This forces an overflow if the number of cells is too high.</span></div>
<div class="line"><span class="lineno">  126</span>        num_cells = num_rows * num_columns</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>        <span class="comment"># GH 26314: Previous ValueError raised was too restrictive for many users.</span></div>
<div class="line"><span class="lineno">  129</span>        <span class="keywordflow">if</span> num_cells &gt; np.iinfo(np.int32).max:</div>
<div class="line"><span class="lineno">  130</span>            warnings.warn(</div>
<div class="line"><span class="lineno">  131</span>                f<span class="stringliteral">&quot;The following operation may generate {num_cells} cells &quot;</span></div>
<div class="line"><span class="lineno">  132</span>                f<span class="stringliteral">&quot;in the resulting pandas object.&quot;</span>,</div>
<div class="line"><span class="lineno">  133</span>                PerformanceWarning,</div>
<div class="line"><span class="lineno">  134</span>                stacklevel=find_stack_level(),</div>
<div class="line"><span class="lineno">  135</span>            )</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>        self._make_selectors()</div>
<div class="line"><span class="lineno">  138</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9945a692a49abbbb53e2d01c065b0ecd" name="a9945a692a49abbbb53e2d01c065b0ecd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9945a692a49abbbb53e2d01c065b0ecd">&#9670;&#160;</a></span>_indexer_and_to_sort()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[
        npt.NDArray[np.intp],
        list[np.ndarray],  # each has _some_ signed integer dtype
    ] pandas.core.reshape.reshape._Unstacker._indexer_and_to_sort </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  145</span>    ]:</div>
<div class="line"><span class="lineno">  146</span>        v = self.level</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>        codes = list(self.index.codes)</div>
<div class="line"><span class="lineno">  149</span>        levs = list(self.index.levels)</div>
<div class="line"><span class="lineno">  150</span>        to_sort = codes[:v] + codes[v + 1 :] + [codes[v]]</div>
<div class="line"><span class="lineno">  151</span>        sizes = tuple(len(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> levs[:v] + levs[v + 1 :] + [levs[v]])</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>        comp_index, obs_ids = get_compressed_ids(to_sort, sizes)</div>
<div class="line"><span class="lineno">  154</span>        ngroups = len(obs_ids)</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>        indexer = get_group_index_sorter(comp_index, ngroups)</div>
<div class="line"><span class="lineno">  157</span>        <span class="keywordflow">return</span> indexer, to_sort</div>
<div class="line"><span class="lineno">  158</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a66d20067cb44f6e75dd00a56ff7c6383" name="a66d20067cb44f6e75dd00a56ff7c6383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66d20067cb44f6e75dd00a56ff7c6383">&#9670;&#160;</a></span>_make_selectors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker._make_selectors </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  170</span>    <span class="keyword">def </span>_make_selectors(self):</div>
<div class="line"><span class="lineno">  171</span>        new_levels = self.new_index_levels</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>        <span class="comment"># make the mask</span></div>
<div class="line"><span class="lineno">  174</span>        remaining_labels = self.sorted_labels[:-1]</div>
<div class="line"><span class="lineno">  175</span>        level_sizes = tuple(len(x) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> new_levels)</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>        comp_index, obs_ids = get_compressed_ids(remaining_labels, level_sizes)</div>
<div class="line"><span class="lineno">  178</span>        ngroups = len(obs_ids)</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>        comp_index = ensure_platform_int(comp_index)</div>
<div class="line"><span class="lineno">  181</span>        stride = self.index.levshape[self.level] + self.lift</div>
<div class="line"><span class="lineno">  182</span>        self.full_shape = ngroups, stride</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>        selector = self.sorted_labels[-1] + stride * comp_index + self.lift</div>
<div class="line"><span class="lineno">  185</span>        mask = np.zeros(np.prod(self.full_shape), dtype=bool)</div>
<div class="line"><span class="lineno">  186</span>        mask.put(selector, <span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">if</span> mask.sum() &lt; len(self.index):</div>
<div class="line"><span class="lineno">  189</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Index contains duplicate entries, cannot reshape&quot;</span>)</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>        self.group_index = comp_index</div>
<div class="line"><span class="lineno">  192</span>        self.mask = mask</div>
<div class="line"><span class="lineno">  193</span>        self.compressor = comp_index.searchsorted(np.arange(ngroups))</div>
<div class="line"><span class="lineno">  194</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b16210fe81cdab6b60e17c1bf0ceae8" name="a9b16210fe81cdab6b60e17c1bf0ceae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b16210fe81cdab6b60e17c1bf0ceae8">&#9670;&#160;</a></span>_make_sorted_values()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray pandas.core.reshape.reshape._Unstacker._make_sorted_values </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">np.ndarray&#160;</td>
          <td class="paramname"><em>values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  164</span>    <span class="keyword">def </span>_make_sorted_values(self, values: np.ndarray) -&gt; np.ndarray:</div>
<div class="line"><span class="lineno">  165</span>        indexer, _ = self._indexer_and_to_sort</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>        sorted_values = algos.take_nd(values, indexer, axis=0)</div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">return</span> sorted_values</div>
<div class="line"><span class="lineno">  169</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aadd559c24ab28cf5cbc04a85ce1b7da1" name="aadd559c24ab28cf5cbc04a85ce1b7da1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadd559c24ab28cf5cbc04a85ce1b7da1">&#9670;&#160;</a></span>_repeater()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> np.ndarray pandas.core.reshape.reshape._Unstacker._repeater </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  339</span>    <span class="keyword">def </span>_repeater(self) -&gt; np.ndarray:</div>
<div class="line"><span class="lineno">  340</span>        <span class="comment"># The two indices differ only if the unstacked level had unused items:</span></div>
<div class="line"><span class="lineno">  341</span>        <span class="keywordflow">if</span> len(self.removed_level_full) != len(self.removed_level):</div>
<div class="line"><span class="lineno">  342</span>            <span class="comment"># In this case, we remap the new codes to the original level:</span></div>
<div class="line"><span class="lineno">  343</span>            repeater = self.removed_level_full.get_indexer(self.removed_level)</div>
<div class="line"><span class="lineno">  344</span>            <span class="keywordflow">if</span> self.lift:</div>
<div class="line"><span class="lineno">  345</span>                repeater = np.insert(repeater, 0, -1)</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  347</span>            <span class="comment"># Otherwise, we just use each level item exactly once:</span></div>
<div class="line"><span class="lineno">  348</span>            stride = len(self.removed_level) + self.lift</div>
<div class="line"><span class="lineno">  349</span>            repeater = np.arange(stride) - self.lift</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>        <span class="keywordflow">return</span> repeater</div>
<div class="line"><span class="lineno">  352</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a16af2217e9ca36e3cb469a5b331b18d0" name="a16af2217e9ca36e3cb469a5b331b18d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16af2217e9ca36e3cb469a5b331b18d0">&#9670;&#160;</a></span>arange_result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[npt.NDArray[np.intp], npt.NDArray[np.bool_]] pandas.core.reshape.reshape._Unstacker.arange_result </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  200</span>    <span class="keyword">def </span>arange_result(self) -&gt; tuple[npt.NDArray[np.intp], npt.NDArray[np.bool_]]:</div>
<div class="line"><span class="lineno">  201</span>        <span class="comment"># We cache this for re-use in ExtensionBlock._unstack</span></div>
<div class="line"><span class="lineno">  202</span>        dummy_arr = np.arange(len(self.index), dtype=np.intp)</div>
<div class="line"><span class="lineno">  203</span>        new_values, mask = self.get_new_values(dummy_arr, fill_value=-1)</div>
<div class="line"><span class="lineno">  204</span>        <span class="keywordflow">return</span> new_values, mask.any(0)</div>
<div class="line"><span class="lineno">  205</span>        <span class="comment"># TODO: in all tests we have mask.any(0).all(); can we rely on that?</span></div>
<div class="line"><span class="lineno">  206</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="acfd107d3d422bb513412d9c103ebd305" name="acfd107d3d422bb513412d9c103ebd305"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfd107d3d422bb513412d9c103ebd305">&#9670;&#160;</a></span>get_new_columns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.get_new_columns </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classpandas_1_1core_1_1indexes_1_1base_1_1_index.html">Index</a> | None&#160;</td>
          <td class="paramname"><em>value_columns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  303</span>    <span class="keyword">def </span>get_new_columns(self, value_columns: Index | <span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  304</span>        <span class="keywordflow">if</span> value_columns <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  305</span>            <span class="keywordflow">if</span> self.lift == 0:</div>
<div class="line"><span class="lineno">  306</span>                <span class="keywordflow">return</span> self.removed_level._rename(name=self.removed_name)</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>            lev = self.removed_level.insert(0, item=self.removed_level._na_value)</div>
<div class="line"><span class="lineno">  309</span>            <span class="keywordflow">return</span> lev.rename(self.removed_name)</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>        stride = len(self.removed_level) + self.lift</div>
<div class="line"><span class="lineno">  312</span>        width = len(value_columns)</div>
<div class="line"><span class="lineno">  313</span>        propagator = np.repeat(np.arange(width), stride)</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>        new_levels: FrozenList | list[Index]</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>        <span class="keywordflow">if</span> isinstance(value_columns, MultiIndex):</div>
<div class="line"><span class="lineno">  318</span>            new_levels = value_columns.levels + (self.removed_level_full,)</div>
<div class="line"><span class="lineno">  319</span>            new_names = value_columns.names + (self.removed_name,)</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>            new_codes = [lab.take(propagator) <span class="keywordflow">for</span> lab <span class="keywordflow">in</span> value_columns.codes]</div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  323</span>            new_levels = [</div>
<div class="line"><span class="lineno">  324</span>                value_columns,</div>
<div class="line"><span class="lineno">  325</span>                self.removed_level_full,</div>
<div class="line"><span class="lineno">  326</span>            ]</div>
<div class="line"><span class="lineno">  327</span>            new_names = [value_columns.name, self.removed_name]</div>
<div class="line"><span class="lineno">  328</span>            new_codes = [propagator]</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>        repeater = self._repeater</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>        <span class="comment"># The entire level is then just a repetition of the single chunk:</span></div>
<div class="line"><span class="lineno">  333</span>        new_codes.append(np.tile(repeater, width))</div>
<div class="line"><span class="lineno">  334</span>        <span class="keywordflow">return</span> MultiIndex(</div>
<div class="line"><span class="lineno">  335</span>            levels=new_levels, codes=new_codes, names=new_names, verify_integrity=<span class="keyword">False</span></div>
<div class="line"><span class="lineno">  336</span>        )</div>
<div class="line"><span class="lineno">  337</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="afd4d380cc648bfb31c2e839d75b842f7" name="afd4d380cc648bfb31c2e839d75b842f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd4d380cc648bfb31c2e839d75b842f7">&#9670;&#160;</a></span>get_new_values()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.get_new_values </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fill_value</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  223</span>    <span class="keyword">def </span>get_new_values(self, values, fill_value=None):</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>        <span class="keywordflow">if</span> values.ndim == 1:</div>
<div class="line"><span class="lineno">  226</span>            values = values[:, np.newaxis]</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>        sorted_values = self._make_sorted_values(values)</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>        <span class="comment"># place the values</span></div>
<div class="line"><span class="lineno">  231</span>        length, width = self.full_shape</div>
<div class="line"><span class="lineno">  232</span>        stride = values.shape[1]</div>
<div class="line"><span class="lineno">  233</span>        result_width = width * stride</div>
<div class="line"><span class="lineno">  234</span>        result_shape = (length, result_width)</div>
<div class="line"><span class="lineno">  235</span>        mask = self.mask</div>
<div class="line"><span class="lineno">  236</span>        mask_all = self.mask_all</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>        <span class="comment"># we can simply reshape if we don&#39;t have a mask</span></div>
<div class="line"><span class="lineno">  239</span>        <span class="keywordflow">if</span> mask_all <span class="keywordflow">and</span> len(values):</div>
<div class="line"><span class="lineno">  240</span>            <span class="comment"># TODO: Under what circumstances can we rely on sorted_values</span></div>
<div class="line"><span class="lineno">  241</span>            <span class="comment">#  matching values?  When that holds, we can slice instead</span></div>
<div class="line"><span class="lineno">  242</span>            <span class="comment">#  of take (in particular for EAs)</span></div>
<div class="line"><span class="lineno">  243</span>            new_values = (</div>
<div class="line"><span class="lineno">  244</span>                sorted_values.reshape(length, width, stride)</div>
<div class="line"><span class="lineno">  245</span>                .swapaxes(1, 2)</div>
<div class="line"><span class="lineno">  246</span>                .reshape(result_shape)</div>
<div class="line"><span class="lineno">  247</span>            )</div>
<div class="line"><span class="lineno">  248</span>            new_mask = np.ones(result_shape, dtype=bool)</div>
<div class="line"><span class="lineno">  249</span>            <span class="keywordflow">return</span> new_values, new_mask</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>        dtype = values.dtype</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>        <span class="comment"># if our mask is all True, then we can use our existing dtype</span></div>
<div class="line"><span class="lineno">  254</span>        <span class="keywordflow">if</span> mask_all:</div>
<div class="line"><span class="lineno">  255</span>            dtype = values.dtype</div>
<div class="line"><span class="lineno">  256</span>            new_values = np.empty(result_shape, dtype=dtype)</div>
<div class="line"><span class="lineno">  257</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  258</span>            <span class="keywordflow">if</span> isinstance(dtype, ExtensionDtype):</div>
<div class="line"><span class="lineno">  259</span>                <span class="comment"># GH#41875</span></div>
<div class="line"><span class="lineno">  260</span>                <span class="comment"># We are assuming that fill_value can be held by this dtype,</span></div>
<div class="line"><span class="lineno">  261</span>                <span class="comment">#  unlike the non-EA case that promotes.</span></div>
<div class="line"><span class="lineno">  262</span>                cls = dtype.construct_array_type()</div>
<div class="line"><span class="lineno">  263</span>                new_values = cls._empty(result_shape, dtype=dtype)</div>
<div class="line"><span class="lineno">  264</span>                new_values[:] = fill_value</div>
<div class="line"><span class="lineno">  265</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  266</span>                dtype, fill_value = maybe_promote(dtype, fill_value)</div>
<div class="line"><span class="lineno">  267</span>                new_values = np.empty(result_shape, dtype=dtype)</div>
<div class="line"><span class="lineno">  268</span>                new_values.fill(fill_value)</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>        name = dtype.name</div>
<div class="line"><span class="lineno">  271</span>        new_mask = np.zeros(result_shape, dtype=bool)</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>        <span class="comment"># we need to convert to a basic dtype</span></div>
<div class="line"><span class="lineno">  274</span>        <span class="comment"># and possibly coerce an input to our output dtype</span></div>
<div class="line"><span class="lineno">  275</span>        <span class="comment"># e.g. ints -&gt; floats</span></div>
<div class="line"><span class="lineno">  276</span>        <span class="keywordflow">if</span> needs_i8_conversion(values.dtype):</div>
<div class="line"><span class="lineno">  277</span>            sorted_values = sorted_values.view(<span class="stringliteral">&quot;i8&quot;</span>)</div>
<div class="line"><span class="lineno">  278</span>            new_values = new_values.view(<span class="stringliteral">&quot;i8&quot;</span>)</div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  280</span>            sorted_values = sorted_values.astype(name, copy=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>        <span class="comment"># fill in our values &amp; mask</span></div>
<div class="line"><span class="lineno">  283</span>        libreshape.unstack(</div>
<div class="line"><span class="lineno">  284</span>            sorted_values,</div>
<div class="line"><span class="lineno">  285</span>            mask.view(<span class="stringliteral">&quot;u1&quot;</span>),</div>
<div class="line"><span class="lineno">  286</span>            stride,</div>
<div class="line"><span class="lineno">  287</span>            length,</div>
<div class="line"><span class="lineno">  288</span>            width,</div>
<div class="line"><span class="lineno">  289</span>            new_values,</div>
<div class="line"><span class="lineno">  290</span>            new_mask.view(<span class="stringliteral">&quot;u1&quot;</span>),</div>
<div class="line"><span class="lineno">  291</span>        )</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>        <span class="comment"># reconstruct dtype if needed</span></div>
<div class="line"><span class="lineno">  294</span>        <span class="keywordflow">if</span> needs_i8_conversion(values.dtype):</div>
<div class="line"><span class="lineno">  295</span>            <span class="comment"># view as datetime64 so we can wrap in DatetimeArray and use</span></div>
<div class="line"><span class="lineno">  296</span>            <span class="comment">#  DTA&#39;s view method</span></div>
<div class="line"><span class="lineno">  297</span>            new_values = new_values.view(<span class="stringliteral">&quot;M8[ns]&quot;</span>)</div>
<div class="line"><span class="lineno">  298</span>            new_values = ensure_wrapped_if_datetimelike(new_values)</div>
<div class="line"><span class="lineno">  299</span>            new_values = new_values.view(values.dtype)</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>        <span class="keywordflow">return</span> new_values, new_mask</div>
<div class="line"><span class="lineno">  302</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a3424ca25e6f891d0b9cf4656cbd7435c" name="a3424ca25e6f891d0b9cf4656cbd7435c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3424ca25e6f891d0b9cf4656cbd7435c">&#9670;&#160;</a></span>get_result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> <a class="el" href="classpandas_1_1core_1_1frame_1_1_data_frame.html">DataFrame</a> pandas.core.reshape.reshape._Unstacker.get_result </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>value_columns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fill_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  207</span>    <span class="keyword">def </span>get_result(self, values, value_columns, fill_value) -&gt; DataFrame:</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>        <span class="keywordflow">if</span> values.ndim == 1:</div>
<div class="line"><span class="lineno">  210</span>            values = values[:, np.newaxis]</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">if</span> value_columns <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> values.shape[1] != 1:  <span class="comment"># pragma: no cover</span></div>
<div class="line"><span class="lineno">  213</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;must pass column labels for multi-column data&quot;</span>)</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>        values, _ = self.get_new_values(values, fill_value)</div>
<div class="line"><span class="lineno">  216</span>        columns = self.get_new_columns(value_columns)</div>
<div class="line"><span class="lineno">  217</span>        index = self.new_index</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>        <span class="keywordflow">return</span> self.constructor(</div>
<div class="line"><span class="lineno">  220</span>            values, index=index, columns=columns, dtype=values.dtype</div>
<div class="line"><span class="lineno">  221</span>        )</div>
<div class="line"><span class="lineno">  222</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac879a1829bc7b6d803cb75ad16848429" name="ac879a1829bc7b6d803cb75ad16848429"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac879a1829bc7b6d803cb75ad16848429">&#9670;&#160;</a></span>mask_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool pandas.core.reshape.reshape._Unstacker.mask_all </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  196</span>    <span class="keyword">def </span>mask_all(self) -&gt; bool:</div>
<div class="line"><span class="lineno">  197</span>        <span class="keywordflow">return</span> bool(self.mask.all())</div>
<div class="line"><span class="lineno">  198</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a68815b36a7564cacecdbfb09d123dac1" name="a68815b36a7564cacecdbfb09d123dac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68815b36a7564cacecdbfb09d123dac1">&#9670;&#160;</a></span>new_index()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> <a class="el" href="classpandas_1_1core_1_1indexes_1_1multi_1_1_multi_index.html">MultiIndex</a> pandas.core.reshape.reshape._Unstacker.new_index </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  354</span>    <span class="keyword">def </span>new_index(self) -&gt; MultiIndex:</div>
<div class="line"><span class="lineno">  355</span>        <span class="comment"># Does not depend on values or value_columns</span></div>
<div class="line"><span class="lineno">  356</span>        result_codes = [lab.take(self.compressor) <span class="keywordflow">for</span> lab <span class="keywordflow">in</span> self.sorted_labels[:-1]]</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>        <span class="comment"># construct the new index</span></div>
<div class="line"><span class="lineno">  359</span>        <span class="keywordflow">if</span> len(self.new_index_levels) == 1:</div>
<div class="line"><span class="lineno">  360</span>            level, level_codes = self.new_index_levels[0], result_codes[0]</div>
<div class="line"><span class="lineno">  361</span>            <span class="keywordflow">if</span> (level_codes == -1).any():</div>
<div class="line"><span class="lineno">  362</span>                level = level.insert(len(level), level._na_value)</div>
<div class="line"><span class="lineno">  363</span>            <span class="keywordflow">return</span> level.take(level_codes).rename(self.new_index_names[0])</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>        <span class="keywordflow">return</span> MultiIndex(</div>
<div class="line"><span class="lineno">  366</span>            levels=self.new_index_levels,</div>
<div class="line"><span class="lineno">  367</span>            codes=result_codes,</div>
<div class="line"><span class="lineno">  368</span>            names=self.new_index_names,</div>
<div class="line"><span class="lineno">  369</span>            verify_integrity=<span class="keyword">False</span>,</div>
<div class="line"><span class="lineno">  370</span>        )</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c68832ff7fda6c30feaa334ef449c45" name="a2c68832ff7fda6c30feaa334ef449c45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c68832ff7fda6c30feaa334ef449c45">&#9670;&#160;</a></span>sorted_labels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> list[np.ndarray] pandas.core.reshape.reshape._Unstacker.sorted_labels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  160</span>    <span class="keyword">def </span>sorted_labels(self) -&gt; list[np.ndarray]:</div>
<div class="line"><span class="lineno">  161</span>        indexer, to_sort = self._indexer_and_to_sort</div>
<div class="line"><span class="lineno">  162</span>        <span class="keywordflow">return</span> [line.take(indexer) <span class="keywordflow">for</span> line <span class="keywordflow">in</span> to_sort]</div>
<div class="line"><span class="lineno">  163</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1f1ab98cc3cc2de8dd4c4d67fb282af7" name="a1f1ab98cc3cc2de8dd4c4d67fb282af7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f1ab98cc3cc2de8dd4c4d67fb282af7">&#9670;&#160;</a></span>compressor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.compressor</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a79d3989edebdee46a519c89ec8f44cb2" name="a79d3989edebdee46a519c89ec8f44cb2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a79d3989edebdee46a519c89ec8f44cb2">&#9670;&#160;</a></span>constructor</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.constructor</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2365a0454c469327fd512b5a5436cafc" name="a2365a0454c469327fd512b5a5436cafc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2365a0454c469327fd512b5a5436cafc">&#9670;&#160;</a></span>full_shape</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.full_shape</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0e0beee8bf3a19e8c76f35b051a7a179" name="a0e0beee8bf3a19e8c76f35b051a7a179"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e0beee8bf3a19e8c76f35b051a7a179">&#9670;&#160;</a></span>group_index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.group_index</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5f7bf40b4eda470f583921bccbe051f3" name="a5f7bf40b4eda470f583921bccbe051f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f7bf40b4eda470f583921bccbe051f3">&#9670;&#160;</a></span>index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.index</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af97c72c0f147d67582d59fdb95701d10" name="af97c72c0f147d67582d59fdb95701d10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af97c72c0f147d67582d59fdb95701d10">&#9670;&#160;</a></span>level</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.level</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a932d4c62d069c20aa6190441603d7ead" name="a932d4c62d069c20aa6190441603d7ead"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a932d4c62d069c20aa6190441603d7ead">&#9670;&#160;</a></span>lift</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.lift</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a40216f8338ddba5bc0ba8fe9ed576877" name="a40216f8338ddba5bc0ba8fe9ed576877"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40216f8338ddba5bc0ba8fe9ed576877">&#9670;&#160;</a></span>mask</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.mask</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a238f0075d4b444ab3b67c134d2fed26b" name="a238f0075d4b444ab3b67c134d2fed26b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a238f0075d4b444ab3b67c134d2fed26b">&#9670;&#160;</a></span>new_index_levels</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.new_index_levels</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afd4f5e19b082d77e1e61a362f87afeaa" name="afd4f5e19b082d77e1e61a362f87afeaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd4f5e19b082d77e1e61a362f87afeaa">&#9670;&#160;</a></span>new_index_names</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.new_index_names</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a473a26bfbebb3a5c5fd89c1b97a47001" name="a473a26bfbebb3a5c5fd89c1b97a47001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a473a26bfbebb3a5c5fd89c1b97a47001">&#9670;&#160;</a></span>removed_level</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.removed_level</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa93ae4ebf5ae0391df0b00c496cedea1" name="aa93ae4ebf5ae0391df0b00c496cedea1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa93ae4ebf5ae0391df0b00c496cedea1">&#9670;&#160;</a></span>removed_level_full</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.removed_level_full</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afa10f4718276e78caa8a27cb40768e27" name="afa10f4718276e78caa8a27cb40768e27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa10f4718276e78caa8a27cb40768e27">&#9670;&#160;</a></span>removed_name</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.reshape.reshape._Unstacker.removed_name</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/rafael/Documents/GitHub/PUC-GCES-PY/Tp-GCS-Rafael-Augusto/venv/lib/python3.9/site-packages/pandas/core/reshape/<a class="el" href="reshape_8py.html">reshape.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
