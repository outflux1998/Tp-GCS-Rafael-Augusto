<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: sklearn.manifold._mds Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesklearn.html">sklearn</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1manifold.html">manifold</a></li><li class="navelem"><a class="el" href="namespacesklearn_1_1manifold_1_1__mds.html">_mds</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">sklearn.manifold._mds Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsklearn_1_1manifold_1_1__mds_1_1_m_d_s.html">MDS</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7955d15af1baf10a4d95c20d8b81885b" id="r_a7955d15af1baf10a4d95c20d8b81885b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1manifold_1_1__mds.html#a7955d15af1baf10a4d95c20d8b81885b">_smacof_single</a> (dissimilarities, metric=True, n_components=2, init=None, max_iter=300, verbose=0, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=1e-3, random_state=None, normalized_stress=False)</td></tr>
<tr class="separator:a7955d15af1baf10a4d95c20d8b81885b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98cafb6881af62ad86c49a7ef4015943" id="r_a98cafb6881af62ad86c49a7ef4015943"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacesklearn_1_1manifold_1_1__mds.html#a98cafb6881af62ad86c49a7ef4015943">smacof</a> (dissimilarities, *metric=True, n_components=2, init=None, n_init=8, n_jobs=None, max_iter=300, verbose=0, <a class="el" href="__lapack__subroutines_8h.html#a57833d05f43fd1408080af6eec88fc43">eps</a>=1e-3, random_state=None, return_n_iter=False, normalized_stress=&quot;warn&quot;)</td></tr>
<tr class="separator:a98cafb6881af62ad86c49a7ef4015943"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Multi-dimensional Scaling (MDS).
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a7955d15af1baf10a4d95c20d8b81885b" name="a7955d15af1baf10a4d95c20d8b81885b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7955d15af1baf10a4d95c20d8b81885b">&#9670;&#160;</a></span>_smacof_single()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.manifold._mds._smacof_single </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dissimilarities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_components</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>300</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normalized_stress</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Computes multidimensional scaling using SMACOF algorithm.

Parameters
----------
dissimilarities : ndarray of shape (n_samples, n_samples)
    Pairwise dissimilarities between the points. Must be symmetric.

metric : bool, default=True
    Compute metric or nonmetric SMACOF algorithm.
    When ``False`` (i.e. non-metric MDS), dissimilarities with 0 are considered as
    missing values.

n_components : int, default=2
    Number of dimensions in which to immerse the dissimilarities. If an
    ``init`` array is provided, this option is overridden and the shape of
    ``init`` is used to determine the dimensionality of the embedding
    space.

init : ndarray of shape (n_samples, n_components), default=None
    Starting configuration of the embedding to initialize the algorithm. By
    default, the algorithm is initialized with a randomly chosen array.

max_iter : int, default=300
    Maximum number of iterations of the SMACOF algorithm for a single run.

verbose : int, default=0
    Level of verbosity.

eps : float, default=1e-3
    Relative tolerance with respect to stress at which to declare
    convergence. The value of `eps` should be tuned separately depending
    on whether or not `normalized_stress` is being used.

random_state : int, RandomState instance or None, default=None
    Determines the random number generator used to initialize the centers.
    Pass an int for reproducible results across multiple function calls.
    See :term:`Glossary &lt;random_state&gt;`.

normalized_stress : bool, default=False
    Whether use and return normed stress value (Stress-1) instead of raw
    stress calculated by default. Only supported in non-metric MDS. The
    caller must ensure that if `normalized_stress=True` then `metric=False`

    .. versionadded:: 1.2

Returns
-------
X : ndarray of shape (n_samples, n_components)
    Coordinates of the points in a ``n_components``-space.

stress : float
    The final value of the stress (sum of squared distance of the
    disparities and the distances for all constrained points).
    If `normalized_stress=True`, and `metric=False` returns Stress-1.
    A value of 0 indicates "perfect" fit, 0.025 excellent, 0.05 good,
    0.1 fair, and 0.2 poor [1]_.

n_iter : int
    The number of iterations corresponding to the best stress.

References
----------
.. [1] "Nonmetric multidimensional scaling: a numerical method" Kruskal, J.
       Psychometrika, 29 (1964)

.. [2] "Multidimensional scaling by optimizing goodness of fit to a nonmetric
       hypothesis" Kruskal, J. Psychometrika, 29, (1964)

.. [3] "Modern Multidimensional Scaling - Theory and Applications" Borg, I.;
       Groenen P. Springer Series in Statistics (1997)
</pre> <div class="fragment"><div class="line"><span class="lineno">   33</span>):</div>
<div class="line"><span class="lineno">   34</span>    <span class="stringliteral">&quot;&quot;&quot;Computes multidimensional scaling using SMACOF algorithm.</span></div>
<div class="line"><span class="lineno">   35</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   36</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">   37</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   38</span><span class="stringliteral">    dissimilarities : ndarray of shape (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">   39</span><span class="stringliteral">        Pairwise dissimilarities between the points. Must be symmetric.</span></div>
<div class="line"><span class="lineno">   40</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   41</span><span class="stringliteral">    metric : bool, default=True</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">        Compute metric or nonmetric SMACOF algorithm.</span></div>
<div class="line"><span class="lineno">   43</span><span class="stringliteral">        When ``False`` (i.e. non-metric MDS), dissimilarities with 0 are considered as</span></div>
<div class="line"><span class="lineno">   44</span><span class="stringliteral">        missing values.</span></div>
<div class="line"><span class="lineno">   45</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   46</span><span class="stringliteral">    n_components : int, default=2</span></div>
<div class="line"><span class="lineno">   47</span><span class="stringliteral">        Number of dimensions in which to immerse the dissimilarities. If an</span></div>
<div class="line"><span class="lineno">   48</span><span class="stringliteral">        ``init`` array is provided, this option is overridden and the shape of</span></div>
<div class="line"><span class="lineno">   49</span><span class="stringliteral">        ``init`` is used to determine the dimensionality of the embedding</span></div>
<div class="line"><span class="lineno">   50</span><span class="stringliteral">        space.</span></div>
<div class="line"><span class="lineno">   51</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   52</span><span class="stringliteral">    init : ndarray of shape (n_samples, n_components), default=None</span></div>
<div class="line"><span class="lineno">   53</span><span class="stringliteral">        Starting configuration of the embedding to initialize the algorithm. By</span></div>
<div class="line"><span class="lineno">   54</span><span class="stringliteral">        default, the algorithm is initialized with a randomly chosen array.</span></div>
<div class="line"><span class="lineno">   55</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   56</span><span class="stringliteral">    max_iter : int, default=300</span></div>
<div class="line"><span class="lineno">   57</span><span class="stringliteral">        Maximum number of iterations of the SMACOF algorithm for a single run.</span></div>
<div class="line"><span class="lineno">   58</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   59</span><span class="stringliteral">    verbose : int, default=0</span></div>
<div class="line"><span class="lineno">   60</span><span class="stringliteral">        Level of verbosity.</span></div>
<div class="line"><span class="lineno">   61</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   62</span><span class="stringliteral">    eps : float, default=1e-3</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral">        Relative tolerance with respect to stress at which to declare</span></div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">        convergence. The value of `eps` should be tuned separately depending</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">        on whether or not `normalized_stress` is being used.</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">    random_state : int, RandomState instance or None, default=None</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">        Determines the random number generator used to initialize the centers.</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">        Pass an int for reproducible results across multiple function calls.</span></div>
<div class="line"><span class="lineno">   70</span><span class="stringliteral">        See :term:`Glossary &lt;random_state&gt;`.</span></div>
<div class="line"><span class="lineno">   71</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   72</span><span class="stringliteral">    normalized_stress : bool, default=False</span></div>
<div class="line"><span class="lineno">   73</span><span class="stringliteral">        Whether use and return normed stress value (Stress-1) instead of raw</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral">        stress calculated by default. Only supported in non-metric MDS. The</span></div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">        caller must ensure that if `normalized_stress=True` then `metric=False`</span></div>
<div class="line"><span class="lineno">   76</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">        .. versionadded:: 1.2</span></div>
<div class="line"><span class="lineno">   78</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   79</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">   80</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">   81</span><span class="stringliteral">    X : ndarray of shape (n_samples, n_components)</span></div>
<div class="line"><span class="lineno">   82</span><span class="stringliteral">        Coordinates of the points in a ``n_components``-space.</span></div>
<div class="line"><span class="lineno">   83</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   84</span><span class="stringliteral">    stress : float</span></div>
<div class="line"><span class="lineno">   85</span><span class="stringliteral">        The final value of the stress (sum of squared distance of the</span></div>
<div class="line"><span class="lineno">   86</span><span class="stringliteral">        disparities and the distances for all constrained points).</span></div>
<div class="line"><span class="lineno">   87</span><span class="stringliteral">        If `normalized_stress=True`, and `metric=False` returns Stress-1.</span></div>
<div class="line"><span class="lineno">   88</span><span class="stringliteral">        A value of 0 indicates &quot;perfect&quot; fit, 0.025 excellent, 0.05 good,</span></div>
<div class="line"><span class="lineno">   89</span><span class="stringliteral">        0.1 fair, and 0.2 poor [1]_.</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   91</span><span class="stringliteral">    n_iter : int</span></div>
<div class="line"><span class="lineno">   92</span><span class="stringliteral">        The number of iterations corresponding to the best stress.</span></div>
<div class="line"><span class="lineno">   93</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   94</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">    .. [1] &quot;Nonmetric multidimensional scaling: a numerical method&quot; Kruskal, J.</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">           Psychometrika, 29 (1964)</span></div>
<div class="line"><span class="lineno">   98</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   99</span><span class="stringliteral">    .. [2] &quot;Multidimensional scaling by optimizing goodness of fit to a nonmetric</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral">           hypothesis&quot; Kruskal, J. Psychometrika, 29, (1964)</span></div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  102</span><span class="stringliteral">    .. [3] &quot;Modern Multidimensional Scaling - Theory and Applications&quot; Borg, I.;</span></div>
<div class="line"><span class="lineno">  103</span><span class="stringliteral">           Groenen P. Springer Series in Statistics (1997)</span></div>
<div class="line"><span class="lineno">  104</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  105</span>    dissimilarities = check_symmetric(dissimilarities, raise_exception=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    n_samples = dissimilarities.shape[0]</div>
<div class="line"><span class="lineno">  108</span>    random_state = check_random_state(random_state)</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    sim_flat = ((1 - np.tri(n_samples)) * dissimilarities).ravel()</div>
<div class="line"><span class="lineno">  111</span>    sim_flat_w = sim_flat[sim_flat != 0]</div>
<div class="line"><span class="lineno">  112</span>    <span class="keywordflow">if</span> init <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  113</span>        <span class="comment"># Randomly choose initial configuration</span></div>
<div class="line"><span class="lineno">  114</span>        X = random_state.uniform(size=n_samples * n_components)</div>
<div class="line"><span class="lineno">  115</span>        X = X.reshape((n_samples, n_components))</div>
<div class="line"><span class="lineno">  116</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  117</span>        <span class="comment"># overrides the parameter p</span></div>
<div class="line"><span class="lineno">  118</span>        n_components = init.shape[1]</div>
<div class="line"><span class="lineno">  119</span>        <span class="keywordflow">if</span> n_samples != init.shape[0]:</div>
<div class="line"><span class="lineno">  120</span>            <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  121</span>                <span class="stringliteral">&quot;init matrix should be of shape (%d, %d)&quot;</span> % (n_samples, n_components)</div>
<div class="line"><span class="lineno">  122</span>            )</div>
<div class="line"><span class="lineno">  123</span>        X = init</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>    old_stress = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  126</span>    ir = IsotonicRegression()</div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">for</span> it <span class="keywordflow">in</span> range(max_iter):</div>
<div class="line"><span class="lineno">  128</span>        <span class="comment"># Compute distance and monotonic regression</span></div>
<div class="line"><span class="lineno">  129</span>        dis = euclidean_distances(X)</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>        <span class="keywordflow">if</span> metric:</div>
<div class="line"><span class="lineno">  132</span>            disparities = dissimilarities</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  134</span>            dis_flat = dis.ravel()</div>
<div class="line"><span class="lineno">  135</span>            <span class="comment"># dissimilarities with 0 are considered as missing values</span></div>
<div class="line"><span class="lineno">  136</span>            dis_flat_w = dis_flat[sim_flat != 0]</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>            <span class="comment"># Compute the disparities using a monotonic regression</span></div>
<div class="line"><span class="lineno">  139</span>            disparities_flat = ir.fit_transform(sim_flat_w, dis_flat_w)</div>
<div class="line"><span class="lineno">  140</span>            disparities = dis_flat.copy()</div>
<div class="line"><span class="lineno">  141</span>            disparities[sim_flat != 0] = disparities_flat</div>
<div class="line"><span class="lineno">  142</span>            disparities = disparities.reshape((n_samples, n_samples))</div>
<div class="line"><span class="lineno">  143</span>            disparities *= np.sqrt(</div>
<div class="line"><span class="lineno">  144</span>                (n_samples * (n_samples - 1) / 2) / (disparities**2).sum()</div>
<div class="line"><span class="lineno">  145</span>            )</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>        <span class="comment"># Compute stress</span></div>
<div class="line"><span class="lineno">  148</span>        stress = ((dis.ravel() - disparities.ravel()) ** 2).sum() / 2</div>
<div class="line"><span class="lineno">  149</span>        <span class="keywordflow">if</span> normalized_stress:</div>
<div class="line"><span class="lineno">  150</span>            stress = np.sqrt(stress / ((disparities.ravel() ** 2).sum() / 2))</div>
<div class="line"><span class="lineno">  151</span>        <span class="comment"># Update X using the Guttman transform</span></div>
<div class="line"><span class="lineno">  152</span>        dis[dis == 0] = 1e-5</div>
<div class="line"><span class="lineno">  153</span>        ratio = disparities / dis</div>
<div class="line"><span class="lineno">  154</span>        B = -ratio</div>
<div class="line"><span class="lineno">  155</span>        B[np.arange(len(B)), np.arange(len(B))] += ratio.sum(axis=1)</div>
<div class="line"><span class="lineno">  156</span>        X = 1.0 / n_samples * np.dot(B, X)</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>        dis = np.sqrt((X**2).sum(axis=1)).sum()</div>
<div class="line"><span class="lineno">  159</span>        <span class="keywordflow">if</span> verbose &gt;= 2:</div>
<div class="line"><span class="lineno">  160</span>            print(<span class="stringliteral">&quot;it: %d, stress %s&quot;</span> % (it, stress))</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">if</span> old_stress <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  162</span>            <span class="keywordflow">if</span> (old_stress - stress / dis) &lt; eps:</div>
<div class="line"><span class="lineno">  163</span>                <span class="keywordflow">if</span> verbose:</div>
<div class="line"><span class="lineno">  164</span>                    print(<span class="stringliteral">&quot;breaking at iteration %d with stress %s&quot;</span> % (it, stress))</div>
<div class="line"><span class="lineno">  165</span>                <span class="keywordflow">break</span></div>
<div class="line"><span class="lineno">  166</span>        old_stress = stress / dis</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">return</span> X, stress, it + 1</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a98cafb6881af62ad86c49a7ef4015943" name="a98cafb6881af62ad86c49a7ef4015943"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98cafb6881af62ad86c49a7ef4015943">&#9670;&#160;</a></span>smacof()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sklearn.manifold._mds.smacof </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dissimilarities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*&#160;</td>
          <td class="paramname"><em>metric</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_components</em> = <code>2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>init</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_init</em> = <code>8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n_jobs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_iter</em> = <code>300</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>verbose</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>eps</em> = <code>1e-3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_state</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>return_n_iter</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>normalized_stress</em> = <code>&quot;warn&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute multidimensional scaling using the SMACOF algorithm.

The SMACOF (Scaling by MAjorizing a COmplicated Function) algorithm is a
multidimensional scaling algorithm which minimizes an objective function
(the *stress*) using a majorization technique. Stress majorization, also
known as the Guttman Transform, guarantees a monotone convergence of
stress, and is more powerful than traditional techniques such as gradient
descent.

The SMACOF algorithm for metric MDS can be summarized by the following
steps:

1. Set an initial start configuration, randomly or not.
2. Compute the stress
3. Compute the Guttman Transform
4. Iterate 2 and 3 until convergence.

The nonmetric algorithm adds a monotonic regression step before computing
the stress.

Parameters
----------
dissimilarities : ndarray of shape (n_samples, n_samples)
    Pairwise dissimilarities between the points. Must be symmetric.

metric : bool, default=True
    Compute metric or nonmetric SMACOF algorithm.
    When ``False`` (i.e. non-metric MDS), dissimilarities with 0 are considered as
    missing values.

n_components : int, default=2
    Number of dimensions in which to immerse the dissimilarities. If an
    ``init`` array is provided, this option is overridden and the shape of
    ``init`` is used to determine the dimensionality of the embedding
    space.

init : ndarray of shape (n_samples, n_components), default=None
    Starting configuration of the embedding to initialize the algorithm. By
    default, the algorithm is initialized with a randomly chosen array.

n_init : int, default=8
    Number of times the SMACOF algorithm will be run with different
    initializations. The final results will be the best output of the runs,
    determined by the run with the smallest final stress. If ``init`` is
    provided, this option is overridden and a single run is performed.

n_jobs : int, default=None
    The number of jobs to use for the computation. If multiple
    initializations are used (``n_init``), each run of the algorithm is
    computed in parallel.

    ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.
    ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`
    for more details.

max_iter : int, default=300
    Maximum number of iterations of the SMACOF algorithm for a single run.

verbose : int, default=0
    Level of verbosity.

eps : float, default=1e-3
    Relative tolerance with respect to stress at which to declare
    convergence. The value of `eps` should be tuned separately depending
    on whether or not `normalized_stress` is being used.

random_state : int, RandomState instance or None, default=None
    Determines the random number generator used to initialize the centers.
    Pass an int for reproducible results across multiple function calls.
    See :term:`Glossary &lt;random_state&gt;`.

return_n_iter : bool, default=False
    Whether or not to return the number of iterations.

normalized_stress : bool or "auto" default=False
    Whether use and return normed stress value (Stress-1) instead of raw
    stress calculated by default. Only supported in non-metric MDS.

    .. versionadded:: 1.2

Returns
-------
X : ndarray of shape (n_samples, n_components)
    Coordinates of the points in a ``n_components``-space.

stress : float
    The final value of the stress (sum of squared distance of the
    disparities and the distances for all constrained points).
    If `normalized_stress=True`, and `metric=False` returns Stress-1.
    A value of 0 indicates "perfect" fit, 0.025 excellent, 0.05 good,
    0.1 fair, and 0.2 poor [1]_.

n_iter : int
    The number of iterations corresponding to the best stress. Returned
    only if ``return_n_iter`` is set to ``True``.

References
----------
.. [1] "Nonmetric multidimensional scaling: a numerical method" Kruskal, J.
       Psychometrika, 29 (1964)

.. [2] "Multidimensional scaling by optimizing goodness of fit to a nonmetric
       hypothesis" Kruskal, J. Psychometrika, 29, (1964)

.. [3] "Modern Multidimensional Scaling - Theory and Applications" Borg, I.;
       Groenen P. Springer Series in Statistics (1997)
</pre> <div class="fragment"><div class="line"><span class="lineno">  185</span>):</div>
<div class="line"><span class="lineno">  186</span>    <span class="stringliteral">&quot;&quot;&quot;Compute multidimensional scaling using the SMACOF algorithm.</span></div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">    The SMACOF (Scaling by MAjorizing a COmplicated Function) algorithm is a</span></div>
<div class="line"><span class="lineno">  189</span><span class="stringliteral">    multidimensional scaling algorithm which minimizes an objective function</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">    (the *stress*) using a majorization technique. Stress majorization, also</span></div>
<div class="line"><span class="lineno">  191</span><span class="stringliteral">    known as the Guttman Transform, guarantees a monotone convergence of</span></div>
<div class="line"><span class="lineno">  192</span><span class="stringliteral">    stress, and is more powerful than traditional techniques such as gradient</span></div>
<div class="line"><span class="lineno">  193</span><span class="stringliteral">    descent.</span></div>
<div class="line"><span class="lineno">  194</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  195</span><span class="stringliteral">    The SMACOF algorithm for metric MDS can be summarized by the following</span></div>
<div class="line"><span class="lineno">  196</span><span class="stringliteral">    steps:</span></div>
<div class="line"><span class="lineno">  197</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  198</span><span class="stringliteral">    1. Set an initial start configuration, randomly or not.</span></div>
<div class="line"><span class="lineno">  199</span><span class="stringliteral">    2. Compute the stress</span></div>
<div class="line"><span class="lineno">  200</span><span class="stringliteral">    3. Compute the Guttman Transform</span></div>
<div class="line"><span class="lineno">  201</span><span class="stringliteral">    4. Iterate 2 and 3 until convergence.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">    The nonmetric algorithm adds a monotonic regression step before computing</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    the stress.</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">    dissimilarities : ndarray of shape (n_samples, n_samples)</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">        Pairwise dissimilarities between the points. Must be symmetric.</span></div>
<div class="line"><span class="lineno">  210</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">    metric : bool, default=True</span></div>
<div class="line"><span class="lineno">  212</span><span class="stringliteral">        Compute metric or nonmetric SMACOF algorithm.</span></div>
<div class="line"><span class="lineno">  213</span><span class="stringliteral">        When ``False`` (i.e. non-metric MDS), dissimilarities with 0 are considered as</span></div>
<div class="line"><span class="lineno">  214</span><span class="stringliteral">        missing values.</span></div>
<div class="line"><span class="lineno">  215</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  216</span><span class="stringliteral">    n_components : int, default=2</span></div>
<div class="line"><span class="lineno">  217</span><span class="stringliteral">        Number of dimensions in which to immerse the dissimilarities. If an</span></div>
<div class="line"><span class="lineno">  218</span><span class="stringliteral">        ``init`` array is provided, this option is overridden and the shape of</span></div>
<div class="line"><span class="lineno">  219</span><span class="stringliteral">        ``init`` is used to determine the dimensionality of the embedding</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral">        space.</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    init : ndarray of shape (n_samples, n_components), default=None</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">        Starting configuration of the embedding to initialize the algorithm. By</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">        default, the algorithm is initialized with a randomly chosen array.</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral">    n_init : int, default=8</span></div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">        Number of times the SMACOF algorithm will be run with different</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">        initializations. The final results will be the best output of the runs,</span></div>
<div class="line"><span class="lineno">  229</span><span class="stringliteral">        determined by the run with the smallest final stress. If ``init`` is</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">        provided, this option is overridden and a single run is performed.</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    n_jobs : int, default=None</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">        The number of jobs to use for the computation. If multiple</span></div>
<div class="line"><span class="lineno">  234</span><span class="stringliteral">        initializations are used (``n_init``), each run of the algorithm is</span></div>
<div class="line"><span class="lineno">  235</span><span class="stringliteral">        computed in parallel.</span></div>
<div class="line"><span class="lineno">  236</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral">        ``None`` means 1 unless in a :obj:`joblib.parallel_backend` context.</span></div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">        ``-1`` means using all processors. See :term:`Glossary &lt;n_jobs&gt;`</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">        for more details.</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">    max_iter : int, default=300</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral">        Maximum number of iterations of the SMACOF algorithm for a single run.</span></div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">    verbose : int, default=0</span></div>
<div class="line"><span class="lineno">  245</span><span class="stringliteral">        Level of verbosity.</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">    eps : float, default=1e-3</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">        Relative tolerance with respect to stress at which to declare</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">        convergence. The value of `eps` should be tuned separately depending</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">        on whether or not `normalized_stress` is being used.</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral">    random_state : int, RandomState instance or None, default=None</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">        Determines the random number generator used to initialize the centers.</span></div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">        Pass an int for reproducible results across multiple function calls.</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">        See :term:`Glossary &lt;random_state&gt;`.</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    return_n_iter : bool, default=False</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral">        Whether or not to return the number of iterations.</span></div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    normalized_stress : bool or &quot;auto&quot; default=False</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">        Whether use and return normed stress value (Stress-1) instead of raw</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">        stress calculated by default. Only supported in non-metric MDS.</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">        .. versionadded:: 1.2</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    X : ndarray of shape (n_samples, n_components)</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">        Coordinates of the points in a ``n_components``-space.</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">    stress : float</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">        The final value of the stress (sum of squared distance of the</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral">        disparities and the distances for all constrained points).</span></div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">        If `normalized_stress=True`, and `metric=False` returns Stress-1.</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">        A value of 0 indicates &quot;perfect&quot; fit, 0.025 excellent, 0.05 good,</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">        0.1 fair, and 0.2 poor [1]_.</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">    n_iter : int</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">        The number of iterations corresponding to the best stress. Returned</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral">        only if ``return_n_iter`` is set to ``True``.</span></div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">    .. [1] &quot;Nonmetric multidimensional scaling: a numerical method&quot; Kruskal, J.</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">           Psychometrika, 29 (1964)</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">    .. [2] &quot;Multidimensional scaling by optimizing goodness of fit to a nonmetric</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">           hypothesis&quot; Kruskal, J. Psychometrika, 29, (1964)</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">    .. [3] &quot;Modern Multidimensional Scaling - Theory and Applications&quot; Borg, I.;</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">           Groenen P. Springer Series in Statistics (1997)</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    dissimilarities = check_array(dissimilarities)</div>
<div class="line"><span class="lineno">  295</span>    random_state = check_random_state(random_state)</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    <span class="comment"># TODO(1.4): Remove</span></div>
<div class="line"><span class="lineno">  298</span>    <span class="keywordflow">if</span> normalized_stress == <span class="stringliteral">&quot;warn&quot;</span>:</div>
<div class="line"><span class="lineno">  299</span>        warnings.warn(</div>
<div class="line"><span class="lineno">  300</span>            <span class="stringliteral">&quot;The default value of `normalized_stress` will change to `&#39;auto&#39;` in&quot;</span></div>
<div class="line"><span class="lineno">  301</span>            <span class="stringliteral">&quot; version 1.4. To suppress this warning, manually set the value of&quot;</span></div>
<div class="line"><span class="lineno">  302</span>            <span class="stringliteral">&quot; `normalized_stress`.&quot;</span>,</div>
<div class="line"><span class="lineno">  303</span>            FutureWarning,</div>
<div class="line"><span class="lineno">  304</span>        )</div>
<div class="line"><span class="lineno">  305</span>        normalized_stress = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>    <span class="keywordflow">if</span> normalized_stress == <span class="stringliteral">&quot;auto&quot;</span>:</div>
<div class="line"><span class="lineno">  308</span>        normalized_stress = <span class="keywordflow">not</span> metric</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>    <span class="keywordflow">if</span> normalized_stress <span class="keywordflow">and</span> metric:</div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  312</span>            <span class="stringliteral">&quot;Normalized stress is not supported for metric MDS. Either set&quot;</span></div>
<div class="line"><span class="lineno">  313</span>            <span class="stringliteral">&quot; `normalized_stress=False` or use `metric=False`.&quot;</span></div>
<div class="line"><span class="lineno">  314</span>        )</div>
<div class="line"><span class="lineno">  315</span>    <span class="keywordflow">if</span> hasattr(init, <span class="stringliteral">&quot;__array__&quot;</span>):</div>
<div class="line"><span class="lineno">  316</span>        init = np.asarray(init).copy()</div>
<div class="line"><span class="lineno">  317</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> n_init == 1:</div>
<div class="line"><span class="lineno">  318</span>            warnings.warn(</div>
<div class="line"><span class="lineno">  319</span>                <span class="stringliteral">&quot;Explicit initial positions passed: &quot;</span></div>
<div class="line"><span class="lineno">  320</span>                <span class="stringliteral">&quot;performing only one init of the MDS instead of %d&quot;</span> % n_init</div>
<div class="line"><span class="lineno">  321</span>            )</div>
<div class="line"><span class="lineno">  322</span>            n_init = 1</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>    best_pos, best_stress = <span class="keywordtype">None</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>    <span class="keywordflow">if</span> effective_n_jobs(n_jobs) == 1:</div>
<div class="line"><span class="lineno">  327</span>        <span class="keywordflow">for</span> it <span class="keywordflow">in</span> range(n_init):</div>
<div class="line"><span class="lineno">  328</span>            pos, stress, n_iter_ = _smacof_single(</div>
<div class="line"><span class="lineno">  329</span>                dissimilarities,</div>
<div class="line"><span class="lineno">  330</span>                metric=metric,</div>
<div class="line"><span class="lineno">  331</span>                n_components=n_components,</div>
<div class="line"><span class="lineno">  332</span>                init=init,</div>
<div class="line"><span class="lineno">  333</span>                max_iter=max_iter,</div>
<div class="line"><span class="lineno">  334</span>                verbose=verbose,</div>
<div class="line"><span class="lineno">  335</span>                eps=eps,</div>
<div class="line"><span class="lineno">  336</span>                random_state=random_state,</div>
<div class="line"><span class="lineno">  337</span>                normalized_stress=normalized_stress,</div>
<div class="line"><span class="lineno">  338</span>            )</div>
<div class="line"><span class="lineno">  339</span>            <span class="keywordflow">if</span> best_stress <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">or</span> stress &lt; best_stress:</div>
<div class="line"><span class="lineno">  340</span>                best_stress = stress</div>
<div class="line"><span class="lineno">  341</span>                best_pos = pos.copy()</div>
<div class="line"><span class="lineno">  342</span>                best_iter = n_iter_</div>
<div class="line"><span class="lineno">  343</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  344</span>        seeds = random_state.randint(np.iinfo(np.int32).max, size=n_init)</div>
<div class="line"><span class="lineno">  345</span>        results = Parallel(n_jobs=n_jobs, verbose=max(verbose - 1, 0))(</div>
<div class="line"><span class="lineno">  346</span>            delayed(_smacof_single)(</div>
<div class="line"><span class="lineno">  347</span>                dissimilarities,</div>
<div class="line"><span class="lineno">  348</span>                metric=metric,</div>
<div class="line"><span class="lineno">  349</span>                n_components=n_components,</div>
<div class="line"><span class="lineno">  350</span>                init=init,</div>
<div class="line"><span class="lineno">  351</span>                max_iter=max_iter,</div>
<div class="line"><span class="lineno">  352</span>                verbose=verbose,</div>
<div class="line"><span class="lineno">  353</span>                eps=eps,</div>
<div class="line"><span class="lineno">  354</span>                random_state=seed,</div>
<div class="line"><span class="lineno">  355</span>                normalized_stress=normalized_stress,</div>
<div class="line"><span class="lineno">  356</span>            )</div>
<div class="line"><span class="lineno">  357</span>            <span class="keywordflow">for</span> seed <span class="keywordflow">in</span> seeds</div>
<div class="line"><span class="lineno">  358</span>        )</div>
<div class="line"><span class="lineno">  359</span>        positions, stress, n_iters = zip(*results)</div>
<div class="line"><span class="lineno">  360</span>        best = np.argmin(stress)</div>
<div class="line"><span class="lineno">  361</span>        best_stress = stress[best]</div>
<div class="line"><span class="lineno">  362</span>        best_pos = positions[best]</div>
<div class="line"><span class="lineno">  363</span>        best_iter = n_iters[best]</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>    <span class="keywordflow">if</span> return_n_iter:</div>
<div class="line"><span class="lineno">  366</span>        <span class="keywordflow">return</span> best_pos, best_stress, best_iter</div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">return</span> best_pos, best_stress</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
