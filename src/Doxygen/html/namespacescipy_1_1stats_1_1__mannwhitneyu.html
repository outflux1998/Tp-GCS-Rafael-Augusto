<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: scipy.stats._mannwhitneyu Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacescipy.html">scipy</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats.html">stats</a></li><li class="navelem"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html">_mannwhitneyu</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">scipy.stats._mannwhitneyu Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classscipy_1_1stats_1_1__mannwhitneyu_1_1___m_w_u.html">_MWU</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abe09cdf7cd9737d0307872f19291fbab" id="r_abe09cdf7cd9737d0307872f19291fbab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#abe09cdf7cd9737d0307872f19291fbab">_broadcast_concatenate</a> (x, y, axis)</td></tr>
<tr class="separator:abe09cdf7cd9737d0307872f19291fbab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54637562a743f044531b54a63ac5e57f" id="r_a54637562a743f044531b54a63ac5e57f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#a54637562a743f044531b54a63ac5e57f">_mwu_f_iterative</a> (m, <a class="el" href="__blas__subroutines_8h.html#a25eafceb38c8e75bc60701fea6623f71">n</a>, <a class="el" href="__blas__subroutines_8h.html#afa8f30d4cfebc7d1efb06e7d245eff5a">k</a>, fmnks)</td></tr>
<tr class="separator:a54637562a743f044531b54a63ac5e57f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35a363e0a318a01c5ff260ee0b3136be" id="r_a35a363e0a318a01c5ff260ee0b3136be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#a35a363e0a318a01c5ff260ee0b3136be">_tie_term</a> (ranks)</td></tr>
<tr class="separator:a35a363e0a318a01c5ff260ee0b3136be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52ce46c372d21bd03893f2352088ad98" id="r_a52ce46c372d21bd03893f2352088ad98"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#a52ce46c372d21bd03893f2352088ad98">_get_mwu_z</a> (U, <a class="el" href="__lapack__subroutines_8h.html#ad13241860d5aa9d8027c8c1d395e5cd9">n1</a>, <a class="el" href="__lapack__subroutines_8h.html#a406c3832a5225544c3afbaeff4271ad6">n2</a>, ranks, axis=0, continuity=True)</td></tr>
<tr class="separator:a52ce46c372d21bd03893f2352088ad98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5aba3b89e940d590f3d1f0751e5dc0a" id="r_ab5aba3b89e940d590f3d1f0751e5dc0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#ab5aba3b89e940d590f3d1f0751e5dc0a">_mwu_input_validation</a> (x, y, use_continuity, alternative, axis, <a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>)</td></tr>
<tr class="separator:ab5aba3b89e940d590f3d1f0751e5dc0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca69f90f5e4c5ae7ba85644c97fa3f3d" id="r_aca69f90f5e4c5ae7ba85644c97fa3f3d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#aca69f90f5e4c5ae7ba85644c97fa3f3d">_tie_check</a> (xy)</td></tr>
<tr class="separator:aca69f90f5e4c5ae7ba85644c97fa3f3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7143f854f85d4bb0374dfada95c8051" id="r_aa7143f854f85d4bb0374dfada95c8051"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#aa7143f854f85d4bb0374dfada95c8051">_mwu_choose_method</a> (<a class="el" href="__lapack__subroutines_8h.html#ad13241860d5aa9d8027c8c1d395e5cd9">n1</a>, <a class="el" href="__lapack__subroutines_8h.html#a406c3832a5225544c3afbaeff4271ad6">n2</a>, xy, <a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>)</td></tr>
<tr class="separator:aa7143f854f85d4bb0374dfada95c8051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72ff0dc70b8aa3ab5b41469e741784f4" id="r_a72ff0dc70b8aa3ab5b41469e741784f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#a72ff0dc70b8aa3ab5b41469e741784f4">mannwhitneyu</a> (x, y, use_continuity=True, alternative=&quot;two-sided&quot;, axis=0, <a class="el" href="namespacescipy_1_1stats_1_1__multivariate.html#ad5850caf3faceef835b3baacc93038ee">method</a>=&quot;auto&quot;)</td></tr>
<tr class="separator:a72ff0dc70b8aa3ab5b41469e741784f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8f2fa66e2a64c0d9359fadd96d2b0bfc" id="r_a8f2fa66e2a64c0d9359fadd96d2b0bfc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#a8f2fa66e2a64c0d9359fadd96d2b0bfc">_mwu_state</a> = <a class="el" href="classscipy_1_1stats_1_1__mannwhitneyu_1_1___m_w_u.html">_MWU</a>()</td></tr>
<tr class="separator:a8f2fa66e2a64c0d9359fadd96d2b0bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6153d670a793bfe725acc1c6999b418c" id="r_a6153d670a793bfe725acc1c6999b418c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacescipy_1_1stats_1_1__mannwhitneyu.html#a6153d670a793bfe725acc1c6999b418c">MannwhitneyuResult</a> = namedtuple('MannwhitneyuResult', ('statistic', 'pvalue'))</td></tr>
<tr class="separator:a6153d670a793bfe725acc1c6999b418c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="abe09cdf7cd9737d0307872f19291fbab" name="abe09cdf7cd9737d0307872f19291fbab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe09cdf7cd9737d0307872f19291fbab">&#9670;&#160;</a></span>_broadcast_concatenate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu._broadcast_concatenate </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Broadcast then concatenate arrays, leaving concatenation axis last</pre> <div class="fragment"><div class="line"><span class="lineno">    8</span><span class="keyword">def </span>_broadcast_concatenate(x, y, axis):</div>
<div class="line"><span class="lineno">    9</span>    <span class="stringliteral">&#39;&#39;&#39;Broadcast then concatenate arrays, leaving concatenation axis last&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">   10</span>    x = np.moveaxis(x, axis, -1)</div>
<div class="line"><span class="lineno">   11</span>    y = np.moveaxis(y, axis, -1)</div>
<div class="line"><span class="lineno">   12</span>    z = np.broadcast(x[..., 0], y[..., 0])</div>
<div class="line"><span class="lineno">   13</span>    x = np.broadcast_to(x, z.shape + (x.shape[-1],))</div>
<div class="line"><span class="lineno">   14</span>    y = np.broadcast_to(y, z.shape + (y.shape[-1],))</div>
<div class="line"><span class="lineno">   15</span>    z = np.concatenate((x, y), axis=-1)</div>
<div class="line"><span class="lineno">   16</span>    <span class="keywordflow">return</span> x, y, z</div>
<div class="line"><span class="lineno">   17</span> </div>
<div class="line"><span class="lineno">   18</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a52ce46c372d21bd03893f2352088ad98" name="a52ce46c372d21bd03893f2352088ad98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52ce46c372d21bd03893f2352088ad98">&#9670;&#160;</a></span>_get_mwu_z()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu._get_mwu_z </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ranks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>continuity</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Standardized MWU statistic</pre> <div class="fragment"><div class="line"><span class="lineno">  167</span><span class="keyword">def </span>_get_mwu_z(U, n1, n2, ranks, axis=0, continuity=True):</div>
<div class="line"><span class="lineno">  168</span>    <span class="stringliteral">&#39;&#39;&#39;Standardized MWU statistic&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  169</span>    <span class="comment"># Follows mannwhitneyu [2]</span></div>
<div class="line"><span class="lineno">  170</span>    mu = n1 * n2 / 2</div>
<div class="line"><span class="lineno">  171</span>    n = n1 + n2</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="comment"># Tie correction according to [2]</span></div>
<div class="line"><span class="lineno">  174</span>    tie_term = np.apply_along_axis(_tie_term, -1, ranks)</div>
<div class="line"><span class="lineno">  175</span>    s = np.sqrt(n1*n2/12 * ((n + 1) - tie_term/(n*(n-1))))</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>    <span class="comment"># equivalent to using scipy.stats.tiecorrect</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="comment"># T = np.apply_along_axis(stats.tiecorrect, -1, ranks)</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="comment"># s = np.sqrt(T * n1 * n2 * (n1+n2+1) / 12.0)</span></div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    numerator = U - mu</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="comment"># Continuity correction.</span></div>
<div class="line"><span class="lineno">  184</span>    <span class="comment"># Because SF is always used to calculate the p-value, we can always</span></div>
<div class="line"><span class="lineno">  185</span>    <span class="comment"># _subtract_ 0.5 for the continuity correction. This always increases the</span></div>
<div class="line"><span class="lineno">  186</span>    <span class="comment"># p-value to account for the rest of the probability mass _at_ q = U.</span></div>
<div class="line"><span class="lineno">  187</span>    <span class="keywordflow">if</span> continuity:</div>
<div class="line"><span class="lineno">  188</span>        numerator -= 0.5</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <span class="comment"># no problem evaluating the norm SF at an infinity</span></div>
<div class="line"><span class="lineno">  191</span>    <span class="keyword">with</span> np.errstate(divide=<span class="stringliteral">&#39;ignore&#39;</span>, invalid=<span class="stringliteral">&#39;ignore&#39;</span>):</div>
<div class="line"><span class="lineno">  192</span>        z = numerator / s</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordflow">return</span> z</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7143f854f85d4bb0374dfada95c8051" name="aa7143f854f85d4bb0374dfada95c8051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7143f854f85d4bb0374dfada95c8051">&#9670;&#160;</a></span>_mwu_choose_method()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu._mwu_choose_method </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Choose method 'asymptotic' or 'exact' depending on input size, ties</pre> <div class="fragment"><div class="line"><span class="lineno">  232</span><span class="keyword">def </span>_mwu_choose_method(n1, n2, xy, method):</div>
<div class="line"><span class="lineno">  233</span>    <span class="stringliteral">&quot;&quot;&quot;Choose method &#39;asymptotic&#39; or &#39;exact&#39; depending on input size, ties&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    <span class="comment"># if both inputs are large, asymptotic is OK</span></div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">if</span> n1 &gt; 8 <span class="keywordflow">and</span> n2 &gt; 8:</div>
<div class="line"><span class="lineno">  237</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;asymptotic&quot;</span></div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <span class="comment"># if there are any ties, asymptotic is preferred</span></div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">if</span> np.apply_along_axis(_tie_check, -1, xy).any():</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">return</span> <span class="stringliteral">&quot;asymptotic&quot;</span></div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;exact&quot;</span></div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a54637562a743f044531b54a63ac5e57f" name="a54637562a743f044531b54a63ac5e57f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54637562a743f044531b54a63ac5e57f">&#9670;&#160;</a></span>_mwu_f_iterative()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu._mwu_f_iterative </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>fmnks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Iterative implementation of function of [3] Theorem 2.5</pre> <div class="fragment"><div class="line"><span class="lineno">  108</span><span class="keyword">def </span>_mwu_f_iterative(m, n, k, fmnks):</div>
<div class="line"><span class="lineno">  109</span>    <span class="stringliteral">&#39;&#39;&#39;Iterative implementation of function of [3] Theorem 2.5&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    <span class="keyword">def </span>_base_case(m, n, k):</div>
<div class="line"><span class="lineno">  112</span>        <span class="stringliteral">&#39;&#39;&#39;Base cases from recursive version&#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>        <span class="comment"># if already calculated, return the value</span></div>
<div class="line"><span class="lineno">  115</span>        <span class="keywordflow">if</span> fmnks.get((m, n, k), -1) &gt;= 0:</div>
<div class="line"><span class="lineno">  116</span>            <span class="keywordflow">return</span> fmnks[(m, n, k)]</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>        <span class="comment"># [3] Theorem 2.5 Line 1</span></div>
<div class="line"><span class="lineno">  119</span>        <span class="keywordflow">elif</span> k &lt; 0 <span class="keywordflow">or</span> m &lt; 0 <span class="keywordflow">or</span> n &lt; 0 <span class="keywordflow">or</span> k &gt; m*n:</div>
<div class="line"><span class="lineno">  120</span>            <span class="keywordflow">return</span> 0</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>        <span class="comment"># [3] Theorem 2.5 Line 2</span></div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">elif</span> k == 0 <span class="keywordflow">and</span> m &gt;= 0 <span class="keywordflow">and</span> n &gt;= 0:</div>
<div class="line"><span class="lineno">  124</span>            <span class="keywordflow">return</span> 1</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    stack = [(m, n, k)]</div>
<div class="line"><span class="lineno">  129</span>    fmnk = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">while</span> stack:</div>
<div class="line"><span class="lineno">  132</span>        <span class="comment"># Popping only if necessary would save a tiny bit of time, but NWI.</span></div>
<div class="line"><span class="lineno">  133</span>        m, n, k = stack.pop()</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>        <span class="comment"># If we&#39;re at a base case, continue (stack unwinds)</span></div>
<div class="line"><span class="lineno">  136</span>        fmnk = _base_case(m, n, k)</div>
<div class="line"><span class="lineno">  137</span>        <span class="keywordflow">if</span> fmnk <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  138</span>            fmnks[(m, n, k)] = fmnk</div>
<div class="line"><span class="lineno">  139</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>        <span class="comment"># If both terms are base cases, continue (stack unwinds)</span></div>
<div class="line"><span class="lineno">  142</span>        f1 = _base_case(m-1, n, k-n)</div>
<div class="line"><span class="lineno">  143</span>        f2 = _base_case(m, n-1, k)</div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">if</span> f1 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> f2 <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  145</span>            <span class="comment"># [3] Theorem 2.5 Line 3 / Equation 3</span></div>
<div class="line"><span class="lineno">  146</span>            fmnk = f1 + f2</div>
<div class="line"><span class="lineno">  147</span>            fmnks[(m, n, k)] = fmnk</div>
<div class="line"><span class="lineno">  148</span>            <span class="keywordflow">continue</span></div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>        <span class="comment"># recurse deeper</span></div>
<div class="line"><span class="lineno">  151</span>        stack.append((m, n, k))</div>
<div class="line"><span class="lineno">  152</span>        <span class="keywordflow">if</span> f1 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  153</span>            stack.append((m-1, n, k-n))</div>
<div class="line"><span class="lineno">  154</span>        <span class="keywordflow">if</span> f2 <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  155</span>            stack.append((m, n-1, k))</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">return</span> fmnks</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5aba3b89e940d590f3d1f0751e5dc0a" name="ab5aba3b89e940d590f3d1f0751e5dc0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5aba3b89e940d590f3d1f0751e5dc0a">&#9670;&#160;</a></span>_mwu_input_validation()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu._mwu_input_validation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_continuity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment"> Input validation and standardization for mannwhitneyu </pre> <div class="fragment"><div class="line"><span class="lineno">  196</span><span class="keyword">def </span>_mwu_input_validation(x, y, use_continuity, alternative, axis, method):</div>
<div class="line"><span class="lineno">  197</span>    <span class="stringliteral">&#39;&#39;&#39; Input validation and standardization for mannwhitneyu &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  198</span>    <span class="comment"># Would use np.asarray_chkfinite, but infs are OK</span></div>
<div class="line"><span class="lineno">  199</span>    x, y = np.atleast_1d(x), np.atleast_1d(y)</div>
<div class="line"><span class="lineno">  200</span>    <span class="keywordflow">if</span> np.isnan(x).any() <span class="keywordflow">or</span> np.isnan(y).any():</div>
<div class="line"><span class="lineno">  201</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;`x` and `y` must not contain NaNs.&#39;</span>)</div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">if</span> np.size(x) == 0 <span class="keywordflow">or</span> np.size(y) == 0:</div>
<div class="line"><span class="lineno">  203</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;`x` and `y` must be of nonzero size.&#39;</span>)</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    bools = {<span class="keyword">True</span>, <span class="keyword">False</span>}</div>
<div class="line"><span class="lineno">  206</span>    <span class="keywordflow">if</span> use_continuity <span class="keywordflow">not</span> <span class="keywordflow">in</span> bools:</div>
<div class="line"><span class="lineno">  207</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&#39;`use_continuity` must be one of {bools}.&#39;</span>)</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    alternatives = {<span class="stringliteral">&quot;two-sided&quot;</span>, <span class="stringliteral">&quot;less&quot;</span>, <span class="stringliteral">&quot;greater&quot;</span>}</div>
<div class="line"><span class="lineno">  210</span>    alternative = alternative.lower()</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">if</span> alternative <span class="keywordflow">not</span> <span class="keywordflow">in</span> alternatives:</div>
<div class="line"><span class="lineno">  212</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&#39;`alternative` must be one of {alternatives}.&#39;</span>)</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    axis_int = int(axis)</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">if</span> axis != axis_int:</div>
<div class="line"><span class="lineno">  216</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;`axis` must be an integer.&#39;</span>)</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>    methods = {<span class="stringliteral">&quot;asymptotic&quot;</span>, <span class="stringliteral">&quot;exact&quot;</span>, <span class="stringliteral">&quot;auto&quot;</span>}</div>
<div class="line"><span class="lineno">  219</span>    method = method.lower()</div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">if</span> method <span class="keywordflow">not</span> <span class="keywordflow">in</span> methods:</div>
<div class="line"><span class="lineno">  221</span>        <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&#39;`method` must be one of {methods}.&#39;</span>)</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <span class="keywordflow">return</span> x, y, use_continuity, alternative, axis_int, method</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aca69f90f5e4c5ae7ba85644c97fa3f3d" name="aca69f90f5e4c5ae7ba85644c97fa3f3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca69f90f5e4c5ae7ba85644c97fa3f3d">&#9670;&#160;</a></span>_tie_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu._tie_check </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Find any ties in data</pre> <div class="fragment"><div class="line"><span class="lineno">  226</span><span class="keyword">def </span>_tie_check(xy):</div>
<div class="line"><span class="lineno">  227</span>    <span class="stringliteral">&quot;&quot;&quot;Find any ties in data&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  228</span>    _, t = np.unique(xy, return_counts=<span class="keyword">True</span>, axis=-1)</div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">return</span> np.any(t != 1)</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a35a363e0a318a01c5ff260ee0b3136be" name="a35a363e0a318a01c5ff260ee0b3136be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35a363e0a318a01c5ff260ee0b3136be">&#9670;&#160;</a></span>_tie_term()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu._tie_term </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ranks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Tie correction term</pre> <div class="fragment"><div class="line"><span class="lineno">  160</span><span class="keyword">def </span>_tie_term(ranks):</div>
<div class="line"><span class="lineno">  161</span>    <span class="stringliteral">&quot;&quot;&quot;Tie correction term&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  162</span>    <span class="comment"># element i of t is the number of elements sharing rank i</span></div>
<div class="line"><span class="lineno">  163</span>    _, t = np.unique(ranks, return_counts=<span class="keyword">True</span>, axis=-1)</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">return</span> (t**3 - t).sum(axis=-1)</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a72ff0dc70b8aa3ab5b41469e741784f4" name="a72ff0dc70b8aa3ab5b41469e741784f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72ff0dc70b8aa3ab5b41469e741784f4">&#9670;&#160;</a></span>mannwhitneyu()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu.mannwhitneyu </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_continuity</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>alternative</em> = <code>&quot;two-sided&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>axis</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>&quot;auto&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Perform the Mann-Whitney U rank test on two independent samples.

The Mann-Whitney U test is a nonparametric test of the null hypothesis
that the distribution underlying sample `x` is the same as the
distribution underlying sample `y`. It is often used as a test of
difference in location between distributions.

Parameters
----------
x, y : array-like
    N-d arrays of samples. The arrays must be broadcastable except along
    the dimension given by `axis`.
use_continuity : bool, optional
        Whether a continuity correction (1/2) should be applied.
        Default is True when `method` is ``'asymptotic'``; has no effect
        otherwise.
alternative : {'two-sided', 'less', 'greater'}, optional
    Defines the alternative hypothesis. Default is 'two-sided'.
    Let *F(u)* and *G(u)* be the cumulative distribution functions of the
    distributions underlying `x` and `y`, respectively. Then the following
    alternative hypotheses are available:

    * 'two-sided': the distributions are not equal, i.e. *F(u) â‰  G(u)* for
      at least one *u*.
    * 'less': the distribution underlying `x` is stochastically less
      than the distribution underlying `y`, i.e. *F(u) &gt; G(u)* for all *u*.
    * 'greater': the distribution underlying `x` is stochastically greater
      than the distribution underlying `y`, i.e. *F(u) &lt; G(u)* for all *u*.

    Under a more restrictive set of assumptions, the alternative hypotheses
    can be expressed in terms of the locations of the distributions;
    see [5] section 5.1.
axis : int, optional
    Axis along which to perform the test. Default is 0.
method : {'auto', 'asymptotic', 'exact'}, optional
    Selects the method used to calculate the *p*-value.
    Default is 'auto'. The following options are available.

    * ``'asymptotic'``: compares the standardized test statistic
      against the normal distribution, correcting for ties.
    * ``'exact'``: computes the exact *p*-value by comparing the observed
      :math:`U` statistic against the exact distribution of the :math:`U`
      statistic under the null hypothesis. No correction is made for ties.
    * ``'auto'``: chooses ``'exact'`` when the size of one of the samples
      is less than 8 and there are no ties; chooses ``'asymptotic'``
      otherwise.

Returns
-------
res : MannwhitneyuResult
    An object containing attributes:

    statistic : float
        The Mann-Whitney U statistic corresponding with sample `x`. See
        Notes for the test statistic corresponding with sample `y`.
    pvalue : float
        The associated *p*-value for the chosen `alternative`.

Notes
-----
If ``U1`` is the statistic corresponding with sample `x`, then the
statistic corresponding with sample `y` is
`U2 = `x.shape[axis] * y.shape[axis] - U1``.

`mannwhitneyu` is for independent samples. For related / paired samples,
consider `scipy.stats.wilcoxon`.

`method` ``'exact'`` is recommended when there are no ties and when either
sample size is less than 8 [1]_. The implementation follows the recurrence
relation originally proposed in [1]_ as it is described in [3]_.
Note that the exact method is *not* corrected for ties, but
`mannwhitneyu` will not raise errors or warnings if there are ties in the
data.

The Mann-Whitney U test is a non-parametric version of the t-test for
independent samples. When the the means of samples from the populations
are normally distributed, consider `scipy.stats.ttest_ind`.

See Also
--------
scipy.stats.wilcoxon, scipy.stats.ranksums, scipy.stats.ttest_ind

References
----------
.. [1] H.B. Mann and D.R. Whitney, "On a test of whether one of two random
       variables is stochastically larger than the other", The Annals of
       Mathematical Statistics, Vol. 18, pp. 50-60, 1947.
.. [2] Mann-Whitney U Test, Wikipedia,
       http://en.wikipedia.org/wiki/Mann-Whitney_U_test
.. [3] A. Di Bucchianico, "Combinatorics, computer algebra, and the
       Wilcoxon-Mann-Whitney test", Journal of Statistical Planning and
       Inference, Vol. 79, pp. 349-364, 1999.
.. [4] Rosie Shier, "Statistics: 2.3 The Mann-Whitney U Test", Mathematics
       Learning Support Centre, 2004.
.. [5] Michael P. Fay and Michael A. Proschan. "Wilcoxon-Mann-Whitney
       or t-test? On assumptions for hypothesis tests and multiple \
       interpretations of decision rules." Statistics surveys, Vol. 4, pp.
       1-39, 2010. https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2857732/

Examples
--------
We follow the example from [4]_: nine randomly sampled young adults were
diagnosed with type II diabetes at the ages below.

&gt;&gt;&gt; males = [19, 22, 16, 29, 24]
&gt;&gt;&gt; females = [20, 11, 17, 12]

We use the Mann-Whitney U test to assess whether there is a statistically
significant difference in the diagnosis age of males and females.
The null hypothesis is that the distribution of male diagnosis ages is
the same as the distribution of female diagnosis ages. We decide
that a confidence level of 95% is required to reject the null hypothesis
in favor of the alternative that the distributions are different.
Since the number of samples is very small and there are no ties in the
data, we can compare the observed test statistic against the *exact*
distribution of the test statistic under the null hypothesis.

&gt;&gt;&gt; from scipy.stats import mannwhitneyu
&gt;&gt;&gt; U1, p = mannwhitneyu(males, females, method="exact")
&gt;&gt;&gt; print(U1)
17.0

`mannwhitneyu` always reports the statistic associated with the first
sample, which, in this case, is males. This agrees with :math:`U_M = 17`
reported in [4]_. The statistic associated with the second statistic
can be calculated:

&gt;&gt;&gt; nx, ny = len(males), len(females)
&gt;&gt;&gt; U2 = nx*ny - U1
&gt;&gt;&gt; print(U2)
3.0

This agrees with :math:`U_F = 3` reported in [4]_. The two-sided
*p*-value can be calculated from either statistic, and the value produced
by `mannwhitneyu` agrees with :math:`p = 0.11` reported in [4]_.

&gt;&gt;&gt; print(p)
0.1111111111111111

The exact distribution of the test statistic is asymptotically normal, so
the example continues by comparing the exact *p*-value against the
*p*-value produced using the normal approximation.

&gt;&gt;&gt; _, pnorm = mannwhitneyu(males, females, method="asymptotic")
&gt;&gt;&gt; print(pnorm)
0.11134688653314041

Here `mannwhitneyu`'s reported *p*-value appears to conflict with the
value :math:`p = 0.09` given in [4]_. The reason is that [4]_
does not apply the continuity correction performed by `mannwhitneyu`;
`mannwhitneyu` reduces the distance between the test statistic and the
mean :math:`\mu = n_x n_y / 2` by 0.5 to correct for the fact that the
discrete statistic is being compared against a continuous distribution.
Here, the :math:`U` statistic used is less than the mean, so we reduce
the distance by adding 0.5 in the numerator.

&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from scipy.stats import norm
&gt;&gt;&gt; U = min(U1, U2)
&gt;&gt;&gt; N = nx + ny
&gt;&gt;&gt; z = (U - nx*ny/2 + 0.5) / np.sqrt(nx*ny * (N + 1)/ 12)
&gt;&gt;&gt; p = 2 * norm.cdf(z)  # use CDF to get p-value from smaller statistic
&gt;&gt;&gt; print(p)
0.11134688653314041

If desired, we can disable the continuity correction to get a result
that agrees with that reported in [4]_.

&gt;&gt;&gt; _, pnorm = mannwhitneyu(males, females, use_continuity=False,
...                         method="asymptotic")
&gt;&gt;&gt; print(pnorm)
0.0864107329737

Regardless of whether we perform an exact or asymptotic test, the
probability of the test statistic being as extreme or more extreme by
chance exceeds 5%, so we do not consider the results statistically
significant.

Suppose that, before seeing the data, we had hypothesized that females
would tend to be diagnosed at a younger age than males.
In that case, it would be natural to provide the female ages as the
first input, and we would have performed a one-sided test using
``alternative = 'less'``: females are diagnosed at an age that is
stochastically less than that of males.

&gt;&gt;&gt; res = mannwhitneyu(females, males, alternative="less", method="exact")
&gt;&gt;&gt; print(res)
MannwhitneyuResult(statistic=3.0, pvalue=0.05555555555555555)

Again, the probability of getting a sufficiently low value of the
test statistic by chance under the null hypothesis is greater than 5%,
so we do not reject the null hypothesis in favor of our alternative.

If it is reasonable to assume that the means of samples from the
populations are normally distributed, we could have used a t-test to
perform the analysis.

&gt;&gt;&gt; from scipy.stats import ttest_ind
&gt;&gt;&gt; res = ttest_ind(females, males, alternative="less")
&gt;&gt;&gt; print(res)
Ttest_indResult(statistic=-2.239334696520584, pvalue=0.030068441095757924)

Under this assumption, the *p*-value would be low enough to reject the
null hypothesis in favor of the alternative.</pre> <div class="fragment"><div class="line"><span class="lineno">  251</span>                 axis=0, method=<span class="stringliteral">&quot;auto&quot;</span>):</div>
<div class="line"><span class="lineno">  252</span>    <span class="stringliteral">r&#39;&#39;&#39;Perform the Mann-Whitney U rank test on two independent samples.</span></div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  254</span><span class="stringliteral">    The Mann-Whitney U test is a nonparametric test of the null hypothesis</span></div>
<div class="line"><span class="lineno">  255</span><span class="stringliteral">    that the distribution underlying sample `x` is the same as the</span></div>
<div class="line"><span class="lineno">  256</span><span class="stringliteral">    distribution underlying sample `y`. It is often used as a test of</span></div>
<div class="line"><span class="lineno">  257</span><span class="stringliteral">    difference in location between distributions.</span></div>
<div class="line"><span class="lineno">  258</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  259</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  260</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  261</span><span class="stringliteral">    x, y : array-like</span></div>
<div class="line"><span class="lineno">  262</span><span class="stringliteral">        N-d arrays of samples. The arrays must be broadcastable except along</span></div>
<div class="line"><span class="lineno">  263</span><span class="stringliteral">        the dimension given by `axis`.</span></div>
<div class="line"><span class="lineno">  264</span><span class="stringliteral">    use_continuity : bool, optional</span></div>
<div class="line"><span class="lineno">  265</span><span class="stringliteral">            Whether a continuity correction (1/2) should be applied.</span></div>
<div class="line"><span class="lineno">  266</span><span class="stringliteral">            Default is True when `method` is ``&#39;asymptotic&#39;``; has no effect</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">            otherwise.</span></div>
<div class="line"><span class="lineno">  268</span><span class="stringliteral">    alternative : {&#39;two-sided&#39;, &#39;less&#39;, &#39;greater&#39;}, optional</span></div>
<div class="line"><span class="lineno">  269</span><span class="stringliteral">        Defines the alternative hypothesis. Default is &#39;two-sided&#39;.</span></div>
<div class="line"><span class="lineno">  270</span><span class="stringliteral">        Let *F(u)* and *G(u)* be the cumulative distribution functions of the</span></div>
<div class="line"><span class="lineno">  271</span><span class="stringliteral">        distributions underlying `x` and `y`, respectively. Then the following</span></div>
<div class="line"><span class="lineno">  272</span><span class="stringliteral">        alternative hypotheses are available:</span></div>
<div class="line"><span class="lineno">  273</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  274</span><span class="stringliteral">        * &#39;two-sided&#39;: the distributions are not equal, i.e. *F(u) â‰  G(u)* for</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral">          at least one *u*.</span></div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">        * &#39;less&#39;: the distribution underlying `x` is stochastically less</span></div>
<div class="line"><span class="lineno">  277</span><span class="stringliteral">          than the distribution underlying `y`, i.e. *F(u) &gt; G(u)* for all *u*.</span></div>
<div class="line"><span class="lineno">  278</span><span class="stringliteral">        * &#39;greater&#39;: the distribution underlying `x` is stochastically greater</span></div>
<div class="line"><span class="lineno">  279</span><span class="stringliteral">          than the distribution underlying `y`, i.e. *F(u) &lt; G(u)* for all *u*.</span></div>
<div class="line"><span class="lineno">  280</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  281</span><span class="stringliteral">        Under a more restrictive set of assumptions, the alternative hypotheses</span></div>
<div class="line"><span class="lineno">  282</span><span class="stringliteral">        can be expressed in terms of the locations of the distributions;</span></div>
<div class="line"><span class="lineno">  283</span><span class="stringliteral">        see [5] section 5.1.</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">    axis : int, optional</span></div>
<div class="line"><span class="lineno">  285</span><span class="stringliteral">        Axis along which to perform the test. Default is 0.</span></div>
<div class="line"><span class="lineno">  286</span><span class="stringliteral">    method : {&#39;auto&#39;, &#39;asymptotic&#39;, &#39;exact&#39;}, optional</span></div>
<div class="line"><span class="lineno">  287</span><span class="stringliteral">        Selects the method used to calculate the *p*-value.</span></div>
<div class="line"><span class="lineno">  288</span><span class="stringliteral">        Default is &#39;auto&#39;. The following options are available.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">        * ``&#39;asymptotic&#39;``: compares the standardized test statistic</span></div>
<div class="line"><span class="lineno">  291</span><span class="stringliteral">          against the normal distribution, correcting for ties.</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">        * ``&#39;exact&#39;``: computes the exact *p*-value by comparing the observed</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral">          :math:`U` statistic against the exact distribution of the :math:`U`</span></div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">          statistic under the null hypothesis. No correction is made for ties.</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">        * ``&#39;auto&#39;``: chooses ``&#39;exact&#39;`` when the size of one of the samples</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">          is less than 8 and there are no ties; chooses ``&#39;asymptotic&#39;``</span></div>
<div class="line"><span class="lineno">  297</span><span class="stringliteral">          otherwise.</span></div>
<div class="line"><span class="lineno">  298</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  299</span><span class="stringliteral">    Returns</span></div>
<div class="line"><span class="lineno">  300</span><span class="stringliteral">    -------</span></div>
<div class="line"><span class="lineno">  301</span><span class="stringliteral">    res : MannwhitneyuResult</span></div>
<div class="line"><span class="lineno">  302</span><span class="stringliteral">        An object containing attributes:</span></div>
<div class="line"><span class="lineno">  303</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  304</span><span class="stringliteral">        statistic : float</span></div>
<div class="line"><span class="lineno">  305</span><span class="stringliteral">            The Mann-Whitney U statistic corresponding with sample `x`. See</span></div>
<div class="line"><span class="lineno">  306</span><span class="stringliteral">            Notes for the test statistic corresponding with sample `y`.</span></div>
<div class="line"><span class="lineno">  307</span><span class="stringliteral">        pvalue : float</span></div>
<div class="line"><span class="lineno">  308</span><span class="stringliteral">            The associated *p*-value for the chosen `alternative`.</span></div>
<div class="line"><span class="lineno">  309</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  310</span><span class="stringliteral">    Notes</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">    -----</span></div>
<div class="line"><span class="lineno">  312</span><span class="stringliteral">    If ``U1`` is the statistic corresponding with sample `x`, then the</span></div>
<div class="line"><span class="lineno">  313</span><span class="stringliteral">    statistic corresponding with sample `y` is</span></div>
<div class="line"><span class="lineno">  314</span><span class="stringliteral">    `U2 = `x.shape[axis] * y.shape[axis] - U1``.</span></div>
<div class="line"><span class="lineno">  315</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  316</span><span class="stringliteral">    `mannwhitneyu` is for independent samples. For related / paired samples,</span></div>
<div class="line"><span class="lineno">  317</span><span class="stringliteral">    consider `scipy.stats.wilcoxon`.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    `method` ``&#39;exact&#39;`` is recommended when there are no ties and when either</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">    sample size is less than 8 [1]_. The implementation follows the recurrence</span></div>
<div class="line"><span class="lineno">  321</span><span class="stringliteral">    relation originally proposed in [1]_ as it is described in [3]_.</span></div>
<div class="line"><span class="lineno">  322</span><span class="stringliteral">    Note that the exact method is *not* corrected for ties, but</span></div>
<div class="line"><span class="lineno">  323</span><span class="stringliteral">    `mannwhitneyu` will not raise errors or warnings if there are ties in the</span></div>
<div class="line"><span class="lineno">  324</span><span class="stringliteral">    data.</span></div>
<div class="line"><span class="lineno">  325</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">    The Mann-Whitney U test is a non-parametric version of the t-test for</span></div>
<div class="line"><span class="lineno">  327</span><span class="stringliteral">    independent samples. When the the means of samples from the populations</span></div>
<div class="line"><span class="lineno">  328</span><span class="stringliteral">    are normally distributed, consider `scipy.stats.ttest_ind`.</span></div>
<div class="line"><span class="lineno">  329</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  330</span><span class="stringliteral">    See Also</span></div>
<div class="line"><span class="lineno">  331</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    scipy.stats.wilcoxon, scipy.stats.ranksums, scipy.stats.ttest_ind</span></div>
<div class="line"><span class="lineno">  333</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  334</span><span class="stringliteral">    References</span></div>
<div class="line"><span class="lineno">  335</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  336</span><span class="stringliteral">    .. [1] H.B. Mann and D.R. Whitney, &quot;On a test of whether one of two random</span></div>
<div class="line"><span class="lineno">  337</span><span class="stringliteral">           variables is stochastically larger than the other&quot;, The Annals of</span></div>
<div class="line"><span class="lineno">  338</span><span class="stringliteral">           Mathematical Statistics, Vol. 18, pp. 50-60, 1947.</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral">    .. [2] Mann-Whitney U Test, Wikipedia,</span></div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">           http://en.wikipedia.org/wiki/Mann-Whitney_U_test</span></div>
<div class="line"><span class="lineno">  341</span><span class="stringliteral">    .. [3] A. Di Bucchianico, &quot;Combinatorics, computer algebra, and the</span></div>
<div class="line"><span class="lineno">  342</span><span class="stringliteral">           Wilcoxon-Mann-Whitney test&quot;, Journal of Statistical Planning and</span></div>
<div class="line"><span class="lineno">  343</span><span class="stringliteral">           Inference, Vol. 79, pp. 349-364, 1999.</span></div>
<div class="line"><span class="lineno">  344</span><span class="stringliteral">    .. [4] Rosie Shier, &quot;Statistics: 2.3 The Mann-Whitney U Test&quot;, Mathematics</span></div>
<div class="line"><span class="lineno">  345</span><span class="stringliteral">           Learning Support Centre, 2004.</span></div>
<div class="line"><span class="lineno">  346</span><span class="stringliteral">    .. [5] Michael P. Fay and Michael A. Proschan. &quot;Wilcoxon-Mann-Whitney</span></div>
<div class="line"><span class="lineno">  347</span><span class="stringliteral">           or t-test? On assumptions for hypothesis tests and multiple \</span></div>
<div class="line"><span class="lineno">  348</span><span class="stringliteral">           interpretations of decision rules.&quot; Statistics surveys, Vol. 4, pp.</span></div>
<div class="line"><span class="lineno">  349</span><span class="stringliteral">           1-39, 2010. https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2857732/</span></div>
<div class="line"><span class="lineno">  350</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  351</span><span class="stringliteral">    Examples</span></div>
<div class="line"><span class="lineno">  352</span><span class="stringliteral">    --------</span></div>
<div class="line"><span class="lineno">  353</span><span class="stringliteral">    We follow the example from [4]_: nine randomly sampled young adults were</span></div>
<div class="line"><span class="lineno">  354</span><span class="stringliteral">    diagnosed with type II diabetes at the ages below.</span></div>
<div class="line"><span class="lineno">  355</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  356</span><span class="stringliteral">    &gt;&gt;&gt; males = [19, 22, 16, 29, 24]</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">    &gt;&gt;&gt; females = [20, 11, 17, 12]</span></div>
<div class="line"><span class="lineno">  358</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  359</span><span class="stringliteral">    We use the Mann-Whitney U test to assess whether there is a statistically</span></div>
<div class="line"><span class="lineno">  360</span><span class="stringliteral">    significant difference in the diagnosis age of males and females.</span></div>
<div class="line"><span class="lineno">  361</span><span class="stringliteral">    The null hypothesis is that the distribution of male diagnosis ages is</span></div>
<div class="line"><span class="lineno">  362</span><span class="stringliteral">    the same as the distribution of female diagnosis ages. We decide</span></div>
<div class="line"><span class="lineno">  363</span><span class="stringliteral">    that a confidence level of 95% is required to reject the null hypothesis</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral">    in favor of the alternative that the distributions are different.</span></div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">    Since the number of samples is very small and there are no ties in the</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">    data, we can compare the observed test statistic against the *exact*</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    distribution of the test statistic under the null hypothesis.</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  369</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import mannwhitneyu</span></div>
<div class="line"><span class="lineno">  370</span><span class="stringliteral">    &gt;&gt;&gt; U1, p = mannwhitneyu(males, females, method=&quot;exact&quot;)</span></div>
<div class="line"><span class="lineno">  371</span><span class="stringliteral">    &gt;&gt;&gt; print(U1)</span></div>
<div class="line"><span class="lineno">  372</span><span class="stringliteral">    17.0</span></div>
<div class="line"><span class="lineno">  373</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  374</span><span class="stringliteral">    `mannwhitneyu` always reports the statistic associated with the first</span></div>
<div class="line"><span class="lineno">  375</span><span class="stringliteral">    sample, which, in this case, is males. This agrees with :math:`U_M = 17`</span></div>
<div class="line"><span class="lineno">  376</span><span class="stringliteral">    reported in [4]_. The statistic associated with the second statistic</span></div>
<div class="line"><span class="lineno">  377</span><span class="stringliteral">    can be calculated:</span></div>
<div class="line"><span class="lineno">  378</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  379</span><span class="stringliteral">    &gt;&gt;&gt; nx, ny = len(males), len(females)</span></div>
<div class="line"><span class="lineno">  380</span><span class="stringliteral">    &gt;&gt;&gt; U2 = nx*ny - U1</span></div>
<div class="line"><span class="lineno">  381</span><span class="stringliteral">    &gt;&gt;&gt; print(U2)</span></div>
<div class="line"><span class="lineno">  382</span><span class="stringliteral">    3.0</span></div>
<div class="line"><span class="lineno">  383</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  384</span><span class="stringliteral">    This agrees with :math:`U_F = 3` reported in [4]_. The two-sided</span></div>
<div class="line"><span class="lineno">  385</span><span class="stringliteral">    *p*-value can be calculated from either statistic, and the value produced</span></div>
<div class="line"><span class="lineno">  386</span><span class="stringliteral">    by `mannwhitneyu` agrees with :math:`p = 0.11` reported in [4]_.</span></div>
<div class="line"><span class="lineno">  387</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  388</span><span class="stringliteral">    &gt;&gt;&gt; print(p)</span></div>
<div class="line"><span class="lineno">  389</span><span class="stringliteral">    0.1111111111111111</span></div>
<div class="line"><span class="lineno">  390</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  391</span><span class="stringliteral">    The exact distribution of the test statistic is asymptotically normal, so</span></div>
<div class="line"><span class="lineno">  392</span><span class="stringliteral">    the example continues by comparing the exact *p*-value against the</span></div>
<div class="line"><span class="lineno">  393</span><span class="stringliteral">    *p*-value produced using the normal approximation.</span></div>
<div class="line"><span class="lineno">  394</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  395</span><span class="stringliteral">    &gt;&gt;&gt; _, pnorm = mannwhitneyu(males, females, method=&quot;asymptotic&quot;)</span></div>
<div class="line"><span class="lineno">  396</span><span class="stringliteral">    &gt;&gt;&gt; print(pnorm)</span></div>
<div class="line"><span class="lineno">  397</span><span class="stringliteral">    0.11134688653314041</span></div>
<div class="line"><span class="lineno">  398</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  399</span><span class="stringliteral">    Here `mannwhitneyu`&#39;s reported *p*-value appears to conflict with the</span></div>
<div class="line"><span class="lineno">  400</span><span class="stringliteral">    value :math:`p = 0.09` given in [4]_. The reason is that [4]_</span></div>
<div class="line"><span class="lineno">  401</span><span class="stringliteral">    does not apply the continuity correction performed by `mannwhitneyu`;</span></div>
<div class="line"><span class="lineno">  402</span><span class="stringliteral">    `mannwhitneyu` reduces the distance between the test statistic and the</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">    mean :math:`\mu = n_x n_y / 2` by 0.5 to correct for the fact that the</span></div>
<div class="line"><span class="lineno">  404</span><span class="stringliteral">    discrete statistic is being compared against a continuous distribution.</span></div>
<div class="line"><span class="lineno">  405</span><span class="stringliteral">    Here, the :math:`U` statistic used is less than the mean, so we reduce</span></div>
<div class="line"><span class="lineno">  406</span><span class="stringliteral">    the distance by adding 0.5 in the numerator.</span></div>
<div class="line"><span class="lineno">  407</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  408</span><span class="stringliteral">    &gt;&gt;&gt; import numpy as np</span></div>
<div class="line"><span class="lineno">  409</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import norm</span></div>
<div class="line"><span class="lineno">  410</span><span class="stringliteral">    &gt;&gt;&gt; U = min(U1, U2)</span></div>
<div class="line"><span class="lineno">  411</span><span class="stringliteral">    &gt;&gt;&gt; N = nx + ny</span></div>
<div class="line"><span class="lineno">  412</span><span class="stringliteral">    &gt;&gt;&gt; z = (U - nx*ny/2 + 0.5) / np.sqrt(nx*ny * (N + 1)/ 12)</span></div>
<div class="line"><span class="lineno">  413</span><span class="stringliteral">    &gt;&gt;&gt; p = 2 * norm.cdf(z)  # use CDF to get p-value from smaller statistic</span></div>
<div class="line"><span class="lineno">  414</span><span class="stringliteral">    &gt;&gt;&gt; print(p)</span></div>
<div class="line"><span class="lineno">  415</span><span class="stringliteral">    0.11134688653314041</span></div>
<div class="line"><span class="lineno">  416</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  417</span><span class="stringliteral">    If desired, we can disable the continuity correction to get a result</span></div>
<div class="line"><span class="lineno">  418</span><span class="stringliteral">    that agrees with that reported in [4]_.</span></div>
<div class="line"><span class="lineno">  419</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  420</span><span class="stringliteral">    &gt;&gt;&gt; _, pnorm = mannwhitneyu(males, females, use_continuity=False,</span></div>
<div class="line"><span class="lineno">  421</span><span class="stringliteral">    ...                         method=&quot;asymptotic&quot;)</span></div>
<div class="line"><span class="lineno">  422</span><span class="stringliteral">    &gt;&gt;&gt; print(pnorm)</span></div>
<div class="line"><span class="lineno">  423</span><span class="stringliteral">    0.0864107329737</span></div>
<div class="line"><span class="lineno">  424</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  425</span><span class="stringliteral">    Regardless of whether we perform an exact or asymptotic test, the</span></div>
<div class="line"><span class="lineno">  426</span><span class="stringliteral">    probability of the test statistic being as extreme or more extreme by</span></div>
<div class="line"><span class="lineno">  427</span><span class="stringliteral">    chance exceeds 5%, so we do not consider the results statistically</span></div>
<div class="line"><span class="lineno">  428</span><span class="stringliteral">    significant.</span></div>
<div class="line"><span class="lineno">  429</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  430</span><span class="stringliteral">    Suppose that, before seeing the data, we had hypothesized that females</span></div>
<div class="line"><span class="lineno">  431</span><span class="stringliteral">    would tend to be diagnosed at a younger age than males.</span></div>
<div class="line"><span class="lineno">  432</span><span class="stringliteral">    In that case, it would be natural to provide the female ages as the</span></div>
<div class="line"><span class="lineno">  433</span><span class="stringliteral">    first input, and we would have performed a one-sided test using</span></div>
<div class="line"><span class="lineno">  434</span><span class="stringliteral">    ``alternative = &#39;less&#39;``: females are diagnosed at an age that is</span></div>
<div class="line"><span class="lineno">  435</span><span class="stringliteral">    stochastically less than that of males.</span></div>
<div class="line"><span class="lineno">  436</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  437</span><span class="stringliteral">    &gt;&gt;&gt; res = mannwhitneyu(females, males, alternative=&quot;less&quot;, method=&quot;exact&quot;)</span></div>
<div class="line"><span class="lineno">  438</span><span class="stringliteral">    &gt;&gt;&gt; print(res)</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral">    MannwhitneyuResult(statistic=3.0, pvalue=0.05555555555555555)</span></div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">    Again, the probability of getting a sufficiently low value of the</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">    test statistic by chance under the null hypothesis is greater than 5%,</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">    so we do not reject the null hypothesis in favor of our alternative.</span></div>
<div class="line"><span class="lineno">  444</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  445</span><span class="stringliteral">    If it is reasonable to assume that the means of samples from the</span></div>
<div class="line"><span class="lineno">  446</span><span class="stringliteral">    populations are normally distributed, we could have used a t-test to</span></div>
<div class="line"><span class="lineno">  447</span><span class="stringliteral">    perform the analysis.</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral">    &gt;&gt;&gt; from scipy.stats import ttest_ind</span></div>
<div class="line"><span class="lineno">  450</span><span class="stringliteral">    &gt;&gt;&gt; res = ttest_ind(females, males, alternative=&quot;less&quot;)</span></div>
<div class="line"><span class="lineno">  451</span><span class="stringliteral">    &gt;&gt;&gt; print(res)</span></div>
<div class="line"><span class="lineno">  452</span><span class="stringliteral">    Ttest_indResult(statistic=-2.239334696520584, pvalue=0.030068441095757924)</span></div>
<div class="line"><span class="lineno">  453</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  454</span><span class="stringliteral">    Under this assumption, the *p*-value would be low enough to reject the</span></div>
<div class="line"><span class="lineno">  455</span><span class="stringliteral">    null hypothesis in favor of the alternative.</span></div>
<div class="line"><span class="lineno">  456</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  457</span><span class="stringliteral">    &#39;&#39;&#39;</span></div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>    x, y, use_continuity, alternative, axis_int, method = (</div>
<div class="line"><span class="lineno">  460</span>        _mwu_input_validation(x, y, use_continuity, alternative, axis, method))</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    x, y, xy = _broadcast_concatenate(x, y, axis)</div>
<div class="line"><span class="lineno">  463</span> </div>
<div class="line"><span class="lineno">  464</span>    n1, n2 = x.shape[-1], y.shape[-1]</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;auto&quot;</span>:</div>
<div class="line"><span class="lineno">  467</span>        method = _mwu_choose_method(n1, n2, xy, method)</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>    <span class="comment"># Follows [2]</span></div>
<div class="line"><span class="lineno">  470</span>    ranks = stats.rankdata(xy, axis=-1)  <span class="comment"># method 2, step 1</span></div>
<div class="line"><span class="lineno">  471</span>    R1 = ranks[..., :n1].sum(axis=-1)    <span class="comment"># method 2, step 2</span></div>
<div class="line"><span class="lineno">  472</span>    U1 = R1 - n1*(n1+1)/2                <span class="comment"># method 2, step 3</span></div>
<div class="line"><span class="lineno">  473</span>    U2 = n1 * n2 - U1                    <span class="comment"># as U1 + U2 = n1 * n2</span></div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">if</span> alternative == <span class="stringliteral">&quot;greater&quot;</span>:</div>
<div class="line"><span class="lineno">  476</span>        U, f = U1, 1  <span class="comment"># U is the statistic to use for p-value, f is a factor</span></div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordflow">elif</span> alternative == <span class="stringliteral">&quot;less&quot;</span>:</div>
<div class="line"><span class="lineno">  478</span>        U, f = U2, 1  <span class="comment"># Due to symmetry, use SF of U2 rather than CDF of U1</span></div>
<div class="line"><span class="lineno">  479</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  480</span>        U, f = np.maximum(U1, U2), 2  <span class="comment"># multiply SF by two for two-sided test</span></div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    <span class="keywordflow">if</span> method == <span class="stringliteral">&quot;exact&quot;</span>:</div>
<div class="line"><span class="lineno">  483</span>        p = _mwu_state.sf(U.astype(int), n1, n2)</div>
<div class="line"><span class="lineno">  484</span>    <span class="keywordflow">elif</span> method == <span class="stringliteral">&quot;asymptotic&quot;</span>:</div>
<div class="line"><span class="lineno">  485</span>        z = _get_mwu_z(U, n1, n2, ranks, continuity=use_continuity)</div>
<div class="line"><span class="lineno">  486</span>        p = stats.norm.sf(z)</div>
<div class="line"><span class="lineno">  487</span>    p *= f</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    <span class="comment"># Ensure that test statistic is not greater than 1</span></div>
<div class="line"><span class="lineno">  490</span>    <span class="comment"># This could happen for exact test when U = m*n/2</span></div>
<div class="line"><span class="lineno">  491</span>    p = np.clip(p, 0, 1)</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>    <span class="keywordflow">return</span> MannwhitneyuResult(U1, p)</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a8f2fa66e2a64c0d9359fadd96d2b0bfc" name="a8f2fa66e2a64c0d9359fadd96d2b0bfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f2fa66e2a64c0d9359fadd96d2b0bfc">&#9670;&#160;</a></span>_mwu_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu._mwu_state = <a class="el" href="classscipy_1_1stats_1_1__mannwhitneyu_1_1___m_w_u.html">_MWU</a>()</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a6153d670a793bfe725acc1c6999b418c" name="a6153d670a793bfe725acc1c6999b418c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6153d670a793bfe725acc1c6999b418c">&#9670;&#160;</a></span>MannwhitneyuResult</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">scipy.stats._mannwhitneyu.MannwhitneyuResult = namedtuple('MannwhitneyuResult', ('statistic', 'pvalue'))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
