<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tp_Gcs: pandas.core.groupby.grouper Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Tp_Gcs<span id="projectnumber">&#160;1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepandas.html">pandas</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1core.html">core</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1core_1_1groupby.html">groupby</a></li><li class="navelem"><a class="el" href="namespacepandas_1_1core_1_1groupby_1_1grouper.html">grouper</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">pandas.core.groupby.grouper Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1groupby_1_1grouper_1_1_grouper.html">Grouper</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpandas_1_1core_1_1groupby_1_1grouper_1_1_grouping.html">Grouping</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7aa203f85e6099ef16d7068bb49c6a6d" id="r_a7aa203f85e6099ef16d7068bb49c6a6d"><td class="memItemLeft" align="right" valign="top">tuple[<a class="el" href="classpandas_1_1core_1_1groupby_1_1ops_1_1_base_grouper.html">ops.BaseGrouper</a>, frozenset[Hashable], NDFrameT]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1core_1_1groupby_1_1grouper.html#a7aa203f85e6099ef16d7068bb49c6a6d">get_grouper</a> (NDFrameT obj, key=None, int axis=0, level=None, bool sort=True, bool observed=False, bool mutated=False, bool validate=True, bool dropna=True)</td></tr>
<tr class="separator:a7aa203f85e6099ef16d7068bb49c6a6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d4664191f4d6cddd80142a5d87ed26" id="r_a69d4664191f4d6cddd80142a5d87ed26"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1core_1_1groupby_1_1grouper.html#a69d4664191f4d6cddd80142a5d87ed26">_is_label_like</a> (val)</td></tr>
<tr class="separator:a69d4664191f4d6cddd80142a5d87ed26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6823b35663d9b0c108a441112534355" id="r_aa6823b35663d9b0c108a441112534355"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1core_1_1groupby_1_1grouper.html#aa6823b35663d9b0c108a441112534355">_convert_grouper</a> (Index axis, grouper)</td></tr>
<tr class="separator:aa6823b35663d9b0c108a441112534355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f6aba95a853064bf51730e0fec2bf8e" id="r_a8f6aba95a853064bf51730e0fec2bf8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepandas_1_1core_1_1groupby_1_1grouper.html#a8f6aba95a853064bf51730e0fec2bf8e">_check_deprecated_resample_kwargs</a> (kwargs, origin)</td></tr>
<tr class="separator:a8f6aba95a853064bf51730e0fec2bf8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Provide user facing operators for doing the split part of the
split-apply-combine paradigm.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a8f6aba95a853064bf51730e0fec2bf8e" name="a8f6aba95a853064bf51730e0fec2bf8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f6aba95a853064bf51730e0fec2bf8e">&#9670;&#160;</a></span>_check_deprecated_resample_kwargs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.groupby.grouper._check_deprecated_resample_kwargs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>kwargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>origin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Check for use of deprecated parameters in ``resample`` and related functions.

Raises the appropriate warnings if these parameters are detected.
Only sets an approximate ``stacklevel`` for the warnings (see #37603, #36629).

Parameters
----------
kwargs : dict
    Dictionary of keyword arguments to check for deprecated parameters.
origin : object
    From where this function is being called; either Grouper or TimeGrouper. Used
    to determine an approximate stacklevel.
</pre> <div class="fragment"><div class="line"><span class="lineno">  952</span><span class="keyword">def </span>_check_deprecated_resample_kwargs(kwargs, origin):</div>
<div class="line"><span class="lineno">  953</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  954</span><span class="stringliteral">    Check for use of deprecated parameters in ``resample`` and related functions.</span></div>
<div class="line"><span class="lineno">  955</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  956</span><span class="stringliteral">    Raises the appropriate warnings if these parameters are detected.</span></div>
<div class="line"><span class="lineno">  957</span><span class="stringliteral">    Only sets an approximate ``stacklevel`` for the warnings (see #37603, #36629).</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral">    Parameters</span></div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    ----------</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">    kwargs : dict</span></div>
<div class="line"><span class="lineno">  962</span><span class="stringliteral">        Dictionary of keyword arguments to check for deprecated parameters.</span></div>
<div class="line"><span class="lineno">  963</span><span class="stringliteral">    origin : object</span></div>
<div class="line"><span class="lineno">  964</span><span class="stringliteral">        From where this function is being called; either Grouper or TimeGrouper. Used</span></div>
<div class="line"><span class="lineno">  965</span><span class="stringliteral">        to determine an approximate stacklevel.</span></div>
<div class="line"><span class="lineno">  966</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  967</span>    <span class="comment"># Deprecation warning of `base` and `loffset` since v1.1.0:</span></div>
<div class="line"><span class="lineno">  968</span>    <span class="comment"># we are raising the warning here to be able to set the `stacklevel`</span></div>
<div class="line"><span class="lineno">  969</span>    <span class="comment"># properly since we need to raise the `base` and `loffset` deprecation</span></div>
<div class="line"><span class="lineno">  970</span>    <span class="comment"># warning from three different cases:</span></div>
<div class="line"><span class="lineno">  971</span>    <span class="comment">#   core/generic.py::NDFrame.resample</span></div>
<div class="line"><span class="lineno">  972</span>    <span class="comment">#   core/groupby/groupby.py::GroupBy.resample</span></div>
<div class="line"><span class="lineno">  973</span>    <span class="comment">#   core/groupby/grouper.py::Grouper</span></div>
<div class="line"><span class="lineno">  974</span>    <span class="comment"># raising these warnings from TimeGrouper directly would fail the test:</span></div>
<div class="line"><span class="lineno">  975</span>    <span class="comment">#   tests/resample/test_deprecated.py::test_deprecating_on_loffset_and_base</span></div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>    <span class="keywordflow">if</span> kwargs.get(<span class="stringliteral">&quot;base&quot;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  978</span>        warnings.warn(</div>
<div class="line"><span class="lineno">  979</span>            <span class="stringliteral">&quot;&#39;base&#39; in .resample() and in Grouper() is deprecated.\n&quot;</span></div>
<div class="line"><span class="lineno">  980</span>            <span class="stringliteral">&quot;The new arguments that you should use are &#39;offset&#39; or &#39;origin&#39;.\n&quot;</span></div>
<div class="line"><span class="lineno">  981</span>            <span class="stringliteral">&#39;\n&gt;&gt;&gt; df.resample(freq=&quot;3s&quot;, base=2)\n&#39;</span></div>
<div class="line"><span class="lineno">  982</span>            <span class="stringliteral">&quot;\nbecomes:\n&quot;</span></div>
<div class="line"><span class="lineno">  983</span>            <span class="stringliteral">&#39;\n&gt;&gt;&gt; df.resample(freq=&quot;3s&quot;, offset=&quot;2s&quot;)\n&#39;</span>,</div>
<div class="line"><span class="lineno">  984</span>            FutureWarning,</div>
<div class="line"><span class="lineno">  985</span>            stacklevel=find_stack_level(),</div>
<div class="line"><span class="lineno">  986</span>        )</div>
<div class="line"><span class="lineno">  987</span>    <span class="keywordflow">if</span> kwargs.get(<span class="stringliteral">&quot;loffset&quot;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  988</span>        warnings.warn(</div>
<div class="line"><span class="lineno">  989</span>            <span class="stringliteral">&quot;&#39;loffset&#39; in .resample() and in Grouper() is deprecated.\n&quot;</span></div>
<div class="line"><span class="lineno">  990</span>            <span class="stringliteral">&#39;\n&gt;&gt;&gt; df.resample(freq=&quot;3s&quot;, loffset=&quot;8H&quot;)\n&#39;</span></div>
<div class="line"><span class="lineno">  991</span>            <span class="stringliteral">&quot;\nbecomes:\n&quot;</span></div>
<div class="line"><span class="lineno">  992</span>            <span class="stringliteral">&quot;\n&gt;&gt;&gt; from pandas.tseries.frequencies import to_offset&quot;</span></div>
<div class="line"><span class="lineno">  993</span>            <span class="stringliteral">&#39;\n&gt;&gt;&gt; df = df.resample(freq=&quot;3s&quot;).mean()&#39;</span></div>
<div class="line"><span class="lineno">  994</span>            <span class="stringliteral">&#39;\n&gt;&gt;&gt; df.index = df.index.to_timestamp() + to_offset(&quot;8H&quot;)\n&#39;</span>,</div>
<div class="line"><span class="lineno">  995</span>            FutureWarning,</div>
<div class="line"><span class="lineno">  996</span>            stacklevel=find_stack_level(),</div>
<div class="line"><span class="lineno">  997</span>        )</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa6823b35663d9b0c108a441112534355" name="aa6823b35663d9b0c108a441112534355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6823b35663d9b0c108a441112534355">&#9670;&#160;</a></span>_convert_grouper()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pandas.core.groupby.grouper._convert_grouper </td>
          <td>(</td>
          <td class="paramtype">Index&#160;</td>
          <td class="paramname"><em>axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>grouper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  931</span><span class="keyword">def </span>_convert_grouper(axis: Index, grouper):</div>
<div class="line"><span class="lineno">  932</span>    <span class="keywordflow">if</span> isinstance(grouper, dict):</div>
<div class="line"><span class="lineno">  933</span>        <span class="keywordflow">return</span> grouper.get</div>
<div class="line"><span class="lineno">  934</span>    <span class="keywordflow">elif</span> isinstance(grouper, Series):</div>
<div class="line"><span class="lineno">  935</span>        <span class="keywordflow">if</span> grouper.index.equals(axis):</div>
<div class="line"><span class="lineno">  936</span>            <span class="keywordflow">return</span> grouper._values</div>
<div class="line"><span class="lineno">  937</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  938</span>            <span class="keywordflow">return</span> grouper.reindex(axis)._values</div>
<div class="line"><span class="lineno">  939</span>    <span class="keywordflow">elif</span> isinstance(grouper, MultiIndex):</div>
<div class="line"><span class="lineno">  940</span>        <span class="keywordflow">return</span> grouper._values</div>
<div class="line"><span class="lineno">  941</span>    <span class="keywordflow">elif</span> isinstance(grouper, (list, tuple, Index, Categorical, np.ndarray)):</div>
<div class="line"><span class="lineno">  942</span>        <span class="keywordflow">if</span> len(grouper) != len(axis):</div>
<div class="line"><span class="lineno">  943</span>            <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Grouper and axis must be same length&quot;</span>)</div>
<div class="line"><span class="lineno">  944</span> </div>
<div class="line"><span class="lineno">  945</span>        <span class="keywordflow">if</span> isinstance(grouper, (list, tuple)):</div>
<div class="line"><span class="lineno">  946</span>            grouper = com.asarray_tuplesafe(grouper)</div>
<div class="line"><span class="lineno">  947</span>        <span class="keywordflow">return</span> grouper</div>
<div class="line"><span class="lineno">  948</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  949</span>        <span class="keywordflow">return</span> grouper</div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a69d4664191f4d6cddd80142a5d87ed26" name="a69d4664191f4d6cddd80142a5d87ed26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69d4664191f4d6cddd80142a5d87ed26">&#9670;&#160;</a></span>_is_label_like()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"> bool pandas.core.groupby.grouper._is_label_like </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  927</span><span class="keyword">def </span>_is_label_like(val) -&gt; bool:</div>
<div class="line"><span class="lineno">  928</span>    <span class="keywordflow">return</span> isinstance(val, (str, tuple)) <span class="keywordflow">or</span> (val <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> is_scalar(val))</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7aa203f85e6099ef16d7068bb49c6a6d" name="a7aa203f85e6099ef16d7068bb49c6a6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aa203f85e6099ef16d7068bb49c6a6d">&#9670;&#160;</a></span>get_grouper()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> tuple[<a class="el" href="classpandas_1_1core_1_1groupby_1_1ops_1_1_base_grouper.html">ops.BaseGrouper</a>, frozenset[Hashable], NDFrameT] pandas.core.groupby.grouper.get_grouper </td>
          <td>(</td>
          <td class="paramtype">NDFrameT&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>key</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>axis</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>level</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>sort</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>observed</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>mutated</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>validate</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>dropna</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create and return a BaseGrouper, which is an internal
mapping of how to create the grouper indexers.
This may be composed of multiple Grouping objects, indicating
multiple groupers

Groupers are ultimately index mappings. They can originate as:
index mappings, keys to columns, functions, or Groupers

Groupers enable local references to axis,level,sort, while
the passed in axis, level, and sort are 'global'.

This routine tries to figure out what the passing in references
are and then creates a Grouping for each one, combined into
a BaseGrouper.

If observed &amp; we have a categorical grouper, only show the observed
values.

If validate, then check for key/level overlaps.</pre> <div class="fragment"><div class="line"><span class="lineno">  712</span>) -&gt; tuple[ops.BaseGrouper, frozenset[Hashable], NDFrameT]:</div>
<div class="line"><span class="lineno">  713</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  714</span><span class="stringliteral">    Create and return a BaseGrouper, which is an internal</span></div>
<div class="line"><span class="lineno">  715</span><span class="stringliteral">    mapping of how to create the grouper indexers.</span></div>
<div class="line"><span class="lineno">  716</span><span class="stringliteral">    This may be composed of multiple Grouping objects, indicating</span></div>
<div class="line"><span class="lineno">  717</span><span class="stringliteral">    multiple groupers</span></div>
<div class="line"><span class="lineno">  718</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  719</span><span class="stringliteral">    Groupers are ultimately index mappings. They can originate as:</span></div>
<div class="line"><span class="lineno">  720</span><span class="stringliteral">    index mappings, keys to columns, functions, or Groupers</span></div>
<div class="line"><span class="lineno">  721</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  722</span><span class="stringliteral">    Groupers enable local references to axis,level,sort, while</span></div>
<div class="line"><span class="lineno">  723</span><span class="stringliteral">    the passed in axis, level, and sort are &#39;global&#39;.</span></div>
<div class="line"><span class="lineno">  724</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  725</span><span class="stringliteral">    This routine tries to figure out what the passing in references</span></div>
<div class="line"><span class="lineno">  726</span><span class="stringliteral">    are and then creates a Grouping for each one, combined into</span></div>
<div class="line"><span class="lineno">  727</span><span class="stringliteral">    a BaseGrouper.</span></div>
<div class="line"><span class="lineno">  728</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  729</span><span class="stringliteral">    If observed &amp; we have a categorical grouper, only show the observed</span></div>
<div class="line"><span class="lineno">  730</span><span class="stringliteral">    values.</span></div>
<div class="line"><span class="lineno">  731</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  732</span><span class="stringliteral">    If validate, then check for key/level overlaps.</span></div>
<div class="line"><span class="lineno">  733</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  734</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  735</span>    group_axis = obj._get_axis(axis)</div>
<div class="line"><span class="lineno">  736</span> </div>
<div class="line"><span class="lineno">  737</span>    <span class="comment"># validate that the passed single level is compatible with the passed</span></div>
<div class="line"><span class="lineno">  738</span>    <span class="comment"># axis of the object</span></div>
<div class="line"><span class="lineno">  739</span>    <span class="keywordflow">if</span> level <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  740</span>        <span class="comment"># TODO: These if-block and else-block are almost same.</span></div>
<div class="line"><span class="lineno">  741</span>        <span class="comment"># MultiIndex instance check is removable, but it seems that there are</span></div>
<div class="line"><span class="lineno">  742</span>        <span class="comment"># some processes only for non-MultiIndex in else-block,</span></div>
<div class="line"><span class="lineno">  743</span>        <span class="comment"># eg. `obj.index.name != level`. We have to consider carefully whether</span></div>
<div class="line"><span class="lineno">  744</span>        <span class="comment"># these are applicable for MultiIndex. Even if these are applicable,</span></div>
<div class="line"><span class="lineno">  745</span>        <span class="comment"># we need to check if it makes no side effect to subsequent processes</span></div>
<div class="line"><span class="lineno">  746</span>        <span class="comment"># on the outside of this condition.</span></div>
<div class="line"><span class="lineno">  747</span>        <span class="comment"># (GH 17621)</span></div>
<div class="line"><span class="lineno">  748</span>        <span class="keywordflow">if</span> isinstance(group_axis, MultiIndex):</div>
<div class="line"><span class="lineno">  749</span>            <span class="keywordflow">if</span> is_list_like(level) <span class="keywordflow">and</span> len(level) == 1:</div>
<div class="line"><span class="lineno">  750</span>                level = level[0]</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>            <span class="keywordflow">if</span> key <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> is_scalar(level):</div>
<div class="line"><span class="lineno">  753</span>                <span class="comment"># Get the level values from group_axis</span></div>
<div class="line"><span class="lineno">  754</span>                key = group_axis.get_level_values(level)</div>
<div class="line"><span class="lineno">  755</span>                level = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  758</span>            <span class="comment"># allow level to be a length-one list-like object</span></div>
<div class="line"><span class="lineno">  759</span>            <span class="comment"># (e.g., level=[0])</span></div>
<div class="line"><span class="lineno">  760</span>            <span class="comment"># GH 13901</span></div>
<div class="line"><span class="lineno">  761</span>            <span class="keywordflow">if</span> is_list_like(level):</div>
<div class="line"><span class="lineno">  762</span>                nlevels = len(level)</div>
<div class="line"><span class="lineno">  763</span>                <span class="keywordflow">if</span> nlevels == 1:</div>
<div class="line"><span class="lineno">  764</span>                    level = level[0]</div>
<div class="line"><span class="lineno">  765</span>                <span class="keywordflow">elif</span> nlevels == 0:</div>
<div class="line"><span class="lineno">  766</span>                    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;No group keys passed!&quot;</span>)</div>
<div class="line"><span class="lineno">  767</span>                <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  768</span>                    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;multiple levels only valid with MultiIndex&quot;</span>)</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>            <span class="keywordflow">if</span> isinstance(level, str):</div>
<div class="line"><span class="lineno">  771</span>                <span class="keywordflow">if</span> obj._get_axis(axis).name != level:</div>
<div class="line"><span class="lineno">  772</span>                    <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  773</span>                        f<span class="stringliteral">&quot;level name {level} is not the name &quot;</span></div>
<div class="line"><span class="lineno">  774</span>                        f<span class="stringliteral">&quot;of the {obj._get_axis_name(axis)}&quot;</span></div>
<div class="line"><span class="lineno">  775</span>                    )</div>
<div class="line"><span class="lineno">  776</span>            <span class="keywordflow">elif</span> level &gt; 0 <span class="keywordflow">or</span> level &lt; -1:</div>
<div class="line"><span class="lineno">  777</span>                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;level &gt; 0 or level &lt; -1 only valid with MultiIndex&quot;</span>)</div>
<div class="line"><span class="lineno">  778</span> </div>
<div class="line"><span class="lineno">  779</span>            <span class="comment"># NOTE: `group_axis` and `group_axis.get_level_values(level)`</span></div>
<div class="line"><span class="lineno">  780</span>            <span class="comment"># are same in this section.</span></div>
<div class="line"><span class="lineno">  781</span>            level = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  782</span>            key = group_axis</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    <span class="comment"># a passed-in Grouper, directly convert</span></div>
<div class="line"><span class="lineno">  785</span>    <span class="keywordflow">if</span> isinstance(key, Grouper):</div>
<div class="line"><span class="lineno">  786</span>        binner, grouper, obj = key._get_grouper(obj, validate=<span class="keyword">False</span>)</div>
<div class="line"><span class="lineno">  787</span>        <span class="keywordflow">if</span> key.key <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  788</span>            <span class="keywordflow">return</span> grouper, frozenset(), obj</div>
<div class="line"><span class="lineno">  789</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  790</span>            <span class="keywordflow">return</span> grouper, frozenset({key.key}), obj</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    <span class="comment"># already have a BaseGrouper, just return it</span></div>
<div class="line"><span class="lineno">  793</span>    <span class="keywordflow">elif</span> isinstance(key, ops.BaseGrouper):</div>
<div class="line"><span class="lineno">  794</span>        <span class="keywordflow">return</span> key, frozenset(), obj</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(key, list):</div>
<div class="line"><span class="lineno">  797</span>        keys = [key]</div>
<div class="line"><span class="lineno">  798</span>        match_axis_length = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  799</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  800</span>        keys = key</div>
<div class="line"><span class="lineno">  801</span>        match_axis_length = len(keys) == len(group_axis)</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>    <span class="comment"># what are we after, exactly?</span></div>
<div class="line"><span class="lineno">  804</span>    any_callable = any(callable(g) <span class="keywordflow">or</span> isinstance(g, dict) <span class="keywordflow">for</span> g <span class="keywordflow">in</span> keys)</div>
<div class="line"><span class="lineno">  805</span>    any_groupers = any(isinstance(g, (Grouper, Grouping)) <span class="keywordflow">for</span> g <span class="keywordflow">in</span> keys)</div>
<div class="line"><span class="lineno">  806</span>    any_arraylike = any(</div>
<div class="line"><span class="lineno">  807</span>        isinstance(g, (list, tuple, Series, Index, np.ndarray)) <span class="keywordflow">for</span> g <span class="keywordflow">in</span> keys</div>
<div class="line"><span class="lineno">  808</span>    )</div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span>    <span class="comment"># is this an index replacement?</span></div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno">  812</span>        <span class="keywordflow">not</span> any_callable</div>
<div class="line"><span class="lineno">  813</span>        <span class="keywordflow">and</span> <span class="keywordflow">not</span> any_arraylike</div>
<div class="line"><span class="lineno">  814</span>        <span class="keywordflow">and</span> <span class="keywordflow">not</span> any_groupers</div>
<div class="line"><span class="lineno">  815</span>        <span class="keywordflow">and</span> match_axis_length</div>
<div class="line"><span class="lineno">  816</span>        <span class="keywordflow">and</span> level <span class="keywordflow">is</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  817</span>    ):</div>
<div class="line"><span class="lineno">  818</span>        <span class="keywordflow">if</span> isinstance(obj, DataFrame):</div>
<div class="line"><span class="lineno">  819</span>            all_in_columns_index = all(</div>
<div class="line"><span class="lineno">  820</span>                g <span class="keywordflow">in</span> obj.columns <span class="keywordflow">or</span> g <span class="keywordflow">in</span> obj.index.names <span class="keywordflow">for</span> g <span class="keywordflow">in</span> keys</div>
<div class="line"><span class="lineno">  821</span>            )</div>
<div class="line"><span class="lineno">  822</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  823</span>            <span class="keyword">assert</span> isinstance(obj, Series)</div>
<div class="line"><span class="lineno">  824</span>            all_in_columns_index = all(g <span class="keywordflow">in</span> obj.index.names <span class="keywordflow">for</span> g <span class="keywordflow">in</span> keys)</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> all_in_columns_index:</div>
<div class="line"><span class="lineno">  827</span>            keys = [com.asarray_tuplesafe(keys)]</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>    <span class="keywordflow">if</span> isinstance(level, (tuple, list)):</div>
<div class="line"><span class="lineno">  830</span>        <span class="keywordflow">if</span> key <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  831</span>            keys = [<span class="keywordtype">None</span>] * len(level)</div>
<div class="line"><span class="lineno">  832</span>        levels = level</div>
<div class="line"><span class="lineno">  833</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  834</span>        levels = [level] * len(keys)</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>    groupings: list[Grouping] = []</div>
<div class="line"><span class="lineno">  837</span>    exclusions: set[Hashable] = set()</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>    <span class="comment"># if the actual grouper should be obj[key]</span></div>
<div class="line"><span class="lineno">  840</span>    <span class="keyword">def </span>is_in_axis(key) -&gt; bool:</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> _is_label_like(key):</div>
<div class="line"><span class="lineno">  843</span>            <span class="keywordflow">if</span> obj.ndim == 1:</div>
<div class="line"><span class="lineno">  844</span>                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>            <span class="comment"># items -&gt; .columns for DataFrame, .index for Series</span></div>
<div class="line"><span class="lineno">  847</span>            items = obj.axes[-1]</div>
<div class="line"><span class="lineno">  848</span>            <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  849</span>                items.get_loc(key)</div>
<div class="line"><span class="lineno">  850</span>            <span class="keywordflow">except</span> (KeyError, TypeError, InvalidIndexError):</div>
<div class="line"><span class="lineno">  851</span>                <span class="comment"># TypeError shows up here if we pass e.g. Int64Index</span></div>
<div class="line"><span class="lineno">  852</span>                <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>    <span class="comment"># if the grouper is obj[name]</span></div>
<div class="line"><span class="lineno">  857</span>    <span class="keyword">def </span>is_in_obj(gpr) -&gt; bool:</div>
<div class="line"><span class="lineno">  858</span>        <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(gpr, <span class="stringliteral">&quot;name&quot;</span>):</div>
<div class="line"><span class="lineno">  859</span>            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  860</span>        <span class="keywordflow">try</span>:</div>
<div class="line"><span class="lineno">  861</span>            <span class="keywordflow">return</span> gpr <span class="keywordflow">is</span> obj[gpr.name]</div>
<div class="line"><span class="lineno">  862</span>        <span class="keywordflow">except</span> (KeyError, IndexError, InvalidIndexError):</div>
<div class="line"><span class="lineno">  863</span>            <span class="comment"># IndexError reached in e.g. test_skip_group_keys when we pass</span></div>
<div class="line"><span class="lineno">  864</span>            <span class="comment">#  lambda here</span></div>
<div class="line"><span class="lineno">  865</span>            <span class="comment"># InvalidIndexError raised on key-types inappropriate for index,</span></div>
<div class="line"><span class="lineno">  866</span>            <span class="comment">#  e.g. DatetimeIndex.get_loc(tuple())</span></div>
<div class="line"><span class="lineno">  867</span>            <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>    <span class="keywordflow">for</span> gpr, level <span class="keywordflow">in</span> zip(keys, levels):</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>        <span class="keywordflow">if</span> is_in_obj(gpr):  <span class="comment"># df.groupby(df[&#39;name&#39;])</span></div>
<div class="line"><span class="lineno">  872</span>            in_axis = <span class="keyword">True</span></div>
<div class="line"><span class="lineno">  873</span>            exclusions.add(gpr.name)</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>        <span class="keywordflow">elif</span> is_in_axis(gpr):  <span class="comment"># df.groupby(&#39;name&#39;)</span></div>
<div class="line"><span class="lineno">  876</span>            <span class="keywordflow">if</span> gpr <span class="keywordflow">in</span> obj:</div>
<div class="line"><span class="lineno">  877</span>                <span class="keywordflow">if</span> validate:</div>
<div class="line"><span class="lineno">  878</span>                    obj._check_label_or_level_ambiguity(gpr, axis=axis)</div>
<div class="line"><span class="lineno">  879</span>                in_axis, name, gpr = <span class="keyword">True</span>, gpr, obj[gpr]</div>
<div class="line"><span class="lineno">  880</span>                <span class="keywordflow">if</span> gpr.ndim != 1:</div>
<div class="line"><span class="lineno">  881</span>                    <span class="comment"># non-unique columns; raise here to get the name in the</span></div>
<div class="line"><span class="lineno">  882</span>                    <span class="comment"># exception message</span></div>
<div class="line"><span class="lineno">  883</span>                    <span class="keywordflow">raise</span> ValueError(f<span class="stringliteral">&quot;Grouper for &#39;{name}&#39; not 1-dimensional&quot;</span>)</div>
<div class="line"><span class="lineno">  884</span>                exclusions.add(name)</div>
<div class="line"><span class="lineno">  885</span>            <span class="keywordflow">elif</span> obj._is_level_reference(gpr, axis=axis):</div>
<div class="line"><span class="lineno">  886</span>                in_axis, level, gpr = <span class="keyword">False</span>, gpr, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  887</span>            <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  888</span>                <span class="keywordflow">raise</span> KeyError(gpr)</div>
<div class="line"><span class="lineno">  889</span>        <span class="keywordflow">elif</span> isinstance(gpr, Grouper) <span class="keywordflow">and</span> gpr.key <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  890</span>            <span class="comment"># Add key to exclusions</span></div>
<div class="line"><span class="lineno">  891</span>            exclusions.add(gpr.key)</div>
<div class="line"><span class="lineno">  892</span>            in_axis = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  893</span>        <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  894</span>            in_axis = <span class="keyword">False</span></div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>        <span class="comment"># create the Grouping</span></div>
<div class="line"><span class="lineno">  897</span>        <span class="comment"># allow us to passing the actual Grouping as the gpr</span></div>
<div class="line"><span class="lineno">  898</span>        ping = (</div>
<div class="line"><span class="lineno">  899</span>            Grouping(</div>
<div class="line"><span class="lineno">  900</span>                group_axis,</div>
<div class="line"><span class="lineno">  901</span>                gpr,</div>
<div class="line"><span class="lineno">  902</span>                obj=obj,</div>
<div class="line"><span class="lineno">  903</span>                level=level,</div>
<div class="line"><span class="lineno">  904</span>                sort=sort,</div>
<div class="line"><span class="lineno">  905</span>                observed=observed,</div>
<div class="line"><span class="lineno">  906</span>                in_axis=in_axis,</div>
<div class="line"><span class="lineno">  907</span>                dropna=dropna,</div>
<div class="line"><span class="lineno">  908</span>            )</div>
<div class="line"><span class="lineno">  909</span>            <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(gpr, Grouping)</div>
<div class="line"><span class="lineno">  910</span>            <span class="keywordflow">else</span> gpr</div>
<div class="line"><span class="lineno">  911</span>        )</div>
<div class="line"><span class="lineno">  912</span> </div>
<div class="line"><span class="lineno">  913</span>        groupings.append(ping)</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>    <span class="keywordflow">if</span> len(groupings) == 0 <span class="keywordflow">and</span> len(obj):</div>
<div class="line"><span class="lineno">  916</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;No group keys passed!&quot;</span>)</div>
<div class="line"><span class="lineno">  917</span>    <span class="keywordflow">elif</span> len(groupings) == 0:</div>
<div class="line"><span class="lineno">  918</span>        groupings.append(Grouping(Index([], dtype=<span class="stringliteral">&quot;int&quot;</span>), np.array([], dtype=np.intp)))</div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span>    <span class="comment"># create the internals grouper</span></div>
<div class="line"><span class="lineno">  921</span>    grouper = ops.BaseGrouper(</div>
<div class="line"><span class="lineno">  922</span>        group_axis, groupings, sort=sort, mutated=mutated, dropna=dropna</div>
<div class="line"><span class="lineno">  923</span>    )</div>
<div class="line"><span class="lineno">  924</span>    <span class="keywordflow">return</span> grouper, frozenset(exclusions), obj</div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
